{"version":3,"sources":["autocomplete.js","dadata.js","fancybox.js","flickity.js","jquery.validate.js","mask.js","styler.js","touchswipe.js"],"names":["factory","define","amd","exports","require","jQuery","$","Autocomplete","el","options","that","this","element","suggestions","badQueries","selectedIndex","currentValue","value","timeoutId","cachedResponse","onChangeTimeout","onChange","isLocal","suggestionsContainer","noSuggestionsContainer","extend","defaults","classes","selected","suggestion","hint","hintValue","selection","initialize","setOptions","utils","escapeRegExChars","replace","createNode","containerClass","div","document","createElement","className","style","position","display","keys","ESC","TAB","RETURN","LEFT","UP","RIGHT","DOWN","noop","ajaxSettings","autoSelectFirst","appendTo","serviceUrl","lookup","onSelect","width","minChars","maxHeight","deferRequestBy","params","formatResult","pattern","RegExp","formatGroup","category","delimiter","zIndex","type","noCache","onSearchStart","onSearchComplete","onSearchError","preserveInput","tabDisabled","dataType","currentRequest","triggerSelectOnValidInput","preventBadQueries","lookupFilter","originalQuery","queryLowerCase","toLowerCase","indexOf","paramName","transformResult","response","parseJSON","showNoSuggestionNotice","noSuggestionNotice","orientation","forceFixPosition","prototype","container","suggestionSelector","setAttribute","html","get","css","on","activate","data","children","removeClass","select","clearTimeout","blurTimeoutId","fixPositionCapture","visible","fixPosition","window","e","onKeyPress","onKeyUp","onBlur","onFocus","val","length","onValueChange","setTimeout","hide","abortAjax","abort","suppliedOptions","Array","isArray","verifySuggestionsFormat","validateOrientation","max-height","z-index","clearCache","clear","disable","disabled","enable","$container","containerParent","parent","body","containerHeight","outerHeight","height","offset","styles","top","left","viewPortHeight","scrollTop","topOverflow","bottomOverflow","Math","max","parentOffsetDiff","opacity","show","offsetParent","outerWidth","isCursorAtEnd","range","valLength","selectionStart","createRange","moveStart","text","which","onHint","selectHint","moveUp","moveDown","stopImmediatePropagation","preventDefault","suggest","findBestHint","ignoreValueChange","query","getQuery","onInvalidateSelection","call","isExactMatch","getSuggestions","parts","split","trim","getSuggestionsLocal","filter","limit","parseInt","lookupLimit","grep","slice","q","cacheKey","ignoreParams","isFunction","param","isBadQuery","url","ajax","done","result","processResponse","fail","jqXHR","textStatus","errorThrown","i","onHide","signalHint","groupBy","classSelected","beforeRender","index","currentCategory","each","adjustContainerWidth","detach","first","addClass","noSuggestions","empty","append","bestMatch","foundMatch","substr","map","fallback","inArray","push","activeItem","find","adjustScroll","offsetTop","upperBound","lowerBound","heightDelta","getValue","onSelectCallback","dispose","off","removeData","remove","fn","devbridgeAutocomplete","args","arguments","inputElement","instance","autocomplete","global","module","valueStartsWith","field","fieldValue","WORD_DELIMITERS","test","chooseFormattedField","formattedMain","formattedAlt","rHasMatch","formattedField","main","alt","highlightMatches","Suggestions","intervalId","enrichmentCache","inputPhase","Deferred","fetchPhase","enrichPhase","triggering","$wrapper","DEFAULT_OPTIONS","mobile","nowrap","subtext","subtext_inline","subtext_delimiter","subtext_label","removeConstraint","$viewport","$body","status","setupElement","initializer","is","resolve","deferInitialization","proxy","resetTokens","statusRequests","chunks","chunk","escapeHtml","matched","join","nowrapLinkedParts","formattedStr","nowrapClass","delimitedParts","part","hasAnotherSuggestion","s","belongsToArea","parentSuggestion","bounds","all","bound","KEYS","ENTER","SPACE","EVENT_NS","WORD_SPLITTER","WORD_PARTS_SPLITTER","uniqueId","str","&","<",">","\"","'","/","ch","getDefaultType","support","cors","getDefaultContentType","fixURLProtocol","location","protocol","addUrlParams","serialize","JSON","stringify","key","undefined","compactObject","compact","array","delay","handler","prefix","obj","start","indexBy","indexField","areSame","self","a","b","same","arrayMinus","array1","array2","arrayMinusWithPartialMatching","some","el2","arraysIntersection","item","getWords","stopwords","words","lastWord","pop","goodWords","normalize","stringEncloses","str1","str2","fieldsNotEmpty","fields","isPlainObject","getDeepValue","name","path","step","shift","reWordExtractor","getTokens","unformattableTokens","tokens","preferredTokens","formatToken","withSubTokens","concat","token","subtokens","objectKeys","Object","copy","matchers","sameParentChecker","preprocessFn","parentValue","haveSameParent","haveSameParentAddress","matchByNormalizedQuery","normalizedQuery","matches","suggestedValue","matchByWords","queryTokens","suggestionWords","matchByWordsAddress","matchByFields","fieldsStopwords","fieldWords","onSuggestionsFetch","onSelectNothing","timeout","formatSelected","triggerSelectOnSpace","triggerSelectOnEnter","triggerSelectOnBlur","noSuggestionsHint","NAME","ADDRESS","EMAIL","PARTY","BANK","requestMode","count","$helpers","headers","scrollOnFocus","mobileWidth","initializeInterval","ADDRESS_STOPWORDS","ADDRESS_COMPONENTS","id","forBounds","forLocations","kladrFormat","digits","zeros","fiasType","innPartsLengths","LEGAL","INDIVIDUAL","types","urlSuffix","fieldNames","surname","patronymic","alwaysContinueSelecting","isDataComplete","composeValue","dataComponents","dataComponentsById","enrichmentEnabled","geoEnabled","to","region","region_with_type","region_type","region_type_full","area","area_with_type","area_type","area_type_full","city","city_with_type","city_type","city_type_full","settelement","settlement_with_type","settlement_type","settlement","settlement_type_full","cityDistrict","city_district_with_type","city_district_type","city_district","city_district_type_full","street","street_with_type","street_type","street_type_full","house","house_type","block_type","block","flat","flat_type","postal_box","saveCityDistrict","excludeCityDistrict","city_district_fias_id","componentsUnderCityDistrict","_underCityDistrict","unusedTokens","formattedHistoryValues","district","historyValues","history_values","findUnusedTokens","getFormattedHistoryValues","wrapFormattedValue","own","isEmptyObject","copyDataComponents","tokenIndex","unused","historyValueIndex","historyValue","values","formatted","getSuggestionValue","formattedValue","hasSameValues","restrict_value","getValueWithinConstraints","getValueWithinBounds","unrestricted_value","hasBeenEnriched","getUnrestrictedData","data.address.value","data.inn","data.ogrn","formattedInnOGRN","formatResultInn","formattedFIO","address","isMobile","maxLength","innParts","formattedInn","inn","innPartsLength","rDigit","partLength","formattedPart","isQueryRequestable","suggest_local","data.bic","data.swift","formattedBIC","notificator","chains","method","serviceMethods","defaultParams","contentType","addTypeInUrl","detectAddressByIp","findById","requestModes","userSelect","updateValue","createWrapper","notify","bindWindowEvents","timer","events","callback","always","clearInterval","setInterval","isInitialized","state","reject","unbindWindowEvents","removeWrapper","trigger","chainName","apply","after","onMousedown","cancelBlur","target","closest","one","$elements","add","floating","contains","scrollToTop","scrollTarget","animate","option","available","wrapperOffset","origin","elLayout","paddingLeft","parseFloat","paddingRight","borderTop","borderLeft","innerHeight","innerWidth","componentsLeft","componentsRight","currentSelection","abortRequest","isUnavailable","update","updateSuggestions","setSuggestion","checkValueBounds","kladr_id","getBoundedKladrId","fixData","fullQuery","extendedCurrentValue","resolver","selectSuggestion","from_bound","to_bound","parentInstance","getParentInstance","getAjaxParams","custom","partner","serviceMethod","version","xhrFields","withCredentials","constructRequestParams","customParams","hookParams","isNumeric","assignSuggestions","requestOptions","noCallbacks","useEnrichmentCache","doGetSuggestions","enrichResponse","request","setUnrestrictedValues","selectionOptions","typeFormattedValue","hasSame","anotherSuggestion","shouldRestrictValues","constraints","shouldRestrict","label","getFirstConstraintLabel","areSuggestionsSame","methods","attr","bindElementEvents","onElementKeyDown","onElementKeyUp","onElementBlur","onElementFocus","unbindElementEvents","selectCurrentValue","noSpace","cancelFocus","completeOnFocus","continueSelecting","dontEnrich","proceedChangedValue","triggerOnSelectNothing","isElementFocused","setCursorAtEnd","activeElement","ex","selectionEnd","scrollLeft","scrollWidth","methods$1","checkStatus","triggerError","requestKey","search","statusText","locationRequest","defaultGeoLocation","methods$2","checkLocation","providedLocation","geoLocation","resp","locationData","getGeoLocation","constructParams","promise","makeArray","resetLocation","methods$3","enrichSuggestion","enrich","qc","disableDropdown","locations","locations_boost","enableDropdown","enrichedSuggestion","methods$4","createContainer","onSuggestionClick","removeContainer","setContainerOptions","$el","dropdownDisabled","focus","isNaN","setDropdownPosition","toggleClass","containerItemsPadding","setItemsPositions","getSuggestionsItems","toggleDropdownEnabling","hasSuggestionsToChoose","labels","makeSuggestionLabel","eq","tokenMatchers","match","word","rWords","exec","hasUpperCase","matchable","j","matcher","tokenMatch","nextIndex","before","beforeText","beforeDelimiter","splice","nameData","$activeItem","$children","deactivate","restoreValue","itemTop","itemBottom","ADDON_TYPES","NONE","SPINNER","CLEAR","Addon","owner","initialPadding","checkType","addon","isTypeCorrect","toggle","immediate","showBackground","stop","queue","dequeue","duration","complete","hideBackground","addonSize","stopBackground","gotoEnd","onClick","methods$5","createAddon","fixAddonPosition","checkAddonType","checkAddonVisibility","fiasParamNames","ConstraintLocation","fiasFieldNames","fiasFields","specificity","component","fieldName","getFiasSpecificity","getKladrSpecificity","getLabel","getFields","isValid","significantLength","significantKladr","containsData","Constraint","deletable","restrictions","methods$6","createConstraints","$constraints","onConstraintRemoveClick","setConstraintsPosition","round","$item","fadeOut","setupConstraints","$parent","nodeType","unbindFromParent","bindToParent","_constraintsUpdating","constraint","addConstraint","filteredLocation","locationComponents","constructConstraintsParams","parentData","constraints_id","onParentSelectionChanged","onParentDispose","valueChanged","shareWithParent","restrictedKeys","unrestrictedData","maxSpecificity","region_kladr_id","city_kladr_id","methods$7","proceedQuery","findSuggestionIndex","selectFoundSuggestion","onSelectComplete","lastValue","assumeDataComplete","event","methods$8","setupBounds","from","setBoundsOptions","boundIsOwn","indexTo","boundsAvailable","newBounds","boundFrom","boundTo","boundsOwn","boundsAll","constructBoundsParams","valueData","components","boundsRange","defaultOptions","_run","currentTarget","opts","items","selector","active","fancybox","getInstance","current","$orig","open","error","loop","margin","gutter","keyboard","arrows","infobar","toolbar","buttons","idleTime","smallBtn","protect","modal","image","preload","settings","iframe","tpl","scrolling","animationEffect","animationDuration","zoomOpacity","transitionEffect","transitionDuration","slideClass","baseClass","baseTpl","spinnerTpl","errorTpl","btnTpl","slideShow","fullScreen","thumbs","close","parentEl","autoFocus","backFocus","trapFocus","autoStart","touch","vertical","momentum","hash","media","speed","hideOnClose","onInit","beforeLoad","afterLoad","beforeShow","afterShow","beforeClose","afterClose","onActivate","onDeactivate","clickContent","clickSlide","clickOutside","dblclickContent","dblclickSlide","dblclickOutside","lang","i18n","en","CLOSE","NEXT","PREV","ERROR","PLAY_START","PLAY_STOP","FULL_SCREEN","THUMBS","de","$W","$D","called","isQuery","hasOwnProperty","requestAFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","transitionEnd","t","transitions","transition","OTransition","MozTransition","WebkitTransition","forceRedraw","offsetHeight","FancyBox","content","group","currIndex","prevIndex","prevPos","currPos","firstRun","createGroup","$lastFocus","blur","slides","init","testWidth","buttonStr","firstItemOpts","translate","prependTo","$refs","forEach","jumpTo","arr","n","src","srcParts","srcset","charAt","$thumb","caption","addEvents","removeEvents","stopPropagation","previous","next","originalEvent","stage","isClosing","hasClass","has","keycode","keyCode","idleSecondsCounter","isIdle","showControls","idleInterval","hideControls","pos","slide","canvasWidth","currentPos","transitionProps","groupLen","isSliding","isAnimating","createSlide","updateControls","getTranslate","$slide","isMoved","forcedDuration","loadSlide","removeAttr","isLoaded","revealContent","isComplete","updateSlide","scaleToActual","x","y","imgPos","posX","posY","scaleX","scaleY","$what","$content","canvasHeight","newImgWidth","newImgHeight","hasError","updateCursor","SlideShow","isActive","scaleToFit","end","getFitPos","minRatio","imgWidth","imgHeight","min","floor","setTranslate","nextWidth","nextHeight","isZoomable","isScaledDown","fitPos","rez","canPan","abs","ajaxLoad","isLoading","setImage","setIframe","setContent","setError","showLoading","success","found","temp","pxRatio","windowWidth","devicePixelRatio","ret","substring","postfix","sort","thumb","$ghost","setBigImage","$img","$image","timouts","naturalWidth","naturalHeight","hideLoading","readyState","$iframe","Date","getTime","isReady","$wrap","frameWidth","frameHeight","contents","ignore","contentWindow","documentElement","ceil","prepend","$placeholder","insertAfter","$smallBtn","$spinner","button","effect","effectClassName","getThumbPos","slidePos","thumbPos","ownerDocument","elementRect","getBoundingClientRect","parentRects","parentElement","every","parentRect","visiblePixelX","right","visiblePixelY","bottom","isElementVisible","siblings","prev","uid","d","cleanUp","unshift","force","$caption","isHiddenControls","prop","toggleControls","command","destroy","createTouch","navigator","userAgent","use3d","getComputedStyle","getPropertyValue","documentMode","matrix","transRez","props","transform","leaveAnimationName","propertyName","format","youtube","autoplay","autohide","fs","rel","hd","wmode","enablejsapi","html5","paramPlace","vimeo","show_title","show_byline","show_portrait","fullscreen","api","metacafe","dailymotion","additionalInfos","vine","instagram","gmap_place","gmap_search","urlParams","o","provider","m","p","decodeURIComponent","contentProvider","cancelAFrame","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","pointers","touches","changedTouches","pageX","pageY","clientX","clientY","distance","point2","point1","what","sqrt","pow","isClickable","onclick","atts","attributes","nodeName","hasScrollbars","overflowY","overflowX","scrollHeight","clientHeight","horizontal","clientWidth","isScrollable","Guestures","$bg","bg","$stage","ontouchstart","$target","isTouchDevice","startPoints","canTap","startTime","distanceX","distanceY","isPanning","isSwiping","isZooming","sliderStartPos","sliderLastPos","contentStartPos","contentLastPos","centerPointStartX","centerPointStartY","percentageOfImageAtPinchPointX","percentageOfImageAtPinchPointY","startDistanceBetweenFingers","ontouchmove","newPoints","onSwipe","onPan","onZoom","angle","swiping","atan2","PI","inTransition","requestId","newOffsetX","newOffsetY","newPos","limitMovement","newWidth","newHeight","minTranslateX","minTranslateY","maxTranslateX","maxTranslateY","currentOffsetX","currentOffsetY","limitPosition","currentWidth","currentHeight","pinchRatio","translateFromZoomingX","translateFromZoomingY","centerPointEndX","centerPointEndY","translateFromTranslatingX","ontouchend","dMs","panning","zooming","endPoints","onTap","velocityX","velocityY","speedX","endPanning","endZooming","endSwiping","reset","where","tapX","tapY","process","action","startEvent","tapped","$button","set","onInit.fb","beforeShow.fb","afterShow.fb","afterKeydown.fb","keypress","beforeClose.fb onDeactivate.fb","hidden","fnMap","FullScreen","elem","requestFullscreen","ALLOW_KEYBOARD_INPUT","exit","exitFullscreen","isFullscreen","Boolean","fullscreenElement","enabled","fullscreenEnabled","beforeClose.fb","fullscreenchange","FancyThumbs","$grid","$list","isVisible","second","create","list","widthRatio","heightRatio","thumbWidth","thumbHeight","margin-top","margin-left","Thumbs","parseUrl","gallery","triggerFromUrl","escapeSelector","shouldCreateHistory","getGalleryID","sel","asCodePoint","charCodeAt","toString","currentHash","timerID","origHash","history","title","pathname","replaceState","jQueryBridget","namespace","PluginClass","methodCall","$elems","methodName","returnValue","pluginMethodStr","logError","plainCall","_init","arg0","arraySlice","updateJQuery","bridget","console","message","EvEmitter","proto","eventName","listener","_events","listeners","once","onceEvents","_onceEvents","emitEvent","onceListeners","allOff","getSize","getStyleSize","num","getZeroSize","size","measurementsLength","measurements","getStyle","setup","isSetup","padding","borderStyle","borderWidth","boxSizing","appendChild","isBoxSizeOuter","removeChild","querySelector","offsetWidth","isBorderBox","measurement","paddingWidth","paddingHeight","paddingTop","paddingBottom","marginWidth","marginLeft","marginRight","marginHeight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderHeight","borderTopWidth","borderBottomWidth","isBorderBoxSizeOuter","styleWidth","styleHeight","matchesSelector","matchesMethod","ElemProto","Element","prefixes","fizzyUIUtils","modulo","ary","removeFrom","getParent","parentNode","getQueryElement","handleEvent","filterFindElements","elems","ffElems","HTMLElement","childElems","querySelectorAll","debounceMethod","_class","threshold","timeoutName","_this","docReady","addEventListener","toDashed","$1","$2","htmlInit","WidgetClass","dashedNamespace","dataAttr","dataAttrElems","jsDashElems","dataOptionsAttr","getAttribute","parse","Flickity","Cell","side","originSide","setPosition","updateTarget","renderPosition","setDefaultTarget","marginProperty","cellAlign","getPositionValue","wrapShift","slideableWidth","Slide","isOriginLeft","cells","addCell","cell","beginMargin","firstMargin","endMargin","lastCell","getLastCell","lastMargin","slideWidth","changeSelectedClass","unselect","classList","getCellElements","animatePrototype","lastTime","currTime","timeToCall","startAnimation","restingFrames","applyDragForce","applySelectedAttraction","previousX","integratePhysics","positionSlider","settle","transformProperty","wrapAround","shiftWrapCells","cursorPosition","rightToLeft","slider","firstSlide","positionX","progress","slidesWidth","dispatchEvent","positionSliderAtSelected","selectedSlide","percentPosition","isPointerDown","isFreeScrolling","beforeGap","_shiftCells","beforeShiftCells","afterGap","afterShiftCells","gap","cellShift","_unshiftCells","velocity","getFrictionFactor","applyForce","getRestingPosition","dragForce","dragX","selectedAttraction","_Flickity","moveElements","toElem","queryElement","flickityGUID","instances","$element","constructor","_create","GUID","accessibility","freeScrollFriction","friction","namespaceJQueryEvents","resize","setGallerySize","createMethods","guid","viewport","_createSlider","watchCSS","_filterFindCellElements","reloadCells","tabIndex","initialIndex","isInitActivated","cellSelector","_makeCells","positionCells","_getWrapShiftCells","cellElem","getLastSlide","_sizeCells","_positionCells","maxCellHeight","cellX","startCell","len","updateSlides","_containSlides","nextMargin","canCellFit","_getCanCellFit","updateSelectedSlide","groupCells","number","percentMatch","percent","reposition","setCellAlign","cellAlignShorthands","center","shorthand","adaptiveHeight","gapX","cellIndex","_getGapCells","increment","contain","isRightToLeft","contentWidth","isContentSmaller","beginBound","endBound","emitArgs","$event","jQEvent","Event","isWrap","isInstant","_wrapSelect","wrapIndex","delta","backWrapDelta","forewardWrapDelta","isDragSelect","unselectSelectedSlide","selectedCells","selectedElements","selectedCell","selectedElement","selectCell","getCell","getCells","getParentCell","getAdjacentCellElements","adjCount","cellElems","slideIndex","uiChange","childUIPointerDown","onresize","onkeydown","leftMethod","rightMethod","removeAttribute","removeEventListener","setJQuery","jq","Unipointer","bindStartEvent","_bindStartEvent","unbindStartEvent","isBind","bindMethod","PointerEvent","getTouch","identifier","pointerIdentifier","onmousedown","_pointerDown","onpointerdown","pointer","pointerId","pointerDown","_bindPostStartEvents","postStartEvents","mousedown","touchstart","pointerdown","_boundPointerEvents","_unbindPostStartEvents","onmousemove","_pointerMove","onpointermove","pointerMove","onmouseup","_pointerUp","onpointerup","_pointerDone","pointerUp","pointerDone","onpointercancel","_pointerCancel","ontouchcancel","pointerCancel","getPointerPoint","Unidragger","bindHandles","_bindHandles","unbindHandles","handles","handle","touchAction","_touchActionValue","_dragPointerDown","focused","pointerDownPoint","canPreventDefaultOnPointerDown","moveVector","_dragPointerMove","_dragMove","movePoint","isDragging","hasDragStarted","_dragStart","_dragPointerUp","_dragEnd","_staticClick","dragStartPoint","isPreventingClicks","dragStart","dragMove","bind","dragEnd","isIgnoringMouseUp","staticClick","getCanPointerDown","isTouchStart","isTouchPointer","pointerType","isFocusNode","focusNodes","getScrollPosition","pageXOffset","pageYOffset","draggable","dragThreshold","isTouch","isTouchmoveScrollCanceled","_createDrag","bindDrag","_uiChangeDrag","_childUIPointerDownDrag","unbindDrag","isDragBound","pointerDownFocus","cursorNodes","TEXTAREA","INPUT","OPTION","clickTypes","radio","checkbox","submit","file","pointerDownScroll","canPointerDown","prevScrollY","scrollTo","SELECT","isTouchScrolling","dragStartPosition","previousDragX","direction","originBound","dragMoveTime","freeScroll","dragEndRestingSelect","restingX","dragEndBoostSelect","getSlideDistance","positiveResting","_getClosestResting","negativeResting","minDistance","Infinity","condition","md","isWrapAround","wrap","clickedCell","onscroll","scroll","scrollMoveX","scrollMoveY","TapListener","bindTap","unbindTap","tapElement","pointerPoint","boundingRect","scrollX","scrollY","PrevNextButton","getArrowMovements","shape","x0","x1","y1","x2","y2","x3","svgURI","isEnabled","isPrevious","leftDirection","isLeft","svg","createSVG","createElementNS","pathMovements","arrowShape","lastIndex","boundIndex","prevNextButtons","_createPrevNextButtons","prevButton","nextButton","activatePrevNextButtons","deactivatePrevNextButtons","PageDots","holder","dots","setDots","addDots","removeDots","fragment","createDocumentFragment","newDots","dot","updateSelected","selectedDot","pageDots","_createPageDots","activatePageDots","updateSelectedPageDots","updatePageDots","deactivatePageDots","Player","visibilityEvent","onVisibilityChange","visibilityChange","onVisibilityPlay","visibilityPlay","hiddenProperty","play","isPageHidden","tick","time","autoPlay","pause","unpause","pauseAutoPlayOnHover","_createPlayer","player","activatePlayer","stopPlayer","deactivatePlayer","playPlayer","pausePlayer","unpausePlayer","onmouseenter","onmouseleave","getCellsFragment","insert","isAppend","insertCellElement","insertBefore","endCells","selectedIndexDelta","_cellAddedRemoved","changedCellIndex","cellChange","cellSizeChange","isPositioningSlider","prevSlideableWidth","deltaX","getCellLazyImages","imgs","LazyLoader","img","flickity","load","_createLazyload","lazyLoad","lazyImages","lazyCellImages","onload","onerror","lerp","_createAsNavFor","activateAsNavFor","deactivateAsNavFor","destroyAsNavFor","asNavForOption","asNavFor","setNavCompanion","companion","navCompanion","onNavCompanionSelect","navCompanionSelect","onNavStaticClick","firstIndex","selectIndex","removeNavSelectedElements","navSelectedElements","changeNavSelectedClass","navElem","cellElement","imagesLoaded","ImagesLoaded","onAlways","elements","getImages","jqDeferred","check","LoadingImage","Background","Image","images","addElementImages","addImage","background","addElementBackgroundImages","elementNodeTypes","childImgs","child","1","9","11","reURL","backgroundImage","addBackground","loadingImage","onProgress","progressedCount","hasAnyBroken","debug","log","jqMethod","getIsImageComplete","confirm","proxyImage","unbindEvents","makeJQueryPlugin","_createImagesLoaded","validate","validator","onsubmit","submitButton","cancelSubmit","submitHandler","formSubmitted","currentForm","form","pendingRequest","focusInvalid","warn","valid","errorList","rules","argument","staticRules","existingRules","filtered","hasAttribute","normalizeRule","messages","normalizeRules","classRules","attributeRules","dataRules","required","remote","expr","pseudos","blank","filled","unchecked","source","groups","errorClass","pendingClass","validClass","errorElement","focusCleanup","errorContainer","errorLabelContainer","ignoreTitle","onfocusin","lastActive","unhighlight","hideThese","errorsFor","onfocusout","checkable","submitted","optional","onkeyup","elementValue","invalid","highlight","findByName","setDefaults","email","date","dateISO","equalTo","maxlength","minlength","rangelength","autoCreateRanges","delegate","eventType","labelContainer","errorContext","containers","valueCache","pending","invalidHandler","checkForm","errorMap","triggerHandler","showErrors","prepareForm","currentElements","rs","cleanElement","clean","checkElement","validationTargetFor","v","prepareElement","testgroup","numberOfInvalids","toHide","errors","successList","defaultShowErrors","resetForm","hideErrors","resetElements","objectLength","not","addWrapper","findLastActive","rulesCache","resetInternals","toShow","idx","validity","badInput","lastIndexOf","rule","normalizer","rulesCount","dependencyMismatch","TypeError","parameters","formatAndAdd","customDataMessage","toUpperCase","customMessage","String","findDefined","defaultMessage","theregex","toToggle","wrapper","showLabel","validElements","invalidElements","place","errorID","elementID","idOrName","describedBy","errorPlacement","parents","escapeCssMeta","describer","string","getLength","depend","dependTypes","boolean","function","startRequest","stopRequest","previousValue","old","classRuleSettings","creditcard","addClassRules","normalizeAttributeRule","Number","depends","keepRule","parameter","transformed","addMethod","decimals","errorMessage","re","decimalPlaces","toInt","Error","optionDataString","originalMessage","mode","port","context","pendingRequests","ajaxPrefilter","_","xhr","caretTimeoutId","ua","iPhone","chrome","android","mask","definitions","*","autoclear","dataName","placeholder","caret","begin","setSelectionRange","createTextRange","collapse","moveEnd","duplicate","unmask","input","defs","tests","partialPosition","firstNonMaskPos","lastRequiredNonMaskPos","oldVal","completed","c","tryFireCompleted","buffer","getPlaceholder","seekNext","seekPrev","shiftL","writeBuffer","shiftR","blurEvent","checkVal","focusText","change","clearBuffer","allow","lastMatch","defaultBuffer","k","ctrlKey","altKey","metaKey","fromCharCode","curVal","Plugin","locale","locales","onDocumentClick","selectbox","dropdown","pluginName","onSelectClosed","keyup","idSuffix","filePlaceholder","fileBrowse","fileNumber","selectPlaceholder","selectSearch","selectSearchLimit","selectSearchNotFound","selectSearchPlaceholder","selectVisibleOptions","selectSmartPositioning","onSelectOpened","onFormStyled","Attributes","opt","iOS","Android","checkboxOutput","att","click","radioOutput","commonParents","cachedThis","commonParent","inputName","fileOutput","browse","files","numberOutput","interval","changeValue","spin","newValue","multiplier","selectboxOutput","preventScrolling","scrollDiff","wheelDelta","detail","makeList","op","li","liClass","liClasses","dataList","optionClass","optgroupClass","dataJqfsClass","ul","ulHeight","liHeight","clkd","shiftKey","prevAll","nextAll","arrIndexes","doMultipleSelect","searchHTML","selectzIndex","divSelect","divText","optionSelected","notFound","liWidthInner","liWidth","l","selClone","clone","selCloneWidth","selectHeight","searchHeight","isMaxHeight","liSelected","liOuterHeight","win","topOffset","bottomOffset","minHeight","dropDown","maxHeightBottom","maxHeightTop","dropUp","hover","selectedText","liText","mouseout","registered","doSelect","returns","allowPageScroll","swipe","swipeStatus","tap","$this","plugin","PLUGIN_NS","TouchSwipe","touchStart","jqEvent","getTouchInProgress","excludedElements","fallbackToMouseEvents","evt","phase","PHASE_START","fingerCount","preventDefaultEvents","currentDirection","pinchDirection","startTouchesDistance","endTouchesDistance","pinchZoom","pinchDistance","maximumsMap","createMaximumsData","cancelMultiFingerRelease","createFingerData","fingers","ALL_FINGERS","hasPinches","getTimeStamp","calculateTouchesDistance","fingerData","pinchStatus","PHASE_CANCEL","hold","holdTimeout","longTapThreshold","setTouchInProgress","touchMove","PHASE_END","inMultiFingerRelease","currentFinger","updateFingerData","endTime","PHASE_MOVE","calculatePinchDirection","calculatePinchZoom","calculateDirection","last","validateDefaultEvent","calculateDistance","calculateDuration","setMaxDistance","triggerOnTouchEnd","triggerOnTouchLeave","inBounds","getbounds","isInBounds","getNextPhase","touchEnd","startMultiFingerRelease","fingerCountAtRelease","didSwipeBackToCancel","validateSwipeDistance","cancelable","hasTap","triggerHandlerForGesture","TAP","touchCancel","touchLeave","removeListeners","unbind","START_EV","CANCEL_EV","MOVE_EV","END_EV","LEAVE_EV","currentPhase","nextPhase","validTime","validateSwipeTime","validDistance","didCancel","didSwipe","hasSwipes","SWIPE","didPinch","PINCH","didDoubleTap","DOUBLE_TAP","didLongTap","LONG_TAP","didTap","gesture","validateSwipe","singleTapTimeout","swipeLeft","swipeRight","swipeUp","swipeDown","validatePinch","IN","pinchIn","OUT","pinchOut","hasDoubleTap","inDoubleTap","doubleTapStartTime","doubleTapThreshold","doubleTap","longTap","cancelled","cancelThreshold","getMaxDistance","validatePinchDistance","pinchThreshold","maxTimeThreshold","auto","AUTO","HORIZONTAL","VERTICAL","hasCorrectFingerCount","validateFingers","hasEndPoint","validateEndPoint","hasCorrectDistance","hasValidTime","hasValidDistance","SUPPORTS_TOUCH","hasLongTap","validateDoubleTap","now","validateTap","validateLongTap","DOUBLE_TAP_THRESHOLD","previousTouchEndTime","withinThreshold","fingerReleaseThreshold","f","getFingerData","maxData","createMaximumVO","dir","startPoint","endPoint","diffX","diffY","startDistance","endDistance","toFixed","calculateAngle","r","comparePoints","point","pointA","pointB","useTouchEvents","SUPPORTS_POINTER","SUPPORTS_POINTER_IE10","property","msPointerEnabled","pointerEnabled","phases","directions","pageScroll","ONE","TWO","THREE","FOUR","FIVE","ALL"],"mappings":"CAYC,SAAUA,GACP,aACsB,mBAAXC,QAAyBA,OAAOC,IAEvCD,QAAQ,UAAWD,GAGnBA,EAF0B,iBAAZG,SAA2C,mBAAZC,QAErCA,QAAQ,UAGRC,QAVhB,CAYE,SAAUC,GACR,aA8BA,SAASC,EAAaC,EAAIC,GACtB,IAAIC,EAAOC,KAGXD,EAAKE,QAAUJ,EACfE,EAAKF,GAAKF,EAAEE,GACZE,EAAKG,eACLH,EAAKI,cACLJ,EAAKK,eAAiB,EACtBL,EAAKM,aAAeN,EAAKE,QAAQK,MACjCP,EAAKQ,UAAY,KACjBR,EAAKS,kBACLT,EAAKU,gBAAkB,KACvBV,EAAKW,SAAW,KAChBX,EAAKY,SAAU,EACfZ,EAAKa,qBAAuB,KAC5Bb,EAAKc,uBAAyB,KAC9Bd,EAAKD,QAAUH,EAAEmB,UAAWlB,EAAamB,SAAUjB,GACnDC,EAAKiB,SACDC,SAAU,wBACVC,WAAY,2BAEhBnB,EAAKoB,KAAO,KACZpB,EAAKqB,UAAY,GACjBrB,EAAKsB,UAAY,KAGjBtB,EAAKuB,aACLvB,EAAKwB,WAAWzB,GAxDpB,IACI0B,GAEQC,iBAAkB,SAAUnB,GACxB,OAAOA,EAAMoB,QAAQ,sBAAuB,SAEhDC,WAAY,SAAUC,GAClB,IAAIC,EAAMC,SAASC,cAAc,OAIjC,OAHAF,EAAIG,UAAYJ,EAChBC,EAAII,MAAMC,SAAW,WACrBL,EAAII,MAAME,QAAU,OACbN,IAKnBO,GACIC,IAAK,GACLC,IAAK,EACLC,OAAQ,GACRC,KAAM,GACNC,GAAI,GACJC,MAAO,GACPC,KAAM,IAGVC,EAAOjD,EAAEiD,KAiCbhD,EAAa4B,MAAQA,EAErB7B,EAAEC,aAAeA,EAEjBA,EAAamB,UACL8B,gBACAC,iBAAiB,EACjBC,SAAU,OACVC,WAAY,KACZC,OAAQ,KACRC,SAAU,KACVC,MAAO,OACPC,SAAU,EACVC,UAAW,IACXC,eAAgB,EAChBC,UACAC,aAiCR,SAAuBtC,EAAYb,GAE/B,IAAKA,EACD,OAAOa,EAAWZ,MAGtB,IAAImD,EAAU,IAAMjC,EAAMC,iBAAiBpB,GAAgB,IAE3D,OAAOa,EAAWZ,MACboB,QAAQ,IAAIgC,OAAOD,EAAS,MAAO,uBACnC/B,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,UACdA,QAAQ,uBAAwB,SA9CjCiC,YAiDR,SAAsBzC,EAAY0C,GAC9B,MAAO,mCAAqCA,EAAW,UAjDnDC,UAAW,KACXC,OAAQ,KACRC,KAAM,MACNC,SAAS,EACTC,cAAerB,EACfsB,iBAAkBtB,EAClBuB,cAAevB,EACfwB,eAAe,EACfxC,eAAgB,2BAChByC,aAAa,EACbC,SAAU,OACVC,eAAgB,KAChBC,2BAA2B,EAC3BC,mBAAmB,EACnBC,aASR,SAAuBxD,EAAYyD,EAAeC,GAC9C,OAAmE,IAA5D1D,EAAWZ,MAAMuE,cAAcC,QAAQF,IAT1CG,UAAW,QACXC,gBAWR,SAA0BC,GACtB,MAA2B,iBAAbA,EAAwBtF,EAAEuF,UAAUD,GAAYA,GAX1DE,wBAAwB,EACxBC,mBAAoB,aACpBC,YAAa,SACbC,kBAAkB,GAgC1B1F,EAAa2F,WAETjE,WAAY,WACR,IAIIkE,EAJAzF,EAAOC,KACPyF,EAAqB,IAAM1F,EAAKiB,QAAQE,WACxCD,EAAWlB,EAAKiB,QAAQC,SACxBnB,EAAUC,EAAKD,QAInBC,EAAKE,QAAQyF,aAAa,eAAgB,OAG1C3F,EAAKc,uBAAyBlB,EAAE,kDACDgG,KAAK3F,KAAKF,QAAQsF,oBAAoBQ,IAAI,GAEzE7F,EAAKa,qBAAuBhB,EAAa4B,MAAMG,WAAW7B,EAAQ8B,iBAElE4D,EAAY7F,EAAEI,EAAKa,uBAETmC,SAASjD,EAAQiD,UAAY,QAGjB,SAAlBjD,EAAQqD,OACRqC,EAAUK,IAAI,QAAS/F,EAAQqD,OAInCqC,EAAUM,GAAG,yBAA0BL,EAAoB,WACvD1F,EAAKgG,SAASpG,EAAEK,MAAMgG,KAAK,YAI/BR,EAAUM,GAAG,wBAAyB,WAClC/F,EAAKK,eAAiB,EACtBoF,EAAUS,SAAS,IAAMhF,GAAUiF,YAAYjF,KAInDuE,EAAUM,GAAG,qBAAsBL,EAAoB,WACnD1F,EAAKoG,OAAOxG,EAAEK,MAAMgG,KAAK,YAG7BR,EAAUM,GAAG,qBAAsB,WAC/BM,aAAarG,EAAKsG,iBAGtBtG,EAAKuG,mBAAqB,WAClBvG,EAAKwG,SACLxG,EAAKyG,eAIb7G,EAAE8G,QAAQX,GAAG,sBAAuB/F,EAAKuG,oBAEzCvG,EAAKF,GAAGiG,GAAG,uBAAwB,SAAUY,GAAK3G,EAAK4G,WAAWD,KAClE3G,EAAKF,GAAGiG,GAAG,qBAAsB,SAAUY,GAAK3G,EAAK6G,QAAQF,KAC7D3G,EAAKF,GAAGiG,GAAG,oBAAqB,WAAc/F,EAAK8G,WACnD9G,EAAKF,GAAGiG,GAAG,qBAAsB,WAAc/F,EAAK+G,YACpD/G,EAAKF,GAAGiG,GAAG,sBAAuB,SAAUY,GAAK3G,EAAK6G,QAAQF,KAC9D3G,EAAKF,GAAGiG,GAAG,qBAAsB,SAAUY,GAAK3G,EAAK6G,QAAQF,MAGjEI,QAAS,WACL,IAAI/G,EAAOC,KAEXD,EAAKyG,cAEDzG,EAAKF,GAAGkH,MAAMC,QAAUjH,EAAKD,QAAQsD,UACrCrD,EAAKkH,iBAIbJ,OAAQ,WACJ,IAAI9G,EAAOC,KAIXD,EAAKsG,cAAgBa,WAAW,WAC5BnH,EAAKoH,QACN,MAGPC,UAAW,WACP,IAAIrH,EAAOC,KACPD,EAAKwE,iBACLxE,EAAKwE,eAAe8C,QACpBtH,EAAKwE,eAAiB,OAI9BhD,WAAY,SAAU+F,GAClB,IAAIvH,EAAOC,KACPF,EAAUH,EAAEmB,UAAWf,EAAKD,QAASwH,GAEzCvH,EAAKY,QAAU4G,MAAMC,QAAQ1H,EAAQmD,QAEjClD,EAAKY,UACLb,EAAQmD,OAASlD,EAAK0H,wBAAwB3H,EAAQmD,SAG1DnD,EAAQuF,YAActF,EAAK2H,oBAAoB5H,EAAQuF,YAAa,UAGpE1F,EAAEI,EAAKa,sBAAsBiF,KACzB8B,aAAc7H,EAAQuD,UAAY,KAClCF,MAASrD,EAAQqD,MAAQ,KACzByE,UAAW9H,EAAQgE,SAGvB9D,KAAKF,QAAUA,GAInB+H,WAAY,WACR7H,KAAKQ,kBACLR,KAAKG,eAGT2H,MAAO,WACH9H,KAAK6H,aACL7H,KAAKK,aAAe,GACpBL,KAAKE,gBAGT6H,QAAS,WACL,IAAIhI,EAAOC,KACXD,EAAKiI,UAAW,EAChB5B,aAAarG,EAAKU,iBAClBV,EAAKqH,aAGTa,OAAQ,WACJjI,KAAKgI,UAAW,GAGpBxB,YAAa,WAGT,IAAIzG,EAAOC,KACPkI,EAAavI,EAAEI,EAAKa,sBACpBuH,EAAkBD,EAAWE,SAASxC,IAAI,GAG9C,GAAIuC,IAAoBrG,SAASuG,MAAStI,EAAKD,QAAQwF,iBAAvD,CAKA,IAAID,EAActF,EAAKD,QAAQuF,YAC3BiD,EAAkBJ,EAAWK,cAC7BC,EAASzI,EAAKF,GAAG0I,cACjBE,EAAS1I,EAAKF,GAAG4I,SACjBC,GAAWC,IAAOF,EAAOE,IAAKC,KAAQH,EAAOG,MAEjD,GAAoB,SAAhBvD,EAAwB,CACxB,IAAIwD,EAAiBlJ,EAAE8G,QAAQ+B,SAC3BM,EAAYnJ,EAAE8G,QAAQqC,YACtBC,GAAeD,EAAYL,EAAOE,IAAML,EACxCU,EAAiBF,EAAYD,GAAkBJ,EAAOE,IAAMH,EAASF,GAEzEjD,EAAe4D,KAAKC,IAAIH,EAAaC,KAAoBD,EAAe,MAAQ,SAWpF,GAPIL,EAAOC,KADS,QAAhBtD,GACeiD,EAEDE,EAKfL,IAAoBrG,SAASuG,KAAM,CAClC,IACIc,EADAC,EAAUlB,EAAWrC,IAAI,WAGpB9F,EAAKwG,SACN2B,EAAWrC,IAAI,UAAW,GAAGwD,OAGrCF,EAAmBjB,EAAWoB,eAAeb,SAC7CC,EAAOC,KAAOQ,EAAiBR,IAC/BD,EAAOE,MAAQO,EAAiBP,KAE3B7I,EAAKwG,SACN2B,EAAWrC,IAAI,UAAWuD,GAASjC,OAIhB,SAAvBpH,EAAKD,QAAQqD,QACbuF,EAAOvF,MAAQpD,EAAKF,GAAG0J,aAAe,MAG1CrB,EAAWrC,IAAI6C,KAGnBc,cAAe,WACX,IAGIC,EAHA1J,EAAOC,KACP0J,EAAY3J,EAAKF,GAAGkH,MAAMC,OAC1B2C,EAAiB5J,EAAKE,QAAQ0J,eAGlC,MAA8B,iBAAnBA,EACAA,IAAmBD,GAE1B5H,SAAST,aACToI,EAAQ3H,SAAST,UAAUuI,eACrBC,UAAU,aAAcH,GACvBA,IAAcD,EAAMK,KAAK9C,SAKxCL,WAAY,SAAUD,GAClB,IAAI3G,EAAOC,KAGX,GAAKD,EAAKiI,UAAajI,EAAKwG,SAAWG,EAAEqD,QAAU3H,EAAKO,OAAQ5C,EAAKM,cAKrE,IAAIN,EAAKiI,UAAajI,EAAKwG,QAA3B,CAIA,OAAQG,EAAEqD,OACN,KAAK3H,EAAKC,IACNtC,EAAKF,GAAGkH,IAAIhH,EAAKM,cACjBN,EAAKoH,OACL,MACJ,KAAK/E,EAAKM,MACN,GAAI3C,EAAKoB,MAAQpB,EAAKD,QAAQkK,QAAUjK,EAAKyJ,gBAAiB,CAC1DzJ,EAAKkK,aACL,MAEJ,OACJ,KAAK7H,EAAKE,IACN,GAAIvC,EAAKoB,MAAQpB,EAAKD,QAAQkK,OAE1B,YADAjK,EAAKkK,aAGT,IAA4B,IAAxBlK,EAAKK,cAEL,YADAL,EAAKoH,OAIT,GADApH,EAAKoG,OAAOpG,EAAKK,gBACgB,IAA7BL,EAAKD,QAAQuE,YACb,OAEJ,MACJ,KAAKjC,EAAKG,OACN,IAA4B,IAAxBxC,EAAKK,cAEL,YADAL,EAAKoH,OAGTpH,EAAKoG,OAAOpG,EAAKK,eACjB,MACJ,KAAKgC,EAAKK,GACN1C,EAAKmK,SACL,MACJ,KAAK9H,EAAKO,KACN5C,EAAKoK,WACL,MACJ,QACI,OAIRzD,EAAE0D,2BACF1D,EAAE2D,uBApDEtK,EAAKuK,WAuDb1D,QAAS,SAAUF,GACf,IAAI3G,EAAOC,KAEX,IAAID,EAAKiI,SAAT,CAIA,OAAQtB,EAAEqD,OACN,KAAK3H,EAAKK,GACV,KAAKL,EAAKO,KACN,OAGRyD,aAAarG,EAAKU,iBAEdV,EAAKM,eAAiBN,EAAKF,GAAGkH,QAC9BhH,EAAKwK,eACDxK,EAAKD,QAAQwD,eAAiB,EAE9BvD,EAAKU,gBAAkByG,WAAW,WAC9BnH,EAAKkH,iBACNlH,EAAKD,QAAQwD,gBAEhBvD,EAAKkH,mBAKjBA,cAAe,WACX,GAAIjH,KAAKwK,kBACLxK,KAAKwK,mBAAoB,MAD7B,CAKA,IAAIzK,EAAOC,KACPF,EAAUC,EAAKD,QACfQ,EAAQP,EAAKF,GAAGkH,MAChB0D,EAAQ1K,EAAK2K,SAASpK,GAEtBP,EAAKsB,WAAatB,EAAKM,eAAiBoK,IACxC1K,EAAKsB,UAAY,MAChBvB,EAAQ6K,uBAAyBhL,EAAEiD,MAAMgI,KAAK7K,EAAKE,UAGxDmG,aAAarG,EAAKU,iBAClBV,EAAKM,aAAeC,EACpBP,EAAKK,eAAiB,EAGlBN,EAAQ0E,2BAA6BzE,EAAK8K,aAAaJ,GACvD1K,EAAKoG,OAAO,GAIZsE,EAAMzD,OAASlH,EAAQsD,SACvBrD,EAAKoH,OAELpH,EAAK+K,eAAeL,KAI5BI,aAAc,SAAUJ,GACpB,IAAIvK,EAAcF,KAAKE,YAEvB,OAA+B,IAAvBA,EAAY8G,QAAgB9G,EAAY,GAAGI,MAAMuE,gBAAkB4F,EAAM5F,eAGrF6F,SAAU,SAAUpK,GAChB,IACIyK,EADAlH,EAAY7D,KAAKF,QAAQ+D,UAG7B,OAAKA,GAGLkH,EAAQzK,EAAM0K,MAAMnH,GACblE,EAAEsL,KAAKF,EAAMA,EAAM/D,OAAS,KAHxB1G,GAMf4K,oBAAqB,SAAUT,GAC3B,IAKIzE,EAJAlG,EADOE,KACQF,QACf8E,EAAiB6F,EAAM5F,cACvBsG,EAASrL,EAAQ4E,aACjB0G,EAAQC,SAASvL,EAAQwL,YAAa,IAa1C,OAVAtF,GACI9F,YAAaP,EAAE4L,KAAKzL,EAAQmD,OAAQ,SAAU/B,GAC1C,OAAOiK,EAAOjK,EAAYuJ,EAAO7F,MAIrCwG,GAASpF,EAAK9F,YAAY8G,OAASoE,IACnCpF,EAAK9F,YAAc8F,EAAK9F,YAAYsL,MAAM,EAAGJ,IAG1CpF,GAGX8E,eAAgB,SAAUW,GACtB,IAAIxG,EAIA1B,EACAmI,EACA7I,EALA9C,EAAOC,KACPF,EAAUC,EAAKD,QACfkD,EAAalD,EAAQkD,WAKzBlD,EAAQyD,OAAOzD,EAAQiF,WAAa0G,GAE6B,IAA7D3L,EAAQmE,cAAc2G,KAAK7K,EAAKE,QAASH,EAAQyD,UAIrDA,EAASzD,EAAQ6L,aAAe,KAAO7L,EAAQyD,OAE3C5D,EAAEiM,WAAW9L,EAAQmD,QACrBnD,EAAQmD,OAAOwI,EAAG,SAAUzF,GACxBjG,EAAKG,YAAc8F,EAAK9F,YACxBH,EAAKuK,UACLxK,EAAQoE,iBAAiB0G,KAAK7K,EAAKE,QAASwL,EAAGzF,EAAK9F,gBAKxDH,EAAKY,QACLsE,EAAWlF,EAAKmL,oBAAoBO,IAEhC9L,EAAEiM,WAAW5I,KACbA,EAAaA,EAAW4H,KAAK7K,EAAKE,QAASwL,IAE/CC,EAAW1I,EAAa,IAAMrD,EAAEkM,MAAMtI,OACtC0B,EAAWlF,EAAKS,eAAekL,IAG/BzG,GAAYsC,MAAMC,QAAQvC,EAAS/E,cACnCH,EAAKG,YAAc+E,EAAS/E,YAC5BH,EAAKuK,UACLxK,EAAQoE,iBAAiB0G,KAAK7K,EAAKE,QAASwL,EAAGxG,EAAS/E,cAChDH,EAAK+L,WAAWL,GAsBxB3L,EAAQoE,iBAAiB0G,KAAK7K,EAAKE,QAASwL,OArB5C1L,EAAKqH,YAELvE,GACIkJ,IAAK/I,EACLgD,KAAMzC,EACNQ,KAAMjE,EAAQiE,KACdO,SAAUxE,EAAQwE,UAGtB3E,EAAEmB,OAAO+B,EAAc/C,EAAQ+C,cAE/B9C,EAAKwE,eAAiB5E,EAAEqM,KAAKnJ,GAAcoJ,KAAK,SAAUjG,GACtD,IAAIkG,EACJnM,EAAKwE,eAAiB,KACtB2H,EAASpM,EAAQkF,gBAAgBgB,EAAMyF,GACvC1L,EAAKoM,gBAAgBD,EAAQT,EAAGC,GAChC5L,EAAQoE,iBAAiB0G,KAAK7K,EAAKE,QAASwL,EAAGS,EAAOhM,eACvDkM,KAAK,SAAUC,EAAOC,EAAYC,GACjCzM,EAAQqE,cAAcyG,KAAK7K,EAAKE,QAASwL,EAAGY,EAAOC,EAAYC,SAO3ET,WAAY,SAAUL,GAClB,IAAKzL,KAAKF,QAAQ2E,kBACd,OAAO,EAMX,IAHA,IAAItE,EAAaH,KAAKG,WAClBqM,EAAIrM,EAAW6G,OAEZwF,KACH,GAAiC,IAA7Bf,EAAE3G,QAAQ3E,EAAWqM,IACrB,OAAO,EAIf,OAAO,GAGXrF,KAAM,WACF,IAAIpH,EAAOC,KACPwF,EAAY7F,EAAEI,EAAKa,sBAEnBjB,EAAEiM,WAAW7L,EAAKD,QAAQ2M,SAAW1M,EAAKwG,SAC1CxG,EAAKD,QAAQ2M,OAAO7B,KAAK7K,EAAKE,QAASuF,GAG3CzF,EAAKwG,SAAU,EACfxG,EAAKK,eAAiB,EACtBgG,aAAarG,EAAKU,iBAClBd,EAAEI,EAAKa,sBAAsBuG,OAC7BpH,EAAK2M,WAAW,OAGpBpC,QAAS,WACL,GAAKtK,KAAKE,YAAY8G,OAAtB,CASA,IAWIpD,EAXA7D,EAAOC,KACPF,EAAUC,EAAKD,QACf6M,EAAU7M,EAAQ6M,QAClBnJ,EAAe1D,EAAQ0D,aACvBlD,EAAQP,EAAK2K,SAAS3K,EAAKM,cAC3B2B,EAAYjC,EAAKiB,QAAQE,WACzB0L,EAAgB7M,EAAKiB,QAAQC,SAC7BuE,EAAY7F,EAAEI,EAAKa,sBACnBC,EAAyBlB,EAAEI,EAAKc,wBAChCgM,EAAe/M,EAAQ+M,aACvBlH,EAAO,GAEPhC,EAAc,SAAUzC,EAAY4L,GAC5B,IAAIC,EAAkB7L,EAAW8E,KAAK2G,GAEtC,OAAI/I,IAAamJ,EACN,IAGXnJ,EAAWmJ,EAEJjN,EAAQ6D,YAAYzC,EAAY0C,KAG/C9D,EAAQ0E,2BAA6BzE,EAAK8K,aAAavK,GACvDP,EAAKoG,OAAO,IAKhBxG,EAAEqN,KAAKjN,EAAKG,YAAa,SAAUsM,EAAGtL,GAC9ByL,IACAhH,GAAQhC,EAAYzC,EAAYZ,IAGpCqF,GAAQ,eAAiB3D,EAAY,iBAAmBwK,EAAI,KAAOhJ,EAAatC,EAAYZ,EAAOkM,GAAK,WAG5GxM,KAAKiN,uBAELpM,EAAuBqM,SACvB1H,EAAUG,KAAKA,GAEXhG,EAAEiM,WAAWiB,IACbA,EAAajC,KAAK7K,EAAKE,QAASuF,EAAWzF,EAAKG,aAGpDH,EAAKyG,cACLhB,EAAU6D,OAGNvJ,EAAQgD,kBACR/C,EAAKK,cAAgB,EACrBoF,EAAUsD,UAAU,GACpBtD,EAAUS,SAAS,IAAMjE,GAAWmL,QAAQC,SAASR,IAGzD7M,EAAKwG,SAAU,EACfxG,EAAKwK,qBAlEGvK,KAAKF,QAAQqF,uBACbnF,KAAKqN,gBAELrN,KAAKmH,QAkEjBkG,cAAe,WACV,IAAItN,EAAOC,KACP6M,EAAe9M,EAAKD,QAAQ+M,aAC5BrH,EAAY7F,EAAEI,EAAKa,sBACnBC,EAAyBlB,EAAEI,EAAKc,wBAErCb,KAAKiN,uBAILpM,EAAuBqM,SAGvB1H,EAAU8H,QACV9H,EAAU+H,OAAO1M,GAEblB,EAAEiM,WAAWiB,IACbA,EAAajC,KAAK7K,EAAKE,QAASuF,EAAWzF,EAAKG,aAGpDH,EAAKyG,cAELhB,EAAU6D,OACVtJ,EAAKwG,SAAU,GAGnB0G,qBAAsB,WAClB,IAEI9J,EAFApD,EAAOC,KACPF,EAAUC,EAAKD,QAEf0F,EAAY7F,EAAEI,EAAKa,sBAKD,SAAlBd,EAAQqD,OACRA,EAAQpD,EAAKF,GAAG0J,aAChB/D,EAAUK,IAAI,QAAS1C,EAAQ,EAAIA,EAAQ,MACnB,SAAlBrD,EAAQqD,OAGdqC,EAAUK,IAAI,QAAS,KAI/B0E,aAAc,WACV,IAAIxK,EAAOC,KACPM,EAAQP,EAAKF,GAAGkH,MAAMlC,cACtB2I,EAAY,KAEXlN,IAILX,EAAEqN,KAAKjN,EAAKG,YAAa,SAAUsM,EAAGtL,GAClC,IAAIuM,EAA+D,IAAlDvM,EAAWZ,MAAMuE,cAAcC,QAAQxE,GAIxD,OAHImN,IACAD,EAAYtM,IAERuM,IAGZ1N,EAAK2M,WAAWc,KAGpBd,WAAY,SAAUxL,GAClB,IAAIE,EAAY,GACZrB,EAAOC,KACPkB,IACAE,EAAYrB,EAAKM,aAAea,EAAWZ,MAAMoN,OAAO3N,EAAKM,aAAa2G,SAE1EjH,EAAKqB,YAAcA,IACnBrB,EAAKqB,UAAYA,EACjBrB,EAAKoB,KAAOD,GACXlB,KAAKF,QAAQkK,QAAUrK,EAAEiD,MAAMxB,KAIxCqG,wBAAyB,SAAUvH,GAE/B,OAAIA,EAAY8G,QAAoC,iBAAnB9G,EAAY,GAClCP,EAAEgO,IAAIzN,EAAa,SAAUI,GAChC,OAASA,MAAOA,EAAO0F,KAAM,QAI9B9F,GAGXwH,oBAAqB,SAASrC,EAAauI,GAOvC,OANAvI,EAAc1F,EAAEsL,KAAK5F,GAAe,IAAIR,eAEkB,IAAvDlF,EAAEkO,QAAQxI,GAAc,OAAQ,SAAU,UACzCA,EAAcuI,GAGXvI,GAGX8G,gBAAiB,SAAUD,EAAQvH,EAAe+G,GAC9C,IAAI3L,EAAOC,KACPF,EAAUC,EAAKD,QAEnBoM,EAAOhM,YAAcH,EAAK0H,wBAAwByE,EAAOhM,aAGpDJ,EAAQkE,UACTjE,EAAKS,eAAekL,GAAYQ,EAC5BpM,EAAQ2E,oBAAsByH,EAAOhM,YAAY8G,QACjDjH,EAAKI,WAAW2N,KAAKnJ,IAKzBA,IAAkB5E,EAAK2K,SAAS3K,EAAKM,gBAIzCN,EAAKG,YAAcgM,EAAOhM,YAC1BH,EAAKuK,YAGTvE,SAAU,SAAU+G,GAChB,IACIiB,EADAhO,EAAOC,KAEPiB,EAAWlB,EAAKiB,QAAQC,SACxBuE,EAAY7F,EAAEI,EAAKa,sBACnBqF,EAAWT,EAAUwI,KAAK,IAAMjO,EAAKiB,QAAQE,YAMjD,OAJAsE,EAAUwI,KAAK,IAAM/M,GAAUiF,YAAYjF,GAE3ClB,EAAKK,cAAgB0M,GAEO,IAAxB/M,EAAKK,eAAwB6F,EAASe,OAASjH,EAAKK,eACpD2N,EAAa9H,EAASL,IAAI7F,EAAKK,eAC/BT,EAAEoO,GAAYX,SAASnM,GAChB8M,GAGJ,MAGX9D,WAAY,WACR,IAAIlK,EAAOC,KACPwM,EAAI7M,EAAEkO,QAAQ9N,EAAKoB,KAAMpB,EAAKG,aAElCH,EAAKoG,OAAOqG,IAGhBrG,OAAQ,SAAUqG,GACd,IAAIzM,EAAOC,KACXD,EAAKoH,OACLpH,EAAKmD,SAASsJ,IAGlBtC,OAAQ,WACJ,IAAInK,EAAOC,KAEX,IAA4B,IAAxBD,EAAKK,cAIT,OAA2B,IAAvBL,EAAKK,eACLT,EAAEI,EAAKa,sBAAsBqF,WAAWkH,QAAQjH,YAAYnG,EAAKiB,QAAQC,UACzElB,EAAKK,eAAiB,EACtBL,EAAKyK,mBAAoB,EACzBzK,EAAKF,GAAGkH,IAAIhH,EAAKM,mBACjBN,EAAKwK,qBAITxK,EAAKkO,aAAalO,EAAKK,cAAgB,IAG3C+J,SAAU,WACN,IAAIpK,EAAOC,KAEPD,EAAKK,gBAAmBL,EAAKG,YAAY8G,OAAS,GAItDjH,EAAKkO,aAAalO,EAAKK,cAAgB,IAG3C6N,aAAc,SAAUnB,GACpB,IAAI/M,EAAOC,KACP+N,EAAahO,EAAKgG,SAAS+G,GAE/B,GAAKiB,EAAL,CAIA,IAAIG,EACAC,EACAC,EACAC,EAAc1O,EAAEoO,GAAYxF,cAEhC2F,EAAYH,EAAWG,UAEvBE,GADAD,EAAaxO,EAAEI,EAAKa,sBAAsBkI,aAChB/I,EAAKD,QAAQuD,UAAYgL,EAE/CH,EAAYC,EACZxO,EAAEI,EAAKa,sBAAsBkI,UAAUoF,GAChCA,EAAYE,GACnBzO,EAAEI,EAAKa,sBAAsBkI,UAAUoF,EAAYnO,EAAKD,QAAQuD,UAAYgL,GAG3EtO,EAAKD,QAAQsE,gBAKdrE,EAAKyK,mBAAoB,EACzBzK,EAAKF,GAAGkH,IAAIhH,EAAKuO,SAASvO,EAAKG,YAAY4M,GAAOxM,SAGtDP,EAAK2M,WAAW,QAGpBxJ,SAAU,SAAU4J,GAChB,IAAI/M,EAAOC,KACPuO,EAAmBxO,EAAKD,QAAQoD,SAChChC,EAAanB,EAAKG,YAAY4M,GAElC/M,EAAKM,aAAeN,EAAKuO,SAASpN,EAAWZ,OAEzCP,EAAKM,eAAiBN,EAAKF,GAAGkH,OAAUhH,EAAKD,QAAQsE,eACrDrE,EAAKF,GAAGkH,IAAIhH,EAAKM,cAGrBN,EAAK2M,WAAW,MAChB3M,EAAKG,eACLH,EAAKsB,UAAYH,EAEbvB,EAAEiM,WAAW2C,IACbA,EAAiB3D,KAAK7K,EAAKE,QAASiB,IAI5CoN,SAAU,SAAUhO,GAChB,IAEID,EACA0K,EAHAhL,EAAOC,KACP6D,EAAY9D,EAAKD,QAAQ+D,UAI7B,OAAKA,GAILxD,EAAeN,EAAKM,aAGC,KAFrB0K,EAAQ1K,EAAa2K,MAAMnH,IAEjBmD,OACC1G,EAGJD,EAAaqN,OAAO,EAAGrN,EAAa2G,OAAS+D,EAAMA,EAAM/D,OAAS,GAAGA,QAAU1G,GAV3EA,GAafkO,QAAS,WACL,IAAIzO,EAAOC,KACXD,EAAKF,GAAG4O,IAAI,iBAAiBC,WAAW,gBACxC/O,EAAE8G,QAAQgI,IAAI,sBAAuB1O,EAAKuG,oBAC1C3G,EAAEI,EAAKa,sBAAsB+N,WAKrChP,EAAEiP,GAAGC,sBAAwB,SAAU/O,EAASgP,GAI5C,OAAKC,UAAU/H,OAIRhH,KAAKgN,KAAK,WACb,IAAIgC,EAAerP,EAAEK,MACjBiP,EAAWD,EAAahJ,KATlB,gBAWa,iBAAZlG,EACHmP,GAAyC,mBAAtBA,EAASnP,IAC5BmP,EAASnP,GAASgP,IAIlBG,GAAYA,EAAST,SACrBS,EAAST,UAEbS,EAAW,IAAIrP,EAAaI,KAAMF,GAClCkP,EAAahJ,KArBP,eAqBqBiJ,MAjBxBjP,KAAKmN,QAAQnH,KAJV,iBA2BbrG,EAAEiP,GAAGM,eACNvP,EAAEiP,GAAGM,aAAevP,EAAEiP,GAAGC;CC39BhC,SAAUM,EAAQ9P,GACC,iBAAZG,SAA0C,oBAAX4P,OAAyB/P,EAAQI,QAAQ,WAC7D,mBAAXH,QAAyBA,OAAOC,IAAMD,QAAQ,UAAWD,GAC/DA,EAAQ8P,EAAOzP,QAHjB,CAIEM,KAAM,SAAWL,GAAK,aAqrBxB,SAAS0P,EAAiBnO,EAAYoO,GAClC,IAAIC,EAAarO,EAAW8E,MAAQ9E,EAAW8E,KAAKsJ,GAEpD,OAAOC,GACH,IAAI7L,OAAO,IAAMlC,EAAMC,iBAAiB8N,GAAc,KAAOC,EAAkB,OAAO,KACjFC,KAAKvO,EAAWZ,OAG7B,SAASoP,EAAsBC,EAAeC,GAC1C,OAAOC,EAAUJ,KAAKG,KAAkBC,EAAUJ,KAAKE,GACjDC,EACAD,EAGV,SAASG,EAAgBC,EAAMC,EAAK3P,EAAca,EAAYpB,GAC1D,IAAIC,EAAOC,KAIX,OAAO0P,EAHa3P,EAAKkQ,iBAAiBF,EAAM1P,EAAca,EAAYpB,GACvDC,EAAKkQ,iBAAiBD,EAAK3P,EAAca,EAAYpB,IAkc5E,SAASoQ,EAAYrQ,EAAIC,GACrB,IAAIC,EAAOC,KAGXD,EAAKE,QAAUJ,EACfE,EAAKF,GAAKF,EAAEE,GACZE,EAAKG,eACLH,EAAKI,cACLJ,EAAKK,eAAiB,EACtBL,EAAKM,aAAeN,EAAKE,QAAQK,MACjCP,EAAKoQ,WAAa,EAClBpQ,EAAKS,kBACLT,EAAKqQ,mBACLrQ,EAAKwE,eAAiB,KACtBxE,EAAKsQ,WAAa1Q,EAAE2Q,WACpBvQ,EAAKwQ,WAAa5Q,EAAE2Q,WACpBvQ,EAAKyQ,YAAc7Q,EAAE2Q,WACrBvQ,EAAKU,gBAAkB,KACvBV,EAAK0Q,cACL1Q,EAAK2Q,SAAW,KAChB3Q,EAAKD,QAAUH,EAAEmB,UAAW6P,EAAiB7Q,GAC7CC,EAAKiB,SACDG,KAAM,mBACNyP,OAAQ,qBACRC,OAAQ,qBACR5P,SAAU,uBACVC,WAAY,yBACZ4P,QAAS,sBACTC,eAAgB,iDAChBC,kBAAmB,gCACnBC,cAAe,gDACfC,iBAAkB,qBAClB5Q,MAAO,qBAEXP,EAAKiI,UAAW,EAChBjI,EAAKsB,UAAY,KACjBtB,EAAKoR,UAAYxR,EAAE8G,QACnB1G,EAAKqR,MAAQzR,EAAEmC,SAASuG,MACxBtI,EAAKgE,KAAO,KACZhE,EAAKsR,UAELtR,EAAKuR,eAELvR,EAAKwR,YAAc5R,EAAE2Q,WAEjBvQ,EAAKF,GAAG2R,GAAG,YACXzR,EAAKwR,YAAYE,UAEjB1R,EAAK2R,sBAGT3R,EAAKwR,YAAYtF,KAAKtM,EAAEgS,MAAM5R,EAAKuB,WAAYvB,IA09BnD,SAAS6R,IACLjS,EAAEqN,KAAK6E,EAAgB,WACnB7R,KAAKqH,UAETwK,KAkNJ,SAAS5B,EAAiB6B,GACtB,OAAOnS,EAAEgO,IAAImE,EAAQ,SAAUC,GAC3B,IAAIjI,EAAOtI,EAAMwQ,WAAWD,EAAMjI,MAKlC,OAHIA,GAAQiI,EAAME,UACdnI,EAAO,WAAaA,EAAO,aAExBA,IACRoI,KAAK,IAGZ,SAASC,EAAkBC,EAAcC,GACrC,IAAIC,EAAiBF,EAAapH,MAAM,MAExC,OAA8B,IAA1BsH,EAAetL,OACRoL,EAGJzS,EAAEgO,IAAI2E,EAAgB,SAAUC,GACnC,MAAO,gBAAkBF,EAAc,KAAOE,EAAO,YACtDL,KAAK,MAGZ,SAASM,EAAsBtS,EAAagB,GACxC,IAAIgL,GAAS,EASb,OAPAvM,EAAEqN,KAAK9M,EAAa,SAAUsM,EAAGiG,GAE7B,GADAvG,EAASuG,EAAEnS,OAASY,EAAWZ,OAASmS,GAAKvR,EAEzC,OAAO,IAIRgL,EA0vBX,SAASwG,EAAcxR,EAAY+N,GAC/B,IAAI0D,EAAmB1D,EAAS5N,UAC5B6K,EAASyG,GAAoBA,EAAiB3M,MAAQiJ,EAAS2D,OAOnE,OALI1G,GACAvM,EAAEqN,KAAKiC,EAAS2D,OAAOC,IAAK,SAAUrG,EAAGsG,GACrC,OAAQ5G,EAASyG,EAAiB3M,KAAK8M,KAAW5R,EAAW8E,KAAK8M,KAGnE5G,EA7oGXvM,EAAI,YAAaA,EAAIA,EAAW,QAAIA,EAEpC,IAAIoT,GACIC,MAAO,GACP3Q,IAAO,GACPC,IAAO,EACP2Q,MAAO,GACPxQ,GAAO,GACPE,KAAO,IAEXuQ,EAAW,eAEX1D,EAAkB,0CAClB2D,EAAgB,IAAIzP,OAAO,IAAM8L,EAAkB,KAAM,KAEzD4D,EAAsB,IAAI1P,OAAO,6BAAoC,KAErElC,EAAS,WACT,IAAI6R,EAAW,EACf,OACI5R,iBAAkB,SAAUnB,GACxB,OAAOA,EAAMoB,QAAQ,sCAAuC,SAEhEsQ,WAAY,SAAUsB,GAelB,OALIA,GACA3T,EAAEqN,MATFuG,IAAK,QACLC,IAAK,OACLC,IAAK,OACLC,IAAK,SACLC,IAAK,SACLC,IAAK,UAIO,SAASC,EAAIlO,GACrB2N,EAAMA,EAAI5R,QAAQ,IAAIgC,OAAOmQ,EAAI,KAAMlO,KAGxC2N,GAEXQ,eAAgB,WACZ,OAAQnU,EAAEoU,QAAQC,KAAO,OAAS,OAEtCC,sBAAuB,WACnB,OAAQtU,EAAEoU,QAAQC,KAAO,mBAAqB,qCAElDE,eAAgB,SAASnI,GACrB,OAAOpM,EAAEoU,QAAQC,KAAOjI,EAAMA,EAAIrK,QAAQ,WAAYyS,SAASC,WAEnEC,aAAc,SAAUtI,EAAKxI,GACzB,OAAOwI,GAAO,KAAK0D,KAAK1D,GAAO,IAAM,KAAOpM,EAAEkM,MAAMtI,IAExD+Q,UAAW,SAAUtO,GACjB,OAAIrG,EAAEoU,QAAQC,KACHO,KAAKC,UAAUxO,EAAM,SAAUyO,EAAKnU,GACvC,OAAiB,OAAVA,OAAiBoU,EAAYpU,KAGxC0F,EAAOhG,KAAK2U,cAAc3O,GACnBrG,EAAEkM,MAAM7F,GAAM,KAG7B4O,QAAS,SAAUC,GACf,OAAOlV,EAAE4L,KAAKsJ,EAAO,SAAUhV,GAC3B,QAASA,KAGjBiV,MAAO,SAAUC,EAASD,GACtB,OAAO5N,WAAW6N,EAASD,GAAS,IAExCzB,SAAU,SAAU2B,GAChB,OAAQA,GAAU,OAAQ3B,GAE9B7H,MAAO,SAASyJ,EAAKC,GACjB,OAAO3N,MAAMhC,UAAUiG,MAAMZ,KAAKqK,EAAKC,IAE3CC,QAAS,SAAUnP,EAAMsJ,EAAO8F,GAC5B,IAAIlJ,KAaJ,OAXAvM,EAAEqN,KAAKhH,EAAM,SAAUwG,EAAGyI,GACtB,IAAIR,EAAMQ,EAAI3F,GACVvI,KAEAqO,IACArO,EAAIqO,GAAc5I,GAGtBN,EAAOuI,GAAO9U,EAAEmB,QAAO,EAAMiG,EAAKkO,KAG/B/I,GASXmJ,QAAS,SAASC,EAAKC,EAAGC,GACtB,IAAIC,GAAO,EAEX,cAAWF,UAAYC,IAIP,iBAALD,GAAsB,MAALA,GAAkB,MAALC,GACrC7V,EAAEqN,KAAKuI,EAAG,SAAU/I,EAAGlM,GACnB,OAAOmV,EAAOH,EAAKhV,EAAOkV,EAAEhJ,MAEzBiJ,GAGJF,IAAMC,IAMjBE,WAAY,SAASC,EAAQC,GACzB,OAAOA,EAASjW,EAAE4L,KAAKoK,EAAQ,SAAS9V,EAAI2M,GACxC,OAAkC,IAA3B7M,EAAEkO,QAAQhO,EAAI+V,KACpBD,GAMTE,8BAA+B,SAASF,EAAQC,GAC5C,OAAOA,EAASjW,EAAE4L,KAAKoK,EAAQ,SAAS9V,EAAI2M,GACxC,OAAQoJ,EAAOE,KAAK,SAASC,GACzB,OAA2B,IAApBA,EAAIjR,QAAQjF,OAEtB8V,GASTK,mBAAoB,SAASL,EAAQC,GACjC,IAAI1J,KACJ,OAAKvM,EAAE6H,QAAQmO,IAAYhW,EAAE6H,QAAQoO,IAGrCjW,EAAEqN,KAAK2I,EAAQ,SAAS7I,EAAOmJ,GACvBtW,EAAEkO,QAAQoI,EAAML,IAAW,GAC3B1J,EAAO4B,KAAKmI,KAGb/J,GAPIA,GASfgK,SAAU,SAAS5C,EAAK6C,GAEpB7C,EAAMA,EAAI5R,QAAQ,yBAA0B,SACvCA,QAAQ,sBAAuB,SAEpC,IAAI0U,EAAQpW,KAAK4U,QAAQtB,EAAItI,MAAMmI,IAC/BkD,EAAWD,EAAME,MACjBC,EAAYvW,KAAK0V,WAAWU,EAAOD,GAGvC,OADAI,EAAUzI,KAAKuI,GACRE,GAKXC,UAAW,SAASlD,EAAK6C,GAErB,OADWnW,KACCkW,SAAS5C,EAAK6C,GAAWjE,KAAK,MAK9CuE,eAAgB,SAASC,EAAMC,GAC3B,OAAOD,EAAK1P,OAAS2P,EAAK3P,SAAkC,IAAxB0P,EAAK5R,QAAQ6R,IAErDC,eAAgB,SAAS3B,EAAK4B,GAC1B,IAAKlX,EAAEmX,cAAc7B,GACjB,OAAO,EAEX,IAAI/I,GAAS,EAIb,OAHAvM,EAAEqN,KAAK6J,EAAQ,SAAUrK,EAAG8C,GACxB,OAAOpD,IAAY+I,EAAI3F,KAEpBpD,GAEX6K,aAAc,SAASzB,EAAKL,EAAK+B,GAC7B,IAAIC,EAAOD,EAAKhM,MAAM,KAClBkM,EAAOD,EAAKE,QAEhB,OAAOlC,IAAQgC,EAAKjQ,OAASsO,EAAKL,EAAIiC,GAAOD,EAAK/E,KAAK,MAAQ+C,EAAIiC,KAEvEE,gBAAiB,WACb,OAAO,IAAI1T,OAAO,MAAQ8L,EAAkB,QAAUA,EAAkB,MAAO,MAKnF6H,UAAW,SAAS/W,EAAOgX,GACvB,IAAIC,EACAC,EAQJ,OANAD,EAASvX,KAAK4U,QAAQ5U,KAAKyX,YAAYnX,GAAO0K,MAAMmI,IAGpDqE,EAAkBxX,KAAK0V,WAAW6B,EAAQD,GAC1CC,EAASvX,KAAK0X,cAAcF,EAAgBG,OAAO3X,KAAK0V,WAAW6B,EAAQC,MAI/EC,YAAa,SAAUG,GACnB,OAAOA,GAASA,EAAM/S,cAAcnD,QAAQ,QAAS,MAEzDgW,cAAe,SAAUH,GACrB,IAAIrL,KAYJ,OAVAvM,EAAEqN,KAAKuK,EAAQ,SAAU/K,EAAGoL,GACxB,IAAIC,EAAYD,EAAM5M,MAAMoI,GAE5BlH,EAAO4B,KAAK8J,GAERC,EAAU7Q,OAAS,IACnBkF,EAASA,EAAOyL,OAAOnW,EAAMoT,QAAQiD,OAItC3L,GASX4L,WAAY,SAAS7C,GACjB,GAAI8C,OAAO3V,KACP,OAAO2V,OAAO3V,KAAK6S,GAEvB,IAAI7S,KAIJ,OAHAzC,EAAEqN,KAAKiI,EAAK,SAAS+B,GACjB5U,EAAK0L,KAAKkJ,KAEP5U,GAOXuS,cAAe,SAASM,GACpB,IAAI+C,EAAOrY,EAAEmB,QAAO,KAAUmU,GAQ9B,OANAtV,EAAEqN,KAAKgL,EAAM,SAAUvD,EAAK1N,GACZ,OAARA,QAAwB2N,IAAR3N,GAA6B,KAARA,UAC9BiR,EAAKvD,KAIbuD,IArPP,GA+PRC,EAAW,WAOX,SAASC,EAAmBC,GACxB,OAAO,SAAUjY,GACb,GAA2B,IAAvBA,EAAY8G,OACZ,OAAO,EAEX,GAA2B,IAAvB9G,EAAY8G,OACZ,OAAO,EAGX,IAAIoR,EAAcD,EAAajY,EAAY,GAAGI,OAK9C,OAAyB,IAJZX,EAAE4L,KAAKrL,EAAa,SAAUgB,GACnC,OAA+D,IAAxDiX,EAAajX,EAAWZ,OAAOwE,QAAQsT,KAC/C,GAEOpR,QAQtB,IAAIqR,EAAiBH,EAAkB,SAASnR,GAAO,OAAOA,IAM1DuR,EAAwBJ,EAAkB,SAASnR,GACnD,OAAOA,EAAIrF,QAAQ,wBAAyB,MAGhD,OAKI6W,uBAAwB,SAAU9N,EAAOvK,GACrC,IAAI0E,EAAiB6F,EAAM5F,cACvBsR,EAAYnW,MAAQA,KAAKmW,UACzBqC,EAAkBhX,EAAMgV,UAAU5R,EAAgBuR,GAClDsC,KAmBJ,OAjBA9Y,EAAEqN,KAAK9M,EAAa,SAASsM,EAAGtL,GAC5B,IAAIwX,EAAiBxX,EAAWZ,MAAMuE,cAGtC,OAAIrD,EAAMiV,eAAe7R,EAAgB8T,OAKrCA,EAAe5T,QAAQ0T,GAAmB,SAG1CA,IAAoBhX,EAAMgV,UAAUkC,EAAgBvC,IACpDsC,EAAQ3K,KAAKtB,OAIK,IAAnBiM,EAAQzR,OAAeyR,EAAQ,IAAM,GAOhDE,aAAc,SAAUlO,EAAOvK,GAC3B,IAEI0Y,EAFAzC,EAAYnW,MAAQA,KAAKmW,UACzBvR,EAAiB6F,EAAM5F,cAEvB4T,KAqBJ,OAnBIJ,EAAenY,KACf0Y,EAAcpX,EAAMkW,cAAclW,EAAM0U,SAAStR,EAAgBuR,IAEjExW,EAAEqN,KAAK9M,EAAa,SAASsM,EAAGtL,GAC5B,IAAIwX,EAAiBxX,EAAWZ,MAAMuE,cAEtC,GAAIrD,EAAMiV,eAAe7R,EAAgB8T,GACrC,OAAO,EAIX,IAAIG,EAAkBrX,EAAMkW,cAAclW,EAAM0U,SAASwC,EAAgBvC,IAEX,IAA1D3U,EAAMkU,WAAWkD,EAAaC,GAAiB7R,QAC/CyR,EAAQ3K,KAAKtB,MAKC,IAAnBiM,EAAQzR,OAAeyR,EAAQ,IAAM,GAGhDK,oBAAqB,SAAUrO,EAAOvK,GAClC,IAEI0Y,EAFAzC,EAAYnW,MAAQA,KAAKmW,UACzBvR,EAAiB6F,EAAM5F,cAEvBiI,GAAS,EAsBb,OApBIwL,EAAsBpY,KACtB0Y,EAAcpX,EAAMkW,cAAclW,EAAM0U,SAAStR,EAAgBuR,IAEjExW,EAAEqN,KAAK9M,EAAa,SAASsM,EAAGtL,GAC5B,IAAIwX,EAAiBxX,EAAWZ,MAAMuE,cAEtC,GAAIrD,EAAMiV,eAAe7R,EAAgB8T,GACrC,OAAO,EAIX,IAAIG,EAAkBrX,EAAMkW,cAAclW,EAAM0U,SAASwC,EAAgBvC,IAEzE,OAA8D,IAA1D3U,EAAMkU,WAAWkD,EAAaC,GAAiB7R,QAC/C8F,EAAQN,GACD,QAFX,KAODM,GAUXiM,cAAe,SAAUtO,EAAOvK,GAC5B,IAAIiW,EAAYnW,MAAQA,KAAKmW,UACzB6C,EAAkBhZ,MAAQA,KAAKgZ,gBAC/BzB,EAAS/V,EAAMkW,cAAclW,EAAM0U,SAASzL,EAAM5F,cAAesR,IACjE0C,KAEJ,OAA2B,IAAvB3Y,EAAY8G,SACRgS,GACArZ,EAAEqN,KAAKgM,EAAiB,SAAU1J,EAAO6G,GACrC,IAAI5G,EAAa/N,EAAMuV,aAAa7W,EAAY,GAAIoP,GAChD2J,EAAa1J,GAAc/N,EAAMkW,cAAclW,EAAM0U,SAAS3G,EAAW1K,cAAesR,IAExF8C,GAAcA,EAAWjS,SACzB6R,EAAkBA,EAAgBlB,OAAOsB,MAKuB,IAAxEzX,EAAMqU,8BAA8B0B,EAAQsB,GAAiB7R,QACtD,GAIP,IAjKL,GAwKX2J,GACA7N,iBAAiB,EAEjBE,WAAY,uDAKZ+I,IAAK,KACL9H,cAAetE,EAAEiD,KACjBsB,iBAAkBvE,EAAEiD,KACpBuB,cAAexE,EAAEiD,KACjBsW,mBAAoB,KACpBhW,SAAU,KACViW,gBAAiB,KACjBxO,sBAAuB,KACvBvH,SAAU,EACVE,eAAgB,IAChBC,UACAwB,UAAW,QACXqU,QAAS,IACT5V,aAAc,KACd6V,eAAgB,KAChBrV,SAAS,EACTpC,eAAgB,0BAChByC,aAAa,EACbiV,sBAAsB,EACtBC,sBAAsB,EACtBC,qBAAqB,EACrB/U,mBAAmB,EACnBtD,KAAM,uCACNsY,mBACIC,KAAY,kBACZC,QAAY,oBACZC,MAAY,wBACZC,MAAY,0BACZC,KAAY,oBAEhB/V,KAAM,KACNgW,YAAa,UACbC,MAAO,EACPC,SAAU,KACVC,QAAS,KACTC,eAAe,EACfC,YAAa,IACbC,mBAAoB,KAyBpBC,GAAqB,KAAM,OAAQ,MAAO,OAAQ,MAAO,MAAO,aAAc,QAAS,QAAS,MAAO,MAAO,QAAS,QAAS,MAAO,KAAM,UAAW,QAAS,QAAS,IAAK,UAAW,MAAO,IAAK,OAAQ,MAAO,MAAO,KAAM,YAAa,aAAc,SAAU,YAAa,WAAY,UAAW,SAAU,UAAW,WAAY,KAAM,QAAS,SAAU,OAAQ,IAAK,UAAW,QAAS,KAAM,OAAQ,KAAM,SAAU,OAAQ,SAAU,OAAQ,KAAM,OAAQ,QAAS,MAAO,IAAK,SAAU,YAAa,MAAO,OAAQ,MAAO,MAAO,KAAM,MAAO,QAAS,SAAU,KAAM,IAAK,MAAO,MAAO,OAAQ,OAAQ,MAAO,MAAO,UAAW,KAAM,QAAS,QAAS,SAAU,aAAc,UAAW,QAAS,SAAU,WAAY,SAAU,UAAW,WAAY,SAAU,UAAW,UAAW,MAAO,MAAO,SAAU,KAAM,OAAQ,IAAK,MAAO,OAAQ,MAAO,MAAO,MAAO,MAAO,QAAS,KAAM,MAAO,QAAS,KAAM,QAAS,MAAO,MAAO,QAAS,MAAO,IAAK,KAAM,OAAQ,MAAO,QAAS,IAAK,IAAK,UAAW,WAAY,UAAW,uBAAwB,QAAS,UAAW,eAAgB,SAAU,UAAW,WAAY,UAAW,SAAU,QAAS,aAAc,WAAY,aAAc,aAAc,UAAW,WAAY,YAAa,WAAY,UAAW,YAAa,UAAW,WAAY,UAAW,QAAS,aAAc,OAAQ,YAAa,UAAW,aAAc,UAAW,UAAW,WAAY,aAAc,QAAS,QAAS,OAAQ,UAAW,QAAS,SAYj8CC,IAEIC,GAAI,WACJ3D,QAAS,YACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,cACJ3D,QAAS,eACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,UACJ3D,QAAS,WACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,iBACJ3D,QAAS,kBACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,mBACJ3D,QAAS,oBACT4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,EAAGC,MAAO,IACjCC,SAAU,mBAGVN,GAAI,SACJ3D,QAAS,SAAU,cAAe,mBAAoB,oBACtD4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,EAAGC,MAAO,IACjCC,SAAU,mBAGVN,GAAI,eACJ3D,QAAS,gBACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,iBACJ3D,QAAS,kBACT4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,EAAGC,MAAO,GACjCC,SAAU,iBAGVN,GAAI,OACJ3D,QAAS,OAAQ,YAAa,iBAAkB,kBAChD4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,EAAGC,MAAO,GACjCC,SAAU,iBAGVN,GAAI,eACJ3D,QAAS,gBACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,iBACJ3D,QAAS,kBACT4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,EAAGC,MAAO,GACjCC,SAAU,iBAGVN,GAAI,OACJ3D,QAAS,OAAQ,YAAa,iBAAkB,kBAChD4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,EAAGC,MAAO,GACjCC,SAAU,iBAGVN,GAAI,wBACJ3D,QAAS,yBACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,0BACJ3D,QAAS,2BACT4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,GAAIC,MAAO,GAClCC,SAAU,0BAGVN,GAAI,gBACJ3D,QAAS,gBAAiB,qBAAsB,0BAA2B,2BAC3E4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,GAAIC,MAAO,GAClCC,SAAU,0BAGVN,GAAI,qBACJ3D,QAAS,sBACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,uBACJ3D,QAAS,wBACT4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,GAAIC,MAAO,GAClCC,SAAU,uBAGVN,GAAI,aACJ3D,QAAS,aAAc,kBAAmB,uBAAwB,wBAClE4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,GAAIC,MAAO,GAClCC,SAAU,uBAGVN,GAAI,iBACJ3D,QAAS,kBACT4D,WAAW,EACXC,cAAc,IAGdF,GAAI,mBACJ3D,QAAS,oBACT4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,GAAIC,MAAO,GAClCC,SAAU,mBAGVN,GAAI,SACJ3D,QAAS,SAAU,cAAe,mBAAoB,oBACtD4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,GAAIC,MAAO,GAClCC,SAAU,mBAGVN,GAAI,QACJ3D,QAAS,QAAS,aAAc,kBAC5B,QAAS,cACb4D,WAAW,EACXC,cAAc,EACdC,aAAeC,OAAQ,MAK3B/K,EAAY,WAEZkL,GACAC,OAAU,EAAG,EAAG,EAAG,GACnBC,YAAe,EAAG,EAAG,EAAG,IAyBxBC,KAEJA,EAAY,MACRC,UAAW,MACXlD,UAAWA,EAASM,uBAAwBN,EAASU,cAErDyC,YACIC,QAAS,UACTrE,KAAM,MACNsE,WAAY,YAGhBC,yBAAyB,EACzBC,eAAgB,SAAUta,GACtB,IAGI2V,EAHA9W,EAAOC,KACPuD,EAASxD,EAAKD,QAAQyD,OACtByC,EAAO9E,EAAW8E,KAkBtB,OAfIrG,EAAEiM,WAAWrI,KACbA,EAASA,EAAOqH,KAAK7K,EAAKE,QAASiB,EAAWZ,QAE9CiD,GAAUA,EAAOwH,MACjB8L,EAASlX,EAAEgO,IAAIpK,EAAOwH,MAAO,SAAUwH,GACnC,OAAOA,EAAK1N,iBAIhBgS,GAAU,UAAW,QAEjBxH,EAAgBnO,EAAY,YAC5B2V,EAAO/I,KAAK,eAGbtM,EAAMoV,eAAe5Q,EAAM6Q,IAEtC4E,aAAc,SAAUzV,GACpB,OAAOxE,EAAMoT,SAAS5O,EAAKqV,QAASrV,EAAKgR,KAAMhR,EAAKsV,aAAapJ,KAAK,OAI9EgJ,EAAe,SACXC,UAAW,UACXlD,UACItY,EAAEgS,MAAMsG,EAASM,wBAA0BpC,UAAWmE,IACtD3a,EAAEgS,MAAMsG,EAASa,qBAAuB3C,UAAWmE,KAEvDoB,eAAgBnB,EAChBoB,mBAAoBna,EAAM2T,QAAQoF,EAAoB,KAAM,SAC5DjD,oBAAqBgD,EACrBsB,mBAAmB,EACnBC,YAAY,EACZL,eAAgB,SAAUta,GACtB,IAAI2V,GAAU7W,KAAK4S,OAAOkJ,IAAM,QAC5B9V,EAAO9E,EAAW8E,KAEtB,OAAQrG,EAAEmX,cAAc9Q,IAASxE,EAAMoV,eAAe5Q,EAAM6Q,IAEhE4E,aAAc,SAAUzV,EAAMlG,GAC1B,IAAIic,EAAS/V,EAAKgW,kBAAoBxa,EAAMoT,SAAS5O,EAAK+V,OAAQ/V,EAAKiW,cAAc/J,KAAK,MAAQlM,EAAKkW,iBACnGC,EAAOnW,EAAKoW,gBAAkB5a,EAAMoT,SAAS5O,EAAKqW,UAAWrW,EAAKmW,OAAOjK,KAAK,MAAQlM,EAAKsW,eAC3FC,EAAOvW,EAAKwW,gBAAkBhb,EAAMoT,SAAS5O,EAAKyW,UAAWzW,EAAKuW,OAAOrK,KAAK,MAAQlM,EAAK0W,eAC3FC,EAAc3W,EAAK4W,sBAAwBpb,EAAMoT,SAAS5O,EAAK6W,gBAAiB7W,EAAK8W,aAAa5K,KAAK,MAAQlM,EAAK+W,qBACpHC,EAAehX,EAAKiX,yBAA2Bzb,EAAMoT,SAAS5O,EAAKkX,mBAAoBlX,EAAKmX,gBAAgBjL,KAAK,MAAQlM,EAAKoX,wBAC9HC,EAASrX,EAAKsX,kBAAoB9b,EAAMoT,SAAS5O,EAAKuX,YAAavX,EAAKqX,SAASnL,KAAK,MAAQlM,EAAKwX,iBACnGC,EAAQjc,EAAMoT,SAAS5O,EAAK0X,WAAY1X,EAAKyX,MAAOzX,EAAK2X,WAAY3X,EAAK4X,QAAQ1L,KAAK,KACvF2L,EAAOrc,EAAMoT,SAAS5O,EAAK8X,UAAW9X,EAAK6X,OAAO3L,KAAK,KACvD6L,EAAa/X,EAAK+X,YAAe,OAAS/X,EAAK+X,WAiCnD,OA3BIhC,IAAWQ,IACXR,EAAS,IAIPjc,GAAWA,EAAQke,mBACjBle,GAAWA,EAAQme,oBAEnBjB,EAAe,GACRA,IAAiBhX,EAAKkY,wBAE7BlB,EAAe,KAIdxb,EAAMoT,SACXmH,EACAI,EACAI,EACAS,EACAL,EACAU,EACAI,EACAI,EACAE,IACD7L,KAAK,OAIZ1O,aAAc,WACV,IAAI2a,KACAC,GAAqB,EAOzB,OALAze,EAAEqN,KAAKuN,EAAoB,WACnB6D,GAAoBD,EAA4BrQ,KAAK9N,KAAKwa,IAC9C,kBAAZxa,KAAKwa,KAAwB4D,GAAqB,KAGnD,SAAU9d,EAAOD,EAAca,EAAYpB,GAC9C,IAIIyX,EACA8G,EACAC,EANAve,EAAOC,KACPue,EAAWrd,EAAW8E,MAAQ9E,EAAW8E,KAAKiX,wBAC9C3F,EAAsBxX,GAAWA,EAAQwX,oBACzCkH,EAAgBtd,EAAW8E,MAAQ9E,EAAW8E,KAAKyY,eA0BvD,OApBID,GAAiBA,EAAcxX,OAAS,IACxCuQ,EAAS/V,EAAM6V,UAAUhX,EAAciX,GACvC+G,EAAere,KAAK+D,KAAK2a,iBAAiBnH,EAAQjX,IAClDge,EAAyBte,KAAK+D,KAAK4a,0BAA0BN,EAAcG,MAEvEle,GAASge,IAIjBhe,EAAQP,EAAKkQ,iBAAiB3P,EAAOD,EAAca,EAAYpB,GAC/DQ,EAAQP,EAAK6e,mBAAmBte,EAAOY,GAEnCqd,KAAcxe,EAAK6S,OAAOiM,IAAI7X,QAAUjH,EAAK6S,OAAOiM,IAAI/Z,QAAQ,WAAa,KACzEnF,EAAEmf,cAAc/e,EAAKgf,mBAAmB7d,EAAW8E,KAAMmY,MAC7D7d,GACI,eAAiBP,EAAKiB,QAAQ8P,QAAU,KACxC/Q,EAAKkQ,iBAAiBsO,EAAUle,EAAca,GAC9C,UAGDZ,GAvCD,GA8Cdoe,iBAAkB,SAASnH,EAAQjX,GAC/B,IAAI0e,EACApH,EACAqH,KAEJ,IAAID,KAAczH,EACdK,EAAQL,EAAOyH,IACe,IAA1B1e,EAAMwE,QAAQ8S,IACdqH,EAAOnR,KAAK8J,GAIpB,OAAOqH,GAMXN,0BAA2B,SAASN,EAAcG,GAC9C,IAAIQ,EACApH,EACAsH,EACAC,EACAC,KACAC,EAAY,GAEhB,IAAIH,KAAqBV,EAAe,CACpCW,EAAeX,EAAcU,GAC7B,IAAIF,KAAcX,EAEd,GADAzG,EAAQyG,EAAaW,GACjBG,EAAata,cAAcC,QAAQ8S,IAAU,EAAG,CAChDwH,EAAOtR,KAAKqR,GACZ,OASZ,OAJIC,EAAOpY,OAAS,IAChBqY,EAAY,WAAaD,EAAOlN,KAAK,MAAQ,KAG1CmN,GAUXC,mBAAoB,SAASrQ,EAAUnP,GACnC,IAAIyf,EAAiB,KAqBrB,OAnBIzf,EAAQ0f,cAIJD,EAHAtQ,EAASnP,QAAQ2f,eAGAzf,KAAK0f,0BAA0BzQ,EAAUnP,EAAQoB,YAC3D+N,EAAS2D,OAAOiM,IAAI7X,OAGVhH,KAAK2f,qBAAqB1Q,EAAUnP,EAAQoB,YAG5CpB,EAAQoB,WAAW0e,mBAEjC9f,EAAQ+f,iBACX5Q,EAASnP,QAAQ2f,iBACjBF,EAAiBvf,KAAK0f,0BAA0BzQ,EAAUnP,EAAQoB,YAAc+c,qBAAqB,KAItGsB,GAKXG,0BAA2B,SAAUzQ,EAAU/N,EAAYpB,GACvD,OAAOE,KAAKyb,aAAaxM,EAAS6Q,oBAAoB5e,EAAW8E,MAAOlG,IAK5E6f,qBAAsB,SAAU1Q,EAAU/N,EAAYpB,GAElD,IAAIkG,EAAOiJ,EAAS8P,mBAAmB7d,EAAW8E,KAAMiJ,EAAS2D,OAAOiM,IAAIlH,QAAQ,2BAEpF,OAAO3X,KAAKyb,aAAazV,EAAMlG,KAKvCob,EAAa,OACTC,UAAW,QACXlD,UACItY,EAAEgS,MAAMsG,EAASc,eAEbC,iBACI1Y,MAAS,KACTyf,qBAAsBzF,EACtB0F,WAAY,KACZC,YAAa,SAIzBvE,eAAgBnB,EAChBsB,YAAY,EACZrY,aAAc,SAAUlD,EAAOD,EAAca,EAAYpB,GACrD,IAAIC,EAAOC,KAGPkgB,EAAmBxQ,EAFJ3P,EAAKgE,KAAKoc,gBAAgBvV,KAAK7K,EAAMmB,EAAYb,GAChDN,EAAKkQ,iBAAiBzO,EAAMuV,aAAa7V,EAAW8E,KAAM,QAAS3F,EAAca,IAEjGkf,EAAergB,EAAKkQ,iBAAiBzO,EAAMuV,aAAa7V,EAAW8E,KAAM,mBAAoB3F,EAAca,GAC3Gmf,EAAU7e,EAAMuV,aAAa7V,EAAW8E,KAAM,kBAAoB,GA4BtE,OA1BIjG,EAAKugB,YACJxgB,IAAYA,OAAeygB,UAAY,IAG5CjgB,EAAQwP,EAAelF,KAAK7K,EAAMO,EAAOkB,EAAMuV,aAAa7V,EAAW8E,KAAM,cAAe3F,EAAca,EAAYpB,GACtHQ,EAAQP,EAAK6e,mBAAmBte,EAAOY,GAEnCmf,IACAA,EAAUA,EAAQ3e,QAAQ,2BAA4B,IAGlD2e,EAFAtgB,EAAKugB,SAEKD,EAAQ3e,QAAQ,IAAIgC,OAAO,OAAS8L,EAAkB,MAAQA,EAAkB,OAASA,EAAkB,SAAU,MAErHzP,EAAKkQ,iBAAiBoQ,EAAShgB,EAAca,GACnDoW,oBAAqBgD,MAK7B4F,GAAoBG,GAAWD,KAC/B9f,GACI,eAAiBP,EAAKiB,QAAQ8P,QAAU,kBACtB/Q,EAAKiB,QAAQ+P,eAAiB,MAAQmP,GAAoB,IAAM,WACjFxQ,EAAqB2Q,EAASD,IAAiB,IAChD,UAED9f,GAEX6f,gBAAiB,SAASjf,EAAYb,GAClC,IAGImgB,EACAC,EAJA1gB,EAAOC,KACP0gB,EAAMxf,EAAW8E,MAAQ9E,EAAW8E,KAAK0a,IACzCC,EAAiB5F,EAAgB7Z,EAAW8E,MAAQ9E,EAAW8E,KAAKjC,MAGpE6c,EAAS,KAEb,GAAIF,EAmBA,OAlBAD,EAAe1gB,EAAKkQ,iBAAiByQ,EAAKrgB,EAAca,GACpDyf,IACAF,EAAeA,EAAazV,MAAM,IAClCwV,EAAW7gB,EAAEgO,IAAIgT,EAAgB,SAAUE,GAIvC,IAHA,IACIhN,EADAiN,EAAgB,GAGbD,IAAehN,EAAK4M,EAAatJ,UACpC2J,GAAiBjN,EACb+M,EAAOnR,KAAKoE,IAAKgN,IAGzB,OAAOC,IAEXL,EAAeD,EAAStO,KAAK,gBAAkBnS,EAAKiB,QAAQgQ,kBAAoB,aAC5EyP,EAAavO,KAAK,KAGnBuO,IAKnBvF,EAAa,OACTC,UAAW,QACXlD,UAAWA,EAASM,wBACpBwI,mBAAoB,SAAUtW,GAC1B,OAAOzK,KAAKF,QAAQkhB,eAAiBvW,EAAM3F,QAAQ,MAAQ,IAInEoW,EAAY,MACRC,UAAW,OACXlD,UAAWtY,EAAEgS,MAAMsG,EAASc,eAExBC,iBACI1Y,MAAS,KACT2gB,WAAY,KACZC,aAAc,SAGtBxF,eAAgBnB,EAChBsB,YAAY,EACZrY,aAAc,SAAUlD,EAAOD,EAAca,EAAYpB,GACrD,IAAIC,EAAOC,KACPmhB,EAAephB,EAAKkQ,iBAAiBzO,EAAMuV,aAAa7V,EAAW8E,KAAM,OAAQ3F,EAAca,GAC/Fmf,EAAU7e,EAAMuV,aAAa7V,EAAW8E,KAAM,kBAAoB,GAwBtE,OAtBA1F,EAAQP,EAAKkQ,iBAAiB3P,EAAOD,EAAca,EAAYpB,GAC/DQ,EAAQP,EAAK6e,mBAAmBte,EAAOY,GAEnCmf,IACAA,EAAUA,EAAQ3e,QAAQ,sBAAuB,IAG7C2e,EAFAtgB,EAAKugB,SAEKD,EAAQ3e,QAAQ,IAAIgC,OAAO,OAAS8L,EAAkB,MAAQA,EAAkB,OAASA,EAAkB,SAAU,MAErHzP,EAAKkQ,iBAAiBoQ,EAAShgB,EAAca,GACnDoW,oBAAqBgD,MAK7B6G,GAAgBd,KAChB/f,GACI,eAAiBP,EAAKiB,QAAQ8P,QAAU,kBACtB/Q,EAAKiB,QAAQ+P,eAAiB,KAAOoQ,EAAe,UACtEd,EACA,UAED/f,GAEX+Y,eAAgB,SAAUnY,GACtB,OAAOM,EAAMuV,aAAa7V,EAAY,sBAAwB,OAItEvB,EAAEmB,OAAO6P,GACLqQ,eAAe,IAGnB,IAAII,GAEAC,UAEAvb,GAAM,SAAUkR,EAAMsK,GAElB,OADAthB,KAAK4F,IAAIoR,GAAMlJ,KAAKwT,GACbthB,MAGX4F,IAAO,SAAUoR,GACb,IAAIqK,EAASrhB,KAAKqhB,OAClB,OAAOA,EAAOrK,KAAUqK,EAAOrK,SAInCuK,GACAjX,SACIkX,eACIzd,KAAMvC,EAAMsS,iBACZxP,SAAU,OACVmd,YAAajgB,EAAMyS,yBAEvByN,cAAc,GAElBC,mBACIH,eACIzd,KAAM,MACNO,SAAU,QAEdod,cAAc,GAElBrQ,QACImQ,eACIzd,KAAM,MACNO,SAAU,QAEdod,cAAc,GAElBE,UACIJ,eACIzd,KAAMvC,EAAMsS,iBACZxP,SAAU,OACVmd,YAAajgB,EAAMyS,yBAEvByN,cAAc,IAIlBG,GACAvX,SACIgX,OAAQ,UACRQ,YAAY,EACZC,aAAa,EACbnG,mBAAmB,GAEvBgG,UACIN,OAAQ,WACRQ,YAAY,EACZC,aAAa,EACbnG,mBAAmB,IA0D3B1L,EAAY3K,WAIRjE,WAAY,WACR,IAAIvB,EAAOC,KAEXD,EAAKsT,SAAW7R,EAAM6R,SAAS,KAE/BtT,EAAKiiB,gBACLjiB,EAAKkiB,OAAO,cAEZliB,EAAKmiB,mBAELniB,EAAKwB,aACLxB,EAAKyG,eAMTkL,oBAAqB,WACjB,IAEIyQ,EAFApiB,EAAOC,KACPoiB,EAAS,0BAETC,EAAW,WACPtiB,EAAKwR,YAAYE,UACjB1R,EAAKkI,UAGblI,EAAKwR,YAAY+Q,OAAO,WACpBviB,EAAKF,GAAG4O,IAAI2T,EAAQC,GACpBE,cAAcJ,KAGlBpiB,EAAKiI,UAAW,EAChBjI,EAAKF,GAAGiG,GAAGsc,EAAQC,GACnBF,EAAQK,YAAY,WACZziB,EAAKF,GAAG2R,GAAG,aACX6Q,KAELtiB,EAAKD,QAAQua,qBAGpBoI,cAAe,WACX,MAAoC,aAA7BziB,KAAKuR,YAAYmR,SAG5BlU,QAAS,WACL,IAAIzO,EAAOC,KAEXD,EAAKwR,YAAYoR,SACjB5iB,EAAKkiB,OAAO,WACZliB,EAAKF,GAAG6O,WAtuCI,eAuuCPxI,YAAY,qBACjBnG,EAAK6iB,qBACL7iB,EAAK8iB,gBACL9iB,EAAKF,GAAGijB,QAAQ,wBAGpBb,OAAQ,SAAUc,GACd,IAAIhjB,EAAOC,KACP8O,EAAOtN,EAAMgK,MAAMuD,UAAW,GAElC,OAAOpP,EAAEgO,IAAIyT,EAAYxb,IAAImd,GAAY,SAAUzB,GAC/C,OAAOA,EAAO0B,MAAMjjB,EAAM+O,MAIlCkT,cAAe,WACX,IAAIjiB,EAAOC,KAEXD,EAAK2Q,SAAW/Q,EAAE,sCAClBI,EAAKF,GAAGojB,MAAMljB,EAAK2Q,UAEnB3Q,EAAK2Q,SAAS5K,GAAG,YAAcoN,EAAUvT,EAAEgS,MAAM5R,EAAKmjB,YAAanjB,KAGvE8iB,cAAe,WACX,IAAI9iB,EAAOC,KAEPD,EAAK2Q,UACL3Q,EAAK2Q,SAAS/B,SAElBhP,EAAEI,EAAKD,QAAQma,UAAUxL,IAAIyE,IAOjCgQ,YAAa,SAAUxc,GACnB,IAAI3G,EAAOC,KAGX0G,EAAE2D,iBAIFtK,EAAKojB,YAAa,EAClB3hB,EAAMsT,MAAM,kBACD/U,EAAKojB,aAOmC,GAA/CxjB,EAAE+G,EAAE0c,QAAQC,QAAQ,iBAAiBrc,QACrCxF,EAAMsT,MAAM,WACRnV,EAAEmC,UAAUwhB,IAAI,YAAa,SAAU5c,GACnC,IAAI6c,EAAYxjB,EAAKF,GAChB2jB,IAAIzjB,EAAK2Q,UACT8S,IAAIzjB,EAAKD,QAAQma,UAElBla,EAAKD,QAAQ2jB,WACbF,EAAYA,EAAUC,IAAIzjB,EAAKmI,cAGnCqb,EAAYA,EAAUpY,OAAO,WACzB,OAAOnL,OAAS0G,EAAE0c,QAAUzjB,EAAE+jB,SAAS1jB,KAAM0G,EAAE0c,WAGpCpc,QACXjH,EAAKoH,YAOzB+a,iBAAkB,WACd,IAAIniB,EAAOC,KACP+U,EAAUpV,EAAEgS,MAAM5R,EAAKyG,YAAazG,GAExCA,EAAKoR,UACArL,GAAG,SAAWoN,EAAWnT,EAAKsT,SAAU0B,GACxCjP,GAAG,SAAWoN,EAAWnT,EAAKsT,SAAU0B,IAGjD6N,mBAAoB,WAChB5iB,KAAKmR,UACA1C,IAAI,SAAWyE,EAAWlT,KAAKqT,UAC/B5E,IAAI,SAAWyE,EAAWlT,KAAKqT,WAGxCsQ,YAAa,WACT,IAAI5jB,EAAOC,KACP4jB,EAAe7jB,EAAKD,QAAQqa,eAEX,IAAjByJ,IACAA,EAAe7jB,EAAKF,IAEpB+jB,aAAwBjkB,GAAKikB,EAAa5c,OAAS,GACnDrH,EAAE,aAAakkB,SACX/a,UAAW8a,EAAanb,SAASE,KAClC,SAMXpH,WAAY,SAAU+F,GAClB,IAAIvH,EAAOC,KAEXL,EAAEmB,OAAOf,EAAKD,QAASwH,GAGvB3H,EAAEqN,MACEjJ,KAAQmX,EACRnB,YAAe8H,GAChB,SAAUiC,EAAQC,GAEjB,GADAhkB,EAAK+jB,GAAUC,EAAUhkB,EAAKD,QAAQgkB,KACjC/jB,EAAK+jB,GAEN,MADA/jB,EAAKgI,UACC,IAAM+b,EAAS,0CAA4CnkB,EAAEgO,IAAIoW,EAAW,SAAUzjB,EAAO0W,GAC/F,MAAO,IAAMA,EAAO,MACrB9E,KAAK,QAIhBvS,EAAEI,EAAKD,QAAQma,UACVxL,IAAIyE,GACJpN,GAAG,YAAcoN,EAAUvT,EAAEgS,MAAM5R,EAAKmjB,YAAanjB,IAEtDA,EAAK0iB,iBACL1iB,EAAKkiB,OAAO,eAMpBzb,YAAa,SAAUE,GACnB,IAEIsd,EACAC,EAHAlkB,EAAOC,KACPkkB,KAIJnkB,EAAKugB,SAAWvgB,EAAKoR,UAAUhO,SAAWpD,EAAKD,QAAQsa,YAElDra,EAAK0iB,mBAAoB/b,GAAe,UAAVA,EAAE3C,MAAsBhE,EAAKD,QAAQ2jB,UAAY1jB,EAAKugB,YACzFvgB,EAAKmI,WAAWnF,SAAShD,EAAKD,QAAQ2jB,SAAW1jB,EAAKqR,MAAQrR,EAAK2Q,UAEnE3Q,EAAKkiB,OAAO,iBAEZliB,EAAKF,GAAGgG,IAAI,cAAe,IAC3B9F,EAAKF,GAAGgG,IAAI,eAAgB,IAC5Bqe,EAASC,YAAcC,WAAWrkB,EAAKF,GAAGgG,IAAI,gBAC9Cqe,EAASG,aAAeD,WAAWrkB,EAAKF,GAAGgG,IAAI,iBAE/ClG,EAAEmB,OAAOojB,EAAUnkB,EAAKF,GAAG4I,UAC3Byb,EAASI,UAA+C,QAAnCvkB,EAAKF,GAAGgG,IAAI,oBAAgC,EAAIue,WAAWrkB,EAAKF,GAAGgG,IAAI,qBAC5Fqe,EAASK,WAAiD,QAApCxkB,EAAKF,GAAGgG,IAAI,qBAAiC,EAAIue,WAAWrkB,EAAKF,GAAGgG,IAAI,sBAC9Fqe,EAASM,YAAczkB,EAAKF,GAAG2kB,cAC/BN,EAASO,WAAa1kB,EAAKF,GAAG4kB,aAC9BP,EAAS3b,YAAcxI,EAAKF,GAAG0I,cAC/B2b,EAASQ,eAAiB,EAC1BR,EAASS,gBAAkB,EAC3BX,EAAgBjkB,EAAK2Q,SAASjI,SAE9Bwb,GACItb,IAAKub,EAASvb,IAAMqb,EAAcrb,IAClCC,KAAMsb,EAAStb,KAAOob,EAAcpb,MAGxC7I,EAAKkiB,OAAO,cAAegC,EAAQC,GAE/BA,EAASQ,eAAiBR,EAASC,aACnCpkB,EAAKF,GAAGgG,IAAI,cAAeqe,EAASQ,eAAiB,MAErDR,EAASS,gBAAkBT,EAASG,cACpCtkB,EAAKF,GAAGgG,IAAI,eAAgBqe,EAASS,gBAAkB,QAI/D9c,WAAY,WACR7H,KAAKQ,kBACLR,KAAKoQ,mBACLpQ,KAAKG,eAGT2H,MAAO,WACH,IAAI/H,EAAOC,KACP4kB,EAAmB7kB,EAAKsB,UAExBtB,EAAK0iB,kBACL1iB,EAAK8H,aACL9H,EAAKM,aAAe,GACpBN,EAAKsB,UAAY,KACjBtB,EAAKoH,OACLpH,EAAKG,eACLH,EAAKF,GAAGkH,IAAI,IACZhH,EAAKF,GAAGijB,QAAQ,qBAChB/iB,EAAKkiB,OAAO,SACZliB,EAAK+iB,QAAQ,sBAAuB8B,KAI5C7c,QAAS,WACL,IAAIhI,EAAOC,KAEXD,EAAKiI,UAAW,EAChBjI,EAAK8kB,eACD9kB,EAAKwG,SACLxG,EAAKoH,QAIbc,OAAQ,WACJjI,KAAKgI,UAAW,GAGpB8c,cAAe,WACX,OAAO9kB,KAAKgI,UAGhB+c,OAAQ,WACJ,IAAIhlB,EAAOC,KACPyK,EAAQ1K,EAAKF,GAAGkH,MAEhBhH,EAAK0iB,kBACL1iB,EAAKM,aAAeoK,EAChB1K,EAAKghB,mBAAmBtW,GACxB1K,EAAKilB,kBAAkBva,GAEvB1K,EAAKoH,SAKjB8d,cAAe,SAAU/jB,GACrB,IACI8E,EACA1F,EAFAP,EAAOC,KAIPL,EAAEmX,cAAc5V,IAAevB,EAAEmX,cAAc5V,EAAW8E,QAC1D9E,EAAavB,EAAEmB,QAAO,KAAUI,GAE5BnB,EAAK+kB,iBAAmB/kB,EAAKwR,aAA4C,YAA7BxR,EAAKwR,YAAYmR,UAC7D3iB,EAAKwR,YAAYE,UACjB1R,EAAKkI,UAGLlI,EAAK6S,OAAOiM,IAAI7X,SAChBjH,EAAKmlB,iBAAiBhkB,GACtB8E,EAAOjG,EAAKgf,mBAAmB7d,EAAW8E,KAAMjG,EAAK6S,OAAOC,KACxD3R,EAAW8E,KAAKmf,WAChBnf,EAAKmf,SAAWplB,EAAKqlB,kBAAkBlkB,EAAW8E,KAAKmf,SAAUplB,EAAK6S,OAAOC,MAEjF3R,EAAW8E,KAAOA,GAGtBjG,EAAKsB,UAAYH,EAGjBnB,EAAKG,aAAegB,GACpBZ,EAAQP,EAAKuf,mBAAmBpe,IAAe,GAC/CnB,EAAKM,aAAeC,EACpBP,EAAKF,GAAGkH,IAAIzG,GACZP,EAAK8kB,eACL9kB,EAAKF,GAAGijB,QAAQ,qBAQxBuC,QAAS,WACL,IAAItlB,EAAOC,KACPslB,EAAYvlB,EAAKwlB,uBACjBllB,EAAeN,EAAKF,GAAGkH,MACvBye,EAAW7lB,EAAE2Q,WAEjBkV,EACKvZ,KAAK,SAAU/K,GACZnB,EAAK0lB,iBAAiBvkB,EAAY,EAAGb,GAAgBwf,iBAAiB,IACtE9f,EAAKF,GAAGijB,QAAQ,sBAAuB5hB,KAE1CkL,KAAK,WACFrM,EAAKsB,UAAY,KACjBtB,EAAKF,GAAGijB,QAAQ,yBAGpB/iB,EAAKghB,mBAAmBuE,IACxBvlB,EAAKM,aAAeilB,EACpBvlB,EAAK+K,eAAewa,GAAatL,MAAO,EAAG0L,WAAY,KAAMC,SAAU,OAClE1Z,KAAK,SAAU/L,GAEZ,IAAIgB,EAAahB,EAAY,GACzBgB,EACAskB,EAAS/T,QAAQvQ,GAEjBskB,EAAS7C,WAGhBvW,KAAK,WAEFoZ,EAAS7C,YAGjB6C,EAAS7C,UAUjB4C,qBAAsB,WAClB,IAAIxlB,EAAOC,KACP4lB,EAAiB7lB,EAAK8lB,oBACtBzN,EAAcwN,GAAkBA,EAAeL,uBAC/CllB,EAAeV,EAAEsL,KAAKlL,EAAKF,GAAGkH,OAElC,OAAOvF,EAAMoT,SAASwD,EAAa/X,IAAe6R,KAAK,MAG3D4T,cAAe,SAAUxE,EAAQyE,GAC7B,IAAIhmB,EAAOC,KACP4X,EAAQjY,EAAEsL,KAAKlL,EAAKD,QAAQ8X,OAC5BoO,EAAUrmB,EAAEsL,KAAKlL,EAAKD,QAAQkmB,SAC9BhjB,EAAajD,EAAKD,QAAQkD,WAC1B+I,EAAMhM,EAAKD,QAAQiM,IACnBka,EAAgB1E,EAAeD,GAC/B/d,EAAS5D,EAAEmB,QACPsY,QAASrZ,EAAKD,QAAQsZ,SACvB6M,EAAczE,eACjBtH,KAkDJ,OAhDInO,EACA/I,EAAa+I,GAER,MAAM0D,KAAKzM,KACZA,GAAc,KAElBA,GAAcse,EACV2E,EAAcvE,eACd1e,GAAc,IAAMjD,EAAKgE,KAAKoX,YAItCnY,EAAaxB,EAAM0S,eAAelR,GAE9BrD,EAAEoU,QAAQC,MAEN4D,IACAsC,EAAuB,cAAI,SAAWtC,GAEtCoO,IACA9L,EAAQ,aAAe8L,GAE3B9L,EAAQ,aAAehK,EAAYgW,QAC9B3iB,EAAO2W,UACR3W,EAAO2W,YAEN3W,EAAO4iB,YACR5iB,EAAO4iB,cAEXxmB,EAAEmB,OAAOyC,EAAO2W,QAASna,EAAKD,QAAQoa,QAASA,GAG/C3W,EAAO4iB,UAAUC,iBAAkB,IAI/BxO,IACAsC,EAAe,MAAItC,GAEnBoO,IACA9L,EAAiB,QAAI8L,GAEzB9L,EAAiB,QAAIhK,EAAYgW,QACjCljB,EAAaxB,EAAM6S,aAAarR,EAAYkX,IAGhD3W,EAAOwI,IAAM/I,EAENrD,EAAEmB,OAAOyC,EAAQwiB,IAG5BhF,mBAAoB,SAAUtW,GAC1B,IACIyB,EADAnM,EAAOC,KASX,OANAkM,EAASzB,EAAMzD,QAAUjH,EAAKD,QAAQsD,WAExBrD,EAAKgE,KAAKgd,qBACpB7U,EAASnM,EAAKgE,KAAKgd,mBAAmBnW,KAAK7K,EAAM0K,IAG9CyB,GAGXma,uBAAwB,SAAU5b,EAAO6b,GACrC,IAAIvmB,EAAOC,KACPF,EAAUC,EAAKD,QACfyD,EAAS5D,EAAEiM,WAAW9L,EAAQyD,QACxBzD,EAAQyD,OAAOqH,KAAK7K,EAAKE,QAASwK,GAClC9K,EAAEmB,UAAWhB,EAAQyD,QAa/B,OAXIxD,EAAKgE,KAAKsiB,wBACV1mB,EAAEmB,OAAOyC,EAAQxD,EAAKgE,KAAKsiB,uBAAuBzb,KAAK7K,IAE3DJ,EAAEqN,KAAKjN,EAAKkiB,OAAO,iBAAkB,SAAUzV,EAAG+Z,GAC9C5mB,EAAEmB,OAAOyC,EAAQgjB,KAErBhjB,EAAOzD,EAAQiF,WAAa0F,EACxB9K,EAAE6mB,UAAU1mB,EAAQka,QAAUla,EAAQka,MAAQ,IAC9CzW,EAAOyW,MAAQla,EAAQka,OAGpBra,EAAEmB,OAAOyC,EAAQ+iB,IAG5BtB,kBAAmB,SAAUva,GACzB,IAAI1K,EAAOC,KAEXD,EAAKwQ,WAAaxQ,EAAK+K,eAAeL,GACjCwB,KAAK,SAAU/L,GACZH,EAAK0mB,kBAAkBvmB,EAAauK,MAahDK,eAAgB,SAAUL,EAAO6b,EAAcI,GAC3C,IAAIzhB,EACAlF,EAAOC,KACPF,EAAUC,EAAKD,QACf6mB,EAAcD,GAAkBA,EAAeC,YAC/CC,EAAqBF,GAAkBA,EAAeE,mBACtDrjB,EAASxD,EAAKsmB,uBAAuB5b,EAAO6b,GAC5C5a,EAAW/L,EAAEkM,MAAMtI,OACnBiiB,EAAW7lB,EAAE2Q,WA8CjB,OA5CArL,EAAWlF,EAAKS,eAAekL,KACf/L,EAAE6H,QAAQvC,EAAS/E,aAC/BslB,EAAS/T,QAAQxM,EAAS/E,aAEtBH,EAAK+L,WAAWrB,GAChB+a,EAAS7C,SAEJgE,IAAoE,IAArD7mB,EAAQmE,cAAc2G,KAAK7K,EAAKE,QAASsD,GAGzDxD,EAAK8mB,iBAAiBtjB,GACjB0I,KAAK,SAAUhH,GAERlF,EAAKoM,gBAAgBlH,IAAawF,GAAS1K,EAAKM,cAG3CP,EAAQkE,UACL4iB,EACA7mB,EAAKqQ,gBAAgB3F,GAASxF,EAAS/E,YAAY,IAEnDH,EAAK+mB,eAAe7hB,EAAUwF,GAC9B1K,EAAKS,eAAekL,GAAYzG,EAC5BnF,EAAQ2E,mBAAqD,IAAhCQ,EAAS/E,YAAY8G,QAClDjH,EAAKI,WAAW2N,KAAKrD,KAKjC+a,EAAS/T,QAAQxM,EAAS/E,cAE1BslB,EAAS7C,SAERgE,GACD7mB,EAAQoE,iBAAiB0G,KAAK7K,EAAKE,QAASwK,EAAOxF,EAAS/E,eAEjEkM,KAAK,SAAUC,EAAOC,EAAYC,GACrCiZ,EAAS7C,SACJgE,GAA8B,UAAfra,GAChBxM,EAAQqE,cAAcyG,KAAK7K,EAAKE,QAASwK,EAAO4B,EAAOC,EAAYC,KA9B3EiZ,EAAS7C,SAoCd6C,GAQXqB,iBAAkB,SAAUtjB,GACxB,IAAIxD,EAAOC,KACP+mB,EAAUpnB,EAAEqM,KACRjM,EAAK+lB,cAAc/lB,EAAKga,YAAYuH,QAAUtb,KAAMxE,EAAM8S,UAAU/Q,MAY5E,OATAxD,EAAK8kB,eACL9kB,EAAKwE,eAAiBwiB,EACtBhnB,EAAKkiB,OAAO,WAEZ8E,EAAQzE,OAAO,WACXviB,EAAKwE,eAAiB,KACtBxE,EAAKkiB,OAAO,aAGT8E,GAGXjb,WAAY,SAAUL,GAClB,IAAKzL,KAAKF,QAAQ2E,kBACd,OAAO,EAGX,IAAIyH,GAAS,EAIb,OAHAvM,EAAEqN,KAAKhN,KAAKG,WAAY,SAAUqM,EAAG/B,GACjC,QAASyB,EAA8B,IAArBT,EAAE3G,QAAQ2F,MAEzByB,GAGX2Y,aAAc,WACV,IAAI9kB,EAAOC,KAEPD,EAAKwE,gBACLxE,EAAKwE,eAAe8C,SAQ5B8E,gBAAiB,SAAUlH,GACvB,IACI/E,EADAH,EAAOC,KAGX,SAAKiF,IAAatF,EAAE6H,QAAQvC,EAAS/E,gBAIrCH,EAAK0H,wBAAwBxC,EAAS/E,aACtCH,EAAKinB,sBAAsB/hB,EAAS/E,aAEhCP,EAAEiM,WAAW7L,EAAKD,QAAQoZ,sBAC1BhZ,EAAcH,EAAKD,QAAQoZ,mBAAmBtO,KAAK7K,EAAKE,QAASgF,EAAS/E,aACtEP,EAAE6H,QAAQtH,KACV+E,EAAS/E,YAAcA,KAIxB,IAGXuH,wBAAyB,SAAUvH,GACD,iBAAnBA,EAAY,IACnBP,EAAEqN,KAAK9M,EAAa,SAAUsM,EAAGlM,GAC7BJ,EAAYsM,IAAOlM,MAAOA,EAAO0F,KAAM,SAcnDsZ,mBAAoB,SAAUpe,EAAY+lB,GACtC,IAII1H,EAJAxf,EAAOC,KACPqZ,EAAiBtZ,EAAKD,QAAQuZ,gBAAkBtZ,EAAKgE,KAAKsV,eAC1DmG,EAAgByH,GAAoBA,EAAiBzH,cACrDK,EAAkBoH,GAAoBA,EAAiBpH,gBAEvDqH,EAAqB,KAuBzB,OApBIvnB,EAAEiM,WAAWyN,KACbkG,EAAiBlG,EAAezO,KAAK7K,EAAMmB,IAGjB,iBAAnBqe,IACPA,EAAiBre,EAAWZ,MAExBP,EAAKgE,KAAKub,oBAOiB,QAN3B4H,EAAqBnnB,EAAKgE,KAAKub,mBAAmBvf,GAC9CmB,WAAYA,EACZse,cAAeA,EACfK,gBAAiBA,OAIjBN,EAAiB2H,IAKtB3H,GAGXC,cAAe,SAASte,GACpB,IAAIimB,GAAU,EASd,OAPAxnB,EAAEqN,KAAKhN,KAAKE,YAAa,SAASsM,EAAG4a,GACjC,GAAIA,EAAkB9mB,QAAUY,EAAWZ,OAAS8mB,IAAsBlmB,EAEtE,OADAimB,GAAU,GACH,IAIRA,GAGXV,kBAAmB,SAAUvmB,EAAauK,GACtC,IAAI1K,EAAOC,KACXD,EAAKG,YAAcA,EACnBH,EAAKkiB,OAAO,oBAAqBxX,IAGrC4c,qBAAsB,WAClB,IAAItnB,EAAOC,KAGX,OAAOD,EAAKD,QAAQ2f,gBACb1f,EAAKunB,aACmC,GAAxCvP,OAAO3V,KAAKrC,EAAKunB,aAAatgB,QAMzCggB,sBAAuB,SAAU9mB,GAC7B,IAAIH,EAAOC,KACPunB,EAAiBxnB,EAAKsnB,uBACtBG,EAAQznB,EAAK0nB,0BAEjB9nB,EAAEqN,KAAK9M,EAAa,SAAUsM,EAAGtL,GACxBA,EAAW0e,qBACZ1e,EAAW0e,mBAAqB2H,EAAiBC,EAAQ,KAAOtmB,EAAWZ,MAAQY,EAAWZ,UAK1GonB,mBAAoB,SAAUnS,EAAGC,GAC7B,OAAOD,GAAKC,GACRD,EAAEjV,QAAUkV,EAAElV,OACdkB,EAAM6T,QAAQE,EAAEvP,KAAMwP,EAAExP,QASpC,IAAI2hB,GAEArW,aAAc,WAEVtR,KAAKH,GACA+nB,KAAK,eAAgB,OACrBxa,SAAS,qBACTvH,IAAI,aAAc,eAG3BgiB,kBAAmB,WACf,IAAI9nB,EAAOC,KAEXD,EAAKF,GAAGiG,GAAG,UAAYoN,EAAUvT,EAAEgS,MAAM5R,EAAK+nB,iBAAkB/nB,IAEhEA,EAAKF,GAAGiG,IAAI,QAAUoN,EAAU,MAAQA,EAAU,QAAUA,EAAU,QAAUA,GAAUhB,KAAK,KAAMvS,EAAEgS,MAAM5R,EAAKgoB,eAAgBhoB,IAClIA,EAAKF,GAAGiG,GAAG,OAASoN,EAAUvT,EAAEgS,MAAM5R,EAAKioB,cAAejoB,IAC1DA,EAAKF,GAAGiG,GAAG,QAAUoN,EAAUvT,EAAEgS,MAAM5R,EAAKkoB,eAAgBloB,KAGhEmoB,oBAAqB,WACjBloB,KAAKH,GAAG4O,IAAIyE,IAGhB8U,cAAe,WACX,IAAIjoB,EAAOC,KAIPD,EAAKojB,WACLpjB,EAAKojB,YAAa,GAIlBpjB,EAAKD,QAAQ0Z,oBACRzZ,EAAK+kB,iBACN/kB,EAAKooB,oBAAqBC,SAAS,IAC9B9F,OAAO,WAEJviB,EAAKoH,SAIjBpH,EAAKoH,OAGLpH,EAAKwQ,WAAWlJ,OAChBtH,EAAKwQ,WAAWlJ,UAIxB4gB,eAAgB,WACZ,IAAIloB,EAAOC,KAEND,EAAKsoB,aAEN7mB,EAAMsT,MAAMnV,EAAEgS,MAAM5R,EAAKuoB,gBAAiBvoB,IAE9CA,EAAKsoB,aAAc,GAGvBP,iBAAkB,SAAUphB,GACxB,IAAI3G,EAAOC,KAEX,IAAID,EAAK+kB,gBAIT,GAAK/kB,EAAKwG,QAAV,CAgBA,OAAQG,EAAEqD,OACN,KAAKgJ,EAAK1Q,IACNtC,EAAKF,GAAGkH,IAAIhH,EAAKM,cACjBN,EAAKoH,OACLpH,EAAK8kB,eACL,MAEJ,KAAK9R,EAAKzQ,IACN,IAAiC,IAA7BvC,EAAKD,QAAQuE,YACb,OAEJ,MAEJ,KAAK0O,EAAKC,MACFjT,EAAKD,QAAQyZ,sBACbxZ,EAAKooB,qBAET,MAEJ,KAAKpV,EAAKE,MAWN,YAVIlT,EAAKD,QAAQwZ,sBAAwBvZ,EAAKyJ,kBAC1C9C,EAAE2D,iBACFtK,EAAKooB,oBAAqBI,mBAAmB,EAAMC,YAAY,IAC1Dpc,KAAK,WAEFrM,EAAKM,cAAgB,IACrBN,EAAKF,GAAGkH,IAAIhH,EAAKM,cACjBN,EAAK0oB,0BAIrB,KAAK1V,EAAKtQ,GACN1C,EAAKmK,SACL,MACJ,KAAK6I,EAAKpQ,KACN5C,EAAKoK,WACL,MACJ,QACI,OAIRzD,EAAE0D,2BACF1D,EAAE2D,sBA1DE,OAAQ3D,EAAEqD,OAEN,KAAKgJ,EAAKpQ,KACN5C,EAAKuK,UACL,MAEJ,KAAKyI,EAAKC,MACFjT,EAAKD,QAAQyZ,sBACbxZ,EAAK2oB,2BAqDzBX,eAAgB,SAAUrhB,GACtB,IAAI3G,EAAOC,KAEX,IAAID,EAAK+kB,gBAAT,CAIA,OAAQpe,EAAEqD,OACN,KAAKgJ,EAAKtQ,GACV,KAAKsQ,EAAKpQ,KACV,KAAKoQ,EAAKC,MACN,OAIR5M,aAAarG,EAAKU,iBAClBV,EAAKsQ,WAAWsS,SAEZ5iB,EAAKM,eAAiBN,EAAKF,GAAGkH,OAC9BhH,EAAK0oB,wBAIbA,oBAAqB,WACjB,IAAI1oB,EAAOC,KAGXD,EAAK8kB,eAEL9kB,EAAKsQ,WAAa1Q,EAAE2Q,WACfrE,KAAKtM,EAAEgS,MAAM5R,EAAKkH,cAAelH,IAElCA,EAAKD,QAAQwD,eAAiB,EAE9BvD,EAAKU,gBAAkBe,EAAMsT,MAAM,WAC/B/U,EAAKsQ,WAAWoB,WACjB1R,EAAKD,QAAQwD,gBAEhBvD,EAAKsQ,WAAWoB,WAIxBxK,cAAe,WACX,IACI2d,EADA7kB,EAAOC,KAGPD,EAAKsB,YACLujB,EAAmB7kB,EAAKsB,UACxBtB,EAAKsB,UAAY,KACjBtB,EAAK+iB,QAAQ,sBAAuB8B,IAGxC7kB,EAAKK,eAAiB,EAEtBL,EAAKglB,SACLhlB,EAAKkiB,OAAO,gBAGhBqG,gBAAiB,WACb,IAAIvoB,EAAOC,KAEPD,EAAK+kB,iBAIL/kB,EAAK4oB,qBACL5oB,EAAKyG,cACLzG,EAAKglB,SACDhlB,EAAKugB,WACLvgB,EAAK6oB,iBACL7oB,EAAK4jB,iBAKjBgF,iBAAkB,WACd,OAAO7mB,SAAS+mB,gBAAkB7oB,KAAKC,SAG3CuJ,cAAe,WACX,IAEIG,EACAF,EAHA1J,EAAOC,KACP0J,EAAY3J,EAAKF,GAAGkH,MAAMC,OAK9B,IAEI,GAA8B,iBAD9B2C,EAAiB5J,EAAKE,QAAQ0J,gBAE1B,OAAOA,IAAmBD,EAEhC,MAAOof,IAGT,OAAIhnB,SAAST,aACToI,EAAQ3H,SAAST,UAAUuI,eACrBC,UAAU,aAAcH,GACvBA,IAAcD,EAAMK,KAAK9C,SAKxC4hB,eAAgB,WACZ,IAAI3oB,EAAUD,KAAKC,QAGnB,IACIA,EAAQ8oB,aAAe9oB,EAAQ0J,eAAiB1J,EAAQK,MAAM0G,OAC9D/G,EAAQ+oB,WAAa/oB,EAAQgpB,YAC/B,MAAOH,GACL7oB,EAAQK,MAAQL,EAAQK,SAMpCX,EAAEmB,OAAOoP,EAAY3K,UAAWoiB,GAEhCvG,EACKtb,GAAG,aAAc6hB,EAAQE,mBACzB/hB,GAAG,UAAW6hB,EAAQO,qBAO3B,IAAIrW,KASJD,IAEA,IAAIsX,GAEAC,YAAa,WAsBT,SAASC,EAAa7c,GAEd5M,EAAEiM,WAAW7L,EAAKD,QAAQqE,gBAC1BpE,EAAKD,QAAQqE,cAAcyG,KAAK7K,EAAKE,QAAS,KAAM8mB,EAAS,QAASxa,GAxB9E,IAAIxM,EAAOC,KACP4X,EAAQjY,EAAEsL,KAAKlL,EAAKD,QAAQ8X,OAC5ByR,EAAatpB,EAAKD,QAAQiE,KAAO6T,EACjCmP,EAAUlV,EAAewX,GAExBtC,IACDA,EAAUlV,EAAewX,GAAc1pB,EAAEqM,KAAKjM,EAAK+lB,cAAc,YAGrEiB,EACK9a,KAAK,SAASoF,GACPA,EAAOiY,OACP3pB,EAAEmB,OAAOf,EAAKsR,OAAQA,GAEtB+X,EAAa,yBAGpBhd,KAAK,WACFgd,EAAarC,EAAQwC,gBAarCrZ,EAAY0B,YAAcA,EAE1BjS,EAAEmB,OAAOoP,EAAY3K,UAAW2jB,GAEhC9H,EACKtb,GAAG,aAAcojB,EAAUC,aAIhC,IAAIK,EACAC,GAAqB,EAOrBC,GAEAC,cAAe,WACX,IAAI5pB,EAAOC,KACP4pB,EAAmB7pB,EAAKD,QAAQ+pB,YAE/B9pB,EAAKgE,KAAK8X,YAAe+N,IAI9B7pB,EAAK8pB,YAAclqB,EAAE2Q,WACjB3Q,EAAEmX,cAAc8S,IAAqBjqB,EAAE6H,QAAQoiB,GAC/C7pB,EAAK8pB,YAAYpY,QAAQmY,IAEpBJ,IACDA,EAAkB7pB,EAAEqM,KAAKjM,EAAK+lB,cAAc,uBAGhD0D,EACKvd,KAAK,SAAU6d,GACZ,IAAIC,EAAeD,GAAQA,EAAK3V,UAAY2V,EAAK3V,SAASnO,KACtD+jB,GAAgBA,EAAa5E,SAC7BplB,EAAK8pB,YAAYpY,QAAQsY,GAEzBhqB,EAAK8pB,YAAYlH,WAGxBvW,KAAK,WACFrM,EAAK8pB,YAAYlH,cASjCqH,eAAgB,WACZ,OAAOhqB,KAAK6pB,aAGhBI,gBAAiB,WACb,IAAIlqB,EAAOC,KACPuD,KAQJ,OANIxD,EAAK8pB,aAAelqB,EAAEiM,WAAW7L,EAAK8pB,YAAYK,UAAwC,YAA5BnqB,EAAK8pB,YAAYnH,SAC/E3iB,EAAK8pB,YAAY5d,KAAK,SAAU8d,GAC5BxmB,EAAwB,gBAAI5D,EAAEwqB,UAAUJ,KAIzCxmB,IAOe,OAA1B/B,EAAMsS,mBACNnU,EAAEmB,OAAO6P,GACLkZ,YAAaJ,IAGjB9pB,EAAEmB,OAAOoP,GACLka,cArER,WACIZ,EAAkB,KAClB7Y,EAAgBkZ,YAAcJ,KAsE9B9pB,EAAEmB,OAAOoP,EAAY3K,WACjBykB,eAAgBN,EAAUM,iBAG9B5I,EACKtb,GAAG,aAAc4jB,EAAUC,eAC3B7jB,GAAG,gBAAiB4jB,EAAUO,kBAGvC,IAAII,GAEAC,iBAAkB,SAAUppB,EAAY+lB,GACpC,IAAIlnB,EAAOC,KACPwlB,EAAW7lB,EAAE2Q,WAEjB,OAAKvQ,EAAKsR,OAAOkZ,SAAWxqB,EAAKgE,KAAK6X,oBAAsB7b,EAAKga,YAAY6B,mBACzEqL,GAAoBA,EAAiBuB,WAC9BhD,EAAS/T,QAAQvQ,GAIxBA,EAAW8E,MAA8B,MAAtB9E,EAAW8E,KAAKwkB,GAC5BhF,EAAS/T,QAAQvQ,IAG5BnB,EAAK0qB,kBAGL1qB,EAAKM,aAAea,EAAW0e,mBAG/B7f,EAAKyQ,YAAczQ,EAAK+K,eACpB5J,EAAW0e,oBAEP5F,MAAO,EACP0Q,UAAW,KACXC,gBAAiB,KACjBjF,WAAY,KACZC,SAAU,OAGVgB,aAAa,EACbC,oBAAoB,IAGvBtE,OAAO,WACJviB,EAAK6qB,mBAER3e,KAAK,SAAU/L,GACZ,IAAI2qB,EAAqB3qB,GAAeA,EAAY,GAEpDslB,EAAS/T,QAAQoZ,GAAsB3pB,IAAc2pB,KAExDze,KAAK,WACFoZ,EAAS/T,QAAQvQ,KAGlBskB,IAQXsB,eAAgB,SAAU7hB,EAAUwF,GAChC,IACIogB,EADO7qB,KACmBoQ,gBAAgB3F,GAE1CogB,GACAlrB,EAAEqN,KAAK/H,EAAS/E,YAAa,SAASsM,EAAGtL,GACrC,GAAIA,EAAWZ,QAAUmK,EAErB,OADAxF,EAAS/E,YAAYsM,GAAKqe,GACnB,MAQ3BlrB,EAAEmB,OAAOoP,EAAY3K,UAAW8kB,GA0ChC,IAKIS,GAEAC,gBAAiB,WACb,IAAIhrB,EAAOC,KACPyF,EAAqB,IAAM1F,EAAKiB,QAAQE,WACxCpB,EAAUC,EAAKD,QACfoI,EAAavI,EAAE,UACVyN,SAAStN,EAAQ8B,gBACjBiE,KACG3D,SAAU,WACVC,QAAS,SAGrBpC,EAAKmI,WAAaA,EAElBA,EAAWpC,GAAG,QAAUoN,EAAUzN,EAAoB9F,EAAEgS,MAAM5R,EAAKirB,kBAAmBjrB,KAG1FkrB,gBAAiB,WACb,IAAIlrB,EAAOC,KAEPD,EAAKD,QAAQ2jB,UACb1jB,EAAKmI,WAAWyG,UAIxBuc,oBAAqB,WACjB,IAAInrB,EAAOC,KAGXD,EAAKmI,WAAWuG,IAFK,yBAGjB1O,EAAKD,QAAQ2jB,UACb1jB,EAAKmI,WAAWpC,GAJC,wBAIkBnG,EAAEgS,MAAM5R,EAAKmjB,YAAanjB,KAOrEirB,kBAAmB,SAAUtkB,GACzB,IAEIoG,EAFA/M,EAAOC,KACPmrB,EAAMxrB,EAAE+G,EAAE0c,QAGd,IAAKrjB,EAAKqrB,iBAAkB,CAIxB,IAHArrB,EAAKsoB,aAAc,EACnBtoB,EAAKF,GAAGwrB,QAEDF,EAAInkB,UAAY8F,EAAQqe,EAAIvD,KAAK,gBACpCuD,EAAMA,EAAI9H,QAAQ,IAAMtjB,EAAKiB,QAAQE,YAGrC4L,IAAUwe,MAAMxe,IAChB/M,EAAKoG,QAAQ2G,KAOzBye,oBAAqB,SAAUtH,EAAQC,GACnC,IAEIjiB,EAFAlC,EAAOC,KACPgpB,EAAajpB,EAAKoR,UAAU6X,aAG5BjpB,EAAKugB,UACLre,EAAQlC,EAAKD,QAAQ2jB,UACjB7a,KAAMogB,EAAa,KACnBrgB,IAAKub,EAASvb,IAAMub,EAAS3b,YAAc,OAE3CK,KAAMqb,EAAOrb,KAAOsb,EAAStb,KAAOogB,EAAa,KACjDrgB,IAAKsb,EAAOtb,IAAMub,EAAS3b,YAAc,OAEvCpF,MAAQpD,EAAKoR,UAAUhO,QAAU,MAEvClB,EAAQlC,EAAKD,QAAQ2jB,UACjB7a,KAAMsb,EAAStb,KAAO,KACtBD,IAAKub,EAASvb,IAAMub,EAASI,UAAYJ,EAASM,YAAc,OAEhE5b,KAAMqb,EAAOrb,KAAO,KACpBD,IAAKsb,EAAOtb,IAAMub,EAASI,UAAYJ,EAASM,YAAc,MAIlEhjB,EAAMsT,MAAM,WACR,IAAI3R,EAAQpD,EAAKD,QAAQqD,MAEX,SAAVA,IACAA,EAAQpD,EAAKF,GAAG0J,cAEpBxJ,EAAKmI,WAAWqB,WAAWpG,MAInCpD,EAAKmI,WACAsjB,YAAYzrB,EAAKiB,QAAQ4P,OAAQ7Q,EAAKugB,UACtCza,IAAI5D,GAETlC,EAAK0rB,sBAAwBvH,EAAStb,KAAOsb,EAASK,WAAaL,EAASC,YAAc6E,GAG9F0C,kBAAmB,WACf,IAAI3rB,EAAOC,KACED,EAAK4rB,sBAEX9lB,IAAI,cAAe9F,EAAKugB,SAAWvgB,EAAK0rB,sBAAwB,KAAO,KAGlFE,oBAAqB,WACjB,OAAO3rB,KAAKkI,WAAWjC,SAAS,IAAMjG,KAAKgB,QAAQE,aAGvD0qB,uBAAwB,SAAU3jB,GAC9BjI,KAAKorB,kBAAoBnjB,EACzBjI,KAAKkI,WAAW0f,KAAK,YAAa3f,IAGtCwiB,gBAAiB,WACbzqB,KAAK4rB,wBAAuB,IAGhChB,eAAgB,WACZ5qB,KAAK4rB,wBAAuB,IAOhCC,uBAAwB,WACpB,IAAI9rB,EAAOC,KAEX,OAAOD,EAAKG,YAAY8G,OAAS,GACA,IAA5BjH,EAAKG,YAAY8G,UACZjH,EAAKsB,WAAa1B,EAAEsL,KAAKlL,EAAKG,YAAY,GAAGI,SAAWX,EAAEsL,KAAKlL,EAAKsB,UAAUf,SAI5FgK,QAAS,WACL,IAEI9G,EAFAzD,EAAOC,KACPF,EAAUC,EAAKD,QAEf6F,KAEJ,GAAK5F,EAAKga,YAAY+H,WAAtB,CAKA,GAAK/hB,EAAK8rB,yBAWNroB,EAAe1D,EAAQ0D,cAAgBzD,EAAKgE,KAAKP,cAAgBzD,EAAKyD,cAGjEzD,EAAKugB,UAAYxgB,EAAQqB,MAAQpB,EAAKG,YAAY8G,QACnDrB,EAAKmI,KAAK,eAAiB/N,EAAKiB,QAAQG,KAAO,KAAOrB,EAAQqB,KAAO,UAEzEpB,EAAKK,eAAiB,EAEtBT,EAAEqN,KAAKjN,EAAKG,YAAa,SAAUsM,EAAGtL,GAClC,IAAI4qB,EAAS/rB,EAAKgsB,oBAAoBhsB,EAAKG,YAAagB,GAEpDA,GAAcnB,EAAKsB,YACnBtB,EAAKK,cAAgBoM,GAGzB7G,EAAKmI,KAAK,eAAiB/N,EAAKiB,QAAQE,WAAa,iBAAmBsL,EAAI,MAC5E7G,EAAKmI,KAAKtK,EAAaoH,KAAK7K,EAAMmB,EAAWZ,MAAOP,EAAKM,aAAca,GACnEoW,oBAAqBvX,EAAKgE,KAAKuT,uBAE/BwU,GACAnmB,EAAKmI,KAAK,gBAAkB/N,EAAKiB,QAAQiQ,cAAgB,KAAOzP,EAAMwQ,WAAW8Z,GAAU,WAE/FnmB,EAAKmI,KAAK,gBAjCkB,CAEhC,GAAI/N,EAAKG,YAAY8G,OAEjB,YADAjH,EAAKoH,OAGLxB,EAAKmI,KAAK,eAAiB/N,EAAKiB,QAAQG,KAAO,KAAOrB,EAAQ2Z,kBAAkB3Z,EAAQiE,MAAQ,UAgCxGhE,EAAKmI,WAAWvC,KAAKA,EAAKuM,KAAK,KAG3BpS,EAAQgD,kBAA2C,IAAxB/C,EAAKK,gBAChCL,EAAKK,cAAgB,IAEG,IAAxBL,EAAKK,eACLL,EAAK4rB,sBAAsBK,GAAGjsB,EAAKK,eAAegN,SAASrN,EAAKiB,QAAQC,UAGxEtB,EAAEiM,WAAW9L,EAAQ+M,eACrB/M,EAAQ+M,aAAajC,KAAK7K,EAAKE,QAASF,EAAKmI,YAGjDnI,EAAKmI,WAAWmB,OAChBtJ,EAAKwG,SAAU,EACfxG,EAAKyG,cACLzG,EAAK2rB,sBAGT9M,mBAAoB,SAAUte,EAAOY,GACjC,IAAInB,EAAOC,KACPqR,EAAS7P,EAAMuV,aAAa7V,EAAW8E,KAAM,gBAEjD,MAAO,gBAAkBjG,EAAKiB,QAAQV,MAAQ,KAAO+Q,EAAS,4BAA8BA,EAAS,IAAM,IAAM,IAC7G/Q,EACA,WAGRkD,aAAc,SAAUlD,EAAOD,EAAca,EAAYpB,GACrD,IAAIC,EAAOC,KAIX,OAFAM,EAAQP,EAAKkQ,iBAAiB3P,EAAOD,EAAca,EAAYpB,GAExDC,EAAK6e,mBAAmBte,EAAOY,IAa1C+O,iBAAkB,SAAU3P,EAAOD,EAAca,EAAYpB,GAEzD,IAIIyX,EAAQ0U,EAERC,EAAOC,EAAM3f,EAAGuF,EAAOK,EANvBrS,EAAOC,KACP8R,KACAwF,EAAsBxX,GAAWA,EAAQwX,oBACzCiJ,EAAYzgB,GAAWA,EAAQygB,UAE/B6L,EAAS5qB,EAAM4V,kBAGnB,IAAK9W,EAAO,MAAO,GAWnB,IATAiX,EAAS/V,EAAM6V,UAAUhX,EAAciX,GAEvC2U,EAAgBtsB,EAAEgO,IAAI4J,EAAQ,SAAUK,GACpC,OAAO,IAAIlU,OAAO,wCACRlC,EAAMC,iBAAiBmW,GAAS,2DACiC,QAIvEsU,EAAQE,EAAOC,KAAK/rB,KAAW4rB,EAAM,IACzCC,EAAOD,EAAM,GACbpa,EAAOhE,MACHhE,KAAMqiB,EAGNG,aAAcH,EAAKtnB,gBAAkBsnB,EACrC9M,UAAW7d,EAAMiW,YAAY0U,GAC7BI,WAAW,IAEXL,EAAM,IACNpa,EAAOhE,MACHhE,KAAMoiB,EAAM,KAMxB,IAAK1f,EAAI,EAAGA,EAAIsF,EAAO9K,OAAQwF,MAC3BuF,EAAQD,EAAOtF,IACL+f,WAAcxa,EAAME,UAAiE,IAArDtS,EAAEkO,QAAQkE,EAAMsN,UAAW/H,KAA+BvF,EAAMua,cACtG3sB,EAAEqN,KAAKif,EAAe,SAAUO,EAAGC,GAC/B,IACIzlB,EADA0lB,EAAaD,EAAQJ,KAAKta,EAAMsN,WACxBsN,EAAYngB,EAAI,EAE5B,GAAIkgB,EA+CA,OA9CAA,GACIE,OAAQF,EAAW,IAAM,GACzBG,WAAYH,EAAW,IAAM,GAC7BI,gBAAiBJ,EAAW,IAAM,GAClC5iB,KAAM4iB,EAAW,IAAM,GACvBzJ,MAAOyJ,EAAW,IAAM,KAGbE,SAEX9a,EAAOib,OAAOvgB,EAAG,GACb1C,KAAMiI,EAAMjI,KAAK4D,OAAO,EAAGgf,EAAWG,WAAW7lB,QACjDqY,UAAWqN,EAAWG,WACtBN,WAAW,IAEXziB,KAAM4iB,EAAWI,kBAErBH,GAAa,EAEb3lB,EAAS0lB,EAAWE,OAAO5lB,OAC3B+K,EAAMjI,KAAOiI,EAAMjI,KAAK4D,OAAO1G,GAC/B+K,EAAMsN,UAAYtN,EAAMsN,UAAU3R,OAAO1G,GACzCwF,KAGJxF,EAAS0lB,EAAW5iB,KAAK9C,OAAS0lB,EAAWzJ,MAAMjc,OAC/C+K,EAAMsN,UAAUrY,OAASA,IACzB8K,EAAOib,OAAOJ,EAAW,GACrB7iB,KAAMiI,EAAMjI,KAAK4D,OAAO1G,GACxBqY,UAAWtN,EAAMsN,UAAU3R,OAAO1G,GAClCulB,WAAW,IAEfxa,EAAMjI,KAAOiI,EAAMjI,KAAK4D,OAAO,EAAG1G,GAClC+K,EAAMsN,UAAYtN,EAAMsN,UAAU3R,OAAO,EAAG1G,IAG5C0lB,EAAWzJ,QACXjc,EAAS0lB,EAAW5iB,KAAK9C,OACzB8K,EAAOib,OAAOJ,EAAW,GACrB7iB,KAAMiI,EAAMjI,KAAK4D,OAAO1G,GACxBqY,UAAWtN,EAAMsN,UAAU3R,OAAO1G,KAEtC+K,EAAMjI,KAAOiI,EAAMjI,KAAK4D,OAAO,EAAG1G,GAClC+K,EAAMsN,UAAYtN,EAAMsN,UAAU3R,OAAO,EAAG1G,IAEhD+K,EAAME,SAAU,GACT,IAMvB,GAAIsO,EAAW,CACX,IAAK/T,EAAI,EAAGA,EAAIsF,EAAO9K,QAAUuZ,GAAa,EAAG/T,KAE7C+T,IADAxO,EAAQD,EAAOtF,IACI1C,KAAK9C,QACR,IACZ+K,EAAMjI,KAAOiI,EAAMjI,KAAK4D,OAAO,EAAGqE,EAAMjI,KAAK9C,OAASuZ,GAAa,OAG3EzO,EAAO9K,OAASwF,EAIpB,OADA4F,EAAenC,EAAiB6B,GACzBK,EAAkBC,EAAcrS,EAAKiB,QAAQ6P,SAGxDkb,oBAAqB,SAAU7rB,EAAagB,GACxC,IAIIgrB,EAAOC,EAHP/Q,EADOpb,KACW+D,KAAKqX,WACvB4R,KACAZ,EAAS5qB,EAAM4V,kBAEf0U,KAEJ,GAAI1Q,GAAc5I,EAAqBtS,EAAagB,IAAeA,EAAW8E,OAE1ErG,EAAEqN,KAAKoO,EAAY,SAAU9L,GACzB,IAAIhP,EAAQY,EAAW8E,KAAKsJ,GACxBhP,IACA0sB,EAAS1d,GAAS9N,EAAMiW,YAAYnX,OAIvCX,EAAEmf,cAAckO,IAAW,CAC5B,MAAQd,EAAQE,EAAOC,KAAK7qB,EAAMiW,YAAYvW,EAAWZ,WAAa6rB,EAAOD,EAAM,KAC/EvsB,EAAEqN,KAAKggB,EAAU,SAAUxgB,EAAGlM,GAC1B,GAAIA,GAAS6rB,EAGT,OAFAL,EAAOhe,KAAKsN,EAAW5O,WAChBwgB,EAASxgB,IACT,IAKnB,GAAIsf,EAAO9kB,OACP,OAAO8kB,EAAO5Z,KAAK,QAMnC/K,KAAM,WACF,IAAIpH,EAAOC,KACXD,EAAKwG,SAAU,EACfxG,EAAKK,eAAiB,EACtBL,EAAKmI,WACAf,OACAmG,SAGTvH,SAAU,SAAU+G,GAChB,IACImgB,EAEAC,EAHAntB,EAAOC,KAEPiB,EAAWlB,EAAKiB,QAAQC,SAG5B,OAAKlB,EAAKqrB,oBACN8B,EAAYntB,EAAK4rB,uBAEPzlB,YAAYjF,GAEtBlB,EAAKK,cAAgB0M,GAEO,IAAxB/M,EAAKK,eAAwB8sB,EAAUlmB,OAASjH,EAAKK,iBACrD6sB,EAAcC,EAAUlB,GAAGjsB,EAAKK,gBACpBgN,SAASnM,GACdgsB,GAIR,MAGXE,WAAY,SAAUC,GAClB,IAAIrtB,EAAOC,KAEND,EAAKqrB,mBACNrrB,EAAKK,eAAiB,EACtBL,EAAK4rB,sBAAsBzlB,YAAYnG,EAAKiB,QAAQC,UAChDmsB,GACArtB,EAAKF,GAAGkH,IAAIhH,EAAKM,gBAK7B6J,OAAQ,WACJ,IAAInK,EAAOC,KAEPD,EAAKqrB,oBAGmB,IAAxBrrB,EAAKK,cAOkB,IAAvBL,EAAKK,cAKTL,EAAKkO,aAAalO,EAAKK,cAAgB,GAJnCL,EAAKotB,YAAW,GAPZptB,EAAKG,YAAY8G,QACjBjH,EAAKkO,aAAalO,EAAKG,YAAY8G,OAAS,KAaxDmD,SAAU,WACN,IAAIpK,EAAOC,KAEPD,EAAKqrB,mBAGLrrB,EAAKK,gBAAmBL,EAAKG,YAAY8G,OAAS,EAKtDjH,EAAKkO,aAAalO,EAAKK,cAAgB,GAJnCL,EAAKotB,YAAW,KAOxBlf,aAAc,SAAUnB,GACpB,IAEIugB,EACAC,EAEAhlB,EALAvI,EAAOC,KACPitB,EAAcltB,EAAKgG,SAAS+G,GAG5BhE,EAAY/I,EAAKmI,WAAWY,YAG3BmkB,GAAgBA,EAAYjmB,UAIjCqmB,EAAUJ,EAAY/qB,WAAWyG,KACnB,EACV5I,EAAKmI,WAAWY,UAAUA,EAAYukB,IAEtCC,EAAaD,EAAUJ,EAAY1kB,gBACnCD,EAAkBvI,EAAKmI,WAAWsc,gBAE9BzkB,EAAKmI,WAAWY,UAAUA,EAAYR,EAAkBglB,GAIhEvtB,EAAKF,GAAGkH,IAAIhH,EAAKG,YAAY4M,GAAOxM,UAK5CX,EAAEmB,OAAO6P,GA9eLxN,MAAO,OACPsgB,UAAU,IA+ed9jB,EAAEmB,OAAOoP,EAAY3K,UAAWulB,GAEhC1J,EACKtb,GAAG,aAAcglB,EAAUC,iBAC3BjlB,GAAG,UAAWglB,EAAUG,iBACxBnlB,GAAG,aAAcglB,EAAUI,qBAC3BplB,GAAG,cAAeglB,EAAUS,qBAC5BzlB,GAAG,cAAeglB,EAAUY,mBAC5B5lB,GAAG,oBAAqBglB,EAAUxgB,SAMvC,IAQIijB,GACAC,KAAQ,OACRC,QAAW,UACXC,MAAS,SAGTC,EAAQ,SAAUC,GAClB,IAAI7tB,EAAOC,KACPmrB,EAAMxrB,EAAE,qCAEZI,EAAK6tB,MAAQA,EACb7tB,EAAKorB,IAAMA,EACXprB,EAAKgE,KAAOwpB,EAAYC,KACxBztB,EAAKwG,SAAU,EACfxG,EAAK8tB,eAAiB,KAEtB1C,EAAIrlB,GAAG,QAASnG,EAAEgS,MAAM5R,EAAM,aAGlC4tB,EAAMpoB,WAEFuoB,UAAW,WACP,IAAI/tB,EAAOC,KACP+D,EAAOhE,EAAK6tB,MAAM9tB,QAAQiuB,MAC1BC,GAAgB,EAEpBruB,EAAEqN,KAAKugB,EAAa,SAAU9Y,EAAKnU,GAE/B,GADA0tB,EAAgB1tB,GAASyD,EAErB,OAAO,IAIViqB,IACDjqB,EAAOhE,EAAK6tB,MAAMtN,SAAWiN,EAAYG,MAAQH,EAAYE,SAG7D1pB,GAAQhE,EAAKgE,OACbhE,EAAKgE,KAAOA,EACZhE,EAAKorB,IAAIvD,KAAK,kBAAmB7jB,GACjChE,EAAKkuB,QAAO,KAIpBA,OAAQ,SAAUC,GACd,IACI3nB,EADAxG,EAAOC,KAGX,OAAQD,EAAKgE,MACT,KAAKwpB,EAAYG,MACbnnB,IAAYxG,EAAK6tB,MAAMvtB,aACvB,MACJ,KAAKktB,EAAYE,QACblnB,IAAYxG,EAAK6tB,MAAMrpB,eACvB,MACJ,QACIgC,GAAU,EAGdA,GAAWxG,EAAKwG,UAChBxG,EAAKwG,QAAUA,EACXA,EACAxG,EAAKsJ,KAAK6kB,GAEVnuB,EAAKoH,KAAK+mB,KAKtB7kB,KAAM,SAAU6kB,GACZ,IAAInuB,EAAOC,KACPiC,GAASmH,QAAW,GAEpB8kB,GACAnuB,EAAKorB,IACA9hB,OACAxD,IAAI5D,GACTlC,EAAKouB,gBAAe,IAEpBpuB,EAAKorB,IACAiD,MAAK,GAAM,GACXtZ,MAxFO,IAyFPuZ,MAAM,WACHtuB,EAAKorB,IAAI9hB,OACTtJ,EAAKouB,iBACLpuB,EAAKorB,IAAImD,YAEZzK,QAAQ5hB,EAAO,SAI5BkF,KAAM,SAAU+mB,GACZ,IAAInuB,EAAOC,KACPiC,GAASmH,QAAW,GAEpB8kB,GACAnuB,EAAKorB,IACAhkB,OACAtB,IAAI5D,GAEblC,EAAKorB,IACAiD,MAAK,GACLvK,QAAQ5hB,GACLssB,SAAU,OACVC,SAAU,WACNzuB,EAAKorB,IAAIhkB,OACTpH,EAAK0uB,qBAKrBjoB,YAAa,SAASyd,EAAQC,GAC1B,IAAInkB,EAAOC,KACP0uB,EAAYxK,EAASM,YAEzBzkB,EAAK+tB,YACL/tB,EAAKorB,IAAItlB,KACL+C,KAAMqb,EAAOrb,KAAOsb,EAASK,WAAaL,EAASO,WAAaiK,EAAY,KAC5E/lB,IAAKsb,EAAOtb,IAAMub,EAASI,UAAY,KACvC9b,OAAQkmB,EACRvrB,MAAOurB,IAGX3uB,EAAK8tB,eAAiB3J,EAASG,aAC/BtkB,EAAKoD,MAAQurB,EACT3uB,EAAKwG,UACL2d,EAASS,iBAAmB+J,IAIpCP,eAAgB,SAAUD,GACtB,IAAInuB,EAAOC,KACPmrB,EAAMprB,EAAK6tB,MAAM/tB,GACjBoC,GAASoiB,aAAgBtkB,EAAKoD,OAE9BpD,EAAKoD,MAAQpD,EAAK8tB,iBAClB9tB,EAAK4uB,iBACDT,EACA/C,EAAItlB,IAAI5D,GAERkpB,EACKtH,QAAQ5hB,GAASssB,SAAU,OAAQF,MArJvC,UAsJIC,QAtJJ,WA2JbG,eAAgB,SAAUP,GACtB,IAAInuB,EAAOC,KACPmrB,EAAMprB,EAAK6tB,MAAM/tB,GACjBoC,GAASoiB,aAAgBtkB,EAAK8tB,gBAE9B9tB,EAAKoD,MAAQpD,EAAK8tB,iBAClB9tB,EAAK4uB,gBAAe,GAChBT,EACA/C,EAAItlB,IAAI5D,GAERkpB,EACKrW,MApKQ,IAFZ,SAuKI+O,QAAQ5hB,GAASssB,SAAU,OAAQF,MAvKvC,UAwKIC,QAxKJ,WA6KbK,eAAgB,SAAUC,GACtB5uB,KAAK4tB,MAAM/tB,GAAGuuB,KA9KL,SA8KsB,EAAMQ,IAGzCC,QAAS,SAAUnoB,GACf,IAAI3G,EAAOC,KAEPD,EAAKgE,MAAQwpB,EAAYG,OACzB3tB,EAAK6tB,MAAM9lB,UAMvB,IAAIgnB,GAEAC,YAAa,WACT,IAAIhvB,EAAOC,KACP+tB,EAAQ,IAAIJ,EAAM5tB,GAEtBA,EAAK2Q,SAASnD,OAAOwgB,EAAM5C,KAC3BprB,EAAKguB,MAAQA,GAGjBiB,iBAAkB,SAAU/K,EAAQC,GAChClkB,KAAK+tB,MAAMvnB,YAAYyd,EAAQC,IAGnC+K,eAAgB,WACZjvB,KAAK+tB,MAAMD,aAGfoB,qBAAsB,WAClBlvB,KAAK+tB,MAAME,UAGfU,eAAgB,WACZ3uB,KAAK+tB,MAAMY,mBAKnBhvB,EAAEmB,OAAO6P,GAlNLod,MAAO,OAoNX3M,EACKtb,GAAG,aAAcgpB,EAAUC,aAC3BjpB,GAAG,aAAcgpB,EAAUG,gBAC3BnpB,GAAG,cAAegpB,EAAUE,kBAC5BlpB,GAAG,QAASgpB,EAAUI,sBACtBppB,GAAG,cAAegpB,EAAUI,sBAC5BppB,GAAG,UAAWgpB,EAAUI,sBACxBppB,GAAG,gBAAiBgpB,EAAUH,gBAKnC,IAKIQ,GACF,iBACA,eACA,eACA,wBACA,qBACA,kBAyBEC,EAAqB,SAASppB,EAAMiJ,GACpC,IACImM,EACAiU,EAFAtvB,EAAOC,KAGPsvB,KAEJvvB,EAAKkP,SAAWA,EAChBlP,EAAK8W,UACL9W,EAAKwvB,aAAe,EAEhB5vB,EAAEmX,cAAc9Q,IAASiJ,EAASlL,KAAK2X,gBACvC/b,EAAEqN,KAAKiC,EAASlL,KAAK2X,eAAgB,SAAUlP,EAAGgjB,GAC9C,IAAIC,EAAYD,EAAUhV,GAEtBgV,EAAU9U,cAAgB1U,EAAKypB,KAC/B1vB,EAAK8W,OAAO4Y,GAAazpB,EAAKypB,GAC9B1vB,EAAKwvB,YAAc/iB,KAK/B4O,EAAa5Z,EAAMsW,WAAW/X,EAAK8W,SACnCwY,EAAiB7tB,EAAMwU,mBAAmBoF,EAAY+T,IACnCnoB,QACfrH,EAAEqN,KAAKqiB,EAAgB,SAASviB,EAAO2iB,GACnCH,EAAWG,GAAa1vB,EAAK8W,OAAO4Y,KAExC1vB,EAAK8W,OAASyY,EACdvvB,EAAKwvB,YAAcxvB,EAAK2vB,mBAAmBL,IACpCtvB,EAAK8W,OAAOsO,WACnBplB,EAAK8W,QAAWsO,SAAUplB,EAAK8W,OAAOsO,UACtCplB,EAAKwvB,YAAcxvB,EAAK4vB,oBAAoB5vB,EAAK8W,OAAOsO,YAIhExlB,EAAEmB,OAAOsuB,EAAmB7pB,WACxBqqB,SAAU,WACN,OAAO5vB,KAAKiP,SAASlL,KAAK0X,aAAazb,KAAK6W,QAAUmH,kBAAkB,KAG5E6R,UAAW,WACP,OAAO7vB,KAAK6W,QAGhBiZ,QAAS,WACL,OAAQnwB,EAAEmf,cAAc9e,KAAK6W,SASjC8Y,oBAAqB,SAAUxK,GAC3B,IACI4K,EADAR,GAAe,EAYnB,OATAvvB,KAAKgwB,iBAAmB7K,EAASzjB,QAAQ,uBAAwB,QACjEquB,EAAoB/vB,KAAKgwB,iBAAiBhpB,OAE1CrH,EAAEqN,KAAKhN,KAAKiP,SAASlL,KAAK2X,eAAgB,SAAUlP,EAAGgjB,GAC/CA,EAAU7U,aAAeoV,IAAsBP,EAAU7U,YAAYC,SACrE2U,EAAc/iB,KAIf+iB,GAgBXG,mBAAoB,SAAUL,GAC1B,IAAIE,GAAe,EAQnB,OANA5vB,EAAEqN,KAAKhN,KAAKiP,SAASlL,KAAK2X,eAAgB,SAAUlP,EAAGgjB,GAC/CA,EAAU1U,UAAanb,EAAEkO,QAAQ2hB,EAAU1U,SAAUuU,IAAmB,GAAME,EAAc/iB,IAC5F+iB,EAAc/iB,KAIf+iB,GAGXU,aAAc,SAAUjqB,GACpB,IAAIkG,GAAS,EAEb,OAAIlM,KAAK6W,OAAOsO,WACHnf,EAAKmf,UAA6D,IAAjDnf,EAAKmf,SAASrgB,QAAQ9E,KAAKgwB,mBAErDrwB,EAAEqN,KAAKhN,KAAK6W,OAAQ,SAAS4Y,EAAWnvB,GACpC,OAAO4L,IAAWlG,EAAKypB,IAAczpB,EAAKypB,GAAW5qB,gBAAkBvE,EAAMuE,gBAG1EqH,MAKnBgE,EAAYkf,mBAAqBA,EAUjC,IAAIc,EAAa,SAASlqB,EAAMiJ,GAC5BjP,KAAKwa,GAAKhZ,EAAM6R,SAAS,KACzBrT,KAAKmwB,YAAcnqB,EAAKmqB,UACxBnwB,KAAKiP,SAAWA,EAEhBjP,KAAK0qB,UAAY/qB,EAAEgO,IAAIhO,EAAEwqB,UAAUnkB,IAASA,EAAK0kB,WAAa1kB,EAAKoqB,eAAgB,SAAUpqB,GACzF,OAAO,IAAIopB,EAAmBppB,EAAMiJ,KAGxCjP,KAAK0qB,UAAY/qB,EAAE4L,KAAKvL,KAAK0qB,UAAW,SAASvW,GAC7C,OAAOA,EAAS2b,YAGpB9vB,KAAKwnB,MAAQxhB,EAAKwhB,MACA,MAAdxnB,KAAKwnB,OAAiBvY,EAASlL,KAAK0X,eACpCzb,KAAKwnB,MAAQ7nB,EAAEgO,IAAI3N,KAAK0qB,UAAW,SAAUvW,GACzC,OAAOA,EAASyb,aACjB1d,KAAK,OAGRlS,KAAKwnB,OAASxnB,KAAK8vB,YACnB9vB,KAAKmrB,IAAMxrB,EAAEmC,SAASC,cAAc,OAC/BwL,OAAO5N,EAAEmC,SAASC,cAAc,SAAS+H,KAAK9J,KAAKwnB,QACnDI,KAAK,qBAAsB5nB,KAAKwa,IAEjCxa,KAAKmwB,WACLnwB,KAAKmrB,IAAI5d,OACL5N,EAAEmC,SAASC,cAAc,SACpBqL,SAAS6B,EAASjO,QAAQkQ,qBAM/CvR,EAAEmB,OAAOovB,EAAW3qB,WAChBuqB,QAAS,WACL,OAAO9vB,KAAK0qB,UAAU1jB,OAAS,GAEnC6oB,UAAW,WACP,OAAOlwB,EAAEgO,IAAI3N,KAAK0qB,UAAW,SAASvW,GAClC,OAAOA,EAAS0b,iBAK5B,IAAIQ,GAEAC,kBAAmB,WACf,IAAIvwB,EAAOC,KAEXD,EAAKunB,eAELvnB,EAAKwwB,aAAe5wB,EAAE,yCACtBI,EAAK2Q,SAASnD,OAAOxN,EAAKwwB,cAC1BxwB,EAAKwwB,aAAazqB,GAAG,QAAS,IAAM/F,EAAKiB,QAAQkQ,iBAAkBvR,EAAEgS,MAAM5R,EAAKywB,wBAAyBzwB,KAG7G0wB,uBAAwB,SAASxM,EAAQC,GACrC,IAAInkB,EAAOC,KAEXD,EAAKwwB,aAAa1qB,KACd+C,KAAMqb,EAAOrb,KAAOsb,EAASK,WAAaL,EAASC,YAAc,KACjExb,IAAKsb,EAAOtb,IAAMub,EAASI,UAAYrb,KAAKynB,OAAOxM,EAASM,YAAczkB,EAAKwwB,aAAa/nB,UAAY,GAAK,OAGjH0b,EAASQ,gBAAkB3kB,EAAKwwB,aAAahnB,YAAW,GAAQ2a,EAASC,aAG7EqM,wBAAyB,SAAU9pB,GAC/B,IAAI3G,EAAOC,KACP2wB,EAAQhxB,EAAE+G,EAAE0c,QAAQC,QAAQ,MAC5B7I,EAAKmW,EAAM/I,KAAK,6BAGb7nB,EAAKunB,YAAY9M,GAExBza,EAAKglB,SAEL4L,EAAMC,QAAQ,OAAQ,WAClB7wB,EAAKmR,iBAAiBsJ,MAI9BqW,iBAAkB,WACd,IAEIC,EAFA/wB,EAAOC,KACPsnB,EAAcvnB,EAAKD,QAAQwnB,YAG1BA,EAKDA,aAAuB3nB,GAA4B,iBAAhB2nB,GAA4D,iBAAzBA,EAAYyJ,UAClFD,EAAUnxB,EAAE2nB,IACC9V,GAAGzR,EAAKunB,eACjBvnB,EAAKixB,mBACAF,EAAQtf,GAAGzR,EAAKF,MACjBE,EAAKunB,YAAcwJ,EACnB/wB,EAAKkxB,kBAIblxB,EAAKmxB,sBAAuB,EAC5BvxB,EAAEqN,KAAKjN,EAAKunB,YAAa3nB,EAAEgS,MAAM5R,EAAKmR,iBAAkBnR,IACxDJ,EAAEqN,KAAKrN,EAAEwqB,UAAU7C,GAAc,SAAU9a,EAAG2kB,GAC1CpxB,EAAKqxB,cAAcD,KAEvBpxB,EAAKmxB,sBAAuB,EAC5BnxB,EAAKyG,eApBLzG,EAAKixB,oBAwBbK,iBAAkB,SAAUrrB,GACxB,IAAIsrB,KACAnd,KAeJ,GAbAxU,EAAEqN,KAAKhN,KAAK+D,KAAK2X,eAAgB,WACzB1b,KAAK0a,cAAc4W,EAAmBxjB,KAAK9N,KAAKwa,MAGpD7a,EAAEmX,cAAc9Q,IAEhBrG,EAAEqN,KAAKhH,EAAM,SAAUyO,EAAKnU,GACpBA,GAASgxB,EAAmBxsB,QAAQ2P,IAAQ,IAC5CN,EAASM,GAAOnU,MAKvBX,EAAEmf,cAAc3K,GACjB,OAAOA,EAASgR,UAAaA,SAAUhR,EAASgR,UAAahR,GAIrEid,cAAe,SAAUD,GACrB,IAAIpxB,EAAOC,MAEXmxB,EAAa,IAAIjB,EAAWiB,EAAYpxB,IAEzB+vB,YACX/vB,EAAKunB,YAAY6J,EAAW3W,IAAM2W,EAE9BA,EAAWhG,MACXprB,EAAKwwB,aAAahjB,OAAO4jB,EAAWhG,KAC/BprB,EAAKmxB,sBACNnxB,EAAKyG,iBAMrB0K,iBAAkB,SAAUsJ,GACxB,IAAIza,EAAOC,YACJD,EAAKunB,YAAY9M,GACxBza,EAAKwwB,aAAatqB,SAAS,wBAA0BuU,EAAK,MAAM7L,SAC3D5O,EAAKmxB,sBACNnxB,EAAKyG,eAIb+qB,2BAA4B,WAQxB,IAPA,IAGI3L,EACA4L,EAJAzxB,EAAOC,KACP0qB,KACApD,EAAcvnB,EAAKunB,YAGnB/jB,KAEG+jB,aAAuB3nB,IAAMimB,EAAiB0B,EAAYpnB,kBAC3DsxB,EAAahwB,EAAMuV,aAAa6O,EAAgB,oBAElD0B,EAAc1B,EAAe0B,YAwBjC,OArBIA,aAAuB3nB,GACvB6xB,EAAa,IAAKpC,EAAmBoC,EAAY5L,GAC5CiK,eAGDtsB,EAAOmnB,WAAc8G,GACrBjuB,EAAOkc,gBAAiB,GAGxB6H,IACA3nB,EAAEqN,KAAKsa,EAAa,SAAU9M,EAAI2W,GAC9BzG,EAAYA,EAAU/S,OAAOwZ,EAAWtB,eAGxCnF,EAAU1jB,SACVzD,EAAOmnB,UAAYA,EACnBnnB,EAAOkc,eAAiB1f,EAAKD,QAAQ2f,iBAK1Clc,GAOXkkB,wBAAyB,WACrB,IAAI1nB,EAAOC,KACPyxB,EAAiB9xB,EAAEmX,cAAc/W,EAAKunB,cAAgBvP,OAAO3V,KAAKrC,EAAKunB,aAAa,GAExF,OAAOmK,EAAiB1xB,EAAKunB,YAAYmK,GAAgBjK,MAAQ,IAGrEyJ,aAAc,WACV,IAAIlxB,EAAOC,KAEXD,EAAKunB,YACAxhB,IACO,sBAAwB/F,EAAKsT,SAC7B,mCAAqCtT,EAAKsT,SAC1C,qBAAuBtT,EAAKsT,UAC9BnB,KAAK,KACPvS,EAAEgS,MAAM5R,EAAK2xB,yBAA0B3xB,IAE1C+F,GAAG,uBAAyB/F,EAAKsT,SAAU1T,EAAEgS,MAAM5R,EAAK4xB,gBAAiB5xB,KAGlFixB,iBAAkB,WACd,IAAIjxB,EAAOC,KACP8wB,EAAU/wB,EAAKunB,YAEfwJ,aAAmBnxB,GACnBmxB,EAAQriB,IAAI,IAAM1O,EAAKsT,WAI/Bqe,yBAA0B,SAAUhrB,EAAGxF,EAAY0wB,IAEhC,uBAAXlrB,EAAE3C,MAAiC6tB,IACnC5xB,KAAK8H,SAIb6pB,gBAAiB,SAAUjrB,GACvB1G,KAAKgxB,oBAGTnL,kBAAmB,WACf,OAAO7lB,KAAKsnB,uBAAuB3nB,GAAKK,KAAKsnB,YAAYpnB,eAG7D2xB,gBAAiB,SAAU3wB,GAEvB,IAAInB,EAAOC,KAAK6lB,oBAEX9lB,GAAQA,EAAKgE,OAAS/D,KAAK+D,OAAQ2O,EAAcxR,EAAYnB,KAIlEA,EAAK8xB,gBAAgB3wB,GACrBnB,EAAKklB,cAAc/jB,KAMvB4e,oBAAqB,SAAU9Z,GAC3B,IAAIjG,EAAOC,KACP8xB,KACAC,KACAC,GAAkB,EAiCtB,OA9BAryB,EAAEqN,KAAKjN,EAAKunB,YAAa,SAAU9M,EAAI2W,GACnCxxB,EAAEqN,KAAKmkB,EAAWzG,UAAW,SAAUle,EAAG2H,GAClCA,EAAS8b,aAAajqB,IAASmO,EAASob,YAAcyC,IACtDA,EAAiB7d,EAASob,iBAKlCyC,GAAkB,GAGdhsB,EAAKisB,iBAAmBjsB,EAAKisB,kBAAoBjsB,EAAKksB,eACtDJ,EAAehkB,KAAKkV,MAAM8O,EAAgB/xB,EAAKgE,KAAK4X,mBAAyB,KAAE9E,QAInFlX,EAAEqN,KAAKjN,EAAKgE,KAAK2X,eAAelQ,MAAM,EAAGwmB,EAAiB,GAAI,SAAUxlB,EAAGgjB,GACvEsC,EAAehkB,KAAKkV,MAAM8O,EAAgBtC,EAAU3Y,UAIxDlX,EAAEqN,KAAKhH,EAAM,SAAUyO,EAAKnU,IACa,IAAjCwxB,EAAehtB,QAAQ2P,KACvBsd,EAAiBtd,GAAOnU,MAIhCyxB,EAAmB/rB,EAGhB+rB,IAKfpyB,EAAEmB,OAAO6P,GA5cL2W,YAAa,KACb7H,gBAAgB,IA6cpB9f,EAAEmB,OAAOoP,EAAY3K,UAAW8qB,GAGF,OAA1B7uB,EAAMsS,kBACNsN,EACKtb,GAAG,aAAcuqB,EAAUC,mBAC3BxqB,GAAG,aAAcuqB,EAAUQ,kBAC3B/qB,GAAG,cAAeuqB,EAAUI,wBAC5B3qB,GAAG,gBAAiBuqB,EAAUkB,4BAC9BzrB,GAAG,UAAWuqB,EAAUW,kBAOjC,IAAImB,GAEAC,aAAc,SAAU3nB,GACpB,IAAI1K,EAAOC,KAEPyK,EAAMzD,QAAUjH,EAAKD,QAAQsD,SAC7BrD,EAAKilB,kBAAkBva,GAEvB1K,EAAKoH,QASbghB,mBAAoB,SAAUlB,GAC1B,IAAIlnB,EAAOC,KACPkM,EAASvM,EAAE2Q,WA4Bf,OAzBAvQ,EAAKsQ,WAAWoB,UAEhB1R,EAAKwQ,WACAtE,KAAK,WACF,IAAIa,EAGA/M,EAAKsB,YAActB,EAAKwG,QACxB2F,EAAOyW,UAEP7V,EAAQ/M,EAAKsyB,sBAEbtyB,EAAKoG,OAAO2G,EAAOma,IAEJ,IAAXna,EACAZ,EAAOyW,SAEPzW,EAAOuF,QAAQ3E,MAI1BV,KAAK,WACFF,EAAOyW,WAGRzW,GAMXomB,sBAAuB,WACnB,IAAIvyB,EAAOC,KAEND,EAAKga,YAAY+H,YAClB/hB,EAAKoG,OAAO,IAQpBksB,oBAAqB,WACjB,IAEI/xB,EAFAP,EAAOC,KACP8M,EAAQ/M,EAAKK,cAcjB,OAXe,IAAX0M,IAEAxM,EAAQX,EAAEsL,KAAKlL,EAAKF,GAAGkH,SAEnBpH,EAAEqN,KAAKjN,EAAKgE,KAAKkU,SAAU,SAAUzL,EAAGigB,GAEpC,OAAkB,KADlB3f,EAAQ2f,EAAQnsB,EAAOP,EAAKG,gBAMjC4M,GAUX3G,OAAQ,SAAU2G,EAAOma,GACrB,IAIIzH,EAJAzf,EAAOC,KACPkB,EAAanB,EAAKG,YAAY4M,GAC9Byb,EAAoBtB,GAAoBA,EAAiBsB,kBACzDloB,EAAeN,EAAKM,aAIxB,IAAIN,EAAK0Q,WAAmB,OAA5B,CAIA,IAAKvP,EAKD,OAJKqnB,GAAsBxoB,EAAKsB,WAC5BtB,EAAK2oB,8BAET3oB,EAAKwyB,iBAAiBhK,GAI1B/I,EAAgBzf,EAAKyf,cAActe,GAEnCnB,EAAKuqB,iBAAiBppB,EAAY+lB,GAC7Bhb,KAAK,SAAU4e,EAAoBhL,GAChC9f,EAAK0lB,iBAAiBoF,EAAoB/d,EAAOzM,EAAcV,EAAEmB,QAC7D+e,gBAAiBA,EACjBL,cAAeA,GAChByH,QAgBfxB,iBAAkB,SAAUvkB,EAAY4L,EAAO0lB,EAAWvL,GACtD,IAAIlnB,EAAOC,KACPuoB,EAAoBtB,EAAiBsB,kBACrCkK,GAAsB1yB,EAAKgE,KAAKyX,gBAAkBzb,EAAKgE,KAAKyX,eAAe5Q,KAAK7K,EAAMmB,GACtF0jB,EAAmB7kB,EAAKsB,UAGxBtB,EAAK0Q,WAAmB,SAGxB1Q,EAAKgE,KAAKwX,0BACVgN,GAAoB,GAGpBkK,IACAlK,GAAoB,GAIpBtB,EAAiBpH,iBAAmB9f,EAAKG,YAAY4M,KACrD/M,EAAKG,YAAY4M,GAAO9G,KAAO9E,EAAW8E,MAG1CjG,EAAKga,YAAYgI,cACjBhiB,EAAKmlB,iBAAiBhkB,GACtBnB,EAAKM,aAAeN,EAAKuf,mBAAmBpe,EAAY+lB,IAEpDlnB,EAAKM,cAAiB4mB,EAAiBmB,SAAYqK,IACnD1yB,EAAKM,cAAgB,KAEzBN,EAAKF,GAAGkH,IAAIhH,EAAKM,eAGjBN,EAAKM,cACLN,EAAKsB,UAAYH,EACZnB,EAAK2nB,mBAAmBxmB,EAAY0jB,IACrC7kB,EAAK+iB,QAAQ,SAAU5hB,EAAYnB,EAAKM,cAAgBmyB,GAExDzyB,EAAKga,YAAY+H,YACjB/hB,EAAKwyB,iBAAiBhK,KAG1BxoB,EAAKsB,UAAY,KACjBtB,EAAK2oB,0BAGT3oB,EAAK8xB,gBAAgB3wB,KAGzBqxB,iBAAkB,SAAUhK,GACxB,IAAIxoB,EAAOC,KAEPuoB,GACAxoB,EAAKK,eAAiB,EACtBL,EAAKilB,kBAAkBjlB,EAAKM,eAE5BN,EAAKoH,QAIbuhB,uBAAwB,WACpB,IAAI3oB,EAAOC,KAEND,EAAK0Q,WAA0B,eAChC1Q,EAAK+iB,QAAQ,gBAAiB/iB,EAAKM,eAI3CyiB,QAAS,SAAU4P,GACf,IAAI3yB,EAAOC,KACP8O,EAAOtN,EAAMgK,MAAMuD,UAAW,GAC9BsT,EAAWtiB,EAAKD,QAAQ,KAAO4yB,GAEnC3yB,EAAK0Q,WAAWiiB,IAAS,EACrB/yB,EAAEiM,WAAWyW,IACbA,EAASW,MAAMjjB,EAAKE,QAAS6O,GAEjC/O,EAAKF,GAAGijB,QAAQlY,KAAK7K,EAAKF,GAAI,eAAiB6yB,EAAM7tB,cAAeiK,GACpE/O,EAAK0Q,WAAWiiB,IAAS,IAKjC/yB,EAAEmB,OAAOoP,EAAY3K,UAAW4sB,GAEhC/Q,EACKtb,GAAG,oBAAqBqsB,EAAUG,uBAMvC,IAIIK,GAEAC,YAAa,WACT5yB,KAAK4S,QACDigB,KAAM,KACN/W,GAAI,OAIZgX,iBAAkB,WACd,IAMIC,EAEAC,EARAjzB,EAAOC,KACPizB,KACAC,EAAYvzB,EAAEsL,KAAKlL,EAAKD,QAAQ8S,QAAQ5H,MAAM,KAC9CmoB,EAAYD,EAAU,GACtBE,EAAUF,EAAUA,EAAUlsB,OAAS,GACvCqsB,KAEAC,KAGAvzB,EAAKgE,KAAK2X,gBACV/b,EAAEqN,KAAKjN,EAAKgE,KAAK2X,eAAgB,WACzB1b,KAAKya,WACLwY,EAAgBnlB,KAAK9N,KAAKwa,OAKS,IAA3C7a,EAAEkO,QAAQslB,EAAWF,KACrBE,EAAY,OAIC,KADjBH,EAAUrzB,EAAEkO,QAAQulB,EAASH,KACPD,IAAYC,EAAgBjsB,OAAS,IACvDosB,EAAU,OAGVD,GAAaC,KACbL,GAAcI,EACdxzB,EAAEqN,KAAKimB,EAAiB,SAAUzmB,EAAGsG,GAQjC,GAPIA,GAASqgB,IACTJ,GAAa,GAEjBO,EAAUxlB,KAAKgF,GACXigB,GACAM,EAAUvlB,KAAKgF,GAEfA,GAASsgB,EACT,OAAO,KAKnBrzB,EAAK6S,OAAOigB,KAAOM,EACnBpzB,EAAK6S,OAAOkJ,GAAKsX,EACjBrzB,EAAK6S,OAAOC,IAAMygB,EAClBvzB,EAAK6S,OAAOiM,IAAMwU,GAGtBE,sBAAuB,WACnB,IAAIxzB,EAAOC,KACPuD,KASJ,OAPIxD,EAAK6S,OAAOigB,OACZtvB,EAAmB,YAAMjD,MAAOP,EAAK6S,OAAOigB,OAE5C9yB,EAAK6S,OAAOkJ,KACZvY,EAAiB,UAAMjD,MAAOP,EAAK6S,OAAOkJ,KAGvCvY,GAQX2hB,iBAAkB,SAAUhkB,GACxB,IACIsyB,EADAzzB,EAAOC,KAIX,GAAID,EAAK6S,OAAOiM,IAAI7X,QAAUjH,EAAKgE,KAAK0X,aAAc,CAElD,IAAI7I,EAAS7S,EAAK6S,OAAOiM,IAAIrT,MAAM,GAGb,IAAlBoH,EAAO5L,QAA8B,kBAAd4L,EAAO,IAC9BA,EAAO9E,KAAK,yBAEhB0lB,EAAYzzB,EAAKgf,mBAAmB7d,EAAW8E,KAAM4M,GACrD1R,EAAWZ,MAAQP,EAAKgE,KAAK0X,aAAa+X,KAIlDzU,mBAAoB,SAAU/Y,EAAMytB,GAChC,IAAIvnB,KACAyP,EAAqB3b,KAAK+D,KAAK4X,mBAYnC,OAVIA,GACAhc,EAAEqN,KAAKymB,EAAY,SAAUjnB,EAAGgjB,GAC5B7vB,EAAEqN,KAAK2O,EAAmB6T,GAAW3Y,OAAQ,SAAUrK,EAAG8C,GACnC,MAAftJ,EAAKsJ,KACLpD,EAAOoD,GAAStJ,EAAKsJ,QAM9BpD,GAGXkZ,kBAAmB,SAAUD,EAAUuO,GACnC,IACI/Y,EADAyY,EAAUM,EAAYA,EAAY1sB,OAAS,GAU/C,OAPArH,EAAEqN,KAAKhN,KAAK+D,KAAK2X,eAAgB,SAASlP,EAAGgjB,GACzC,GAAIA,EAAUhV,KAAO4Y,EAEjB,OADAzY,EAAc6U,EAAU7U,aACjB,IAIRwK,EAASzX,OAAO,EAAGiN,EAAYC,QAAW,IAAIrT,OAAOoT,EAAYE,OAAS,GAAK,GAAG3I,KAAK,OAKtGvS,EAAEmB,OAAO6P,GApILiC,OAAQ,OAsIZjT,EAAEmB,OAAOoP,EAAY3K,UAAWotB,GAEhCvR,EACKtb,GAAG,aAAc6sB,EAAUC,aAC3B9sB,GAAG,aAAc6sB,EAAUG,kBAC3BhtB,GAAG,gBAAiB6sB,EAAUY,uBAEnCrjB,EAAYyjB,eAAiBhjB,EAE7BT,EAAYgW,QAAU,SAEtBvmB,EAAEuQ,YAAcA,EAGhBvQ,EAAEiP,GAAG1O,YAAc,SAAUJ,EAASgP,GAGlC,OAAyB,IAArBC,UAAU/H,OACHhH,KAAKmN,QAAQnH,KAh8HR,eAm8HThG,KAAKgN,KAAK,WACb,IAAIgC,EAAerP,EAAEK,MACjBiP,EAAWD,EAAahJ,KAr8HhB,eAu8HW,iBAAZlG,EACHmP,GAAyC,mBAAtBA,EAASnP,IAC5BmP,EAASnP,GAASgP,IAIlBG,GAAYA,EAAST,SACrBS,EAAST,UAEbS,EAAW,IAAIiB,EAAYlQ,KAAMF,GACjCkP,EAAahJ,KAj9HL,cAi9HyBiJ;CC/9H3C,SAAUxI,EAAQ3E,EAAUnC,EAAG+U,GAC7B,aA81FA,SAASkf,EAAMltB,GACX,IAAI0c,EAAS1c,EAAEmtB,cACXC,EAAOptB,EAAEV,KAAOU,EAAEV,KAAKlG,WACvBi0B,EAAQD,EAAKE,SAAWr0B,EAAGm0B,EAAKE,UAAettB,EAAEV,KAAOU,EAAEV,KAAK+tB,SAC/DzzB,EAAQX,EAAGyjB,GAASwE,KAAM,kBAAqB,GAC/C9a,EAAQ,EACRmnB,EAAUt0B,EAAEu0B,SAASC,cAEzBztB,EAAE2D,iBAGG4pB,GAAUA,EAAOG,QAAQN,KAAKO,MAAM7iB,GAAI4R,KAKxC9iB,GAEDwM,GADAinB,EAAQA,EAAM/sB,OAAS+sB,EAAM5oB,OAAQ,mBAAqB7K,EAAQ,MAASX,EAAG,mBAAqBW,EAAQ,OAC7FwM,MAAOsW,IAIR,IACTtW,EAAQ,GAIZinB,GAAU3Q,GAGdzjB,EAAEu0B,SAASI,KAAMP,EAAOD,EAAMhnB,IAv3FlC,GAAMnN,EAON,GAAKA,EAAEiP,GAAGslB,SAENv0B,EAAE40B,MAAM,oCAFZ,CAUA,IAAIxzB,GAGAyzB,MAAO,EAGPC,QAAU,GAAI,GAGdC,OAAS,GAGTC,UAAW,EAGXC,QAAS,EAGTC,SAAU,EAGVC,SAAU,EAKVC,SACI,YACA,aACA,SACA,SAIJC,SAAW,EAKXC,SAAW,OAGXC,SAAU,EAGVC,OAAQ,EAERC,OAKIC,QAAU,QAIdrpB,MAGIspB,UAIItvB,MACIkuB,UAAW,KAMvBqB,QAGIC,IAAM,+NAKNH,SAAU,EAIVxvB,OAGA+hB,MACI6N,UAAY,SAYpBC,gBAAkB,OAGlBC,kBAAoB,IAIpBC,YAAc,OAadC,iBAAmB,OAGnBC,mBAAqB,IAGrBC,WAAa,GAGbC,UAAY,GAGZC,QACI,o2BAyBJC,WAAa,uCAGbC,SAAW,oDAEXC,QACIC,UAAa,4GACbC,WAAa,yHACbC,OAAa,4GACbC,MAAa,yGAIbvB,SAAa,wFAIjBwB,SAAW,OAOXC,WAAY,EAGZC,WAAY,EAGZC,WAAY,EAMZN,YACIO,WAAY,GAIhBC,OACIC,UAAW,EACXC,UAAW,GAKfC,KAAO,KAaPC,SAEAb,WACIQ,WAAY,EACZM,MAAY,KAGhBZ,QACIM,WAAc,EACdO,aAAc,GAelBC,OAAe13B,EAAEiD,KAEjB00B,WAAe33B,EAAEiD,KACjB20B,UAAe53B,EAAEiD,KAEjB40B,WAAe73B,EAAEiD,KACjB60B,UAAe93B,EAAEiD,KAEjB80B,YAAe/3B,EAAEiD,KACjB+0B,WAAeh4B,EAAEiD,KAEjBg1B,WAAej4B,EAAEiD,KACjBi1B,aAAel4B,EAAEiD,KAkBjBk1B,aAAe,SAAU1D,EAAS1B,GAC9B,MAAwB,UAAjB0B,EAAQrwB,MAAmB,QAItCg0B,WAAa,QAGbC,aAAe,QAGfC,iBAAkB,EAClBC,eAAkB,EAClBC,iBAAkB,EAMlBvnB,QACIknB,aAAe,SAAU1D,EAAS1B,GAC9B,MAAwB,UAAjB0B,EAAQrwB,MAAmB,kBAEtCg0B,WAAa,SAAU3D,EAAS1B,GAC5B,MAAwB,UAAjB0B,EAAQrwB,KAAmB,iBAAmB,SAEzDk0B,gBAAkB,SAAU7D,EAAS1B,GACjC,MAAwB,UAAjB0B,EAAQrwB,MAAmB,QAEtCm0B,cAAgB,SAAU9D,EAAS1B,GAC/B,MAAwB,UAAjB0B,EAAQrwB,MAAmB,SAQ1Cq0B,KAAO,KACPC,MACIC,IACIC,MAAc,QACdC,KAAc,OACdC,KAAc,WACdC,MAAc,wEACdC,WAAc,kBACdC,UAAc,kBACdC,YAAc,cACdC,OAAc,cAElBC,IACIR,MAAc,aACdC,KAAc,SACdC,KAAc,SACdC,MAAc,qGACdC,WAAc,mBACdC,UAAc,mBACdC,YAAc,WACdC,OAAc,oBAStBE,EAAKr5B,EAAE8G,GACPwyB,EAAKt5B,EAAEmC,GAEPo3B,EAAS,EAMTC,EAAU,SAAWlkB,GACrB,OAAOA,GAAOA,EAAImkB,gBAAkBnkB,aAAetV,GAOnD05B,EACO5yB,EAAO6yB,uBACN7yB,EAAO8yB,6BACP9yB,EAAO+yB,0BACP/yB,EAAOgzB,wBAEP,SAAUpX,GACN,OAAO5b,EAAOS,WAAWmb,EAAU,IAAO,KAQtDqX,EAAgB,WAChB,IAAIC,EAAG95B,EAAKiC,EAASC,cAAc,eAE/B63B,GACAC,WAAoB,gBACpBC,YAAoB,iBACpBC,cAAoB,gBACpBC,iBAAoB,uBAGxB,IAAKL,KAAKC,EACN,QApZX,IAoZe/5B,EAAGoC,MAAM03B,GACT,OAAOC,EAAYD,GAZX,GAsBhBM,EAAc,SAAU9O,GACxB,OAASA,GAAOA,EAAInkB,QAAUmkB,EAAI,GAAG+O,cAOrCC,EAAW,SAAUC,EAAStG,EAAMhnB,GACpC,IAAIwI,EAAOtV,KAEXsV,EAAKwe,KAAQn0B,EAAEmB,QAAQ,GAAQgM,MAAQA,GAAS/L,EAAU+yB,OAGrDA,GAAQn0B,EAAE6H,QAASssB,EAAKiB,WACzBzf,EAAKwe,KAAKiB,QAAUjB,EAAKiB,SAG7Bzf,EAAKkF,GAAQlF,EAAKwe,KAAKtZ,MAAQ0e,EAC/B5jB,EAAK+kB,SAEL/kB,EAAKglB,UAAYjvB,SAAUiK,EAAKwe,KAAKhnB,MAAO,KAAQ,EACpDwI,EAAKilB,UAAY,KAEjBjlB,EAAKklB,QAAU,KACfllB,EAAKmlB,QAAU,EAEfnlB,EAAKolB,SAAW,KAGhBplB,EAAKqlB,YAAaP,GAEZ9kB,EAAK+kB,MAAMrzB,SAKjBsO,EAAKslB,WAAaj7B,EAAEmC,EAAS+mB,eAAegS,OAG5CvlB,EAAKwlB,UAELxlB,EAAKylB,KAAMX,KAIfz6B,EAAEmB,OAAOq5B,EAAS50B,WAKdw1B,KAAO,WACH,IAEIC,EAAW9yB,EAAY+yB,EAFvB3lB,EAAOtV,KAIPk7B,EAAgB5lB,EAAK+kB,MAAO/kB,EAAKglB,WAAYxG,KAEjDxe,EAAKxM,UAAamwB,EAAGnwB,YACrBwM,EAAK0T,WAAaiQ,EAAGjQ,aAMfrpB,EAAEu0B,SAASC,eAAkBx0B,EAAEu0B,SAAS5T,UAA4C,WAAhC3gB,EAAG,QAASkG,IAAI,cACtEm1B,EAAYr7B,EAAG,QAASwD,QAExBxD,EAAG,QAASyN,SAAU,qBAGtB4tB,EAAYr7B,EAAG,QAASwD,QAAU63B,GAGjB,GACbr7B,EAAG,QAAS4N,OAAQ,yHAA2HytB,EAAY,kBASnKC,EAAY,GAEZt7B,EAAEqN,KAAMkuB,EAAcnG,QAAS,SAAUjoB,EAAOxM,GAC5C26B,GAAeC,EAAc9E,OAAQ91B,IAAW,KAKpD4H,EAAavI,EAAG2V,EAAK6lB,UAAW7lB,EAAM4lB,EAAcjF,QAAQv0B,QAAS,cAAmBu5B,KACnF7tB,SAAU,sBACVwa,KAAK,KAAM,sBAAwBtS,EAAKkF,IACxCpN,SAAU8tB,EAAclF,WACxBhwB,KAAM,WAAYsP,GAClB8lB,UAAWF,EAAczE,UAG9BnhB,EAAK+lB,OACD71B,UAAY0C,IAGd,KAAM,QAAS,UAAW,UAAW,QAAS,WAAYozB,QAAQ,SAASrlB,GACzEX,EAAK+lB,MAAOplB,GAAS/N,EAAW8F,KAAM,aAAeiI,OAInDilB,EAActG,QAAUtf,EAAK+kB,MAAMrzB,OAAS,IAC9CkB,EAAW8F,KAAK,wBAAwBW,SAGtCusB,EAAcrG,SAChBvf,EAAK+lB,MAAMxG,QAAQlmB,SAGjBusB,EAAcpG,SAChBxf,EAAK+lB,MAAMvG,QAAQnmB,SAGvB2G,EAAKwN,QAAS,UAGdxN,EAAKvP,WAGLuP,EAAKimB,OAAQjmB,EAAKglB,YAQtBa,UAAY,SAAUlmB,EAAK3B,GACvB,IAAIkoB,EAAMvmB,EAAI6e,KAAKuE,KAAMpjB,EAAI6e,KAAKsE,MAElC,OAAO9kB,EAAI5R,QAAQ,iBAAkB,SAASwqB,EAAOuP,GACjD,IAAIn7B,EAAQk7B,EAAIC,GAEhB,YA5iBf,IA4iBoBn7B,EACM4rB,EAGJ5rB,KAQfq6B,YAAc,SAAWP,GACrB,IAAI9kB,EAAQtV,KACR+zB,EAAQp0B,EAAEwqB,UAAWiQ,GAEzBz6B,EAAEqN,KAAK+mB,EAAO,SAAUvnB,EAAGyJ,GACvB,IAGI0a,EACA5sB,EACA23B,EACAC,EANA1mB,KACA6e,KACA9tB,KASCrG,EAAEmX,cAAeb,IAKlBhB,EAAOgB,EACP6d,EAAO7d,EAAK6d,MAAQ7d,GAEO,WAAnBtW,EAAEoE,KAAMkS,IAAuBtW,EAAGsW,GAAOjP,QAIjD2pB,EAAQhxB,EAAGsW,GACXjQ,EAAQ2qB,EAAM3qB,OAEd8tB,EAAO,YAAa9tB,EAAOA,EAAKlG,WAChCg0B,EAA0B,WAAnBn0B,EAAEoE,KAAM+vB,GAAsBA,KAErC7e,EAAIymB,IAAO,QAAS11B,EAAOA,EAAK01B,IAAQ5H,EAAK4H,KAAO/K,EAAM/I,KAAM,SAE9D,QAAS,SAAU,QAAS,OAAQ,UAAW0T,QAAQ,SAASrlB,GACzDA,KAAQjQ,IACT8tB,EAAM7d,GAASjQ,EAAMiQ,MAIxB,WAAYjQ,IACb8tB,EAAKsB,OAAUwG,OAAS51B,EAAK41B,SAGjC9H,EAAKO,MAAQ1D,EAEP1b,EAAIlR,MAASkR,EAAIymB,MACnBzmB,EAAIlR,KAAO,SACXkR,EAAIymB,IAAOzlB,IAQfhB,GACIlR,KAAO,OACP23B,IAAOzlB,EAAO,IAMtBhB,EAAI6e,KAAOn0B,EAAEmB,QAAQ,KAAUwU,EAAKwe,KAAMA,GAErCn0B,EAAEu0B,SAAS5T,WACZrL,EAAI6e,KAAOn0B,EAAEmB,QAAQ,KAAUmU,EAAI6e,KAAM7e,EAAI6e,KAAKljB,SAOtD7M,EAAOkR,EAAIlR,MAAQkR,EAAI6e,KAAK/vB,KAC5B23B,EAAOzmB,EAAIymB,KAAO,IAEZ33B,GAAQ23B,IACLA,EAAIxP,MAAM,wFACXnoB,EAAO,QAEC23B,EAAIxP,MAAM,wBAClBnoB,EAAO,MAEmB,MAAlB23B,EAAIG,OAAO,KACnB93B,EAAO,WAIfkR,EAAIlR,KAAOA,EAMXkR,EAAInI,MAAQwI,EAAK+kB,MAAMrzB,OAGlBiO,EAAI6e,KAAKO,QAAUpf,EAAI6e,KAAKO,MAAMrtB,eAC5BiO,EAAI6e,KAAKO,OAGdpf,EAAI6e,KAAKgI,QAAU7mB,EAAI6e,KAAKO,QAC9Bpf,EAAI6e,KAAKgI,OAAS7mB,EAAI6e,KAAKO,MAAMrmB,KAAM,cAGtCiH,EAAI6e,KAAKgI,SAAW7mB,EAAI6e,KAAKgI,OAAO90B,eAC9BiO,EAAI6e,KAAKgI,OAIgB,aAA/Bn8B,EAAEoE,KAAMkR,EAAI6e,KAAKiI,SAClB9mB,EAAI6e,KAAKiI,QAAU9mB,EAAI6e,KAAKiI,QAAQ/Y,MAAO/M,GAAQX,EAAML,IAEjD,YAAajP,IACrBiP,EAAI6e,KAAKiI,QAAU/1B,EAAK+1B,SAI5B9mB,EAAI6e,KAAKiI,aAjrBxB,IAirBkC9mB,EAAI6e,KAAKiI,QAAwB,GAAK9mB,EAAI6e,KAAKiI,QAAU,GAI9D,SAATh4B,IACD43B,EAAWD,EAAI1wB,MAAM,MAAO,IAEdhE,OAAS,IACnBiO,EAAIymB,IAAMC,EAASxkB,QAEnBlC,EAAI6e,KAAK3oB,OAASwwB,EAASxkB,SAIT,QAArBlC,EAAI6e,KAAKmB,WAELt1B,EAAEkO,QAAS9J,GAAO,OAAQ,SAAU,UAAa,GAClDkR,EAAI6e,KAAKgB,SAAW,EACpB7f,EAAI6e,KAAKmB,UAAW,GAGpBhgB,EAAI6e,KAAKmB,UAAW,GAMd,QAATlxB,IACDkR,EAAIlR,KAAO,SAEXkR,EAAI6e,KAAKyB,OAAOF,SAAU,GAIzBpgB,EAAI6e,KAAKqB,QAEVlgB,EAAI6e,KAAOn0B,EAAEmB,QAAO,EAAMmU,EAAI6e,MAE1Be,QAAU,EACVC,QAAU,EAEVG,SAAW,EAGXN,SAAW,EAGX0B,UAAa,EACbC,WAAa,EACbC,OAAa,EACbO,MAAa,EAGbgB,cAAkB,EAClBC,YAAkB,EAClBC,cAAkB,EAClBC,iBAAkB,EAClBC,eAAkB,EAClBC,iBAAkB,KAQ1B7iB,EAAK+kB,MAAMvsB,KAAMmH,MAezB+mB,UAAY,WACR,IAAI1mB,EAAOtV,KAEXsV,EAAK2mB,eAGL3mB,EAAK+lB,MAAM71B,UAAUM,GAAG,iBAAkB,wBAAyB,SAASY,GACxEA,EAAEw1B,kBACFx1B,EAAE2D,iBAEFiL,EAAKkhB,MAAO9vB,KAEbZ,GAAI,iCAAkC,uBAAwB,SAASY,GACtEA,EAAEw1B,kBACFx1B,EAAE2D,iBAEFiL,EAAK6mB,aAENr2B,GAAI,iCAAkC,uBAAwB,SAASY,GACtEA,EAAEw1B,kBACFx1B,EAAE2D,iBAEFiL,EAAK8mB,SAMTpD,EAAGlzB,GAAG,iCAAkC,SAASY,GAExCA,GAAKA,EAAE21B,eAA0C,WAAzB31B,EAAE21B,cAAct4B,KAEzCs1B,EAAc,WACV/jB,EAAKyP,YAKTzP,EAAK+lB,MAAMiB,MAAMn1B,OAEjBD,WAAW,WACPoO,EAAK+lB,MAAMiB,MAAMjzB,OAEjBiM,EAAKyP,UACN,QAQXkU,EAAGnzB,GAAG,aAAc,SAASY,GACzB,IAAIuI,EAAWtP,EAAEu0B,SAAWv0B,EAAEu0B,SAASC,cAAgB,KAElDllB,EAASstB,YAActtB,EAASmlB,UAAYnlB,EAASmlB,QAAQN,KAAK8C,WAAaj3B,EAAG+G,EAAE0c,QAASoZ,SAAU,uBAA0B78B,EAAG+G,EAAE0c,QAAS5R,GAAI1P,IAInJmN,GAAgD,UAApCtP,EAAG+G,EAAE0c,QAASvd,IAAK,cAA6BoJ,EAASosB,MAAM71B,UAAUi3B,IAAK/1B,EAAE0c,QAASpc,SACtGN,EAAEw1B,kBAEFjtB,EAASoc,QAGT2N,EAAGlwB,UAAWwM,EAAKxM,WAAYkgB,WAAY1T,EAAK0T,eAMxDiQ,EAAGnzB,GAAG,aAAc,SAAUY,GAC1B,IAAI0tB,EAAU9e,EAAK8e,QACfsI,EAAUh2B,EAAEi2B,SAAWj2B,EAAEqD,MAE7B,GAAMqqB,GAAYA,EAAQN,KAAKa,WAI1Bh1B,EAAE+G,EAAE0c,QAAQ5R,GAAG,WAAY7R,EAAE+G,EAAE0c,QAAQ5R,GAAG,YAK/C,OAAiB,IAAZkrB,GAA6B,KAAZA,GAClBh2B,EAAE2D,sBAEFiL,EAAKkhB,MAAO9vB,IAMC,KAAZg2B,GAA8B,KAAZA,GACnBh2B,EAAE2D,sBAEFiL,EAAK6mB,YAMQ,KAAZO,GAA8B,KAAZA,GACnBh2B,EAAE2D,sBAEFiL,EAAK8mB,aAKT9mB,EAAKwN,QAAQ,eAAgBpc,EAAGg2B,KAK/BpnB,EAAK+kB,MAAO/kB,EAAKglB,WAAYxG,KAAKkB,WACnC1f,EAAKsnB,mBAAqB,EAE1B3D,EAAGnzB,GAAG,gJAAiJ,WACnJwP,EAAKsnB,mBAAqB,EAErBtnB,EAAKunB,QACNvnB,EAAKwnB,eAGTxnB,EAAKunB,QAAS,IAGlBvnB,EAAKynB,aAAet2B,EAAO+b,YAAY,WAEnClN,EAAKsnB,qBAEAtnB,EAAKsnB,oBAAsBtnB,EAAK+kB,MAAO/kB,EAAKglB,WAAYxG,KAAKkB,WAC9D1f,EAAKunB,QAAS,EACdvnB,EAAKsnB,mBAAqB,EAE1BtnB,EAAK0nB,iBAGV,OASXf,aAAe,WACX,IAAI3mB,EAAOtV,KAEXg5B,EAAGvqB,IAAK,kCACRwqB,EAAGxqB,IAAK,kCAERzO,KAAKq7B,MAAM71B,UAAUiJ,IAAK,+BAErB6G,EAAKynB,eACNt2B,EAAO8b,cAAejN,EAAKynB,cAE3BznB,EAAKynB,aAAe,OAQ5BZ,SAAW,SAAU5N,GACjB,OAAOvuB,KAAKu7B,OAAQv7B,KAAKy6B,QAAU,EAAGlM,IAO1C6N,KAAO,SAAU7N,GACb,OAAOvuB,KAAKu7B,OAAQv7B,KAAKy6B,QAAU,EAAGlM,IAO1CgN,OAAS,SAAW0B,EAAK1O,EAAU2O,GAC/B,IACIxC,EACAlG,EACAJ,EACA+H,EACAgB,EACAC,EACAC,EAPA/nB,EAAOtV,KASPs9B,EAAWhoB,EAAK+kB,MAAMrzB,OAE1B,KAAKsO,EAAKioB,WAAajoB,EAAKinB,WAAejnB,EAAKkoB,aAAeloB,EAAKolB,UAApE,CAOA,GAHAuC,EAAO5xB,SAAU4xB,EAAK,MACtBzI,EAAOlf,EAAK8e,QAAU9e,EAAK8e,QAAQN,KAAKU,KAAOlf,EAAKwe,KAAKU,QAEzCyI,EAAM,GAAKA,GAAOK,GAC9B,OAAO,EAKX,GAFA5C,EAAWplB,EAAKolB,SAA+B,OAAlBplB,EAAKolB,WAE7B4C,EAAW,IAAM5C,GAAcplB,EAAKioB,WAAzC,CA4CA,GAxCApB,EAAW7mB,EAAK8e,QAEhB9e,EAAKilB,UAAYjlB,EAAKglB,UACtBhlB,EAAKklB,QAAYllB,EAAKmlB,QAGtBrG,EAAU9e,EAAKmoB,YAAaR,GAEvBK,EAAW,KACP9I,GAAQJ,EAAQtnB,MAAQ,IACzBwI,EAAKmoB,YAAaR,EAAM,IAGvBzI,GAAQJ,EAAQtnB,MAAQwwB,EAAW,IACpChoB,EAAKmoB,YAAaR,EAAM,IAIhC3nB,EAAK8e,QAAYA,EACjB9e,EAAKglB,UAAYlG,EAAQtnB,MACzBwI,EAAKmlB,QAAYrG,EAAQ6I,IAEzB3nB,EAAKwN,QAAS,aAAc4X,GAE5BplB,EAAKooB,iBAELN,EAAaz9B,EAAEu0B,SAASyJ,aAAcvJ,EAAQwJ,QAE9CxJ,EAAQyJ,SAAuC,IAApBT,EAAWx0B,MAAiC,IAAnBw0B,EAAWz0B,OAAgByrB,EAAQwJ,OAAOpB,SAAU,qBACxGpI,EAAQ0J,oBAn/BnB,EAq/BgBn+B,EAAE6mB,UAAW+H,GACd6F,EAAQ0J,eAAiBvP,EAEzBA,EAAW6F,EAAQN,KAAM4G,EAAW,oBAAsB,sBAG9DnM,EAAWljB,SAAUkjB,EAAU,IAG1BmM,EAmBD,OAjBKtG,EAAQN,KAAK4B,iBAAmBnH,GACjCjZ,EAAK+lB,MAAM71B,UAAUK,IAAK,sBAAuB0oB,EAAW,MAGhEjZ,EAAK+lB,MAAM71B,UAAUU,YAAa,sBAElC+zB,EAAa3kB,EAAK+lB,MAAM71B,WAExB8P,EAAK+lB,MAAM71B,UAAU4H,SAAU,oBAG/BgnB,EAAQwJ,OAAOxwB,SAAU,2BAEzBkI,EAAKyoB,UAAW3J,QAEhB9e,EAAK+f,UAMT11B,EAAEqN,KAAKsI,EAAKwlB,OAAQ,SAAUhuB,EAAOowB,GACjCv9B,EAAEu0B,SAAS9F,KAAM8O,EAAMU,UAI3BxJ,EAAQwJ,OAAO13B,YAAa,iDAAkDkH,SAAU,2BAGnFgnB,EAAQyJ,SACTV,EAAcl0B,KAAKynB,MAAO0D,EAAQwJ,OAAOz6B,SAEzCxD,EAAEqN,KAAKsI,EAAKwlB,OAAQ,SAAUhuB,EAAOowB,GACjC,IAAID,EAAMC,EAAMD,IAAM7I,EAAQ6I,IAE9Bt9B,EAAEu0B,SAASrQ,QAASqZ,EAAMU,QACtBj1B,IAAO,EACPC,KAASq0B,EAAME,EAAkBF,EAAMC,EAAMpJ,KAAKY,QACnDnG,EAAU,WAET2O,EAAMU,OAAOI,WAAW,SAAS93B,YAAa,iDAEzCg3B,EAAMD,MAAQ3nB,EAAKmlB,UACpBrG,EAAQyJ,SAAU,EAElBvoB,EAAKkZ,iBAMjBlZ,EAAK+lB,MAAMiB,MAAMr2B,WAAW+3B,WAAY,SAMvC5J,EAAQ6J,SACT3oB,EAAK4oB,cAAe9J,GAGpB9e,EAAKyoB,UAAW3J,GAGpB9e,EAAK+f,UAEA8G,EAASc,MAAQ7I,EAAQ6I,MAO9BI,EAAkB,oBAAuBlB,EAASc,IAAM7I,EAAQ6I,IAAM,OAAS,YAE/Ed,EAASyB,OAAO13B,YAAa,kGAE7Bi2B,EAASgC,YAAa,EAEhB5P,IAAe6F,EAAQyJ,SAAYzJ,EAAQN,KAAK+B,oBAIjDzB,EAAQyJ,QACT1B,EAASyB,OAAOxwB,SAAUiwB,IAI1BA,EAAkB,qBAAuBA,EAAkB,gBAAkBjJ,EAAQN,KAAK+B,iBAE1Fl2B,EAAEu0B,SAASrQ,QAASsY,EAASyB,OAAQP,EAAiB9O,EAAU,WAC5D4N,EAASyB,OAAO13B,YAAam3B,GAAkBW,WAAY,iBAYvEP,YAAc,SAAUR,GAEpB,IACIW,EACA9wB,EAFAwI,EAAOtV,KAmBX,OAfA8M,EAAQmwB,EAAM3nB,EAAK+kB,MAAMrzB,OACzB8F,EAAQA,EAAQ,EAAIwI,EAAK+kB,MAAMrzB,OAAS8F,EAAQA,GAE1CwI,EAAKwlB,OAAQmC,IAAS3nB,EAAK+kB,MAAOvtB,KACpC8wB,EAASj+B,EAAE,sCAAsCoD,SAAUuS,EAAK+lB,MAAMiB,OAEtEhnB,EAAKwlB,OAAQmC,GAAQt9B,EAAEmB,QAAQ,KAAUwU,EAAK+kB,MAAOvtB,IACjDmwB,IAAWA,EACXW,OAAWA,EACXK,UAAW,IAGf3oB,EAAK8oB,YAAa9oB,EAAKwlB,OAAQmC,KAG5B3nB,EAAKwlB,OAAQmC,IAOxBoB,cAAgB,SAAUC,EAAGC,EAAGhQ,GAE5B,IAKIiQ,EAAQC,EAAMC,EAAMC,EAAQC,EAL5BtpB,EAAOtV,KAEPo0B,EAAU9e,EAAK8e,QACfyK,EAAUzK,EAAQ0K,SAIlB3B,EAAe9xB,SAAU+oB,EAAQwJ,OAAOz6B,QAAS,IACjD47B,EAAe1zB,SAAU+oB,EAAQwJ,OAAOp1B,SAAU,IAElDw2B,EAAe5K,EAAQjxB,MACvB87B,EAAe7K,EAAQ5rB,OAEH,SAAhB4rB,EAAQrwB,MAAoBqwB,EAAQ8K,WAAcL,GAASvpB,EAAKkoB,cAIxE79B,EAAEu0B,SAAS9F,KAAMyQ,GAEjBvpB,EAAKkoB,aAAc,EAEnBc,OA1pCX,IA0pCeA,EAAiC,GAAfnB,EAAsBmB,EAC5CC,OA3pCX,IA2pCeA,EAAiC,GAAfQ,EAAsBR,EAI5CI,EAAUK,GAFVR,EAAS7+B,EAAEu0B,SAASyJ,aAAckB,IAEF17B,MAChCy7B,EAAUK,EAAeT,EAAOh2B,OAGhCi2B,EAAuB,GAAdtB,EAAmC,GAAd6B,EAC9BN,EAAwB,GAAfK,EAAoC,GAAfE,EAGzBD,EAAc7B,KACfsB,EAAOD,EAAO51B,KAAO+1B,GAAaL,EAAIK,EAAWL,IAErC,IACRG,EAAO,GAGNA,EAAQtB,EAAc6B,IACvBP,EAAOtB,EAAc6B,IAIxBC,EAAeF,KAChBL,EAAOF,EAAO71B,IAAOi2B,GAAaL,EAAIK,EAAWL,IAErC,IACRG,EAAO,GAGNA,EAAQK,EAAeE,IACxBP,EAAOK,EAAeE,IAI9B3pB,EAAK6pB,aAAcH,EAAaC,GAEhCt/B,EAAEu0B,SAASrQ,QAASgb,GAChBl2B,IAAS+1B,EACT91B,KAAS61B,EACTE,OAASA,EACTC,OAASA,GACVrQ,GAAY,IAAK,WAChBjZ,EAAKkoB,aAAc,IAIlBloB,EAAK8pB,WAAa9pB,EAAK8pB,UAAUC,UAClC/pB,EAAK8pB,UAAUhR,SAQvBkR,WAAa,SAAU/Q,GAEnB,IAIIgR,EAJAjqB,EAAOtV,KAEPo0B,EAAU9e,EAAK8e,QACfyK,EAAUzK,EAAQ0K,SAGE,SAAhB1K,EAAQrwB,MAAoBqwB,EAAQ8K,WAAcL,GAASvpB,EAAKkoB,cAIxE79B,EAAEu0B,SAAS9F,KAAMyQ,GAEjBvpB,EAAKkoB,aAAc,EAEnB+B,EAAMjqB,EAAKkqB,UAAWpL,GAEtB9e,EAAK6pB,aAAcI,EAAIp8B,MAAOo8B,EAAI/2B,QAElC7I,EAAEu0B,SAASrQ,QAASgb,GAChBl2B,IAAS42B,EAAI52B,IACbC,KAAS22B,EAAI32B,KACb+1B,OAASY,EAAIp8B,MAAS07B,EAAM17B,QAC5By7B,OAASW,EAAI/2B,OAASq2B,EAAMr2B,UAC7B+lB,GAAY,IAAK,WAChBjZ,EAAKkoB,aAAc,MAQ3BgC,UAAY,SAAUtC,GAClB,IAQIC,EAAa4B,EAAcU,EAAUt8B,EAAOqF,EAR5C8M,EAAQtV,KACR6+B,EAAQ3B,EAAM4B,SAEdY,EAAYxC,EAAM/5B,MAClBw8B,EAAYzC,EAAM10B,OAElBisB,EAASyI,EAAMpJ,KAAKW,OAIxB,SAAMoK,IAAUA,EAAM73B,SAAa04B,IAAaC,KAKtB,WAArBhgC,EAAEoE,KAAM0wB,KACTA,GAAWA,EAAQA,IAGD,GAAjBA,EAAOztB,SACRytB,GAAWA,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAAIA,EAAO,KAGlDuE,EAAG71B,QAAU,MACdsxB,GAAW,EAAG,EAAG,EAAG,IAIxB0I,EAAe9xB,SAAUiK,EAAK+lB,MAAMiB,MAAMn5B,QAAS,KAAUsxB,EAAQ,GAAMA,EAAQ,IACnFsK,EAAe1zB,SAAUiK,EAAK+lB,MAAMiB,MAAM9zB,SAAU,KAASisB,EAAQ,GAAMA,EAAQ,IAEnFgL,EAAWx2B,KAAK22B,IAAI,EAAGzC,EAAcuC,EAAUX,EAAeY,GAE9Dx8B,EAAS8F,KAAK42B,MAAOJ,EAAWC,GAChCl3B,EAASS,KAAK42B,MAAOJ,EAAWE,IAI5Bh3B,IAASM,KAAK42B,MAAmC,IAA1Bd,EAAev2B,IAAmBisB,EAAQ,GACjE7rB,KAASK,KAAK42B,MAAmC,IAA1B1C,EAAeh6B,IAAmBsxB,EAAQ,GACjEtxB,MAASA,EACTqF,OAASA,KASjBuc,OAAS,WAEL,IAAIzP,EAAOtV,KAEXL,EAAEqN,KAAMsI,EAAKwlB,OAAQ,SAAUrmB,EAAKyoB,GAChC5nB,EAAK8oB,YAAalB,MAS1BkB,YAAc,SAAUlB,GAEpB,IAAI5nB,EAAQtV,KACR6+B,EAAQ3B,EAAM4B,SAEbD,IAAW3B,EAAM/5B,OAAS+5B,EAAM10B,UACjC7I,EAAEu0B,SAAS9F,KAAMyQ,GAEjBl/B,EAAEu0B,SAAS4L,aAAcjB,EAAOvpB,EAAKkqB,UAAWtC,IAE3CA,EAAMD,MAAQ3nB,EAAKmlB,SACpBnlB,EAAK6pB,gBAIbjC,EAAMU,OAAO9a,QAAS,WAEtBxN,EAAKwN,QAAS,WAAYoa,IAO9BiC,aAAe,SAAUY,EAAWC,GAEhC,IAAI1qB,EAAOtV,KAGPkI,EAAaoN,EAAK+lB,MAAM71B,UAAUU,YAAY,mFAE5CoP,EAAK8e,UAAW9e,EAAKinB,YAItBjnB,EAAK2qB,cAEN/3B,EAAWkF,SAAU,8BA51CpC,IA81CoB2yB,QA91CpB,IA81C+CC,EACbD,EAAYzqB,EAAK8e,QAAQjxB,OAAS68B,EAAa1qB,EAAK8e,QAAQ5rB,OAG5D8M,EAAK4qB,gBAMpBh4B,EAAWkF,SAAS,uBAIfkI,EAAK8e,QAAQN,KAAKgD,MAInB5uB,EAAWkF,SAAS,qBAGpBlF,EAAWkF,SAAS,yBAKpBkI,EAAK8e,QAAQN,KAAKgD,OAC1B5uB,EAAWkF,SAAS,uBAS5B6yB,WAAa,WAET,IAGIE,EAHA7qB,EAAOtV,KAEPo0B,EAAU9e,EAAK8e,QAGnB,GAAMA,IAAW9e,EAAKinB,UAQtB,SAAsB,UAAjBnI,EAAQrwB,MAAoBqwB,EAAQ6J,WAAa7J,EAAQ8K,WAC1B,SAA9B9K,EAAQN,KAAKgE,cAA6Bn4B,EAAEiM,WAAYwoB,EAAQN,KAAKgE,eAA4D,SAA1C1D,EAAQN,KAAKgE,aAAc1D,MAGpH+L,EAAS7qB,EAAKkqB,UAAWpL,GAEpBA,EAAQjxB,MAAQg9B,EAAOh9B,OAASixB,EAAQ5rB,OAAS23B,EAAO33B,UAcrE03B,aAAe,WAEX,IAEI9L,EAFOp0B,KAEQo0B,QACfyK,EAAUzK,EAAQ0K,SAElBsB,GAAM,EAOV,OALKvB,IAEDuB,GADAA,EAAMzgC,EAAEu0B,SAASyJ,aAAckB,IACrB17B,MAAQixB,EAAQjxB,OAASi9B,EAAI53B,OAAS4rB,EAAQ5rB,QAGrD43B,GAQXC,OAAS,WAEL,IAAI/qB,EAAOtV,KAEPo0B,EAAU9e,EAAK8e,QACfyK,EAAUzK,EAAQ0K,SAElBsB,GAAM,EAQV,OANKvB,IACDuB,EAAM9qB,EAAKkqB,UAAWpL,GACtBgM,EAAMn3B,KAAKq3B,IAAKzB,EAAM17B,QAAUi9B,EAAIj9B,OAAU,GAAM8F,KAAKq3B,IAAKzB,EAAMr2B,SAAW43B,EAAI53B,QAAW,GAI3F43B,GAQXrC,UAAY,SAAUb,GAElB,IAAiBn5B,EAAM65B,EACnB2C,EADAjrB,EAAOtV,KAGX,IAAKk9B,EAAMsD,YAINtD,EAAMe,SAAX,CAmBA,OAfAf,EAAMsD,WAAY,EAElBlrB,EAAKwN,QAAS,aAAcoa,GAE5Bn5B,EAASm5B,EAAMn5B,MACf65B,EAASV,EAAMU,QAGVnvB,IAAK,WACLqU,QAAS,WACT1V,SAAU,oBAAuBrJ,GAAQ,YACzCqJ,SAAU8vB,EAAMpJ,KAAKiC,YAIjBhyB,GAEL,IAAK,QAEDuR,EAAKmrB,SAAUvD,GAEnB,MAEA,IAAK,SAED5nB,EAAKorB,UAAWxD,GAEpB,MAEA,IAAK,OAED5nB,EAAKqrB,WAAYzD,EAAOA,EAAMxB,KAAOwB,EAAM9C,SAE/C,MAEA,IAAK,SAEIz6B,EAAGu9B,EAAMxB,KAAM10B,OAChBsO,EAAKqrB,WAAYzD,EAAOv9B,EAAGu9B,EAAMxB,MAGjCpmB,EAAKsrB,SAAU1D,GAGvB,MAEA,IAAK,OAED5nB,EAAKurB,YAAa3D,GAElBqD,EAAW5gC,EAAEqM,KAAMrM,EAAEmB,UAAYo8B,EAAMpJ,KAAK9nB,KAAKspB,UAC7CvpB,IAAMmxB,EAAMxB,IACZoF,QAAU,SAAW96B,EAAMsG,GAEH,YAAfA,GACDgJ,EAAKqrB,WAAYzD,EAAOl3B,IAIhCuuB,MAAQ,SAAWloB,EAAOC,GAEjBD,GAAwB,UAAfC,GACVgJ,EAAKsrB,SAAU1D,OAM3BU,EAAOta,IAAK,UAAW,WACnBid,EAASl5B,UAGjB,MAEA,QAEIiO,EAAKsrB,SAAU1D,GAMvB,OAAO,IAQXuD,SAAW,SAAUvD,GAEjB,IAGI6D,EAAOC,EAAMC,EAASC,EAHtB5rB,EAAStV,KACT47B,EAASsB,EAAMpJ,KAAKsB,MAAMwG,OAO9B,GAAKA,EAAS,CACVqF,EAAcx6B,EAAO06B,kBAAoB,EACzCD,EAAcz6B,EAAOge,WAAcwc,GAEnCD,EAAOpF,EAAO5wB,MAAM,KAAK2C,IAAI,SAAW9N,GAC1C,IAAIuhC,KAgBJ,OAdAvhC,EAAGoL,OAAOD,MAAM,OAAOswB,QAAQ,SAAWz7B,EAAI2M,GACpC,IAAIlM,EAAQ+K,SAAUxL,EAAGwhC,UAAU,EAAGxhC,EAAGmH,OAAS,GAAI,IAE/D,GAAW,IAANwF,EACJ,OAAS40B,EAAIr1B,IAAMlM,EAGNS,IACD8gC,EAAI9gC,MAAUA,EACd8gC,EAAIE,QAAUzhC,EAAIA,EAAGmH,OAAS,MAKrCo6B,KAIAG,KAAK,SAAUhsB,EAAGC,GACrB,OAAOD,EAAEjV,MAAQkV,EAAElV,QAIrB,IAAM,IAAIksB,EAAI,EAAGA,EAAIwU,EAAKh6B,OAAQwlB,IAAM,CACpC,IAAI3sB,EAAKmhC,EAAMxU,GAEf,GAAsB,MAAf3sB,EAAGyhC,SAAmBzhC,EAAGS,OAAS4gC,GAAkC,MAAfrhC,EAAGyhC,SAAmBzhC,EAAGS,OAAS2gC,EAAY,CACtGF,EAAQlhC,EACR,QAKFkhC,GAASC,EAAKh6B,SAChB+5B,EAAQC,EAAMA,EAAKh6B,OAAS,IAG3B+5B,IACD7D,EAAMxB,IAAMqF,EAAMh1B,IAGbmxB,EAAM/5B,OAAS+5B,EAAM10B,QAA2B,KAAjBu4B,EAAMO,UACtCpE,EAAM10B,OAAW00B,EAAM/5B,MAAQ+5B,EAAM10B,OAAWu4B,EAAMzgC,MACtD48B,EAAM/5B,MAAS49B,EAAMzgC,QAMjC48B,EAAM4B,SAAWn/B,EAAE,2CACdyN,SAAU,sBACVrK,SAAUm6B,EAAMU,SAKO,IAAvBV,EAAMpJ,KAAKuB,SAAqB6H,EAAMpJ,KAAK3wB,OAAS+5B,EAAMpJ,KAAKtrB,SAAY00B,EAAMpJ,KAAK0N,OAAStE,EAAMpJ,KAAKgI,SAE3GoB,EAAM/5B,MAAS+5B,EAAMpJ,KAAK3wB,MAC1B+5B,EAAM10B,OAAS00B,EAAMpJ,KAAKtrB,OAE1B00B,EAAMuE,OAAS9hC,EAAE,WACZ2jB,IAAI,QAAS,WAEV3jB,EAAEK,MAAM2O,SAERuuB,EAAMuE,OAAS,KAEfnsB,EAAKosB,YAAaxE,KAGrB5Z,IAAI,OAAQ,WAEThO,EAAKiiB,UAAW2F,GAEhB5nB,EAAKosB,YAAaxE,KAGrB9vB,SAAU,kBACVrK,SAAUm6B,EAAM4B,UAChBlX,KAAM,MAAOsV,EAAMpJ,KAAK0N,OAAStE,EAAMpJ,KAAKgI,OAAOlU,KAAM,SAI9DtS,EAAKosB,YAAaxE,IAU1BwE,YAAc,SAAWxE,GACrB,IAAI5nB,EAAOtV,KACP2hC,EAAOhiC,EAAE,WAEbu9B,EAAM0E,OAASD,EACVre,IAAI,QAAS,WAEVhO,EAAKsrB,SAAU1D,KAGlB5Z,IAAI,OAAQ,WAGTld,aAAc82B,EAAM2E,SAEpB3E,EAAM2E,QAAU,KAEXvsB,EAAKinB,YAIVW,EAAM/5B,MAASnD,KAAK8hC,aACpB5E,EAAM10B,OAASxI,KAAK+hC,cAEf7E,EAAMpJ,KAAKsB,MAAMwG,QAClB+F,EAAK/Z,KAAM,QAAS,SAAUA,KAAM,SAAUsV,EAAMpJ,KAAKsB,MAAMwG,QAGnEtmB,EAAK0sB,YAAa9E,GAEbA,EAAMuE,OAEPvE,EAAM2E,QAAU36B,WAAW,WACvBg2B,EAAM2E,QAAU,KAEhB3E,EAAMuE,OAAOt6B,QAEd8B,KAAK22B,IAAK,IAAK32B,KAAKC,IAAK,IAAMg0B,EAAM10B,OAAS,QAGjD8M,EAAKiiB,UAAW2F,MAIvB9vB,SAAU,kBACVwa,KAAK,MAAOsV,EAAMxB,KAClB34B,SAAUm6B,EAAM4B,WAEd6C,EAAK,GAAGnT,UAAkC,YAAtBmT,EAAK,GAAGM,aAA8BN,EAAK,GAAGG,cAAgBH,EAAK,GAAGI,cAC3FJ,EAAK7e,QAAS,QAET6e,EAAK,GAAGpN,MACdoN,EAAK7e,QAAS,SAIfoa,EAAM2E,QAAU36B,WAAW,WACjBy6B,EAAK,GAAGnT,UAAa0O,EAAMgC,UAC7B5pB,EAAKurB,YAAa3D,IAGvB,MAUXwD,UAAY,SAAUxD,GAClB,IAGIgF,EAHA5sB,EAAOtV,KACP8zB,EAAUoJ,EAAMpJ,KAAKyB,OACrBqI,EAASV,EAAMU,OAGnBV,EAAM4B,SAAWn/B,EAAE,gCAAmCm0B,EAAKuB,QAAU,sBAAwB,IAAO,YAC/FxvB,IAAKiuB,EAAKjuB,KACV9C,SAAU66B,GAEfsE,EAAUviC,EAAGm0B,EAAK0B,IAAI9zB,QAAQ,YAAY,IAAIygC,MAAOC,YAChDxa,KAAMkM,EAAKlM,MACX7kB,SAAUm6B,EAAM4B,UAEhBhL,EAAKuB,SAEN/f,EAAKurB,YAAa3D,GAKlBgF,EAAQp8B,GAAG,mBAAoB,SAASY,GACpC1G,KAAKqiC,QAAU,EAEfnF,EAAMU,OAAO9a,QAAS,WAEtBxN,EAAKiiB,UAAW2F,KAMpBU,EAAO93B,GAAG,aAAc,WACpB,IAGImjB,EAEA7X,EALAkxB,EAAQpF,EAAM4B,SACdyD,EAAczO,EAAKjuB,IAAI1C,MACvBq/B,EAAc1O,EAAKjuB,IAAI2C,OAK3B,GAA4B,IAAvB05B,EAAQ,GAAGG,QAAhB,CAOA,IAEIjxB,EADY8wB,EAAQO,WACEz0B,KAAK,QAE7B,MAAO00B,IAGJtxB,GAASA,EAAMpK,cAryDvC,IAuyD4Bu7B,IACDtZ,EAAciZ,EAAQ,GAAGS,cAAc7gC,SAAS8gC,gBAAgB3Z,YAEhEsZ,EAAat5B,KAAK45B,KAAMzxB,EAAM7H,YAAW,IAAU+4B,EAAMn/B,QAAU8lB,IACnEsZ,GAAcD,EAAM/4B,aAAe+4B,EAAM7d,mBA3yDpE,IA8yD4B+d,IACDA,EAAcv5B,KAAK45B,KAAMzxB,EAAM7I,aAAY,IAC3Ci6B,GAAeF,EAAM/5B,cAAgB+5B,EAAM9d,eAI1C+d,GACDD,EAAMn/B,MAAOo/B,GAGZC,GACDF,EAAM95B,OAAQg6B,IAItBF,EAAMp8B,YAAa,0BAMvBlG,KAAKu3B,UAAW2F,GAIpBgF,EAAQta,KAAM,MAAOsV,EAAMxB,MAEE,IAAxBwB,EAAMpJ,KAAKmB,UACZiI,EAAM4B,SAASgE,QAASxtB,EAAK6lB,UAAW+B,EAAOA,EAAMpJ,KAAKsC,OAAOnB,WAIrE2I,EAAOta,IAAK,UAAW,WAGnB,IAEI3jB,EAAGK,MAAOgO,KAAM,UAAW7G,OAAOygB,KAAM,MAAO,iBAEjD,MAAQ8a,IAEV/iC,EAAGK,MAAOsN,QAEV4vB,EAAMe,UAAW,KAUzB0C,WAAa,SAAWzD,EAAO9C,GAE3B,IAAI9kB,EAAOtV,KAENsV,EAAKinB,YAIVjnB,EAAK0sB,YAAa9E,GAElBA,EAAMU,OAAOtwB,QAER6rB,EAASiB,IAAaA,EAAQhyB,SAASpB,QAQxCozB,EAAQhyB,OAAQ,2BAA4B0a,QAAS,WAGrDoa,EAAM6F,aAAepjC,EAAG,eAAgBwH,OAAO67B,YAAa5I,GAG5DA,EAAQv0B,IAAI,UAAW,iBAEdq3B,EAAMgC,WAGY,WAAtBv/B,EAAEoE,KAAMq2B,IAIoB,KAH7BA,EAAUz6B,EAAE,SAAS4N,OAAQ5N,EAAEsL,KAAMmvB,IAAYqI,YAGpC,GAAG1R,WACZqJ,EAAUz6B,EAAE,SAASgG,KAAMy0B,IAK9B8C,EAAMpJ,KAAK3oB,SACZivB,EAAUz6B,EAAE,SAASgG,KAAMy0B,GAAUpsB,KAAMkvB,EAAMpJ,KAAK3oB,UAK9D+xB,EAAMU,OAAOta,IAAI,UAAW,WAGnB4Z,EAAM6F,eACP7F,EAAM6F,aAAa9f,MAAOmX,EAAQjzB,QAASwH,SAE3CuuB,EAAM6F,aAAe,MAIpB7F,EAAM+F,YACP/F,EAAM+F,UAAUt0B,SAEhBuuB,EAAM+F,UAAY,MAIhB/F,EAAMgC,WACRv/B,EAAEK,MAAMsN,QAER4vB,EAAMe,UAAW,KAKzBf,EAAM4B,SAAWn/B,EAAGy6B,GAAUr3B,SAAUm6B,EAAMU,QAEzCV,EAAMpJ,KAAKmB,WAAaiI,EAAM+F,YAC/B/F,EAAM+F,UAAYtjC,EAAG2V,EAAK6lB,UAAW+B,EAAOA,EAAMpJ,KAAKsC,OAAOnB,WAAalyB,SAAUm6B,EAAM4B,SAAS3zB,OAAO,OAAOgC,UAGtHnN,KAAKu3B,UAAW2F,KAMpB0D,SAAW,SAAW1D,GAElBA,EAAMgC,UAAW,EAEjBhC,EAAMU,OAAO13B,YAAa,mBAAqBg3B,EAAMn5B,MAErD/D,KAAK2gC,WAAYzD,EAAOl9B,KAAKm7B,UAAW+B,EAAOA,EAAMpJ,KAAKqC,YAQ9D0K,YAAc,SAAU3D,GAEpB,IAAI5nB,EAAOtV,MAEXk9B,EAAQA,GAAS5nB,EAAK8e,WAEP8I,EAAMgG,WACjBhG,EAAMgG,SAAWvjC,EAAG2V,EAAKwe,KAAKoC,YAAanzB,SAAUm6B,EAAMU,UAQnEoE,YAAc,SAAU9E,IAIpBA,EAAQA,GAFGl9B,KAEWo0B,UAER8I,EAAMgG,WAChBhG,EAAMgG,SAASv0B,gBAERuuB,EAAMgG,WASrB3L,UAAY,SAAU2F,GAElB,IAAI5nB,EAAOtV,KAENsV,EAAKinB,YAIVW,EAAMsD,WAAY,EAClBtD,EAAMe,UAAY,EAElB3oB,EAAKwN,QAAS,YAAaoa,GAE3B5nB,EAAK0sB,YAAa9E,GAEbA,EAAMpJ,KAAKoB,SAAWgI,EAAM4B,WAAa5B,EAAMgC,WAGhDhC,EAAM4B,SAASh5B,GAAI,iBAAkB,SAAUY,GAK3C,OAJkB,GAAZA,EAAEy8B,QACHz8B,EAAE2D,kBAGA,IAKS,UAAf6yB,EAAMn5B,MACPpE,EAAG,0CAA2CoD,SAAUm6B,EAAM4B,WAKtExpB,EAAK4oB,cAAehB,KAUxBgB,cAAgB,SAAUhB,GAEtB,IAGIkG,EAAQC,EAAiB9U,EAAUnlB,EAASm2B,EAH5CjqB,EAAStV,KACT49B,EAASV,EAAMU,OAEkC1oB,GAAQ,EAmB7D,OAjBAkuB,EAAWlG,EAAMpJ,KAAMxe,EAAKolB,SAAW,kBAAsB,oBAC7DnM,EAAW2O,EAAMpJ,KAAMxe,EAAKolB,SAAW,oBAAsB,sBAE7DnM,EAAWljB,cA5hEtB,IA4hEgC6xB,EAAMY,eAA+BvP,EAAW2O,EAAMY,eAAgB,KAEtFZ,EAAMW,SAAWX,EAAMD,MAAQ3nB,EAAKmlB,SAAYlM,IACjD6U,GAAS,GAIG,SAAXA,GAAwBlG,EAAMD,MAAQ3nB,EAAKmlB,SAAWlM,GAA2B,UAAf2O,EAAMn5B,OAAqBm5B,EAAMgC,WAAchqB,EAAQI,EAAKguB,YAAapG,MAC5IkG,EAAS,QAMG,SAAXA,GACD7D,EAAMjqB,EAAKkqB,UAAWtC,GAEtBqC,EAAIZ,OAASY,EAAIp8B,MAAS+R,EAAM/R,MAChCo8B,EAAIX,OAASW,EAAI/2B,OAAS0M,EAAM1M,cAEzB+2B,EAAIp8B,aACJo8B,EAAI/2B,OAKK,SAFhBY,EAAU8zB,EAAMpJ,KAAK8B,eAGjBxsB,EAAUH,KAAKq3B,IAAKpD,EAAM/5B,MAAQ+5B,EAAM10B,OAAS0M,EAAM/R,MAAQ+R,EAAM1M,QAAW,IAG/EY,IACD8L,EAAM9L,QAAU,GAChBm2B,EAAIn2B,QAAY,GAIpBzJ,EAAEu0B,SAAS4L,aAAc5C,EAAM4B,SAAS54B,YAAa,sBAAwBgP,GAE7E+kB,EAAaiD,EAAM4B,eAGnBn/B,EAAEu0B,SAASrQ,QAASqZ,EAAM4B,SAAUS,EAAKhR,EAAU,WAC/CjZ,EAAKkZ,eAOblZ,EAAK8oB,YAAalB,GAMZkG,GAYNzjC,EAAEu0B,SAAS9F,KAAMwP,GAEjByF,EAAkB,sCAAyCnG,EAAMD,IAAM3nB,EAAKklB,QAAU,OAAS,YAAe,gBAAkB4I,EAEhIxF,EAAOI,WAAY,SAAU93B,YAAa,yEAA0EkH,SAAUi2B,GAE9HnG,EAAM4B,SAAS54B,YAAa,sBAG5B+zB,EAAa2D,QAEbj+B,EAAEu0B,SAASrQ,QAAS+Z,EAAQ,0BAA2BrP,EAAU,SAAS7nB,GACtEk3B,EAAO13B,YAAam9B,GAAkBrF,WAAY,SAE7Cd,EAAMD,MAAQ3nB,EAAKmlB,SACpBnlB,EAAKkZ,aAGV,KA7BCyL,EAAa2D,GAEbV,EAAM4B,SAAS54B,YAAa,2BAEvBg3B,EAAMD,MAAQ3nB,EAAKmlB,SACpBnlB,EAAKkZ,eAgCjB8U,YAAc,SAAUpG,GAEpB,IAkCIqG,EAlCAjuB,EAAOtV,KACPogC,GAAO,EA+BPtE,EAAWoB,EAAMpJ,KAAKgI,OACtB0H,EAAW1H,EAASA,EAAOrzB,SAAW,EAgB1C,OAbK+6B,GAAY1H,EAAO,GAAG2H,gBAAkB3hC,GAhCtB,SAAUqpB,GAQ7B,IAPA,IAAIlrB,EAAUkrB,EAAI,GAEduY,EAAczjC,EAAQ0jC,wBACtBC,KAI8B,OAA1B3jC,EAAQ4jC,eACsC,WAA7ClkC,EAAEM,EAAQ4jC,eAAeh+B,IAAI,aAA0E,SAA7ClG,EAAEM,EAAQ4jC,eAAeh+B,IAAI,aACxF+9B,EAAY91B,KAAK7N,EAAQ4jC,cAAcF,yBAG3C1jC,EAAUA,EAAQ4jC,cAUtB,OAPsBD,EAAYE,MAAM,SAASC,GAC7C,IAAIC,EAAgB/6B,KAAK22B,IAAI8D,EAAYO,MAAOF,EAAWE,OAASh7B,KAAKC,IAAIw6B,EAAY96B,KAAMm7B,EAAWn7B,MACtGs7B,EAAgBj7B,KAAK22B,IAAI8D,EAAYS,OAAQJ,EAAWI,QAAUl7B,KAAKC,IAAIw6B,EAAY/6B,IAAKo7B,EAAWp7B,KAE3G,OAAOq7B,EAAgB,GAAKE,EAAgB,KAI5CR,EAAYS,OAAS,GAAKT,EAAYO,MAAQ,GAC9CP,EAAY96B,KAAOjJ,EAAE8G,GAAQtD,SAAWugC,EAAY/6B,IAAMhJ,EAAE8G,GAAQ+B,SAOnB47B,CAAkBtI,KACvEyH,EAAWjuB,EAAK+lB,MAAMiB,MAAM7zB,SAE5B23B,GACIz3B,IAAS66B,EAAS76B,IAAO46B,EAAS56B,IAAOyb,WAAY0X,EAAOj2B,IAAK,qBAAwB,GACzF+C,KAAS46B,EAAS56B,KAAO26B,EAAS36B,KAAOwb,WAAY0X,EAAOj2B,IAAK,sBAAyB,GAC1F1C,MAAS24B,EAAO34B,QAChBqF,OAASszB,EAAOtzB,SAChBm2B,OAAS,EACTC,OAAS,IAIVwB,GAQX5R,SAAW,WAEP,IAAIlZ,EAAOtV,KAEPo0B,EAAU9e,EAAK8e,QACf0G,KAEC1G,EAAQyJ,UAAYzJ,EAAQ6J,UAAY7J,EAAQ+J,aAIrD/J,EAAQ+J,YAAa,EAErB/J,EAAQwJ,OAAOyG,WAAWvhB,QAAS,WAGnCmX,EAAa7F,EAAQwJ,QAErBxJ,EAAQwJ,OAAOxwB,SAAU,4BAGzBzN,EAAEqN,KAAMsI,EAAKwlB,OAAQ,SAAUrmB,EAAKyoB,GAC3BA,EAAMD,KAAO3nB,EAAKmlB,QAAU,GAAKyC,EAAMD,KAAO3nB,EAAKmlB,QAAU,EAC9DK,EAAQoC,EAAMD,KAAQC,EAEdA,IAERv9B,EAAEu0B,SAAS9F,KAAM8O,EAAMU,QAEvBV,EAAMU,OAAOnvB,MAAME,YAI3B2G,EAAKwlB,OAASA,EAEdxlB,EAAK6pB,eAEL7pB,EAAKwN,QAAS,cAGTnjB,EAAGmC,EAAS+mB,eAAgBrX,GAAI,eAAoB4iB,EAAQN,KAAK4C,WAAgC,SAAhBtC,EAAQrwB,MAAoC,WAAjBqwB,EAAQrwB,OACrHuR,EAAK+V,UASbgK,QAAU,WACN,IACI+G,EAAMkI,EADNhvB,EAAOtV,KAGNsV,EAAK+kB,MAAMrzB,OAAS,IAIzBo1B,EAAQ9mB,EAAKwlB,OAAQxlB,EAAKmlB,QAAU,GACpC6J,EAAQhvB,EAAKwlB,OAAQxlB,EAAKmlB,QAAU,GAE/B2B,GAAsB,UAAdA,EAAKr4B,MACduR,EAAKyoB,UAAW3B,GAGfkI,GAAsB,UAAdA,EAAKvgC,MACduR,EAAKyoB,UAAWuG,KASxBjZ,MAAQ,WACJ,IACIF,EADAiJ,EAAUp0B,KAAKo0B,QAGdp0B,KAAKu8B,YAILnI,GAAWA,EAAQ+J,cAGpBhT,EAAMiJ,EAAQwJ,OAAO5vB,KAAK,2CAEhBhH,SACNmkB,EAAMiJ,EAAQwJ,OAAO5vB,KAAK,8BAA8B7C,OAAO,6BAIvEggB,EAAMA,GAAOA,EAAInkB,OAASmkB,EAAMnrB,KAAKq7B,MAAM71B,WAEvC6lB,UAQRtlB,SAAW,WACP,IAAIuP,EAAOtV,KAGXL,EAAG,uBAAwBqN,KAAK,WAC5B,IAAIiC,EAAWtP,EAAEK,MAAMgG,KAAM,YAGzBiJ,GAAYA,EAASs1B,MAAQjvB,EAAKivB,MAAQt1B,EAASstB,WACnDttB,EAAS6T,QAAS,kBAKrBxN,EAAK8e,UACD9e,EAAK+lB,MAAM71B,UAAUsH,QAAU,GAChCwI,EAAK+lB,MAAM71B,UAAU41B,UAAWt5B,EAASuG,MAG7CiN,EAAKooB,kBAGTpoB,EAAKwN,QAAS,cAEdxN,EAAK0mB,aASTxF,MAAQ,SAAU9vB,EAAG89B,GAEjB,IAGIpB,EAAQ7U,EACRsQ,EAAOz1B,EAAS8L,EAAOqqB,EAJvBjqB,EAAUtV,KACVo0B,EAAU9e,EAAK8e,QAKfnoB,EAAO,WACPqJ,EAAKmvB,QAAS/9B,IAGlB,OAAK4O,EAAKinB,YAIVjnB,EAAKinB,WAAY,GAGyB,IAArCjnB,EAAKwN,QAAS,cAAepc,IAC9B4O,EAAKinB,WAAY,EAEjBlD,EAAc,WACV/jB,EAAKyP,YAGF,IAKXzP,EAAK2mB,eAEA7H,EAAQyN,SACTz7B,aAAcguB,EAAQyN,SAG1BhD,EAAWzK,EAAQ0K,SACnBsE,EAAWhP,EAAQN,KAAK4B,gBACxBnH,EAAW5uB,EAAE6mB,UAAWge,GAAMA,EAAMpB,EAAShP,EAAQN,KAAK6B,kBAAoB,EAG9EvB,EAAQwJ,OAAOnvB,IAAKirB,GAAgBxzB,YAAa,4FAEjDkuB,EAAQwJ,OAAOyG,WAAWvhB,QAAS,WAAYnU,SAG1C4f,GACDjZ,EAAK+lB,MAAM71B,UAAUU,YAAa,oBAAqBkH,SAAU,uBAIrEkI,EAAK0sB,YAAa5N,GAElB9e,EAAK0nB,eAEL1nB,EAAK6pB,eAGW,SAAXiE,IAA8B,IAAN18B,GAAcm4B,GAAStQ,GAA6B,UAAjB6F,EAAQrwB,OAAqBqwB,EAAQ8K,WAAcK,EAAMjqB,EAAKguB,YAAalP,MACvIgP,EAAS,QAGG,SAAXA,GACDzjC,EAAEu0B,SAAS9F,KAAMyQ,GAEjB3pB,EAAQvV,EAAEu0B,SAASyJ,aAAckB,GAEjC3pB,EAAM/R,MAAS+R,EAAM/R,MAAS+R,EAAMypB,OACpCzpB,EAAM1M,OAAS0M,EAAM1M,OAAS0M,EAAM0pB,OAKpB,SAFhBx1B,EAAUgrB,EAAQN,KAAK8B,eAGnBxsB,EAAUH,KAAKq3B,IAAKlM,EAAQjxB,MAAQixB,EAAQ5rB,OAAS+2B,EAAIp8B,MAAQo8B,EAAI/2B,QAAW,IAG/EY,IACDm2B,EAAIn2B,QAAU,GAGlB8L,EAAMypB,OAASzpB,EAAM/R,MAASo8B,EAAIp8B,MAClC+R,EAAM0pB,OAAS1pB,EAAM1M,OAAS+2B,EAAI/2B,OAElC0M,EAAM/R,MAASo8B,EAAIp8B,MACnB+R,EAAM1M,OAAS+2B,EAAI/2B,OAEnB7I,EAAEu0B,SAAS4L,aAAc1L,EAAQ0K,SAAU5pB,GAE3CvV,EAAEu0B,SAASrQ,QAASuQ,EAAQ0K,SAAUS,EAAKhR,EAAUtiB,IAE9C,IAGNm3B,GAAU7U,GAGA,IAAN7nB,EACDQ,WAAY+E,EAAMsiB,GAGlB5uB,EAAEu0B,SAASrQ,QAASuQ,EAAQwJ,OAAO13B,YAAa,2BAA6B,0DAA4Dk9B,EAAQ7U,EAAUtiB,GAI/JA,KAGG,MAOXw4B,QAAU,SAAU/9B,GAChB,IACIuI,EADAqG,EAAOtV,KAGXsV,EAAK8e,QAAQwJ,OAAO9a,QAAS,WAE7BxN,EAAK+lB,MAAM71B,UAAU8H,QAAQqB,SAE7B2G,EAAKwN,QAAS,aAAcpc,GAGvB4O,EAAKslB,YAAgBtlB,EAAK8e,QAAQN,KAAK6C,WACxCrhB,EAAKslB,WAAWvP,QAGpB/V,EAAK8e,QAAU,MAGfnlB,EAAWtP,EAAEu0B,SAASC,eAGlBllB,EAASlJ,YAGTizB,EAAGlwB,UAAWwM,EAAKxM,WAAYkgB,WAAY1T,EAAK0T,YAEhDrpB,EAAG,QAASuG,YAAa,oBAEzBvG,EAAG,4BAA6BgP,WASxCmU,QAAU,SAAU9L,EAAMkmB,GACtB,IAGIkD,EAHAtxB,EAAQvH,MAAMhC,UAAUiG,MAAMZ,KAAKmE,UAAW,GAC9CuG,EAAQtV,KACRiV,EAAQioB,GAASA,EAAMpJ,KAAOoJ,EAAQ5nB,EAAK8e,QAgB/C,GAbKnf,EACDnG,EAAK41B,QAASzvB,GAGdA,EAAMK,EAGVxG,EAAK41B,QAASpvB,GAET3V,EAAEiM,WAAYqJ,EAAI6e,KAAM9c,MACzBopB,EAAMnrB,EAAI6e,KAAM9c,GAAOgM,MAAO/N,EAAKnG,KAG1B,IAARsxB,EACD,OAAOA,EAGG,eAATppB,EACDiiB,EAAGnW,QAAS9L,EAAO,MAAOlI,GAG1BwG,EAAK+lB,MAAM71B,UAAUsd,QAAS9L,EAAO,MAAOlI,IASpD4uB,eAAiB,SAAWiH,GAExB,IAAIrvB,EAAOtV,KAEPo0B,EAAW9e,EAAK8e,QAChBtnB,EAAWsnB,EAAQtnB,MACnBgnB,EAAWM,EAAQN,KACnBiI,EAAWjI,EAAKiI,QAChB6I,EAAWtvB,EAAK+lB,MAAMU,QAG1B3H,EAAQwJ,OAAO9a,QAAS,WAExBxN,EAAKsvB,SAAW7I,GAAWA,EAAQ/0B,OAAS49B,EAASj/B,KAAMo2B,GAAY,KAEjEzmB,EAAKuvB,kBACPvvB,EAAKwnB,eAITn9B,EAAE,yBAAyBgG,KAAM2P,EAAK+kB,MAAMrzB,QAC5CrH,EAAE,yBAAyBgG,KAAMmH,EAAQ,GAEzCnN,EAAE,wBAAwBmlC,KAAK,YAAehR,EAAKU,MAAQ1nB,GAAS,GACpEnN,EAAE,wBAAwBmlC,KAAK,YAAehR,EAAKU,MAAQ1nB,GAASwI,EAAK+kB,MAAMrzB,OAAS,IAO5Fg2B,aAAe,WAEXh9B,KAAK6kC,kBAAmB,EAExB7kC,KAAKq7B,MAAM71B,UAAUU,YAAY,wFAIrC42B,aAAe,WAEX,IAAIxnB,EAAOtV,KACP8zB,EAAOxe,EAAK8e,QAAU9e,EAAK8e,QAAQN,KAAOxe,EAAKwe,KAC/C5rB,EAAaoN,EAAK+lB,MAAM71B,UAE5B8P,EAAKuvB,kBAAqB,EAC1BvvB,EAAKsnB,mBAAqB,EAE1B10B,EACKsjB,YAAY,2BAA6BsI,EAAKgB,UAAWhB,EAAKiB,UAC9DvJ,YAAY,2BAA6BsI,EAAKe,SAAWvf,EAAK+kB,MAAMrzB,OAAS,IAC7EwkB,YAAY,uBAA6BsI,EAAKc,QAAUtf,EAAK+kB,MAAMrzB,OAAS,IAC5EwkB,YAAY,sBAA2BsI,EAAKqB,OAE5C7f,EAAKsvB,SACN18B,EAAWkF,SAAU,0BAGtBlF,EAAWhC,YAAa,0BAShC6+B,eAAiB,WAER/kC,KAAK6kC,iBACN7kC,KAAK88B,eAGL98B,KAAKg9B,kBAShBr9B,EAAEu0B,UAEEhO,QAAW,SACXnlB,SAAWA,EAeXozB,YAAc,SAAW6Q,GACrB,IAAI/1B,EAAWtP,EAAE,yDAAyDqG,KAAM,YAC5E8I,EAAWvH,MAAMhC,UAAUiG,MAAMZ,KAAKmE,UAAW,GAErD,OAAKE,aAAoBkrB,IAEM,WAAtBx6B,EAAEoE,KAAMihC,GACT/1B,EAAU+1B,GAAUhiB,MAAO/T,EAAUH,GAEP,aAAtBnP,EAAEoE,KAAMihC,IAChBA,EAAQhiB,MAAO/T,EAAUH,GAItBG,IAWfqlB,KAAO,SAAWP,EAAOD,EAAMhnB,GAC3B,OAAO,IAAIqtB,EAAUpG,EAAOD,EAAMhnB,IAOtC0pB,MAAQ,SAAW3jB,GACf,IAAI5D,EAAWjP,KAAKm0B,cAEfllB,IACDA,EAASunB,SAII,IAAR3jB,GACD7S,KAAKw2B,UASjByO,QAAU,WAENjlC,KAAKw2B,OAAO,GAEZyC,EAAGxqB,IAAK,mBAQZ6R,cA5pFP,IA4pFkBxe,EAASojC,aAA6B,6CAA6Cz1B,KAAK01B,UAAUC,WAM7GC,MAAS,WACL,IAAIxjC,EAAMC,EAASC,cAAc,OAEjC,OAAO0E,EAAO6+B,kBAAoB7+B,EAAO6+B,iBAAkBzjC,GAAM0jC,iBAAiB,gBAAkBzjC,EAAS0jC,cAAgB1jC,EAAS0jC,aAAe,IAHjJ,GAWR7H,aAAe,SAAUxS,GACrB,IAAIsa,EAEJ,IAAMta,IAAQA,EAAInkB,OACd,OAAO,EAaX,GAVAy+B,EAAUta,EAAIa,GAAI,GAAInmB,IAAI,cAKtB4/B,EAHCA,IAA0C,IAAhCA,EAAO3gC,QAAS,WAE3B2gC,GADAA,EAASA,EAAOz6B,MAAM,KAAK,IACXA,MAAM,KAAK,IACXA,MAAM,SAKdhE,OAURy+B,GANIA,EADCA,EAAOz+B,OAAS,IACNy+B,EAAO,IAAKA,EAAO,IAAKA,EAAO,GAAIA,EAAO,KAG1CA,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAAIA,EAAO,KAGvC93B,IAAIyW,gBAEjB,CACHqhB,GAAW,EAAG,EAAG,EAAG,GAEpB,IACIC,EADa,iCACSrZ,KAAMlB,EAAIa,GAAI,GAAIpE,KAAK,UAE5C8d,IACDD,EAAQ,GAAMrhB,WAAYshB,EAAS,IACnCD,EAAQ,GAAMrhB,WAAYshB,EAAS,KAI3C,OACI/8B,IAAU88B,EAAQ,GAClB78B,KAAU68B,EAAQ,GAClB9G,OAAU8G,EAAQ,GAClB7G,OAAU6G,EAAQ,GAClBr8B,QAAUgb,WAAY+G,EAAItlB,IAAI,YAC9B1C,MAAUgoB,EAAIhoB,QACdqF,OAAU2iB,EAAI3iB,WAUtBs3B,aAAe,SAAU3U,EAAKwa,GAC1B,IAAIryB,EAAO,GACPzN,KAEJ,GAAMslB,GAAQwa,EAmCd,YA9wFX,IA+uFgBA,EAAM/8B,WA/uFtB,IA+uF4C+8B,EAAMh9B,MACnC2K,QAhvFf,IAgvFuBqyB,EAAM/8B,KAAqBuiB,EAAIjpB,WAAW0G,KAAO+8B,EAAM/8B,MAAU,aAhvFxF,IAgvFmG+8B,EAAMh9B,IAAoBwiB,EAAIjpB,WAAWyG,IAAMg9B,EAAMh9B,KAAQ,KAG7I2K,EADCtT,KAAKqlC,MACA,eAAiB/xB,EAAM,SAGvB,aAAeA,EAAM,UAtvF9C,IA0vFgBqyB,EAAMhH,aA1vFtB,IA0vF8CgH,EAAM/G,SACrCtrB,GAAOA,EAAItM,OAASsM,EAAM,IAAM,IAAM,SAAWqyB,EAAMhH,OAAS,KAAOgH,EAAM/G,OAAS,KAGrFtrB,EAAItM,SACLnB,EAAI+/B,UAAYtyB,QA/vF/B,IAkwFgBqyB,EAAMv8B,UACPvD,EAAIuD,QAAUu8B,EAAMv8B,cAnwFnC,IAswFgBu8B,EAAMxiC,QACP0C,EAAI1C,MAAQwiC,EAAMxiC,YAvwFjC,IA0wFgBwiC,EAAMn9B,SACP3C,EAAI2C,OAASm9B,EAAMn9B,QAGhB2iB,EAAItlB,IAAKA,IAOpBge,QAAU,SAAWsH,EAAKrP,EAAIyS,EAAUlM,EAAUwjB,GAC9C,IAAInT,EAAQgH,GAAiB,gBAExB/5B,EAAEiM,WAAY2iB,KACflM,EAAWkM,EACXA,EAAW,MAGT5uB,EAAEmX,cAAegF,IACnBqP,EAAI6S,WAAW,SAGnB7S,EAAIrlB,GAAI4sB,EAAO,SAAShsB,KAGfA,IAAKA,EAAE21B,eAAoBlR,EAAI3Z,GAAI9K,EAAE21B,cAAcjZ,SAA4C,WAAhC1c,EAAE21B,cAAcyJ,gBAIpF3a,EAAI1c,IAAKikB,GAEJ/yB,EAAEmX,cAAegF,QA1yFrC,IA4yFwBA,EAAG6iB,aA5yF3B,IA4yFmD7iB,EAAG8iB,SAC/BzT,EAAItlB,IAAK,sBAAuB,OAEhCiW,EAAG3Y,MAAS8F,KAAKynB,MAAOvF,EAAIhoB,QAAW2Y,EAAG6iB,QAC1C7iB,EAAGtT,OAASS,KAAKynB,MAAOvF,EAAI3iB,SAAWsT,EAAG8iB,QAE1C9iB,EAAG6iB,OAAS,EACZ7iB,EAAG8iB,OAAS,EAEZj/B,EAAEu0B,SAAS4L,aAAc3U,EAAKrP,KAGH,IAAvB+pB,GACR1a,EAAIjlB,YAAa4V,GAGhBnc,EAAEiM,WAAYyW,IACfA,EAAU3b,MAKb/G,EAAE6mB,UAAW+H,IACdpD,EAAItlB,IAAK,sBAAuB0oB,EAAW,MAG1C5uB,EAAEmX,cAAegF,GAClBnc,EAAEu0B,SAAS4L,aAAc3U,EAAKrP,GAG9BqP,EAAI/d,SAAU0O,GAGlBqP,EAAInlB,KAAK,QAASkB,WAAW,WACzBikB,EAAIrI,QAAS,kBACdyL,EAAW,MAIlBH,KAAO,SAAUjD,GACb/kB,aAAc+kB,EAAInlB,KAAK,UAEvBmlB,EAAI1c,IAAKirB,KA8CjB/5B,EAAEiP,GAAGslB,SAAW,SAAUp0B,GACtB,IAAIk0B,EAoBJ,OAlBAl0B,EAAWA,OACXk0B,EAAWl0B,EAAQk0B,WAAY,GAI3Br0B,EAAG,QAAS8O,IAAK,iBAAkBulB,GAAWluB,GAAI,iBAAkBkuB,GAChEl0B,QAAUA,GACX8zB,GAIH5zB,KAAKyO,IAAK,kBAAmB3I,GAAI,kBAC7BiuB,MAAU/zB,KACVF,QAAUA,GACX8zB,GAIA5zB,MAOXi5B,EAAGnzB,GAAI,iBAAkB,kBAAmB8tB,IAh6F/C,CAk6FEntB,OAAQ3E,SAAU2E,OAAO/G,QAAUA,QAQpC,SAAUC,GAEX,aAIA,IAAIomC,EAAS,SAAUh6B,EAAKq0B,EAAK78B,GAChC,GAAMwI,EAkBN,OAdAxI,EAASA,GAAU,GAEK,WAAnB5D,EAAEoE,KAAKR,KACXA,EAAS5D,EAAEkM,MAAMtI,GAAQ,IAG1B5D,EAAEqN,KAAKozB,EAAK,SAAU3rB,EAAKnU,GAC1ByL,EAAMA,EAAIrK,QAAQ,IAAM+S,EAAKnU,GAAS,MAGnCiD,EAAOyD,SACV+E,IAAQA,EAAIjH,QAAQ,KAAO,EAAI,IAAM,KAAOvB,GAGtCwI,GAKJhL,GACHilC,SACCvZ,QAAU,wJACVlpB,QACC0iC,SAAW,EACXC,SAAW,EACXC,GAAM,EACNC,IAAM,EACNC,GAAM,EACNC,MAAQ,cACRC,YAAc,EACdC,MAAQ,GAETC,WAAa,EACb1iC,KAAQ,SACRgI,IAAQ,6BACRy1B,MAAQ,yCAGTkF,OACCja,QAAU,oCACVlpB,QACC0iC,SAAW,EACXI,GAAK,EACLM,WAAgB,EAChBC,YAAgB,EAChBC,cAAgB,EAChBC,WAAgB,EAChBC,IAAM,GAEPN,WAAa,EACb1iC,KAAO,SACPgI,IAAM,+BAGPi7B,UACCva,QAAU,oCACV1oB,KAAU,SACVgI,IAAU,qCAGXk7B,aACCxa,QAAU,sCACVlpB,QACC2jC,gBAAkB,EAClBrQ,UAAY,GAEb9yB,KAAO,SACPgI,IAAO,wCAGRo7B,MACC1a,QAAU,mCACV1oB,KAAU,SACVgI,IAAU,+BAGXq7B,WACC3a,QAAU,yDACV1oB,KAAU,QACVgI,IAAU,2BAOXs7B,YACC5a,QAAU,4GACV1oB,KAAU,SACVgI,IAAU,SAAUq0B,GACnB,MAAO,iBAAmBA,EAAI,GAAK,SAAYA,EAAI,GAAKA,EAAI,GAAK,MAAQn3B,KAAK42B,MAAQO,EAAI,MAAWA,EAAI,IAAMA,EAAI,IAAI1+B,QAAQ,MAAO,KAAO,IAAQ0+B,EAAI,KAAQ,YAAeA,EAAI,KAAOA,EAAI,IAAIt7B,QAAQ,WAAa,EAAI,UAAY,WAQ1OwiC,aACC7a,QAAU,oEACV1oB,KAAU,SACVgI,IAAU,SAAUq0B,GACnB,MAAO,iBAAmBA,EAAI,GAAK,WAAaA,EAAI,GAAG1+B,QAAQ,SAAU,MAAMA,QAAQ,QAAS,IAAM,mBAKzG/B,EAAEmC,UAAUgE,GAAG,YAAa,SAAUY,EAAGuI,GAExCtP,EAAEqN,KAAKiC,EAASorB,MAAO,SAAU7tB,EAAGyJ,GAEnC,IAECihB,EACAsK,EACApB,EACA78B,EACAgkC,EACAC,EACAC,EARG17B,EAAOkK,EAAKylB,KAAO,GACtB33B,GAAO,EAUHkS,EAAKlS,OAIVmzB,EAAQv3B,EAAEmB,QAAQ,KAAUC,EAAUkV,EAAK6d,KAAKoD,OAGhDv3B,EAAEqN,KAAKkqB,EAAO,SAAWuE,EAAG57B,GAK3B,GAJAugC,EAAMr0B,EAAImgB,MAAMrsB,EAAG4sB,SACnB+a,KACAC,EAAWhM,EAEN2E,EAAL,CAMA,GAFAr8B,EAAOlE,EAAGkE,KAELlE,EAAG4mC,YAAcrG,EAAKvgC,EAAG4mC,YAAe,CAGrB,MAFvBc,EAAYnH,EAAKvgC,EAAG4mC,aAEJ,KACfc,EAAYA,EAAUlG,UAAU,IAGjCkG,EAAYA,EAAUv8B,MAAM,KAE5B,IAAM,IAAI08B,EAAI,EAAGA,EAAIH,EAAUvgC,SAAU0gC,EAAI,CAC5C,IAAIC,EAAIJ,EAAWG,GAAI18B,MAAM,IAAK,GAEjB,GAAZ28B,EAAE3gC,SACNwgC,EAAGG,EAAE,IAAOC,mBAAoBD,EAAE,GAAGjmC,QAAQ,MAAO,QAcvD,OATA6B,EAAS5D,EAAEmB,QAAQ,KAAUjB,EAAG0D,OAAQ0S,EAAK6d,KAAM2H,GAAK+L,GAExDz7B,EAA2B,aAAnBpM,EAAEoE,KAAKlE,EAAGkM,KAAsBlM,EAAGkM,IAAInB,KAAK5K,KAAMogC,EAAK78B,EAAQ0S,GAAQ8vB,EAAOlmC,EAAGkM,IAAKq0B,EAAK78B,GACnGi+B,EAA6B,aAArB7hC,EAAEoE,KAAKlE,EAAG2hC,OAAwB3hC,EAAG2hC,MAAM52B,KAAK5K,KAAMogC,EAAK78B,EAAQ0S,GAAQ8vB,EAAOlmC,EAAG2hC,MAAOpB,GAElF,UAAbqH,IACJ17B,EAAMA,EAAIrK,QAAQ,OAAQ,OAGpB,KAKHqC,GACJkS,EAAKylB,IAAO3vB,EACZkK,EAAKlS,KAAOA,EAENkS,EAAK6d,KAAK0N,OAAYvrB,EAAK6d,KAAKgI,QAAU7lB,EAAK6d,KAAKgI,OAAO90B,SAChEiP,EAAK6d,KAAK0N,MAAQA,GAGL,WAATz9B,IACJpE,EAAEmB,QAAO,EAAMmV,EAAK6d,MACnByB,QACCF,SAAU,EACVzN,MACC6N,UAAY,SAKfxf,EAAK4xB,gBAAkBJ,EAEvBxxB,EAAK6d,KAAKiC,YAAc,qBAAoC,cAAZ0R,GAAwC,eAAZA,EAA4B,MAAQ,WAMjHxxB,EAAKlS,KAAO,aAjNf,CAwNC0C,OAAO/G,QAQP,SAAU+G,EAAQ3E,EAAUnC,GAC7B,aAEA,IAAI05B,EACU5yB,EAAO6yB,uBACN7yB,EAAO8yB,6BACP9yB,EAAO+yB,0BACP/yB,EAAOgzB,wBAEP,SAAUpX,GACN,OAAO5b,EAAOS,WAAWmb,EAAU,IAAO,KAKtDylB,EACOrhC,EAAOshC,sBACNthC,EAAOuhC,4BACPvhC,EAAOwhC,yBACPxhC,EAAOyhC,uBACP,SAAU1tB,GACN/T,EAAOL,aAAaoU,IAKnC2tB,EAAW,SAAUzhC,GACxB,IAAIwF,KAGJxF,GADAA,EAAIA,EAAE21B,eAAiB31B,GAAKD,EAAOC,GAC7B0hC,SAAW1hC,EAAE0hC,QAAQphC,OAASN,EAAE0hC,QAAY1hC,EAAE2hC,gBAAkB3hC,EAAE2hC,eAAerhC,OAASN,EAAE2hC,gBAAmB3hC,GAErH,IAAM,IAAI+N,KAAO/N,EAEXA,EAAG+N,GAAM6zB,MACbp8B,EAAO4B,MAAQwwB,EAAI53B,EAAG+N,GAAM6zB,MAAO/J,EAAI73B,EAAG+N,GAAM8zB,QAErC7hC,EAAG+N,GAAM+zB,SACpBt8B,EAAO4B,MAAQwwB,EAAI53B,EAAG+N,GAAM+zB,QAASjK,EAAI73B,EAAG+N,GAAMg0B,UAIpD,OAAOv8B,GAGJw8B,EAAW,SAAUC,EAAQC,EAAQC,GACxC,OAAMD,GAAWD,EAIH,MAATE,EACGF,EAAOrK,EAAIsK,EAAOtK,EAEL,MAATuK,EACJF,EAAOpK,EAAIqK,EAAOrK,EAGnBt1B,KAAK6/B,KAAM7/B,KAAK8/B,IAAKJ,EAAOrK,EAAIsK,EAAOtK,EAAG,GAAMr1B,KAAK8/B,IAAKJ,EAAOpK,EAAIqK,EAAOrK,EAAG,IAV9E,GAaLyK,EAAc,SAAU7d,GAE3B,GAAKA,EAAI3Z,GAAG,yCAA2C7R,EAAEiM,WAAYuf,EAAIvlB,IAAI,GAAGqjC,UAAa9d,EAAInlB,KAAK,cACrG,OAAO,EAIR,IAAM,IAAIwG,EAAI,EAAG08B,EAAO/d,EAAI,GAAGge,WAAY1N,EAAIyN,EAAKliC,OAAQwF,EAAIivB,EAAGjvB,IACzD,GAAwC,mBAAnC08B,EAAK18B,GAAG48B,SAAS17B,OAAO,EAAG,IAC5B,OAAO,EAIpB,OAAO,GAGL27B,EAAgB,SAAUxpC,GAC7B,IAAIypC,EAAY7iC,EAAO6+B,iBAAkBzlC,GAAK,cAC1C0pC,EAAY9iC,EAAO6+B,iBAAkBzlC,GAAK,cAE1Ck3B,GAA4B,WAAduS,GAAwC,SAAdA,IAAyBzpC,EAAG2pC,aAAe3pC,EAAG4pC,aACtFC,GAA4B,WAAdH,GAAwC,SAAdA,IAAyB1pC,EAAGopB,YAAcppB,EAAG8pC,YAEzF,OAAO5S,GAAY2S,GAGhBE,EAAe,SAAWze,GAG7B,IAFA,IAAIiV,GAAM,IAEK,CAGd,GAFAA,EAAMiJ,EAAele,EAAIvlB,IAAI,IAG5B,MAKD,KAFAulB,EAAMA,EAAI/iB,UAEApB,QAAUmkB,EAAIqR,SAAU,mBAAsBrR,EAAI3Z,GAAI,QAC/D,MAIF,OAAO4uB,GAIJyJ,EAAY,SAAW56B,GAC1B,IAAIqG,EAAOtV,KAEXsV,EAAKrG,SAAWA,EAEhBqG,EAAKw0B,IAAa76B,EAASosB,MAAM0O,GACjCz0B,EAAK00B,OAAa/6B,EAASosB,MAAMiB,MACjChnB,EAAKpN,WAAa+G,EAASosB,MAAM71B,UAEjC8P,EAAK2vB,UAEL3vB,EAAKpN,WAAWpC,GAAI,yCAA0CnG,EAAEgS,MAAM2D,EAAM,kBAG7Eu0B,EAAUtkC,UAAU0/B,QAAU,WAC7BjlC,KAAKkI,WAAWuG,IAAK,cAGtBo7B,EAAUtkC,UAAU0kC,aAAe,SAAUvjC,GAC5C,IAAI4O,EAAOtV,KAEPkqC,EAAWvqC,EAAG+G,EAAE0c,QAChBnU,EAAWqG,EAAKrG,SAChBmlB,EAAWnlB,EAASmlB,QACpB0K,EAAW1K,EAAQ0K,SAEnBqL,EAA4B,cAAVzjC,EAAE3C,KAQxB,GALKomC,GACE70B,EAAKpN,WAAWuG,IAAK,uBAItB2lB,GAAW9e,EAAKrG,SAASuuB,aAAeloB,EAAKrG,SAASstB,UAI3D,OAHA71B,EAAEw1B,uBACFx1B,EAAE2D,iBAME3D,EAAE21B,eAA2C,GAA1B31B,EAAE21B,cAAc8G,SAKlC+G,EAAQljC,QAAUgiC,EAAakB,IAAalB,EAAakB,EAAQ9hC,WAKlE1B,EAAE21B,cAAcmM,QAAU0B,EAAQ,GAAGP,YAAcO,EAAQzhC,SAASG,OAIzE0M,EAAK80B,YAAcjC,EAAUzhC,IAGvB4O,EAAK80B,aAAiB90B,EAAK80B,YAAYpjC,OAAS,GAAKiI,EAASsuB,YAIpEjoB,EAAK40B,QAAWA,EAChB50B,EAAKwpB,SAAWA,EAChBxpB,EAAK+0B,QAAW,EAEhB1qC,EAAEmC,GAAU2M,IAAK,aAEjB9O,EAAEmC,GAAUgE,GAAIqkC,EAAgB,yCAA2C,uCAAyCxqC,EAAEgS,MAAM2D,EAAM,eAClI3V,EAAEmC,GAAUgE,GAAIqkC,EAAgB,qBAAuB,qBAAuBxqC,EAAEgS,MAAM2D,EAAM,iBAErFrG,EAASmlB,QAAQN,KAAKgD,OAAS7nB,EAASoxB,YAAiB6J,EAAQ14B,GAAI8D,EAAK00B,SAAY10B,EAAK00B,OAAOh8B,KAAMk8B,GAAUljC,SAUzHN,EAAEw1B,kBAEMv8B,EAAEu0B,SAAS5T,WAAcspB,EAAct0B,EAAK40B,UAAaN,EAAct0B,EAAK40B,QAAQ9hC,YAC3F1B,EAAE2D,iBAGHiL,EAAK6nB,YAAel0B,KAAKynB,MAAO0D,EAAQwJ,OAAO,GAAG+L,aAClDr0B,EAAKypB,aAAe91B,KAAKynB,MAAO0D,EAAQwJ,OAAO,GAAG6L,cAElDn0B,EAAKg1B,WAAY,IAAInI,MAAOC,UAC5B9sB,EAAKi1B,UAAYj1B,EAAKk1B,UAAYl1B,EAAKozB,SAAW,EAElDpzB,EAAKm1B,WAAY,EACjBn1B,EAAKo1B,WAAY,EACjBp1B,EAAKq1B,WAAY,EAEjBr1B,EAAKs1B,eAAkBt1B,EAAKu1B,gBAAmBliC,IAAK,EAAGC,KAAM,GAC7D0M,EAAKw1B,gBAAkBnrC,EAAEu0B,SAASyJ,aAAcroB,EAAKwpB,UACrDxpB,EAAKy1B,eAAkB,KAEU,IAA5Bz1B,EAAK80B,YAAYpjC,QAAiBsO,EAAKq1B,YAC3Cr1B,EAAK+0B,QAAUp7B,EAASsuB,UAEF,UAAjBnJ,EAAQrwB,OAAsBuR,EAAKw1B,gBAAgB3nC,MAAQmS,EAAK6nB,YAAc,GAAK7nB,EAAKw1B,gBAAgBtiC,OAAS8M,EAAKypB,aAAe,IAEzIp/B,EAAEu0B,SAAS9F,KAAM9Y,EAAKwpB,UAEtBxpB,EAAKwpB,SAASj5B,IAAK,sBAAuB,OAE1CyP,EAAKm1B,WAAY,GAIjBn1B,EAAKo1B,WAAY,EAGlBp1B,EAAKpN,WAAWkF,SAAS,kCAGO,IAA5BkI,EAAK80B,YAAYpjC,QAAiBiI,EAASuuB,aAAgBpJ,EAAQ8K,UAA6B,UAAjB9K,EAAQrwB,OAAsBqwB,EAAQ6J,WAAY7J,EAAQqN,SAC7InsB,EAAKq1B,WAAY,EAEjBr1B,EAAKo1B,WAAY,EACjBp1B,EAAKm1B,WAAY,EAEjB9qC,EAAEu0B,SAAS9F,KAAM9Y,EAAKwpB,UAEtBxpB,EAAKwpB,SAASj5B,IAAK,sBAAuB,OAE1CyP,EAAK01B,kBAA0E,IAAlD11B,EAAK80B,YAAY,GAAG9L,EAAIhpB,EAAK80B,YAAY,GAAG9L,GAAc3+B,EAAE8G,GAAQuiB,aACjG1T,EAAK21B,kBAA0E,IAAlD31B,EAAK80B,YAAY,GAAG7L,EAAIjpB,EAAK80B,YAAY,GAAG7L,GAAc5+B,EAAE8G,GAAQqC,YAEjGwM,EAAK41B,gCAAmC51B,EAAK01B,kBAAoB11B,EAAKw1B,gBAAgBliC,MAAS0M,EAAKw1B,gBAAgB3nC,MACpHmS,EAAK61B,gCAAmC71B,EAAK21B,kBAAoB31B,EAAKw1B,gBAAgBniC,KAAS2M,EAAKw1B,gBAAgBtiC,OAEpH8M,EAAK81B,4BAA8B1C,EAAUpzB,EAAK80B,YAAY,GAAI90B,EAAK80B,YAAY,MA9D9EF,EAAQ14B,GAAG,QACf9K,EAAE2D,oBAkELw/B,EAAUtkC,UAAU8lC,YAAc,SAAU3kC,GAE3C,IAAI4O,EAAOtV,KAIX,GAFAsV,EAAKg2B,UAAYnD,EAAUzhC,GAEtB/G,EAAEu0B,SAAS5T,WAAcspB,EAAct0B,EAAK40B,UAAaN,EAAct0B,EAAK40B,QAAQ9hC,WAKxF,OAJA1B,EAAEw1B,uBAEF5mB,EAAK+0B,QAAS,GAKf,IAAQ/0B,EAAKrG,SAASmlB,QAAQN,KAAKgD,OAASxhB,EAAKrG,SAASoxB,WAAe/qB,EAAKg2B,WAAch2B,EAAKg2B,UAAUtkC,SAI3GsO,EAAKi1B,UAAY7B,EAAUpzB,EAAKg2B,UAAU,GAAIh2B,EAAK80B,YAAY,GAAI,KACnE90B,EAAKk1B,UAAY9B,EAAUpzB,EAAKg2B,UAAU,GAAIh2B,EAAK80B,YAAY,GAAI,KAEnE90B,EAAKozB,SAAWA,EAAUpzB,EAAKg2B,UAAU,GAAIh2B,EAAK80B,YAAY,IAGzD90B,EAAKozB,SAAW,GAAI,CAExB,IAAQpzB,EAAK40B,QAAQ14B,GAAI8D,EAAK00B,UAAY10B,EAAK00B,OAAOh8B,KAAMsH,EAAK40B,SAAUljC,OAC1E,OAGDN,EAAEw1B,kBACFx1B,EAAE2D,iBAEGiL,EAAKo1B,UACTp1B,EAAKi2B,UAEMj2B,EAAKm1B,UAChBn1B,EAAKk2B,QAEMl2B,EAAKq1B,WAChBr1B,EAAKm2B,WAOR5B,EAAUtkC,UAAUgmC,QAAU,WAE7B,IAIIG,EAJAp2B,EAAOtV,KAEP2rC,EAAUr2B,EAAKo1B,UACf9hC,EAAU0M,EAAKs1B,eAAehiC,MAAQ,GAGzB,IAAZ+iC,EAEC1iC,KAAKq3B,IAAKhrB,EAAKozB,UAAa,KAEhCpzB,EAAK+0B,QAAS,EAET/0B,EAAKrG,SAASorB,MAAMrzB,OAAS,GAAKsO,EAAKrG,SAAS6kB,KAAKgD,MAAMC,SAC/DzhB,EAAKo1B,UAAa,IAEPp1B,EAAKrG,SAASsuB,YAAmD,IAAtCjoB,EAAKrG,SAAS6kB,KAAKgD,MAAMC,UAA8D,SAAtCzhB,EAAKrG,SAAS6kB,KAAKgD,MAAMC,UAAuBp3B,EAAG8G,GAAStD,QAAU,IAC7JmS,EAAKo1B,UAAa,KAGlBgB,EAAQziC,KAAKq3B,IAAoD,IAA/Cr3B,KAAK2iC,MAAOt2B,EAAKk1B,UAAWl1B,EAAKi1B,WAAoBthC,KAAK4iC,IAE5Ev2B,EAAKo1B,UAAcgB,EAAQ,IAAMA,EAAQ,IAAQ,IAAM,KAGxDp2B,EAAKrG,SAASsuB,UAAYjoB,EAAKo1B,UAG/Bp1B,EAAK80B,YAAc90B,EAAKg2B,UAExB3rC,EAAEqN,KAAKsI,EAAKrG,SAAS6rB,OAAQ,SAAUhuB,EAAOowB,GAC7Cv9B,EAAEu0B,SAAS9F,KAAM8O,EAAMU,QAEvBV,EAAMU,OAAO/3B,IAAK,sBAAuB,OAEzCq3B,EAAM4O,cAAe,EAEhB5O,EAAMD,MAAQ3nB,EAAKrG,SAASmlB,QAAQ6I,MACxC3nB,EAAKs1B,eAAehiC,KAAOjJ,EAAEu0B,SAASyJ,aAAcT,EAAMU,QAASh1B,QAOhE0M,EAAKrG,SAASmwB,WAAa9pB,EAAKrG,SAASmwB,UAAUC,UACvD/pB,EAAKrG,SAASmwB,UAAUhR,SAMV,KAAXud,IAGCr2B,EAAKi1B,UAAY,IAAOj1B,EAAKrG,SAASorB,MAAMrzB,OAAS,GAAuC,IAAhCsO,EAAKrG,SAASmlB,QAAQtnB,QAAgBwI,EAAKrG,SAASmlB,QAAQN,KAAKU,MACjI5rB,GAAcK,KAAK8/B,IAAKzzB,EAAKi1B,UAAW,IAE7Bj1B,EAAKi1B,UAAY,IAAOj1B,EAAKrG,SAASorB,MAAMrzB,OAAS,GAAOsO,EAAKrG,SAASmlB,QAAQtnB,QAAUwI,EAAKrG,SAASorB,MAAMrzB,OAAS,IAAMsO,EAAKrG,SAASmlB,QAAQN,KAAKU,MACrK5rB,GAAcK,KAAK8/B,KAAMzzB,EAAKi1B,UAAW,IAGzC3hC,GAAc0M,EAAKi1B,WAKrBj1B,EAAKu1B,eACJliC,IAAkB,KAAXgjC,EAAiB,EAAIr2B,EAAKs1B,eAAejiC,IAAM2M,EAAKk1B,UAC3D5hC,KAAOA,GAGH0M,EAAKy2B,YACTjE,EAAcxyB,EAAKy2B,WAEnBz2B,EAAKy2B,UAAY,MAGlBz2B,EAAKy2B,UAAY1S,EAAc,WAEzB/jB,EAAKu1B,gBACTlrC,EAAEqN,KAAKsI,EAAKrG,SAAS6rB,OAAQ,SAAUhuB,EAAOowB,GAC7C,IAAID,EAAMC,EAAMD,IAAM3nB,EAAKrG,SAASwrB,QAEpC96B,EAAEu0B,SAAS4L,aAAc5C,EAAMU,QAC9Bj1B,IAAO2M,EAAKu1B,cAAcliC,IAC1BC,KAAO0M,EAAKu1B,cAAcjiC,KAASq0B,EAAM3nB,EAAK6nB,YAAkBF,EAAMC,EAAMpJ,KAAKY,WAInFpf,EAAKpN,WAAWkF,SAAU,4BAS9By8B,EAAUtkC,UAAUimC,MAAQ,WAE3B,IAEIQ,EAAYC,EAAYC,EAFxB52B,EAAOtV,KAIXsV,EAAK+0B,QAAS,EAGb2B,EADI12B,EAAKw1B,gBAAgB3nC,MAAQmS,EAAK6nB,YACzB7nB,EAAKw1B,gBAAgBliC,KAAO0M,EAAKi1B,UAGjCj1B,EAAKw1B,gBAAgBliC,KAGnCqjC,EAAa32B,EAAKw1B,gBAAgBniC,IAAM2M,EAAKk1B,WAE7C0B,EAAS52B,EAAK62B,cAAeH,EAAYC,EAAY32B,EAAKw1B,gBAAgB3nC,MAAOmS,EAAKw1B,gBAAgBtiC,SAE/Fm2B,OAASrpB,EAAKw1B,gBAAgBnM,OACrCuN,EAAOtN,OAAStpB,EAAKw1B,gBAAgBlM,OAErCtpB,EAAKy1B,eAAiBmB,EAEjB52B,EAAKy2B,YACTjE,EAAcxyB,EAAKy2B,WAEnBz2B,EAAKy2B,UAAY,MAGlBz2B,EAAKy2B,UAAY1S,EAAc,WAC9B15B,EAAEu0B,SAAS4L,aAAcxqB,EAAKwpB,SAAUxpB,EAAKy1B,mBAK/ClB,EAAUtkC,UAAU4mC,cAAgB,SAAUH,EAAYC,EAAYG,EAAUC,GAE/E,IAEIC,EAAeC,EAAeC,EAAeC,EAF7Cn3B,EAAOtV,KAIPm9B,EAAe7nB,EAAK6nB,YACpB4B,EAAezpB,EAAKypB,aAEpB2N,EAAiBp3B,EAAKw1B,gBAAgBliC,KACtC+jC,EAAiBr3B,EAAKw1B,gBAAgBniC,IAEtC4hC,EAAYj1B,EAAKi1B,UACjBC,EAAYl1B,EAAKk1B,UAsCrB,OAlCA8B,EAAgBrjC,KAAKC,IAAI,EAAkB,GAAfi0B,EAAiC,GAAZiP,GACjDG,EAAgBtjC,KAAKC,IAAI,EAAkB,GAAf61B,EAAiC,GAAZsN,GAEjDG,EAAgBvjC,KAAK22B,IAAKzC,EAAeiP,EAA0B,GAAfjP,EAAiC,GAAZiP,GACzEK,EAAgBxjC,KAAK22B,IAAKb,EAAesN,EAA0B,GAAftN,EAAiC,GAAZsN,GAEpED,EAAWjP,IAGVoN,EAAY,GAAKyB,EAAaM,IAClCN,EAAaM,EAAgB,EAAIrjC,KAAK8/B,KAAMuD,EAAgBI,EAAiBnC,EAAW,KAAS,GAI7FA,EAAa,GAAKyB,EAAaQ,IACnCR,EAAaQ,EAAgB,EAAIvjC,KAAK8/B,IAAKyD,EAAgBE,EAAiBnC,EAAW,KAAS,IAK7F8B,EAAYtN,IAGXyL,EAAY,GAAKyB,EAAaM,IAClCN,EAAaM,EAAgB,EAAItjC,KAAK8/B,KAAKwD,EAAgBI,EAAiBnC,EAAW,KAAS,GAI5FA,EAAY,GAAKyB,EAAaQ,IAClCR,EAAaQ,EAAgB,EAAIxjC,KAAK8/B,IAAM0D,EAAgBE,EAAiBnC,EAAW,KAAS,KAMlG7hC,IAAOsjC,EACPrjC,KAAOojC,IAMTnC,EAAUtkC,UAAUqnC,cAAgB,SAAUZ,EAAYC,EAAYG,EAAUC,GAE/E,IAAI/2B,EAAOtV,KAEPm9B,EAAe7nB,EAAK6nB,YACpB4B,EAAezpB,EAAKypB,aAwBxB,OApBCiN,EAFII,EAAWjP,GACf6O,EAAaA,EAAa,EAAI,EAAIA,GACR7O,EAAciP,EAAWjP,EAAciP,EAAWJ,EAK/D/iC,KAAKC,IAAK,EAAGi0B,EAAc,EAAIiP,EAAW,GAMvDH,EAFII,EAAYtN,GAChBkN,EAAaA,EAAa,EAAI,EAAIA,GACRlN,EAAesN,EAAYtN,EAAesN,EAAYJ,EAKnEhjC,KAAKC,IAAK,EAAG61B,EAAe,EAAIsN,EAAY,IAKzD1jC,IAAOsjC,EACPrjC,KAAOojC,IAKTnC,EAAUtkC,UAAUkmC,OAAS,WAE5B,IAAIn2B,EAAOtV,KAIP6sC,EAAgBv3B,EAAKw1B,gBAAgB3nC,MACrC2pC,EAAgBx3B,EAAKw1B,gBAAgBtiC,OAErCkkC,EAAiBp3B,EAAKw1B,gBAAgBliC,KACtC+jC,EAAiBr3B,EAAKw1B,gBAAgBniC,IAItCokC,EAF4BrE,EAAUpzB,EAAKg2B,UAAU,GAAIh2B,EAAKg2B,UAAU,IAE/Bh2B,EAAK81B,4BAE9CgB,EAAYnjC,KAAK42B,MAAOgN,EAAgBE,GACxCV,EAAYpjC,KAAK42B,MAAOiN,EAAgBC,GAGxCC,GAAyBH,EAAgBT,GAAa92B,EAAK41B,+BAC3D+B,GAAyBH,EAAgBT,GAAa/2B,EAAK61B,+BAI3D+B,GAAoB53B,EAAKg2B,UAAU,GAAGhN,EAAIhpB,EAAKg2B,UAAU,GAAGhN,GAAK,EAAK3+B,EAAE8G,GAAQuiB,aAChFmkB,GAAoB73B,EAAKg2B,UAAU,GAAG/M,EAAIjpB,EAAKg2B,UAAU,GAAG/M,GAAK,EAAK5+B,EAAE8G,GAAQqC,YAKhFskC,EAA4BF,EAAkB53B,EAAK01B,kBAQnDkB,GACHvjC,IAHgBgkC,GAAmBM,GALJE,EAAkB73B,EAAK21B,oBAStDriC,KALgB8jC,GAAmBM,EAAwBI,GAM3DzO,OAASrpB,EAAKw1B,gBAAgBnM,OAASoO,EACvCnO,OAAStpB,EAAKw1B,gBAAgBlM,OAASmO,GAGxCz3B,EAAK+0B,QAAS,EAEd/0B,EAAK82B,SAAYA,EACjB92B,EAAK+2B,UAAYA,EAEjB/2B,EAAKy1B,eAAiBmB,EAEjB52B,EAAKy2B,YACTjE,EAAcxyB,EAAKy2B,WAEnBz2B,EAAKy2B,UAAY,MAGlBz2B,EAAKy2B,UAAY1S,EAAc,WAC9B15B,EAAEu0B,SAAS4L,aAAcxqB,EAAKwpB,SAAUxpB,EAAKy1B,mBAK/ClB,EAAUtkC,UAAU8nC,WAAa,SAAU3mC,GAE1C,IAAI4O,EAAOtV,KACPstC,EAAOrkC,KAAKC,KAAM,IAAIi5B,MAAOC,UAAc9sB,EAAKg1B,UAAW,GAE3DqB,EAAUr2B,EAAKo1B,UACf6C,EAAUj4B,EAAKm1B,UACf+C,EAAUl4B,EAAKq1B,UAkBnB,GAhBAr1B,EAAKm4B,UAAYtF,EAAUzhC,GAE3B4O,EAAKpN,WAAWhC,YAAa,iCAE7BvG,EAAEmC,GAAU2M,IAAK,aAEZ6G,EAAKy2B,YACTjE,EAAcxyB,EAAKy2B,WAEnBz2B,EAAKy2B,UAAY,MAGlBz2B,EAAKo1B,WAAY,EACjBp1B,EAAKm1B,WAAY,EACjBn1B,EAAKq1B,WAAY,EAEZr1B,EAAK+0B,OACT,OAAO/0B,EAAKo4B,MAAOhnC,GAGpB4O,EAAK6hB,MAAQ,IAGb7hB,EAAKq4B,UAAYr4B,EAAKi1B,UAAY+C,EAAM,GACxCh4B,EAAKs4B,UAAYt4B,EAAKk1B,UAAY8C,EAAM,GAExCh4B,EAAKu4B,OAAS5kC,KAAKC,IAAkB,GAAboM,EAAK6hB,MAAaluB,KAAK22B,IAAkB,IAAbtqB,EAAK6hB,MAAe,EAAIluB,KAAKq3B,IAAKhrB,EAAKq4B,WAAgBr4B,EAAK6hB,QAE3GoW,EACJj4B,EAAKw4B,aAEMN,EACXl4B,EAAKy4B,aAGLz4B,EAAK04B,WAAYrC,IAMnB9B,EAAUtkC,UAAUyoC,WAAa,SAAUrC,GAE1C,IAAIr2B,EAAOtV,KACPohC,GAAM,EAEV9rB,EAAKrG,SAASsuB,WAAY,EAC1BjoB,EAAKu1B,cAAqB,KAGV,KAAXc,GAAkB1iC,KAAKq3B,IAAKhrB,EAAKk1B,WAAc,IAGnD7qC,EAAEu0B,SAASrQ,QAASvO,EAAKrG,SAASmlB,QAAQwJ,QACzCj1B,IAAU2M,EAAKs1B,eAAejiC,IAAM2M,EAAKk1B,UAA+B,IAAjBl1B,EAAKs4B,UAC5DxkC,QAAU,GACR,KAEHg4B,EAAM9rB,EAAKrG,SAASunB,OAAO,EAAM,MAEX,KAAXmV,GAAkBr2B,EAAKi1B,UAAY,IAAMj1B,EAAKrG,SAASorB,MAAMrzB,OAAS,EACjFo6B,EAAM9rB,EAAKrG,SAASktB,SAAU7mB,EAAKu4B,QAEb,KAAXlC,GAAkBr2B,EAAKi1B,WAAa,IAAOj1B,EAAKrG,SAASorB,MAAMrzB,OAAS,IACnFo6B,EAAM9rB,EAAKrG,SAASmtB,KAAM9mB,EAAKu4B,UAGnB,IAARzM,GAA8B,KAAXuK,GAA6B,KAAXA,GACzCr2B,EAAKrG,SAASssB,OAAQjmB,EAAKrG,SAASmlB,QAAQtnB,MAAO,KAGpDwI,EAAKpN,WAAWhC,YAAa,wBAO9B2jC,EAAUtkC,UAAUuoC,WAAa,WAEhC,IACI9B,EAAYC,EAAYC,EADxB52B,EAAOtV,KAGLsV,EAAKy1B,kBAIwC,IAA9Cz1B,EAAKrG,SAASmlB,QAAQN,KAAKgD,MAAME,UACrCgV,EAAa12B,EAAKy1B,eAAeniC,KACjCqjC,EAAa32B,EAAKy1B,eAAepiC,MAKjCqjC,EAAa12B,EAAKy1B,eAAeniC,KAAS0M,EAAKq4B,UAAYr4B,EAAK6hB,MAChE8U,EAAa32B,EAAKy1B,eAAepiC,IAAS2M,EAAKs4B,UAAYt4B,EAAK6hB,QAGjE+U,EAAS52B,EAAKs3B,cAAeZ,EAAYC,EAAY32B,EAAKw1B,gBAAgB3nC,MAAOmS,EAAKw1B,gBAAgBtiC,SAE9FrF,MAASmS,EAAKw1B,gBAAgB3nC,MACrC+oC,EAAO1jC,OAAS8M,EAAKw1B,gBAAgBtiC,OAEtC7I,EAAEu0B,SAASrQ,QAASvO,EAAKwpB,SAAUoN,EAAQ,OAI5CrC,EAAUtkC,UAAUwoC,WAAa,WAEhC,IAII/B,EAAYC,EAAYC,EAAQ+B,EAJhC34B,EAAOtV,KAEPo0B,EAAU9e,EAAKrG,SAASmlB,QAIxBgY,EAAY92B,EAAK82B,SACjBC,EAAY/2B,EAAK+2B,UAEf/2B,EAAKy1B,iBAIXiB,EAAa12B,EAAKy1B,eAAeniC,KAGjCqlC,GACItlC,IAHJsjC,EAAa32B,EAAKy1B,eAAepiC,IAI7BC,KAASojC,EACT7oC,MAASipC,EACT5jC,OAAS6jC,EACZ1N,OAAS,EACTC,OAAS,GAIRj/B,EAAEu0B,SAAS4L,aAAcxqB,EAAKwpB,SAAUmP,GAErC7B,EAAW92B,EAAK6nB,aAAekP,EAAY/2B,EAAKypB,aACpDzpB,EAAKrG,SAASqwB,WAAY,KAEf8M,EAAWhY,EAAQjxB,OAASkpC,EAAYjY,EAAQ5rB,OAC3D8M,EAAKrG,SAASovB,cAAe/oB,EAAK01B,kBAAmB11B,EAAK21B,kBAAmB,MAI7EiB,EAAS52B,EAAKs3B,cAAeZ,EAAYC,EAAYG,EAAUC,GAG/D1sC,EAAEu0B,SAAS4L,aAAcxqB,EAAK8kB,QAASz6B,EAAEu0B,SAASyJ,aAAcroB,EAAKwpB,WAErEn/B,EAAEu0B,SAASrQ,QAASvO,EAAKwpB,SAAUoN,EAAQ,QAK7CrC,EAAUtkC,UAAUmoC,MAAQ,SAAShnC,GACpC,IAWIwnC,EAXA54B,EAAUtV,KACVkqC,EAAUvqC,EAAG+G,EAAE0c,QAEfnU,EAAWqG,EAAKrG,SAChBmlB,EAAWnlB,EAASmlB,QAEpBqZ,EAAc/mC,GAAKyhC,EAAUzhC,IAAS4O,EAAK80B,YAE3C+D,EAAOV,EAAU,GAAKA,EAAU,GAAGnP,EAAIhpB,EAAK00B,OAAOvhC,SAASG,KAAO,EACnEwlC,EAAOX,EAAU,GAAKA,EAAU,GAAGlP,EAAIjpB,EAAK00B,OAAOvhC,SAASE,IAAO,EAInE0lC,EAAU,SAAWr5B,GAExB,IAAIs5B,EAASla,EAAQN,KAAM9e,GAM3B,GAJKrV,EAAEiM,WAAY0iC,KAClBA,EAASA,EAAOtrB,MAAO/T,GAAYmlB,EAAS1tB,KAGvC4nC,EAIN,OAASA,GAER,IAAK,QAEJr/B,EAASunB,MAAOlhB,EAAKi5B,YAEtB,MAEA,IAAK,iBAEJt/B,EAAS81B,gBAAgB,GAE1B,MAEA,IAAK,OAEJ91B,EAASmtB,OAEV,MAEA,IAAK,cAECntB,EAASorB,MAAMrzB,OAAS,EAC5BiI,EAASmtB,OAGTntB,EAASunB,MAAOlhB,EAAKi5B,YAGvB,MAEA,IAAK,OAEiB,SAAhBna,EAAQrwB,OAAqBqwB,EAAQ6J,UAAY7J,EAAQqN,UAExDxyB,EAASoxB,SACbpxB,EAASqwB,aAEErwB,EAASixB,eACpBjxB,EAASovB,cAAe8P,EAAMC,GAEnBn/B,EAASorB,MAAMrzB,OAAS,GACnCiI,EAASunB,MAAOlhB,EAAKi5B,eAU1B,KAAK7nC,EAAE21B,eAA2C,GAA1B31B,EAAE21B,cAAc8G,QAKnCl0B,EAASsuB,WAKT4Q,EAAOjE,EAAQ,GAAGP,YAAcO,EAAQzhC,SAASG,MAAtD,CAKA,GAAKshC,EAAQ14B,GAAI,oEAChB08B,EAAQ,eAEF,GAAKhE,EAAQ14B,GAAI,mBACvB08B,EAAQ,YAEF,CAAA,IAAMj/B,EAASmlB,QAAQ0K,WAAY7vB,EAASmlB,QAAQ0K,SAASrC,IAAK/1B,EAAE0c,QAASpc,OAInF,OAHCknC,EAAQ,UAOV,GAAK54B,EAAKk5B,OAAS,CAOlB,GAJApoC,aAAckP,EAAKk5B,QACnBl5B,EAAKk5B,OAAS,KAGTvlC,KAAKq3B,IAAK6N,EAAO74B,EAAK64B,MAAS,IAAMllC,KAAKq3B,IAAK8N,EAAO94B,EAAK84B,MAAS,IAAMn/B,EAASsuB,UACvF,OAAOv9B,KAIRquC,EAAS,WAAaH,QAMtB54B,EAAK64B,KAAOA,EACZ74B,EAAK84B,KAAOA,EAEPha,EAAQN,KAAM,WAAaoa,IAAW9Z,EAAQN,KAAM,WAAaoa,KAAY9Z,EAAQN,KAAM,QAAUoa,GACzG54B,EAAKk5B,OAAStnC,WAAW,WACxBoO,EAAKk5B,OAAS,KAEdH,EAAS,QAAUH,IAEjB,KAGHG,EAAS,QAAUH,GAKrB,OAAOluC,OAGRL,EAAEmC,GAAUgE,GAAG,gBAAiB,SAAUY,EAAGuI,GACvCA,IAAaA,EAAS46B,YAC1B56B,EAAS46B,UAAY,IAAIA,EAAW56B,MAItCtP,EAAEmC,GAAUgE,GAAG,iBAAkB,SAAUY,EAAGuI,GACxCA,GAAYA,EAAS46B,WACzB56B,EAAS46B,UAAU5E,YA74BrB,CAk5BCx+B,OAAQ3E,SAAU2E,OAAO/G,QAWzB,SAAUoC,EAAUnC,GACrB,aAEA,IAAIy/B,EAAY,SAAUnwB,GACzBjP,KAAKiP,SAAWA,EAChBjP,KAAK+6B,QAGNp7B,EAAEmB,OAAQs+B,EAAU75B,WACnB4c,MAAW,KACXkd,UAAW,EACXoP,QAAW,KACXtX,MAAW,IAEX4D,KAAO,WACN,IAAIzlB,EAAOtV,KAEXsV,EAAKm5B,QAAUn5B,EAAKrG,SAASosB,MAAMvG,QAAQ9mB,KAAK,wBAAwBlI,GAAG,QAAS,WACnFwP,EAAK2Y,YAGD3Y,EAAKrG,SAASorB,MAAMrzB,OAAS,IAAMsO,EAAKrG,SAASorB,MAAO/kB,EAAKrG,SAASqrB,WAAYxG,KAAKuC,YAC3F/gB,EAAKm5B,QAAQtnC,QAIfunC,IAAM,WACL,IAAIp5B,EAAOtV,KAGNsV,EAAKrG,UAAYqG,EAAKrG,SAASmlB,UAAY9e,EAAKrG,SAASmlB,QAAQN,KAAKU,MAAQlf,EAAKrG,SAASqrB,UAAYhlB,EAAKrG,SAASorB,MAAMrzB,OAAS,GACzIsO,EAAK6M,MAAQjb,WAAW,WACvBoO,EAAKrG,SAASmtB,QAEZ9mB,EAAKrG,SAASmlB,QAAQN,KAAKuC,UAAUc,OAAS7hB,EAAK6hB,QAGtD7hB,EAAK8Y,OACL9Y,EAAKrG,SAAS2tB,mBAAqB,EACnCtnB,EAAKrG,SAAS6tB,iBAKhBh1B,MAAQ,WACP,IAAIwN,EAAOtV,KAEXoG,aAAckP,EAAK6M,OAEnB7M,EAAK6M,MAAQ,MAGdjN,MAAQ,WACP,IAAII,EAAOtV,KACPo0B,EAAU9e,EAAKrG,SAASmlB,QAEvB9e,EAAKrG,UAAYmlB,IAAaA,EAAQN,KAAKU,MAAQJ,EAAQtnB,MAAQwI,EAAKrG,SAASorB,MAAMrzB,OAAS,KAEpGsO,EAAK+pB,UAAW,EAEhB/pB,EAAKm5B,QACH7mB,KAAM,QAASwM,EAAQN,KAAKuE,KAAMjE,EAAQN,KAAKsE,MAAOQ,WACtDxrB,SAAU,0BAEPgnB,EAAQ+J,YACZ7oB,EAAKo5B,QAKRtgB,KAAO,WACN,IAAI9Y,EAAOtV,KACPo0B,EAAU9e,EAAKrG,SAASmlB,QAE5B9e,EAAKxN,QAELwN,EAAKm5B,QACH7mB,KAAM,QAASwM,EAAQN,KAAKuE,KAAMjE,EAAQN,KAAKsE,MAAOO,YACtDzyB,YAAa,0BAEfoP,EAAK+pB,UAAW,GAGjBpR,OAAS,WACR,IAAI3Y,EAAOtV,KAENsV,EAAK+pB,SACT/pB,EAAK8Y,OAGL9Y,EAAKJ,WAMRvV,EAAEmC,GAAUgE,IACX6oC,YAAc,SAASjoC,EAAGuI,GACpBA,IAAaA,EAASmwB,YAC1BnwB,EAASmwB,UAAY,IAAIA,EAAWnwB,KAItC2/B,gBAAkB,SAASloC,EAAGuI,EAAUmlB,EAASsG,GAChD,IAAI0E,EAAYnwB,GAAYA,EAASmwB,UAEhC1E,EAEC0E,GAAahL,EAAQN,KAAKuC,UAAUQ,WACxCuI,EAAUlqB,QAGAkqB,GAAaA,EAAUC,UAClCD,EAAUt3B,SAIZ+mC,eAAiB,SAASnoC,EAAGuI,EAAUmlB,GACtC,IAAIgL,EAAYnwB,GAAYA,EAASmwB,UAEhCA,GAAaA,EAAUC,UAC3BD,EAAUsP,OAIZI,kBAAoB,SAASpoC,EAAGuI,EAAUmlB,EAAS2a,EAAUrS,GAC5D,IAAI0C,EAAYnwB,GAAYA,EAASmwB,WAGhCA,IAAahL,EAAQN,KAAKuC,WAA2B,KAAZqG,GAA8B,KAAZA,GAAqB/8B,EAAEmC,EAAS+mB,eAAerX,GAAI,oBAClHu9B,EAAS1kC,iBAET+0B,EAAUnR,WAIZ+gB,iCAAmC,SAAStoC,EAAGuI,GAC9C,IAAImwB,EAAYnwB,GAAYA,EAASmwB,UAEhCA,GACJA,EAAUhR,UAMbzuB,EAAEmC,GAAUgE,GAAG,mBAAoB,WAClC,IAAImJ,EAAYtP,EAAEu0B,SAASC,cACvBiL,EAAYnwB,GAAYA,EAASmwB,UAEhCA,GAAaA,EAAUC,WACtBv9B,EAASmtC,OACb7P,EAAUt3B,QAGVs3B,EAAUsP,SA3Jb,CAgKC5sC,SAAU2E,OAAO/G,QAQjB,SAAUoC,EAAUnC,GACrB,aAGA,IAAIiP,EAAK,WAER,IA+CI7H,EAEAyF,EAAGggB,EAjDH0iB,IAEF,oBACA,iBACA,oBACA,oBACA,mBACA,oBAIA,0BACA,uBACA,0BACA,0BACA,yBACA,0BAKA,0BACA,yBACA,iCACA,yBACA,yBACA,0BAIA,uBACA,sBACA,uBACA,uBACA,sBACA,uBAGA,sBACA,mBACA,sBACA,sBACA,qBACA,sBAKE9N,KAGJ,IAAM50B,EAAI,EAAGA,EAAI0iC,EAAMloC,OAAQwF,IAG9B,IAFAzF,EAAMmoC,EAAO1iC,KAEDzF,EAAK,KAAOjF,EAAW,CAClC,IAAM0qB,EAAI,EAAGA,EAAIzlB,EAAIC,OAAQwlB,IAC5B4U,EAAK8N,EAAO,GAAK1iB,IAAQzlB,EAAKylB,GAG/B,OAAO4U,EAIT,OAAO,EAjEC,GAqET,GAAMxyB,EAAN,CASA,IAAIugC,GAEHpoB,QAAU,SAAWqoB,IAEpBA,EAAOA,GAAQttC,EAAS8gC,iBAElBh0B,EAAGygC,mBAAqBD,EAAKE,uBAGpCC,KAAO,WAENztC,EAAU8M,EAAG4gC,mBAGdvhB,OAAS,SAAWmhB,GAEnBA,EAAOA,GAAQttC,EAAS8gC,gBAEnB5iC,KAAKyvC,eACTzvC,KAAKuvC,OAGLvvC,KAAK+mB,QAASqoB,IAIhBK,aAAe,WAEd,OAAOC,QAAS5tC,EAAU8M,EAAG+gC,qBAG9BC,QAAU,WAET,OAAOF,QAAS5tC,EAAU8M,EAAGihC,sBAK/BlwC,EAAEmC,GAAUgE,IACX6oC,YAAc,SAASjoC,EAAGuI,GACzB,IAAI/G,EAEAumC,EAAUx/B,EAASosB,MAAMvG,QAAQ9mB,KAAK,8BAErCiB,IAAaA,EAASkgC,YAAclgC,EAASorB,MAAOprB,EAASqrB,WAAYxG,KAAKwC,aAClFpuB,EAAa+G,EAASosB,MAAM71B,WAEjBM,GAAG,sBAAuB,6BAA8B,SAASY,GAE3EA,EAAEw1B,kBACFx1B,EAAE2D,iBAEF8kC,EAAWlhB,OAAQ/lB,EAAY,MAI3B+G,EAAS6kB,KAAKwC,aAAqD,IAAvCrnB,EAAS6kB,KAAKwC,WAAWO,WACzDsY,EAAWpoB,QAAS7e,EAAY,IAIjC+G,EAASkgC,WAAaA,GAGtBV,EAAQtnC,QAKV2nC,kBAAoB,SAASpoC,EAAGuI,EAAUmlB,EAAS2a,EAAUrS,GAGvDztB,GAAYA,EAASkgC,YAA0B,KAAZzS,IACvCqS,EAAS1kC,iBAET4E,EAASkgC,WAAWlhB,OAAQhf,EAASosB,MAAM71B,UAAW,MAKxDsqC,iBAAmB,SAAU7gC,GACvBA,GAAYA,EAASkgC,YACzBA,EAAWI,UAKd5vC,EAAEmC,GAAUgE,GAAG8I,EAAGmhC,iBAAkB,WACnC,IAAI9gC,EAAWtP,EAAEu0B,SAASC,cAGrBllB,EAASmlB,SAAqC,UAA1BnlB,EAASmlB,QAAQrwB,MAAoBkL,EAASuuB,cACtEvuB,EAASmlB,QAAQ0K,SAASj5B,IAAK,aAAc,QAE7CoJ,EAASuuB,aAAc,EAEvBvuB,EAAS8V,QAAQ,GAAM,EAAM,IAG9B9V,EAAS6T,QAAQ,qBAAsBqsB,EAAWM,uBA1G7C9vC,GAAKA,EAAEu0B,WACXv0B,EAAEu0B,SAASnzB,SAASq1B,OAAOE,YAAa,GA5E1C,CAyLCx0B,SAAU2E,OAAO/G,QAQjB,SAAUoC,EAAUnC,GACrB,aAEA,IAAIqwC,EAAc,SAAU/gC,GAC3BjP,KAAKiP,SAAWA,EAChBjP,KAAK+6B,QAGNp7B,EAAEmB,OAAQkvC,EAAYzqC,WAErBkpC,QAAW,KACXwB,MAAS,KACTC,MAAS,KACTC,WAAY,EAEZpV,KAAO,WACN,IAAIzlB,EAAOtV,KAEPmN,EAASmI,EAAKrG,SAASorB,MAAM,GAChC+V,EAAS96B,EAAKrG,SAASorB,MAAM,GAE9B/kB,EAAKm5B,QAAUn5B,EAAKrG,SAASosB,MAAMvG,QAAQ9mB,KAAM,0BAE5CsH,EAAKrG,SAASorB,MAAMrzB,OAAS,GAAKsO,EAAKrG,SAASorB,MAAO/kB,EAAKrG,SAASqrB,WAAYxG,KAAKyC,SACtE,SAAdppB,EAAMpJ,MAAoBoJ,EAAM2mB,KAAK0N,OAAUr0B,EAAM2mB,KAAKgI,UAC3C,SAAfsU,EAAOrsC,MAAmBqsC,EAAOtc,KAAK0N,OAAS4O,EAAOtc,KAAKgI,SAGjExmB,EAAKm5B,QAAQ3oC,GAAG,QAAS,WACxBwP,EAAK2Y,WAGN3Y,EAAK+pB,UAAW,IAGhB/pB,EAAKm5B,QAAQtnC,OAEbmO,EAAK+pB,UAAW,IAKlBgR,OAAS,WACR,IACCC,EACA5U,EAFGzsB,EAAWjP,KAAKiP,SAIpBjP,KAAKiwC,MAAQtwC,EAAE,uCAAuCoD,SAAUkM,EAASosB,MAAM71B,WAE/E8qC,EAAO,OAEP3wC,EAAEqN,KAAKiC,EAASorB,MAAO,SAAU7tB,EAAGyJ,IAEnCylB,EAAMzlB,EAAK6d,KAAK0N,QAAWvrB,EAAK6d,KAAKgI,OAAS7lB,EAAK6d,KAAKgI,OAAOlU,KAAK,OAAS,QAElD,UAAd3R,EAAKlS,OACjB23B,EAAMzlB,EAAKylB,KAGPA,GAAOA,EAAI10B,SACfspC,GAAQ,mBAAqB9jC,EAAI,kEAAoEkvB,EAAM,eAK7G4U,GAAQ,QAERtwC,KAAKkwC,MAAQvwC,EAAG2wC,GAAOvtC,SAAU/C,KAAKiwC,OAAQnqC,GAAG,QAAS,KAAM,WAC/DmJ,EAASssB,OAAQ57B,EAAEK,MAAMgG,KAAK,YAG/BhG,KAAKkwC,MAAMliC,KAAK,OAAO7G,OAAOmc,IAAI,OAAQ,WAEzC,IAGCngB,EACAqF,EACA+nC,EACAC,EANG1f,EAAWnxB,EAAEK,MAAMoI,SAASlC,YAAa,2BAC5CuqC,EAAa3f,EAAQvnB,aACrBmnC,EAAc5f,EAAQvoB,cAMvBpF,EAASnD,KAAK8hC,cAAgB9hC,KAAKmD,MAMnCqtC,GALAhoC,EAASxI,KAAK+hC,eAAiB/hC,KAAKwI,QAKbkoC,GADvBH,EAAcptC,EAASstC,IAGJ,GAAKD,GAAe,IAClCD,EAAaC,GAChBrtC,GAAiBqtC,EACjBhoC,EAASkoC,IAGTvtC,EAASstC,EACTjoC,GAAkB+nC,IAIpB5wC,EAAEK,MAAM6F,KACP1C,MAAgB8F,KAAK42B,MAAM18B,GAC3BqF,OAAgBS,KAAK42B,MAAMr3B,GAC3BmoC,aAAgB1nC,KAAK22B,IAAK,EAAG32B,KAAK42B,MAAoB,GAAd6Q,EAA6B,GAATloC,IAC5DooC,cAAgB3nC,KAAK22B,IAAK,EAAG32B,KAAK42B,MAAoB,GAAd4Q,EAA6B,GAATttC,MAC1DkG,SAGH2D,KAAK,WACLhN,KAAK07B,IAAM/7B,EAAGK,MAAOgG,KAAM,UAK7BqlB,MAAQ,WAEFrrB,KAAKiP,SAASmlB,SAClBp0B,KAAKkwC,MACHjqC,WACAC,YAAa,0BACbiF,OAAQ,gBAAkBnL,KAAKiP,SAASmlB,QAAQtnB,MAAS,MACzDM,SAAU,0BACVie,SAKJmL,MAAQ,WACPx2B,KAAKiwC,MAAM9oC,QAGZ4d,OAAS,WAER/kB,KAAKiP,SAASosB,MAAM71B,UAAUgmB,YAAa,uBAAwBxrB,KAAKmwC,WAEnEnwC,KAAKmwC,WAEHnwC,KAAKiwC,OACVjwC,KAAKqwC,SAGNrwC,KAAKiP,SAAS6T,QAAS,gBAEvB9iB,KAAKqrB,SAEMrrB,KAAKiwC,OAChBjwC,KAAKiP,SAAS6T,QAAS,gBAIxB9iB,KAAKiP,SAAS8V,UAIf5d,KAAO,WACNnH,KAAKmwC,WAAY,EACjBnwC,KAAK+kB,UAGN1b,KAAO,WACNrJ,KAAKmwC,WAAY,EACjBnwC,KAAK+kB,UAGNkJ,OAAS,WACRjuB,KAAKmwC,WAAanwC,KAAKmwC,UACvBnwC,KAAK+kB,YAKPplB,EAAEmC,GAAUgE,IAEX6oC,YAAc,SAASjoC,EAAGuI,GACpBA,IAAaA,EAAS4hC,SAC1B5hC,EAAS4hC,OAAS,IAAIb,EAAa/gC,KAIrC2/B,gBAAkB,SAASloC,EAAGuI,EAAUgH,EAAMykB,GAC7C,IAAImW,EAAS5hC,GAAYA,EAAS4hC,OAElC,GAAMA,GAAWA,EAAOxR,SAAxB,CAIA,GAAKppB,EAAKkf,MAKT,OAJA0b,EAAOpC,QAAQtnC,YAEf0pC,EAAO1pC,OAKHuzB,IAA2C,IAA/BzkB,EAAK6d,KAAKyC,OAAOM,WACjCga,EAAOxnC,OAGHwnC,EAAOV,WACXU,EAAOxlB,UAITyjB,kBAAoB,SAASpoC,EAAGuI,EAAUmlB,EAAS2a,EAAUrS,GAC5D,IAAImU,EAAS5hC,GAAYA,EAAS4hC,OAG7BA,GAAUA,EAAOxR,UAAwB,KAAZ3C,IACjCqS,EAAS1kC,iBAETwmC,EAAO5iB,WAIT6hB,iBAAmB,SAAUppC,EAAGuI,GAC/B,IAAI4hC,EAAS5hC,GAAYA,EAAS4hC,OAE7BA,GAAUA,EAAOV,YAAkD,IAArClhC,EAAS6kB,KAAKyC,OAAOa,aACvDyZ,EAAOra,WA1NV,CAgOC10B,SAAU2E,OAAO/G,QAQjB,SAAUoC,EAAU2E,EAAQ9G,GAC7B,aAoCG,SAASmxC,IACL,IAAI7Z,EAAUxwB,EAAO0N,SAAS8iB,KAAKvpB,OAAQ,GACvC0yB,EAAUnJ,EAAKjsB,MAAO,KACtB8B,EAAUszB,EAAIp5B,OAAS,GAAK,WAAWyI,KAAM2wB,EAAKA,EAAIp5B,OAAS,IAAQqE,SAAU+0B,EAAI9pB,KAAM,GAAK,KAAQ,EAAI,EAC5Gy6B,EAAU3Q,EAAIluB,KAAM,KAOxB,OAJDpF,EAAQ,IACZA,EAAQ,IAICmqB,KAAUA,EACVnqB,MAAUA,EACVikC,QAAUA,GAKrB,SAASC,EAAgBjlC,GACxB,IAAIof,EAEuB,KAAhBpf,EAAIglC,WAGd5lB,EAAMxrB,EAAG,mBAAqBA,EAAEsxC,eAAgBllC,EAAIglC,SAAY,MAAO/kB,GAAIjgB,EAAIe,MAAQ,IAEpE9F,SAElBmkB,EAAMxrB,EAAG,IAAMA,EAAEsxC,eAAgBllC,EAAIglC,WAGjC5lB,EAAInkB,SACRkqC,GAAsB,EAEtB/lB,EAAIrI,QAAS,WAOhB,SAASquB,EAAcliC,GACtB,IAAI6kB,EAEJ,QAAM7kB,KAIN6kB,EAAO7kB,EAASmlB,QAAUnlB,EAASmlB,QAAQN,KAAO7kB,EAAS6kB,MAE/CmD,OAAUnD,EAAKO,MAAQP,EAAKO,MAAMruB,KAAM,YAAe,KApF9DrG,EAAEsxC,iBACPtxC,EAAEsxC,eAAiB,SAAUG,GAiB5B,OAASA,EAAM,IAAK1vC,QAhBH,+CACA,SAAUmS,EAAIw9B,GAC9B,OAAKA,EAEQ,OAAPx9B,EACG,IAIDA,EAAGrI,MAAO,GAAI,GAAM,KAAOqI,EAAGy9B,WAAYz9B,EAAG7M,OAAS,GAAIuqC,SAAU,IAAO,IAI5E,KAAO19B,MAQjB,IAAIq9B,GAAsB,EAInBM,EAAc,KAGjBC,EAAU,KA0DX9xC,EAAE,WAGJuH,WAAW,YAGwB,IAA7BvH,EAAEu0B,SAASnzB,SAASk2B,OAKtBt3B,EAAEmC,GAAUgE,IACd6oC,YAAc,SAAUjoC,EAAGuI,GAC1B,IAAIlD,EAAKglC,GAE+C,IAAnD9hC,EAASorB,MAAOprB,EAASqrB,WAAYxG,KAAKmD,OAI/ClrB,EAAU+kC,KACVC,EAAUI,EAAcliC,KAGRlD,EAAIglC,SAAWA,GAAWhlC,EAAIglC,UAC7C9hC,EAASqrB,UAAYvuB,EAAIe,MAAQ,KAKnC8hC,gBAAkB,SAAUloC,EAAGuI,EAAUmlB,GACxC,IAAI2c,EAEE3c,IAAiC,IAAtBA,EAAQN,KAAKmD,OAIrB8Z,EAAUI,EAAcliC,KAGI,KAAZ8hC,IAEnBtqC,EAAO0N,SAAS8iB,KAAKnyB,QAASisC,GAAY,IAClC9hC,EAAS6kB,KAAK4d,SAAWjrC,EAAO0N,SAAS8iB,MAGtDua,EAAcT,GAAY9hC,EAASorB,MAAMrzB,OAAS,EAAI,KAAQotB,EAAQtnB,MAAQ,GAAM,IAE/E,iBAAkBrG,EAAOkrC,SACxBF,GACJrrC,aAAcqrC,GAGfA,EAAUvqC,WAAW,WACpBT,EAAOkrC,QAAST,EAAsB,YAAc,mBAAuBpvC,EAAS8vC,MAAOnrC,EAAO0N,SAAS09B,SAAWprC,EAAO0N,SAASmV,OAAS,IAAOkoB,GAEtJC,EAAU,KAEVP,GAAsB,GAEpB,MAGHzqC,EAAO0N,SAAS8iB,KAAOua,IAO1B1B,iBAAmB,SAAUppC,EAAGuI,EAAUmlB,GACzC,IAAI2c,EAASW,EAERD,GACJrrC,aAAcqrC,IAGY,IAAtBrd,EAAQN,KAAKmD,OAIlB8Z,EAAWI,EAAcliC,GACzByiC,EAAWziC,GAAYA,EAAS6kB,KAAK4d,SAAWziC,EAAS6kB,KAAK4d,SAAW,GAG3DX,GAAuB,KAAZA,IAEP,iBAAkBY,QAClClrC,EAAOkrC,QAAQG,gBAAmBhwC,EAAS8vC,MAAOnrC,EAAO0N,SAAS09B,SAAWprC,EAAO0N,SAASmV,OAASooB,IAGtGjrC,EAAO0N,SAAS8iB,KAAOya,EAGvB/xC,EAAG8G,GAASqC,UAAWmG,EAASnG,WAAYkgB,WAAY/Z,EAAS+Z,cAInEwoB,EAAc,SAKhB7xC,EAAE8G,GAAQX,GAAG,gBAAiB,WAC7B,IAAIiG,EAAM+kC,IAELnxC,EAAEu0B,SAASC,eACVqd,GAAeA,IAAgBzlC,EAAIglC,QAAU,IAAMhlC,EAAIe,OAA0B,IAAdf,EAAIe,OAAe0kC,GAAezlC,EAAIglC,UAC7GS,EAAc,KAEd7xC,EAAEu0B,SAASsC,SAGe,KAAhBzqB,EAAIglC,SACfC,EAAgBjlC,KAKlBilC,EAAgBF,OAEd,MApNJ,CAwNChvC,SAAU2E,OAAQA,OAAO/G;CCv0JzB,SAAU+G,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,iCAAkC,UAAY,SAAUI,GAC9D,OAAOL,EAASoH,EAAQ/G,KAEC,iBAAV0P,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,WAIVgH,EAAOsrC,cAAgB1yC,EACrBoH,EACAA,EAAO/G,QAlBb,CAsBG+G,OAAQ,SAAkBA,EAAQ/G,GACrC,aAgBA,SAASqyC,EAAeC,EAAWC,EAAatyC,GAgC9C,SAASuyC,EAAYC,EAAQC,EAAYtjC,GACvC,IAAIujC,EACAC,EAAkB,OAASN,EAAY,KAAOI,EAAa,KAuB/D,OArBAD,EAAOnlC,KAAM,SAAUR,EAAG4iC,GAExB,IAAIngC,EAAWtP,EAAEqG,KAAMopC,EAAM4C,GAC7B,GAAM/iC,EAAN,CAMA,IAAIqS,EAASrS,EAAUmjC,GACvB,GAAM9wB,GAAkC,KAAxB8wB,EAAWvW,OAAO,GAAlC,CAMA,IAAIv7B,EAAQghB,EAAO0B,MAAO/T,EAAUH,GAEpCujC,OAA8B39B,IAAhB29B,EAA4B/xC,EAAQ+xC,OAPhDE,EAAUD,EAAkB,+BAP5BC,EAAUP,EAAY,+CACpBM,UAgBiB59B,IAAhB29B,EAA4BA,EAAcF,EAGnD,SAASK,EAAWL,EAAQryC,GAC1BqyC,EAAOnlC,KAAM,SAAUR,EAAG4iC,GACxB,IAAIngC,EAAWtP,EAAEqG,KAAMopC,EAAM4C,GACxB/iC,GAEHA,EAAS6U,OAAQhkB,GACjBmP,EAASwjC,UAGTxjC,EAAW,IAAIgjC,EAAa7C,EAAMtvC,GAClCH,EAAEqG,KAAMopC,EAAM4C,EAAW/iC,OArE/BtP,EAAIA,GAAKD,GAAU+G,EAAO/G,UAMpBuyC,EAAY1sC,UAAUue,SAE1BmuB,EAAY1sC,UAAUue,OAAS,SAAUgQ,GAEjCn0B,EAAEmX,cAAegd,KAGvB9zB,KAAKF,QAAUH,EAAEmB,QAAQ,EAAMd,KAAKF,QAASg0B,MAKjDn0B,EAAEiP,GAAIojC,GAAc,SAAUU,GAC5B,MAAoB,iBAARA,EAIHR,EAAYlyC,KAAM0yC,EADdC,EAAW/nC,KAAMmE,UAAW,KAIzCyjC,EAAWxyC,KAAM0yC,GACV1yC,OA+CT4yC,EAAcjzC,IAOhB,SAASizC,EAAcjzC,IACfA,GAAOA,GAAKA,EAAEkzC,UAGpBlzC,EAAEkzC,QAAUd,GAlGd,IAAIY,EAAaprC,MAAMhC,UAAUiG,MAI7BsnC,EAAUrsC,EAAOqsC,QACjBP,OAA6B,IAAXO,EAAyB,aAC7C,SAAUC,GACRD,EAAQve,MAAOwe,IAkGnB,OAJAH,EAAclzC,GAAU+G,EAAO/G,QAIxBqyC,IAYL,SAAU5iC,EAAQ9P,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,wBAAwBD,GACL,iBAAV+P,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,IAGjB8P,EAAO6jC,UAAY3zC,IAXvB,CAcoB,oBAAVoH,OAAwBA,OAASzG,KAAM,WAIjD,SAASgzC,KAET,IAAIC,EAAQD,EAAUztC,UAiFtB,OA/EA0tC,EAAMntC,GAAK,SAAUotC,EAAWC,GAC9B,GAAMD,GAAcC,EAApB,CAIA,IAAI/wB,EAASpiB,KAAKozC,QAAUpzC,KAAKozC,YAE7BC,EAAYjxB,EAAQ8wB,GAAc9wB,EAAQ8wB,OAM9C,OAJuC,GAAlCG,EAAUvuC,QAASquC,IACtBE,EAAUvlC,KAAMqlC,GAGXnzC,OAGTizC,EAAMK,KAAO,SAAUJ,EAAWC,GAChC,GAAMD,GAAcC,EAApB,CAIAnzC,KAAK8F,GAAIotC,EAAWC,GAGpB,IAAII,EAAavzC,KAAKwzC,YAAcxzC,KAAKwzC,gBAMzC,OAJoBD,EAAYL,GAAcK,EAAYL,QAE3CC,IAAa,EAErBnzC,OAGTizC,EAAMxkC,IAAM,SAAUykC,EAAWC,GAC/B,IAAIE,EAAYrzC,KAAKozC,SAAWpzC,KAAKozC,QAASF,GAC9C,GAAMG,GAAcA,EAAUrsC,OAA9B,CAGA,IAAI8F,EAAQumC,EAAUvuC,QAASquC,GAK/B,OAJe,GAAVrmC,GACHumC,EAAUtmB,OAAQjgB,EAAO,GAGpB9M,OAGTizC,EAAMQ,UAAY,SAAUP,EAAWpkC,GACrC,IAAIukC,EAAYrzC,KAAKozC,SAAWpzC,KAAKozC,QAASF,GAC9C,GAAMG,GAAcA,EAAUrsC,OAA9B,CAIAqsC,EAAYA,EAAU7nC,MAAM,GAC5BsD,EAAOA,MAIP,IAAM,IAFF4kC,EAAgB1zC,KAAKwzC,aAAexzC,KAAKwzC,YAAaN,GAEhD1mC,EAAE,EAAGA,EAAI6mC,EAAUrsC,OAAQwF,IAAM,CACzC,IAAI2mC,EAAWE,EAAU7mC,GACZknC,GAAiBA,EAAeP,KAI3CnzC,KAAKyO,IAAKykC,EAAWC,UAEdO,EAAeP,IAGxBA,EAASnwB,MAAOhjB,KAAM8O,GAGxB,OAAO9O,OAGTizC,EAAMU,OAAS,kBACN3zC,KAAKozC,eACLpzC,KAAKwzC,aAGPR,IAaP,SAAYvsC,EAAQpH,GAClB,aAEsB,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,uBAAuB,WAC7B,OAAOD,MAEkB,iBAAV+P,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,IAGjBoH,EAAOmtC,QAAUv0C,IAbrB,CAgBIoH,OAAQ,WACZ,aAKA,SAASotC,EAAcvzC,GACrB,IAAIwzC,EAAM1vB,WAAY9jB,GAGtB,OADqC,GAAvBA,EAAMwE,QAAQ,OAAewmB,MAAOwoB,IAChCA,EA6BpB,SAASC,IASP,IAAM,IARFC,GACF7wC,MAAO,EACPqF,OAAQ,EACRic,WAAY,EACZD,YAAa,EACbjb,WAAY,EACZhB,YAAa,GAELiE,EAAE,EAAGA,EAAIynC,EAAoBznC,IAErCwnC,EADkBE,EAAa1nC,IACT,EAExB,OAAOwnC,EAST,SAASG,EAAU/E,GACjB,IAAIntC,EAAQqjC,iBAAkB8J,GAM9B,OALMntC,GACJswC,EAAU,kBAAoBtwC,EAC5B,4FAGGA,EAcT,SAASmyC,IAEP,IAAKC,EAAL,CAGAA,GAAU,EAQV,IAAIxyC,EAAMC,SAASC,cAAc,OACjCF,EAAII,MAAMkB,MAAQ,QAClBtB,EAAII,MAAMqyC,QAAU,kBACpBzyC,EAAII,MAAMsyC,YAAc,QACxB1yC,EAAII,MAAMuyC,YAAc,kBACxB3yC,EAAII,MAAMwyC,UAAY,aAEtB,IAAIpsC,EAAOvG,SAASuG,MAAQvG,SAAS8gC,gBACrCv6B,EAAKqsC,YAAa7yC,GAClB,IAAII,EAAQkyC,EAAUtyC,GAEtB+xC,EAAQe,eAAiBA,EAAgD,KAA/Bd,EAAc5xC,EAAMkB,OAC9DkF,EAAKusC,YAAa/yC,IAMpB,SAAS+xC,EAASxE,GAShB,GARAgF,IAGoB,iBAARhF,IACVA,EAAOttC,SAAS+yC,cAAezF,IAI3BA,GAAuB,iBAARA,GAAqBA,EAAKre,SAA/C,CAIA,IAAI9uB,EAAQkyC,EAAU/E,GAGtB,GAAsB,QAAjBntC,EAAME,QACT,OAAO4xC,IAGT,IAAIC,KACJA,EAAK7wC,MAAQisC,EAAK0F,YAClBd,EAAKxrC,OAAS4mC,EAAKlV,aAKnB,IAAM,IAHF6a,EAAcf,EAAKe,YAAiC,cAAnB9yC,EAAMwyC,UAGjCjoC,EAAE,EAAGA,EAAIynC,EAAoBznC,IAAM,CAC3C,IAAIwoC,EAAcd,EAAa1nC,GAC3BlM,EAAQ2B,EAAO+yC,GACflB,EAAM1vB,WAAY9jB,GAEtB0zC,EAAMgB,GAAiB1pB,MAAOwoB,GAAc,EAANA,EAGxC,IAAImB,EAAejB,EAAK7vB,YAAc6vB,EAAK3vB,aACvC6wB,EAAgBlB,EAAKmB,WAAanB,EAAKoB,cACvCC,EAAcrB,EAAKsB,WAAatB,EAAKuB,YACrCC,EAAexB,EAAKyB,UAAYzB,EAAK0B,aACrClB,EAAcR,EAAK2B,gBAAkB3B,EAAK4B,iBAC1CC,EAAe7B,EAAK8B,eAAiB9B,EAAK+B,kBAE1CC,EAAuBjB,GAAeJ,EAGtCsB,EAAapC,EAAc5xC,EAAMkB,QACjB,IAAf8yC,IACHjC,EAAK7wC,MAAQ8yC,GAETD,EAAuB,EAAIf,EAAeT,IAGhD,IAAI0B,EAAcrC,EAAc5xC,EAAMuG,QAatC,OAZqB,IAAhB0tC,IACHlC,EAAKxrC,OAAS0tC,GAEVF,EAAuB,EAAId,EAAgBW,IAGjD7B,EAAKvvB,WAAauvB,EAAK7wC,OAAU8xC,EAAeT,GAChDR,EAAKxvB,YAAcwvB,EAAKxrC,QAAW0sC,EAAgBW,GAEnD7B,EAAKzqC,WAAayqC,EAAK7wC,MAAQkyC,EAC/BrB,EAAKzrC,YAAcyrC,EAAKxrC,OAASgtC,EAE1BxB,GAnKT,IA4DIW,EA5DApC,EAA6B,oBAAXO,QAFtB,aAGE,SAAUC,GACRD,QAAQve,MAAOwe,IAKfmB,GACF,cACA,eACA,aACA,gBACA,aACA,cACA,YACA,eACA,kBACA,mBACA,iBACA,qBAGED,EAAqBC,EAAaltC,OAoClCqtC,GAAU,EA4Gd,OAAOT,IAYL,SAAUntC,EAAQpH,GAElB,aAEsB,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,6CAA6CD,GAC1B,iBAAV+P,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,IAGjBoH,EAAO0vC,gBAAkB92C,IAZ7B,CAeGoH,OAAQ,WACT,aAEA,IAAI2vC,EAAgB,WAClB,IAAIC,EAAY5vC,OAAO6vC,QAAQ/wC,UAE/B,GAAK8wC,EAAU59B,QACb,MAAO,UAGT,GAAK49B,EAAUF,gBACb,MAAO,kBAKT,IAAM,IAFFI,GAAa,SAAU,MAAO,KAAM,KAE9B/pC,EAAE,EAAGA,EAAI+pC,EAASvvC,OAAQwF,IAAM,CACxC,IACI8U,EADSi1B,EAAS/pC,GACA,kBACtB,GAAK6pC,EAAW/0B,GACd,OAAOA,GAjBO,GAsBpB,OAAO,SAA0B8tB,EAAMpb,GACrC,OAAOob,EAAMgH,GAAiBpiB,MAYhC,SAAUvtB,EAAQpH,GAII,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,wBACN,8CACC,SAAU62C,GACX,OAAO92C,EAASoH,EAAQ0vC,KAEC,iBAAV/mC,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,8BAIVgH,EAAO+vC,aAAen3C,EACpBoH,EACAA,EAAO0vC,iBArBb,CAyBG1vC,OAAQ,SAAkBA,EAAQ0vC,GAIrC,IAAI30C,KAKJA,EAAMV,OAAS,SAAUyU,EAAGC,GAC1B,IAAM,IAAIsvB,KAAQtvB,EAChBD,EAAGuvB,GAAStvB,EAAGsvB,GAEjB,OAAOvvB,GAKT/T,EAAMi1C,OAAS,SAAU3C,EAAKjyC,GAC5B,OAAWiyC,EAAMjyC,EAAQA,GAAQA,GAMnCL,EAAM2oB,UAAY,SAAUlV,GAC1B,IAAIyhC,KACJ,GAAKnvC,MAAMC,QAASyN,GAElByhC,EAAMzhC,OACD,GAAKA,GAAqB,iBAAPA,GACH,iBAAdA,EAAIjO,OAEX,IAAM,IAAIwF,EAAE,EAAGA,EAAIyI,EAAIjO,OAAQwF,IAC7BkqC,EAAI5oC,KAAMmH,EAAIzI,SAIhBkqC,EAAI5oC,KAAMmH,GAEZ,OAAOyhC,GAKTl1C,EAAMm1C,WAAa,SAAUD,EAAKzhC,GAChC,IAAInI,EAAQ4pC,EAAI5xC,QAASmQ,IACV,GAAVnI,GACH4pC,EAAI3pB,OAAQjgB,EAAO,IAMvBtL,EAAMo1C,UAAY,SAAUxH,EAAMpb,GAChC,KAAQob,EAAKyH,YAAczH,GAAQttC,SAASuG,MAE1C,GADA+mC,EAAOA,EAAKyH,WACPV,EAAiB/G,EAAMpb,GAC1B,OAAOob,GAQb5tC,EAAMs1C,gBAAkB,SAAU1H,GAChC,MAAoB,iBAARA,EACHttC,SAAS+yC,cAAezF,GAE1BA,GAMT5tC,EAAMu1C,YAAc,SAAUrkB,GAC5B,IAAIpR,EAAS,KAAOoR,EAAM3uB,KACrB/D,KAAMshB,IACTthB,KAAMshB,GAAUoR,IAMpBlxB,EAAMw1C,mBAAqB,SAAUC,EAAOjjB,GAG1C,IAAIkjB,KAyBJ,OA1BAD,EAAQz1C,EAAM2oB,UAAW8sB,IAGnB3b,QAAS,SAAU8T,GAEvB,GAAQA,aAAgB+H,YAIxB,GAAMnjB,EAAN,CAMKmiB,EAAiB/G,EAAMpb,IAC1BkjB,EAAQppC,KAAMshC,GAKhB,IAAM,IAFFgI,EAAahI,EAAKiI,iBAAkBrjB,GAE9BxnB,EAAE,EAAGA,EAAI4qC,EAAWpwC,OAAQwF,IACpC0qC,EAAQppC,KAAMspC,EAAW5qC,SAZzB0qC,EAAQppC,KAAMshC,KAgBX8H,GAKT11C,EAAM81C,eAAiB,SAAUC,EAAQnF,EAAYoF,GAEnD,IAAIl2B,EAASi2B,EAAOhyC,UAAW6sC,GAC3BqF,EAAcrF,EAAa,UAE/BmF,EAAOhyC,UAAW6sC,GAAe,WAC/B,IAAIh5B,EAAUpZ,KAAMy3C,GACfr+B,GACHhT,aAAcgT,GAEhB,IAAItK,EAAOC,UAEP2oC,EAAQ13C,KACZA,KAAMy3C,GAAgBvwC,WAAY,WAChCoa,EAAO0B,MAAO00B,EAAO5oC,UACd4oC,EAAOD,IACbD,GAAa,OAMpBh2C,EAAMm2C,SAAW,SAAUt1B,GACzB,IAAI4f,EAAangC,SAASmgC,WACP,YAAdA,GAA0C,eAAdA,EAE/B/6B,WAAYmb,GAEZvgB,SAAS81C,iBAAkB,mBAAoBv1B,IAOnD7gB,EAAMq2C,SAAW,SAAUvkC,GACzB,OAAOA,EAAI5R,QAAS,cAAe,SAAUwqB,EAAO4rB,EAAIC,GACtD,OAAOD,EAAK,IAAMC,IACjBlzC,eAGL,IAAIiuC,EAAUrsC,EAAOqsC,QA4CrB,OAtCAtxC,EAAMw2C,SAAW,SAAUC,EAAajG,GACtCxwC,EAAMm2C,SAAU,WACd,IAAIO,EAAkB12C,EAAMq2C,SAAU7F,GAClCmG,EAAW,QAAUD,EACrBE,EAAgBt2C,SAASu1C,iBAAkB,IAAMc,EAAW,KAC5DE,EAAcv2C,SAASu1C,iBAAkB,OAASa,GAClDjB,EAAQz1C,EAAM2oB,UAAWiuB,GAC1BzgC,OAAQnW,EAAM2oB,UAAWkuB,IACxBC,EAAkBH,EAAW,WAC7Bz4C,EAAS+G,EAAO/G,OAEpBu3C,EAAM3b,QAAS,SAAU8T,GACvB,IAEItvC,EAFA8nB,EAAOwnB,EAAKmJ,aAAcJ,IAC5B/I,EAAKmJ,aAAcD,GAErB,IACEx4C,EAAU8nB,GAAQrT,KAAKikC,MAAO5wB,GAC9B,MAAQ2M,GAMR,YAJKue,GACHA,EAAQve,MAAO,iBAAmB4jB,EAAW,OAAS/I,EAAKptC,UAC3D,KAAOuyB,IAKX,IAAItlB,EAAW,IAAIgpC,EAAa7I,EAAMtvC,GAEjCJ,GACHA,EAAOsG,KAAMopC,EAAM4C,EAAW/iC,QAS/BzN,IAKL,SAAUiF,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,oBACN,qBACC,SAAUs0C,GACX,OAAOv0C,EAASoH,EAAQmtC,KAEC,iBAAVxkC,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,cAIVgH,EAAOgyC,SAAWhyC,EAAOgyC,aACzBhyC,EAAOgyC,SAASC,KAAOr5C,EACrBoH,EACAA,EAAOmtC,UArBb,CAyBGntC,OAAQ,SAAkBA,EAAQmtC,GAIrC,SAAS8E,EAAMtJ,EAAMhnC,GACnBpI,KAAKC,QAAUmvC,EACfpvC,KAAKoI,OAASA,EAEdpI,KAAKqwC,SAGP,IAAI4C,EAAQyF,EAAKnzC,UAkDjB,OAhDA0tC,EAAM5C,OAAS,WACbrwC,KAAKC,QAAQgC,MAAMC,SAAW,WAC9BlC,KAAKs+B,EAAI,EACTt+B,KAAKmX,MAAQ,GAGf87B,EAAMhO,QAAU,WAEdjlC,KAAKC,QAAQgC,MAAMC,SAAW,GAC9B,IAAIy2C,EAAO34C,KAAKoI,OAAOwwC,WACvB54C,KAAKC,QAAQgC,MAAO02C,GAAS,IAG/B1F,EAAMW,QAAU,WACd5zC,KAAKg0C,KAAOJ,EAAS5zC,KAAKC,UAG5BgzC,EAAM4F,YAAc,SAAUva,GAC5Bt+B,KAAKs+B,EAAIA,EACTt+B,KAAK84C,eACL94C,KAAK+4C,eAAgBza,IAIvB2U,EAAM6F,aAAe7F,EAAM+F,iBAAmB,WAC5C,IAAIC,EAA2C,QAA1Bj5C,KAAKoI,OAAOwwC,WAAuB,aAAe,cACvE54C,KAAKojB,OAASpjB,KAAKs+B,EAAIt+B,KAAKg0C,KAAMiF,GAChCj5C,KAAKg0C,KAAK7wC,MAAQnD,KAAKoI,OAAO8wC,WAGlCjG,EAAM8F,eAAiB,SAAUza,GAE/B,IAAIqa,EAAO34C,KAAKoI,OAAOwwC,WACvB54C,KAAKC,QAAQgC,MAAO02C,GAAS34C,KAAKoI,OAAO+wC,iBAAkB7a,IAM7D2U,EAAMmG,UAAY,SAAUjiC,GAC1BnX,KAAKmX,MAAQA,EACbnX,KAAK+4C,eAAgB/4C,KAAKs+B,EAAIt+B,KAAKoI,OAAOixC,eAAiBliC,IAG7D87B,EAAMtkC,OAAS,WACb3O,KAAKC,QAAQ42C,WAAWjC,YAAa50C,KAAKC,UAGrCy4C,IAKL,SAAUjyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,oBAAoBD,GACD,iBAAV+P,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,KAGjBoH,EAAOgyC,SAAWhyC,EAAOgyC,aACzBhyC,EAAOgyC,SAASa,MAAQj6C,KAZ5B,CAeGoH,OAAQ,WACX,aAEA,SAAS6yC,EAAOlxC,GACdpI,KAAKoI,OAASA,EACdpI,KAAKu5C,aAAoC,QAArBnxC,EAAOwwC,WAC3B54C,KAAKw5C,SACLx5C,KAAKuJ,WAAa,EAClBvJ,KAAKwI,OAAS,EAGhB,IAAIyqC,EAAQqG,EAAM/zC,UA8ClB,OA5CA0tC,EAAMwG,QAAU,SAAUC,GAKxB,GAJA15C,KAAKw5C,MAAM1rC,KAAM4rC,GACjB15C,KAAKuJ,YAAcmwC,EAAK1F,KAAKzqC,WAC7BvJ,KAAKwI,OAASS,KAAKC,IAAKwwC,EAAK1F,KAAKzrC,YAAavI,KAAKwI,QAE1B,GAArBxI,KAAKw5C,MAAMxyC,OAAc,CAC5BhH,KAAKs+B,EAAIob,EAAKpb,EACd,IAAIqb,EAAc35C,KAAKu5C,aAAe,aAAe,cACrDv5C,KAAK45C,YAAcF,EAAK1F,KAAM2F,KAIlC1G,EAAM6F,aAAe,WACnB,IAAIe,EAAY75C,KAAKu5C,aAAe,cAAgB,aAChDO,EAAW95C,KAAK+5C,cAChBC,EAAaF,EAAWA,EAAS9F,KAAM6F,GAAc,EACrDI,EAAaj6C,KAAKuJ,YAAevJ,KAAK45C,YAAcI,GACxDh6C,KAAKojB,OAASpjB,KAAKs+B,EAAIt+B,KAAK45C,YAAcK,EAAaj6C,KAAKoI,OAAO8wC,WAGrEjG,EAAM8G,YAAc,WAClB,OAAO/5C,KAAKw5C,MAAOx5C,KAAKw5C,MAAMxyC,OAAS,IAGzCisC,EAAM9sC,OAAS,WACbnG,KAAKk6C,oBAAoB,QAG3BjH,EAAMkH,SAAW,WACfn6C,KAAKk6C,oBAAoB,WAG3BjH,EAAMiH,oBAAsB,SAAU54B,GACpCthB,KAAKw5C,MAAMle,QAAS,SAAUoe,GAC5BA,EAAKz5C,QAAQm6C,UAAW94B,GAAS,kBAIrC2xB,EAAMoH,gBAAkB,WACtB,OAAOr6C,KAAKw5C,MAAM7rC,IAAK,SAAU+rC,GAC/B,OAAOA,EAAKz5C,WAITq5C,IAKL,SAAU7yC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,uBACN,wBACC,SAAUkC,GACX,OAAOnC,EAASoH,EAAQjF,KAEC,iBAAV4N,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,oBAIVgH,EAAOgyC,SAAWhyC,EAAOgyC,aACzBhyC,EAAOgyC,SAAS6B,iBAAmBj7C,EACjCoH,EACAA,EAAO+vC,eArBb,CAyBG/vC,OAAQ,SAAkBA,EAAQjF,GAOrC,IAAI83B,EAAwB7yB,EAAO6yB,uBACjC7yB,EAAO8yB,4BAGLghB,EAAW,EACTjhB,IACJA,EAAwB,SAAUjX,GAChC,IAAIm4B,GAAW,IAAIrY,MAAOC,UACtBqY,EAAaxxC,KAAKC,IAAK,EAAG,IAAOsxC,EAAWD,IAC5C//B,EAAKtT,WAAYmb,EAAUo4B,GAE/B,OADAF,EAAWC,EAAWC,EACfjgC,IAMX,IAAIy4B,KAEJA,EAAMyH,eAAiB,WAChB16C,KAAKw9B,cAIVx9B,KAAKw9B,aAAc,EACnBx9B,KAAK26C,cAAgB,EACrB36C,KAAK6jB,YAGPovB,EAAMpvB,QAAU,WACd7jB,KAAK46C,iBACL56C,KAAK66C,0BAEL,IAAIC,EAAY96C,KAAKs+B,EAMrB,GAJAt+B,KAAK+6C,mBACL/6C,KAAKg7C,iBACLh7C,KAAKi7C,OAAQH,GAER96C,KAAKw9B,YAAc,CACtB,IAAIka,EAAQ13C,KACZs5B,EAAuB,WACrBoe,EAAM7zB,cAMZ,IAAIq3B,EAE6B,iBADnBp5C,SAAS8gC,gBAAgB3gC,MACnB2jC,UACT,YAEF,kBAkIT,OA/HAqN,EAAM+H,eAAiB,WACrB,IAAI1c,EAAIt+B,KAAKs+B,EAERt+B,KAAKF,QAAQq7C,YAAcn7C,KAAKw5C,MAAMxyC,OAAS,IAClDs3B,EAAI98B,EAAMi1C,OAAQnY,EAAGt+B,KAAKq5C,gBAC1B/a,GAAQt+B,KAAKq5C,eACbr5C,KAAKo7C,eAAgB9c,IAGvBA,GAAQt+B,KAAKq7C,eAEb/c,EAAIt+B,KAAKF,QAAQw7C,aAAeJ,GAAqB5c,EAAIA,EACzD,IAAIh+B,EAAQN,KAAKm5C,iBAAkB7a,GAGnCt+B,KAAKu7C,OAAOt5C,MAAOi5C,GAAsBl7C,KAAKw9B,YAC5C,eAAiBl9B,EAAQ,QAAU,cAAgBA,EAAQ,IAG7D,IAAIk7C,EAAax7C,KAAK86B,OAAO,GAC7B,GAAK0gB,EAAa,CAChB,IAAIC,GAAaz7C,KAAKs+B,EAAIkd,EAAWp4B,OACjCs4B,EAAWD,EAAYz7C,KAAK27C,YAChC37C,KAAK47C,cAAe,SAAU,MAAQF,EAAUD,MAIpDxI,EAAM4I,yBAA2B,WACzB77C,KAAKw5C,MAAMxyC,SAGjBhH,KAAKs+B,GAAKt+B,KAAK87C,cAAc14B,OAC7BpjB,KAAKg7C,mBAGP/H,EAAMkG,iBAAmB,SAAUj3C,GACjC,OAAKlC,KAAKF,QAAQi8C,gBAEqD,IAA5D9yC,KAAKynB,MAASxuB,EAAWlC,KAAKg0C,KAAKvvB,WAAe,KAAkB,IAGtExb,KAAKynB,MAAOxuB,GAAa,MAIpC+wC,EAAMgI,OAAS,SAAUH,GAEjB96C,KAAKg8C,eAAiB/yC,KAAKynB,MAAgB,IAAT1wB,KAAKs+B,IAAar1B,KAAKynB,MAAmB,IAAZoqB,IACpE96C,KAAK26C,gBAGF36C,KAAK26C,cAAgB,IACxB36C,KAAKw9B,aAAc,SACZx9B,KAAKi8C,gBAEZj8C,KAAKg7C,iBACLh7C,KAAK47C,cAAc,YAIvB3I,EAAMmI,eAAiB,SAAU9c,GAE/B,IAAI4d,EAAYl8C,KAAKq7C,eAAiB/c,EACtCt+B,KAAKm8C,YAAan8C,KAAKo8C,iBAAkBF,GAAY,GAErD,IAAIG,EAAWr8C,KAAKg0C,KAAKvvB,YAAe6Z,EAAIt+B,KAAKq5C,eAAiBr5C,KAAKq7C,gBACvEr7C,KAAKm8C,YAAan8C,KAAKs8C,gBAAiBD,EAAU,IAGpDpJ,EAAMkJ,YAAc,SAAU3C,EAAO+C,EAAKplC,GACxC,IAAM,IAAI3K,EAAE,EAAGA,EAAIgtC,EAAMxyC,OAAQwF,IAAM,CACrC,IAAIktC,EAAOF,EAAMhtC,GACbgwC,EAAYD,EAAM,EAAIplC,EAAQ,EAClCuiC,EAAKN,UAAWoD,GAChBD,GAAO7C,EAAK1F,KAAKzqC,aAIrB0pC,EAAMwJ,cAAgB,SAAUjD,GAC9B,GAAMA,GAAUA,EAAMxyC,OAGtB,IAAM,IAAIwF,EAAE,EAAGA,EAAIgtC,EAAMxyC,OAAQwF,IAC/BgtC,EAAMhtC,GAAG4sC,UAAW,IAMxBnG,EAAM8H,iBAAmB,WACvB/6C,KAAKs+B,GAAKt+B,KAAK08C,SACf18C,KAAK08C,UAAY18C,KAAK28C,qBAGxB1J,EAAM2J,WAAa,SAAUjY,GAC3B3kC,KAAK08C,UAAY/X,GAGnBsO,EAAM0J,kBAAoB,WACxB,OAAO,EAAI38C,KAAKF,QAASE,KAAKi8C,gBAAkB,qBAAuB,aAGzEhJ,EAAM4J,mBAAqB,WAEzB,OAAO78C,KAAKs+B,EAAIt+B,KAAK08C,UAAa,EAAI18C,KAAK28C,sBAG7C1J,EAAM2H,eAAiB,WACrB,GAAM56C,KAAKg8C,cAAX,CAIA,IACIc,EADe98C,KAAK+8C,MAAQ/8C,KAAKs+B,EACNt+B,KAAK08C,SACpC18C,KAAK48C,WAAYE,KAGnB7J,EAAM4H,wBAA0B,WAE9B,IAAK76C,KAAKg8C,gBAAiBh8C,KAAKi8C,iBAAoBj8C,KAAKw5C,MAAMxyC,OAA/D,CAGA,IACI29B,IADwC,EAA7B3kC,KAAK87C,cAAc14B,OAAcpjB,KAAKs+B,GAC9Bt+B,KAAKF,QAAQk9C,mBACpCh9C,KAAK48C,WAAYjY,KAGZsO,IAKL,SAAUxsC,EAAQpH,GAGlB,GAAsB,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,wBACN,wBACA,oBACA,uBACA,SACA,UACA,aACC,SAAU0zC,EAAWY,EAASpyC,EAAOk3C,EAAMY,EAAOgB,GACnD,OAAOj7C,EAASoH,EAAQusC,EAAWY,EAASpyC,EAAOk3C,EAAMY,EAAOgB,UAE7D,GAAsB,iBAAVlrC,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,cACRA,QAAQ,YACRA,QAAQ,kBACRA,QAAQ,UACRA,QAAQ,WACRA,QAAQ,kBAEL,CAEL,IAAIw9C,EAAYx2C,EAAOgyC,SAEvBhyC,EAAOgyC,SAAWp5C,EAChBoH,EACAA,EAAOusC,UACPvsC,EAAOmtC,QACPntC,EAAO+vC,aACPyG,EAAUvE,KACVuE,EAAU3D,MACV2D,EAAU3C,mBArChB,CAyCG7zC,OAAQ,SAAkBA,EAAQusC,EAAWY,EAC9CpyC,EAAOk3C,EAAMY,EAAOgB,GAStB,SAAS4C,EAAcjG,EAAOkG,GAE5B,IADAlG,EAAQz1C,EAAM2oB,UAAW8sB,GACjBA,EAAMjwC,QACZm2C,EAAOzI,YAAauC,EAAM9/B,SAW9B,SAASshC,EAAUx4C,EAASH,GAC1B,IAAIs9C,EAAe57C,EAAMs1C,gBAAiB72C,GAC1C,GAAMm9C,EAAN,CAQA,GAFAp9C,KAAKC,QAAUm9C,EAEVp9C,KAAKC,QAAQo9C,aAAe,CAC/B,IAAIpuC,EAAWquC,EAAWt9C,KAAKC,QAAQo9C,cAEvC,OADApuC,EAAS6U,OAAQhkB,GACVmP,EAIJvP,IACHM,KAAKu9C,SAAW79C,EAAQM,KAAKC,UAG/BD,KAAKF,QAAU0B,EAAMV,UAAYd,KAAKw9C,YAAYz8C,UAClDf,KAAK8jB,OAAQhkB,GAGbE,KAAKy9C,eAtBE3K,GACHA,EAAQve,MAAO,8BAAiC6oB,GAAgBn9C,IAtBtE,IAAIP,EAAS+G,EAAO/G,OAChB4lC,EAAmB7+B,EAAO6+B,iBAC1BwN,EAAUrsC,EAAOqsC,QAYjB4K,EAAO,EAEPJ,KA8BJ7E,EAAS13C,UACP48C,eAAe,EAEfzE,UAAW,SAGX0E,mBAAoB,KACpBC,SAAU,IACVC,uBAAuB,EAEvB/B,iBAAiB,EACjBgC,QAAQ,EACRf,mBAAoB,KACpBgB,gBAAgB,GAMlBvF,EAASwF,iBAET,IAAIhL,EAAQwF,EAASlzC,UAErB/D,EAAMV,OAAQmyC,EAAOD,EAAUztC,WAE/B0tC,EAAMwK,QAAU,WAEd,IAAIjjC,EAAKxa,KAAKk+C,OAASR,EACvB19C,KAAKC,QAAQo9C,aAAe7iC,EAC5B8iC,EAAW9iC,GAAOxa,KAElBA,KAAKI,cAAgB,EAErBJ,KAAK26C,cAAgB,EAErB36C,KAAKs+B,EAAI,EACTt+B,KAAK08C,SAAW,EAChB18C,KAAK44C,WAAa54C,KAAKF,QAAQw7C,YAAc,QAAU,OAEvDt7C,KAAKm+C,SAAWr8C,SAASC,cAAc,OACvC/B,KAAKm+C,SAASn8C,UAAY,oBAC1BhC,KAAKo+C,iBAEAp+C,KAAKF,QAAQi+C,QAAU/9C,KAAKF,QAAQu+C,WACvC53C,EAAOmxC,iBAAkB,SAAU53C,MAGrCy4C,EAASwF,cAAc3iB,QAAS,SAAUha,GACxCthB,KAAMshB,MACLthB,MAEEA,KAAKF,QAAQu+C,SAChBr+C,KAAKq+C,WAELr+C,KAAK+F,YASTktC,EAAMnvB,OAAS,SAAUgQ,GACvBtyB,EAAMV,OAAQd,KAAKF,QAASg0B,IAG9Bmf,EAAMltC,SAAW,WACf,IAAK/F,KAAKq/B,SAAV,CAGAr/B,KAAKq/B,UAAW,EAChBr/B,KAAKC,QAAQm6C,UAAU52B,IAAI,oBACtBxjB,KAAKF,QAAQw7C,aAChBt7C,KAAKC,QAAQm6C,UAAU52B,IAAI,gBAG7BxjB,KAAK4zC,UAGLsJ,EADgBl9C,KAAKs+C,wBAAyBt+C,KAAKC,QAAQgG,UAClCjG,KAAKu7C,QAC9Bv7C,KAAKm+C,SAASzJ,YAAa10C,KAAKu7C,QAChCv7C,KAAKC,QAAQy0C,YAAa10C,KAAKm+C,UAE/Bn+C,KAAKu+C,cAEAv+C,KAAKF,QAAQ69C,gBAEhB39C,KAAKC,QAAQu+C,SAAW,EAExBx+C,KAAKC,QAAQ23C,iBAAkB,UAAW53C,OAG5CA,KAAKyzC,UAAU,YAEf,IAAI3mC,EACA2xC,EAAez+C,KAAKF,QAAQ2+C,aAE9B3xC,EADG9M,KAAK0+C,gBACA1+C,KAAKI,mBACcsU,IAAjB+pC,GACFz+C,KAAKw5C,MAAOiF,GAAiBA,EAE7B,EAGVz+C,KAAKmG,OAAQ2G,GAAO,GAAO,GAE3B9M,KAAK0+C,iBAAkB,IAIzBzL,EAAMmL,cAAgB,WAEpB,IAAI7C,EAASz5C,SAASC,cAAc,OACpCw5C,EAAOv5C,UAAY,kBACnBu5C,EAAOt5C,MAAOjC,KAAK44C,YAAe,EAClC54C,KAAKu7C,OAASA,GAGhBtI,EAAMqL,wBAA0B,SAAUrH,GACxC,OAAOz1C,EAAMw1C,mBAAoBC,EAAOj3C,KAAKF,QAAQ6+C,eAIvD1L,EAAMsL,YAAc,WAElBv+C,KAAKw5C,MAAQx5C,KAAK4+C,WAAY5+C,KAAKu7C,OAAOt1C,UAC1CjG,KAAK6+C,gBACL7+C,KAAK8+C,qBACL9+C,KAAKg+C,kBAQP/K,EAAM2L,WAAa,SAAU3H,GAQ3B,OAPgBj3C,KAAKs+C,wBAAyBrH,GAGxBtpC,IAAK,SAAUoxC,GACnC,OAAO,IAAIrG,EAAMqG,EAAU/+C,OAC1BA,OAKLizC,EAAM8G,YAAc,WAClB,OAAO/5C,KAAKw5C,MAAOx5C,KAAKw5C,MAAMxyC,OAAS,IAGzCisC,EAAM+L,aAAe,WACnB,OAAOh/C,KAAK86B,OAAQ96B,KAAK86B,OAAO9zB,OAAS,IAI3CisC,EAAM4L,cAAgB,WAEpB7+C,KAAKi/C,WAAYj/C,KAAKw5C,OAEtBx5C,KAAKk/C,eAAgB,IAOvBjM,EAAMiM,eAAiB,SAAUpyC,GAC/BA,EAAQA,GAAS,EAGjB9M,KAAKm/C,cAAgBryC,EAAQ9M,KAAKm/C,eAAiB,EAAI,EACvD,IAAIC,EAAQ,EAEZ,GAAKtyC,EAAQ,EAAI,CACf,IAAIuyC,EAAYr/C,KAAKw5C,MAAO1sC,EAAQ,GACpCsyC,EAAQC,EAAU/gB,EAAI+gB,EAAUrL,KAAKzqC,WAGvC,IAAM,IADF+1C,EAAMt/C,KAAKw5C,MAAMxyC,OACXwF,EAAEM,EAAON,EAAI8yC,EAAK9yC,IAAM,CAChC,IAAIktC,EAAO15C,KAAKw5C,MAAMhtC,GACtBktC,EAAKb,YAAauG,GAClBA,GAAS1F,EAAK1F,KAAKzqC,WACnBvJ,KAAKm/C,cAAgBl2C,KAAKC,IAAKwwC,EAAK1F,KAAKzrC,YAAavI,KAAKm/C,eAG7Dn/C,KAAKq5C,eAAiB+F,EAEtBp/C,KAAKu/C,eAELv/C,KAAKw/C,iBAELx/C,KAAK27C,YAAc2D,EAAMt/C,KAAKg/C,eAAe57B,OAASpjB,KAAK86B,OAAO,GAAG1X,OAAS,GAOhF6vB,EAAMgM,WAAa,SAAUzF,GAC3BA,EAAMle,QAAS,SAAUoe,GACvBA,EAAK9F,aAMTX,EAAMsM,aAAe,WAEnB,GADAv/C,KAAK86B,UACC96B,KAAKw5C,MAAMxyC,OAAjB,CAIA,IAAIk2B,EAAQ,IAAIoc,EAAOt5C,MACvBA,KAAK86B,OAAOhtB,KAAMovB,GAClB,IACIuiB,EADkC,QAAnBz/C,KAAK44C,WACQ,cAAgB,aAE5C8G,EAAa1/C,KAAK2/C,iBAEtB3/C,KAAKw5C,MAAMle,QAAS,SAAUoe,EAAMltC,GAElC,GAAM0wB,EAAMsc,MAAMxyC,OAAlB,CAKA,IAAIizC,EAAe/c,EAAM3zB,WAAa2zB,EAAM0c,aACxCF,EAAK1F,KAAKzqC,WAAamwC,EAAK1F,KAAMyL,IAEjCC,EAAW90C,KAAM5K,KAAMwM,EAAGytC,GAC7B/c,EAAMuc,QAASC,IAGfxc,EAAM4b,eAEN5b,EAAQ,IAAIoc,EAAOt5C,MACnBA,KAAK86B,OAAOhtB,KAAMovB,GAClBA,EAAMuc,QAASC,SAffxc,EAAMuc,QAASC,IAiBhB15C,MAEHk9B,EAAM4b,eAEN94C,KAAK4/C,wBAGP3M,EAAM0M,eAAiB,WACrB,IAAIE,EAAa7/C,KAAKF,QAAQ+/C,WAC9B,IAAMA,EACJ,OAAO,WACL,OAAO,GAEJ,GAA0B,iBAAdA,EAAyB,CAE1C,IAAIC,EAASz0C,SAAUw0C,EAAY,IACnC,OAAO,SAAUrzC,GACf,OAASA,EAAIszC,GAAa,GAK9B,IAAIC,EAAoC,iBAAdF,GACxBA,EAAW3zB,MAAM,YACf8zB,EAAUD,EAAe10C,SAAU00C,EAAa,GAAI,IAAO,IAAM,EACrE,OAAO,SAAUvzC,EAAGytC,GAClB,OAAOA,IAAgBj6C,KAAKg0C,KAAKvvB,WAAa,GAAMu7B,IAKxD/M,EAAMR,MACNQ,EAAMgN,WAAa,WACjBjgD,KAAK6+C,gBACL7+C,KAAK67C,4BAGP5I,EAAMW,QAAU,WACd5zC,KAAKg0C,KAAOJ,EAAS5zC,KAAKC,SAC1BD,KAAKkgD,eACLlgD,KAAKq7C,eAAiBr7C,KAAKg0C,KAAKvvB,WAAazkB,KAAKk5C,WAGpD,IAAIiH,GAEFC,QACEx3C,KAAM,GACNq7B,MAAO,IAETr7B,MACEA,KAAM,EACNq7B,MAAO,GAETA,OACEA,MAAO,EACPr7B,KAAM,IA8cV,OA1cAqqC,EAAMiN,aAAe,WACnB,IAAIG,EAAYF,EAAqBngD,KAAKF,QAAQo5C,WAClDl5C,KAAKk5C,UAAYmH,EAAYA,EAAWrgD,KAAK44C,YAAe54C,KAAKF,QAAQo5C,WAG3EjG,EAAM+K,eAAiB,WACrB,GAAKh+C,KAAKF,QAAQk+C,eAAiB,CACjC,IAAIx1C,EAASxI,KAAKF,QAAQwgD,gBAAkBtgD,KAAK87C,cAC/C97C,KAAK87C,cAActzC,OAASxI,KAAKm/C,cACnCn/C,KAAKm+C,SAASl8C,MAAMuG,OAASA,EAAS,OAI1CyqC,EAAM6L,mBAAqB,WAEzB,GAAM9+C,KAAKF,QAAQq7C,WAAnB,CAIAn7C,KAAKy8C,cAAez8C,KAAKo8C,kBACzBp8C,KAAKy8C,cAAez8C,KAAKs8C,iBAGzB,IAAIiE,EAAOvgD,KAAKq7C,eACZmF,EAAYxgD,KAAKw5C,MAAMxyC,OAAS,EACpChH,KAAKo8C,iBAAmBp8C,KAAKygD,aAAcF,EAAMC,GAAY,GAG7DD,EAAOvgD,KAAKg0C,KAAKvvB,WAAazkB,KAAKq7C,eAEnCr7C,KAAKs8C,gBAAkBt8C,KAAKygD,aAAcF,EAAM,EAAG,KAGrDtN,EAAMwN,aAAe,SAAUF,EAAMC,EAAWE,GAG9C,IADA,IAAIlH,KACI+G,EAAO,GAAI,CACjB,IAAI7G,EAAO15C,KAAKw5C,MAAOgH,GACvB,IAAM9G,EACJ,MAEFF,EAAM1rC,KAAM4rC,GACZ8G,GAAaE,EACbH,GAAQ7G,EAAK1F,KAAKzqC,WAEpB,OAAOiwC,GAMTvG,EAAMuM,eAAiB,WACrB,GAAMx/C,KAAKF,QAAQ6gD,UAAW3gD,KAAKF,QAAQq7C,YAAen7C,KAAKw5C,MAAMxyC,OAArE,CAGA,IAAI45C,EAAgB5gD,KAAKF,QAAQw7C,YAC7B3B,EAAciH,EAAgB,cAAgB,aAC9C/G,EAAY+G,EAAgB,aAAe,cAC3CC,EAAe7gD,KAAKq5C,eAAiBr5C,KAAK+5C,cAAc/F,KAAM6F,GAE9DiH,EAAmBD,EAAe7gD,KAAKg0C,KAAKvvB,WAE5Cs8B,EAAa/gD,KAAKq7C,eAAiBr7C,KAAKw5C,MAAM,GAAGxF,KAAM2F,GACvDqH,EAAWH,EAAe7gD,KAAKg0C,KAAKvvB,YAAe,EAAIzkB,KAAKk5C,WAEhEl5C,KAAK86B,OAAOQ,QAAS,SAAU4B,GACxB4jB,EAEH5jB,EAAM9Z,OAASy9B,EAAe7gD,KAAKk5C,WAGnChc,EAAM9Z,OAASna,KAAKC,IAAKg0B,EAAM9Z,OAAQ29B,GACvC7jB,EAAM9Z,OAASna,KAAK22B,IAAK1C,EAAM9Z,OAAQ49B,KAExChhD,QAWLizC,EAAM2I,cAAgB,SAAU73C,EAAM2uB,EAAO5jB,GAC3C,IAAImyC,EAAWvuB,GAAUA,GAAQ/a,OAAQ7I,GAASA,EAGlD,GAFA9O,KAAKyzC,UAAW1vC,EAAMk9C,GAEjBvhD,GAAUM,KAAKu9C,SAAW,CAG7B,IAAI2D,EADJn9C,GAAQ/D,KAAKF,QAAQg+C,sBAAwB,YAAc,GAE3D,GAAKprB,EAAQ,CAEX,IAAIyuB,EAAUzhD,EAAO0hD,MAAO1uB,GAC5ByuB,EAAQp9C,KAAOA,EACfm9C,EAASC,EAEXnhD,KAAKu9C,SAASz6B,QAASo+B,EAAQpyC,KAWnCmkC,EAAM9sC,OAAS,SAAU2G,EAAOu0C,EAAQC,GAChCthD,KAAKq/B,WAGXvyB,EAAQzB,SAAUyB,EAAO,IACzB9M,KAAKuhD,YAAaz0C,IAEb9M,KAAKF,QAAQq7C,YAAckG,KAC9Bv0C,EAAQtL,EAAMi1C,OAAQ3pC,EAAO9M,KAAK86B,OAAO9zB,SAGrChH,KAAK86B,OAAQhuB,KAGnB9M,KAAKI,cAAgB0M,EACrB9M,KAAK4/C,sBACA0B,EACHthD,KAAK67C,2BAEL77C,KAAK06C,iBAEF16C,KAAKF,QAAQwgD,gBAChBtgD,KAAKg+C,iBAGPh+C,KAAK47C,cAAc,UAEnB57C,KAAK47C,cAAc,iBAIrB3I,EAAMsO,YAAc,SAAUz0C,GAC5B,IAAIwyC,EAAMt/C,KAAK86B,OAAO9zB,OAEtB,KADiBhH,KAAKF,QAAQq7C,YAAcmE,EAAM,GAEhD,OAAOxyC,EAET,IAAI00C,EAAYhgD,EAAMi1C,OAAQ3pC,EAAOwyC,GAEjCmC,EAAQx4C,KAAKq3B,IAAKkhB,EAAYxhD,KAAKI,eACnCshD,EAAgBz4C,KAAKq3B,IAAOkhB,EAAYlC,EAAQt/C,KAAKI,eACrDuhD,EAAoB14C,KAAKq3B,IAAOkhB,EAAYlC,EAAQt/C,KAAKI,gBACvDJ,KAAK4hD,cAAgBF,EAAgBD,EACzC30C,GAASwyC,GACEt/C,KAAK4hD,cAAgBD,EAAoBF,IACpD30C,GAASwyC,GAGNxyC,EAAQ,EACX9M,KAAKs+B,GAAKt+B,KAAKq5C,eACLvsC,GAASwyC,IACnBt/C,KAAKs+B,GAAKt+B,KAAKq5C,iBAInBpG,EAAM9W,SAAW,SAAUklB,EAAQC,GACjCthD,KAAKmG,OAAQnG,KAAKI,cAAgB,EAAGihD,EAAQC,IAG/CrO,EAAM7W,KAAO,SAAUilB,EAAQC,GAC7BthD,KAAKmG,OAAQnG,KAAKI,cAAgB,EAAGihD,EAAQC,IAG/CrO,EAAM2M,oBAAsB,WAC1B,IAAI1iB,EAAQl9B,KAAK86B,OAAQ96B,KAAKI,eAExB88B,IAINl9B,KAAK6hD,wBAEL7hD,KAAK87C,cAAgB5e,EACrBA,EAAM/2B,SACNnG,KAAK8hD,cAAgB5kB,EAAMsc,MAC3Bx5C,KAAK+hD,iBAAmB7kB,EAAMmd,kBAG9Br6C,KAAKgiD,aAAe9kB,EAAMsc,MAAM,GAChCx5C,KAAKiiD,gBAAkBjiD,KAAK+hD,iBAAiB,KAG/C9O,EAAM4O,sBAAwB,WACvB7hD,KAAK87C,eACR97C,KAAK87C,cAAc3B,YAQvBlH,EAAMiP,WAAa,SAAU5hD,EAAO+gD,EAAQC,GAE1C,IAAI5H,EACiB,iBAATp5C,EACVo5C,EAAO15C,KAAKw5C,MAAOl5C,IAGE,iBAATA,IACVA,EAAQN,KAAKC,QAAQ40C,cAAev0C,IAGtCo5C,EAAO15C,KAAKmiD,QAAS7hD,IAGvB,IAAM,IAAIkM,EAAE,EAAGktC,GAAQltC,EAAIxM,KAAK86B,OAAO9zB,OAAQwF,IAG7C,IAAe,GAFHxM,KAAK86B,OAAOtuB,GACNgtC,MAAM10C,QAAS40C,GAG/B,YADA15C,KAAKmG,OAAQqG,EAAG60C,EAAQC,IAa9BrO,EAAMkP,QAAU,SAAU/S,GAExB,IAAM,IAAI5iC,EAAE,EAAGA,EAAIxM,KAAKw5C,MAAMxyC,OAAQwF,IAAM,CAC1C,IAAIktC,EAAO15C,KAAKw5C,MAAMhtC,GACtB,GAAKktC,EAAKz5C,SAAWmvC,EACnB,OAAOsK,IAUbzG,EAAMmP,SAAW,SAAUnL,GAEzB,IAAIuC,KAOJ,OARAvC,EAAQz1C,EAAM2oB,UAAW8sB,IAEnB3b,QAAS,SAAU8T,GACvB,IAAIsK,EAAO15C,KAAKmiD,QAAS/S,GACpBsK,GACHF,EAAM1rC,KAAM4rC,IAEb15C,MACIw5C,GAOTvG,EAAMoH,gBAAkB,WACtB,OAAOr6C,KAAKw5C,MAAM7rC,IAAK,SAAU+rC,GAC/B,OAAOA,EAAKz5C,WAShBgzC,EAAMoP,cAAgB,SAAUjT,GAE9B,IAAIsK,EAAO15C,KAAKmiD,QAAS/S,GACzB,OAAKsK,IAILtK,EAAO5tC,EAAMo1C,UAAWxH,EAAM,wBACvBpvC,KAAKmiD,QAAS/S,KASvB6D,EAAMqP,wBAA0B,SAAUC,EAAUz1C,GAClD,IAAMy1C,EACJ,OAAOviD,KAAK87C,cAAczB,kBAE5BvtC,OAAkB4H,IAAV5H,EAAsB9M,KAAKI,cAAgB0M,EAEnD,IAAIwyC,EAAMt/C,KAAK86B,OAAO9zB,OACtB,GAAK,EAAiB,EAAXu7C,GAAkBjD,EAC3B,OAAOt/C,KAAKq6C,kBAId,IAAM,IADFmI,KACMh2C,EAAIM,EAAQy1C,EAAU/1C,GAAKM,EAAQy1C,EAAW/1C,IAAM,CAC5D,IAAIi2C,EAAaziD,KAAKF,QAAQq7C,WAAa35C,EAAMi1C,OAAQjqC,EAAG8yC,GAAQ9yC,EAChE0wB,EAAQl9B,KAAK86B,OAAQ2nB,GACpBvlB,IACHslB,EAAYA,EAAU7qC,OAAQulB,EAAMmd,oBAGxC,OAAOmI,GAKTvP,EAAMyP,SAAW,WACf1iD,KAAKyzC,UAAU,aAGjBR,EAAM0P,mBAAqB,SAAUjwB,GACnC1yB,KAAKyzC,UAAW,sBAAwB/gB,KAK1CugB,EAAM2P,SAAW,WACf5iD,KAAKq+C,WACLr+C,KAAK+9C,UAGPv8C,EAAM81C,eAAgBmB,EAAU,WAAY,KAE5CxF,EAAM8K,OAAS,WACb,GAAM/9C,KAAKq/B,SAAX,CAGAr/B,KAAK4zC,UAEA5zC,KAAKF,QAAQq7C,aAChBn7C,KAAKs+B,EAAI98B,EAAMi1C,OAAQz2C,KAAKs+B,EAAGt+B,KAAKq5C,iBAEtCr5C,KAAK6+C,gBACL7+C,KAAK8+C,qBACL9+C,KAAKg+C,iBACLh+C,KAAKyzC,UAAU,UAGf,IAAIwO,EAAkBjiD,KAAK+hD,kBAAoB/hD,KAAK+hD,iBAAiB,GACrE/hD,KAAKkiD,WAAYD,GAAiB,GAAO,KAI3ChP,EAAMoL,SAAW,WACGr+C,KAAKF,QAAQu+C,YAOW,GAFvB/Y,EAAkBtlC,KAAKC,QAAS,UAAWm6B,QAE5Ct1B,QAAQ,YACxB9E,KAAK+F,WAEL/F,KAAKmtB,eAOT8lB,EAAM4P,UAAY,SAAUnwB,GAE1B,GAAM1yB,KAAKF,QAAQ69C,iBACf77C,SAAS+mB,eAAiB/mB,SAAS+mB,eAAiB7oB,KAAKC,SAI7D,GAAsB,IAAjByyB,EAAMiK,QAAgB,CAEzB,IAAImmB,EAAa9iD,KAAKF,QAAQw7C,YAAc,OAAS,WACrDt7C,KAAK0iD,WACL1iD,KAAM8iD,UACD,GAAsB,IAAjBpwB,EAAMiK,QAAgB,CAEhC,IAAIomB,EAAc/iD,KAAKF,QAAQw7C,YAAc,WAAa,OAC1Dt7C,KAAK0iD,WACL1iD,KAAM+iD,OAOV9P,EAAM9lB,WAAa,WACXntB,KAAKq/B,WAGXr/B,KAAKC,QAAQm6C,UAAUzrC,OAAO,oBAC9B3O,KAAKC,QAAQm6C,UAAUzrC,OAAO,gBAE9B3O,KAAKw5C,MAAMle,QAAS,SAAUoe,GAC5BA,EAAKzU,YAEPjlC,KAAK6hD,wBACL7hD,KAAKC,QAAQ20C,YAAa50C,KAAKm+C,UAE/BjB,EAAcl9C,KAAKu7C,OAAOt1C,SAAUjG,KAAKC,SACpCD,KAAKF,QAAQ69C,gBAChB39C,KAAKC,QAAQ+iD,gBAAgB,YAC7BhjD,KAAKC,QAAQgjD,oBAAqB,UAAWjjD,OAG/CA,KAAKq/B,UAAW,EAChBr/B,KAAKyzC,UAAU,gBAGjBR,EAAMhO,QAAU,WACdjlC,KAAKmtB,aACL1mB,EAAOw8C,oBAAqB,SAAUjjD,MACtCA,KAAKyzC,UAAU,WACV/zC,GAAUM,KAAKu9C,UAClB79C,EAAOgP,WAAY1O,KAAKC,QAAS,mBAE5BD,KAAKC,QAAQo9C,oBACbC,EAAWt9C,KAAKk+C,OAKzB18C,EAAMV,OAAQmyC,EAAOqH,GASrB7B,EAASzyC,KAAO,SAAUopC,GAExB,IAAI50B,GADJ40B,EAAO5tC,EAAMs1C,gBAAiB1H,KACbA,EAAKiO,aACtB,OAAO7iC,GAAM8iC,EAAW9iC,IAG1BhZ,EAAMw2C,SAAUS,EAAU,YAErB/4C,GAAUA,EAAOmzC,SACpBnzC,EAAOmzC,QAAS,WAAY4F,GAI9BA,EAASyK,UAAY,SAAUC,GAC7BzjD,EAASyjD,GAGX1K,EAASC,KAAOA,EAETD,IAYL,SAAUhyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,yBACN,yBACC,SAAU0zC,GACX,OAAO3zC,EAASoH,EAAQusC,KAEC,iBAAV5jC,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,eAIVgH,EAAO28C,WAAa/jD,EAClBoH,EACAA,EAAOusC,WApBb,CAwBGvsC,OAAQ,SAAkBA,EAAQusC,GAMrC,SAASoQ,KAGT,IAAInQ,EAAQmQ,EAAW79C,UAAYwS,OAAOs4B,OAAQ2C,EAAUztC,WAE5D0tC,EAAMoQ,eAAiB,SAAUjU,GAC/BpvC,KAAKsjD,gBAAiBlU,GAAM,IAG9B6D,EAAMsQ,iBAAmB,SAAUnU,GACjCpvC,KAAKsjD,gBAAiBlU,GAAM,IAO9B6D,EAAMqQ,gBAAkB,SAAUlU,EAAMoU,GAGtC,IAAIC,GADJD,OAAoB9uC,IAAX8uC,KAAgCA,GACf,mBAAqB,sBAE1C/8C,EAAOi9C,aAEVtU,EAAMqU,GAAc,cAAezjD,OAGnCovC,EAAMqU,GAAc,YAAazjD,MACjCovC,EAAMqU,GAAc,aAAczjD,QAKtCizC,EAAM8D,YAAc,SAAUrkB,GAC5B,IAAIpR,EAAS,KAAOoR,EAAM3uB,KACrB/D,KAAMshB,IACTthB,KAAMshB,GAAUoR,IAKpBugB,EAAM0Q,SAAW,SAAUvb,GACzB,IAAM,IAAI57B,EAAE,EAAGA,EAAI47B,EAAQphC,OAAQwF,IAAM,CACvC,IAAIsqB,EAAQsR,EAAQ57B,GACpB,GAAKsqB,EAAM8sB,YAAc5jD,KAAK6jD,kBAC5B,OAAO/sB,IAObmc,EAAM6Q,YAAc,SAAUpxB,GAE5B,IAAIyQ,EAASzQ,EAAMyQ,OACdA,GAAuB,IAAXA,GAA2B,IAAXA,GAGjCnjC,KAAK+jD,aAAcrxB,EAAOA,IAG5BugB,EAAMhJ,aAAe,SAAUvX,GAC7B1yB,KAAK+jD,aAAcrxB,EAAOA,EAAM2V,eAAe,KAGjD4K,EAAM+Q,cAAgB,SAAUtxB,GAC9B1yB,KAAK+jD,aAAcrxB,EAAOA,IAQ5BugB,EAAM8Q,aAAe,SAAUrxB,EAAOuxB,GAE/BjkD,KAAKg8C,gBAIVh8C,KAAKg8C,eAAgB,EAErBh8C,KAAK6jD,uBAA0CnvC,IAAtBuvC,EAAQC,UAE/BD,EAAQC,UAAYD,EAAQL,WAE9B5jD,KAAKmkD,YAAazxB,EAAOuxB,KAG3BhR,EAAMkR,YAAc,SAAUzxB,EAAOuxB,GACnCjkD,KAAKokD,qBAAsB1xB,GAC3B1yB,KAAKyzC,UAAW,eAAiB/gB,EAAOuxB,KAI1C,IAAII,GACFC,WAAa,YAAa,WAC1BC,YAAc,YAAa,WAAY,eACvCC,aAAe,cAAe,YAAa,kBA4J7C,OAzJAvR,EAAMmR,qBAAuB,SAAU1xB,GACrC,GAAMA,EAAN,CAIA,IAAItQ,EAASiiC,EAAiB3xB,EAAM3uB,MAEpCqe,EAAOkZ,QAAS,SAAU4X,GACxBzsC,EAAOmxC,iBAAkB1E,EAAWlzC,OACnCA,MAEHA,KAAKykD,oBAAsBriC,IAG7B6wB,EAAMyR,uBAAyB,WAEvB1kD,KAAKykD,sBAGXzkD,KAAKykD,oBAAoBnpB,QAAS,SAAU4X,GAC1CzsC,EAAOw8C,oBAAqB/P,EAAWlzC,OACtCA,aAEIA,KAAKykD,sBAKdxR,EAAM0R,YAAc,SAAUjyB,GAC5B1yB,KAAK4kD,aAAclyB,EAAOA,IAG5BugB,EAAM4R,cAAgB,SAAUnyB,GACzBA,EAAMwxB,WAAalkD,KAAK6jD,mBAC3B7jD,KAAK4kD,aAAclyB,EAAOA,IAI9BugB,EAAM5H,YAAc,SAAU3Y,GAC5B,IAAIoE,EAAQ92B,KAAK2jD,SAAUjxB,EAAM2V,gBAC5BvR,GACH92B,KAAK4kD,aAAclyB,EAAOoE,IAU9Bmc,EAAM2R,aAAe,SAAUlyB,EAAOuxB,GACpCjkD,KAAK8kD,YAAapyB,EAAOuxB,IAI3BhR,EAAM6R,YAAc,SAAUpyB,EAAOuxB,GACnCjkD,KAAKyzC,UAAW,eAAiB/gB,EAAOuxB,KAM1ChR,EAAM8R,UAAY,SAAUryB,GAC1B1yB,KAAKglD,WAAYtyB,EAAOA,IAG1BugB,EAAMgS,YAAc,SAAUvyB,GACvBA,EAAMwxB,WAAalkD,KAAK6jD,mBAC3B7jD,KAAKglD,WAAYtyB,EAAOA,IAI5BugB,EAAM5F,WAAa,SAAU3a,GAC3B,IAAIoE,EAAQ92B,KAAK2jD,SAAUjxB,EAAM2V,gBAC5BvR,GACH92B,KAAKglD,WAAYtyB,EAAOoE,IAU5Bmc,EAAM+R,WAAa,SAAUtyB,EAAOuxB,GAClCjkD,KAAKklD,eACLllD,KAAKmlD,UAAWzyB,EAAOuxB,IAIzBhR,EAAMkS,UAAY,SAAUzyB,EAAOuxB,GACjCjkD,KAAKyzC,UAAW,aAAe/gB,EAAOuxB,KAMxChR,EAAMiS,aAAe,WAEnBllD,KAAKg8C,eAAgB,SACdh8C,KAAK6jD,kBAEZ7jD,KAAK0kD,yBACL1kD,KAAKolD,eAGPnS,EAAMmS,YAnNN,aAuNAnS,EAAMoS,gBAAkB,SAAU3yB,GAC3BA,EAAMwxB,WAAalkD,KAAK6jD,mBAC3B7jD,KAAKslD,eAAgB5yB,EAAOA,IAIhCugB,EAAMsS,cAAgB,SAAU7yB,GAC9B,IAAIoE,EAAQ92B,KAAK2jD,SAAUjxB,EAAM2V,gBAC5BvR,GACH92B,KAAKslD,eAAgB5yB,EAAOoE,IAUhCmc,EAAMqS,eAAiB,SAAU5yB,EAAOuxB,GACtCjkD,KAAKklD,eACLllD,KAAKwlD,cAAe9yB,EAAOuxB,IAI7BhR,EAAMuS,cAAgB,SAAU9yB,EAAOuxB,GACrCjkD,KAAKyzC,UAAW,iBAAmB/gB,EAAOuxB,KAM5Cb,EAAWqC,gBAAkB,SAAUxB,GACrC,OACE3lB,EAAG2lB,EAAQ3b,MACX/J,EAAG0lB,EAAQ1b,QAMR6a,IAYL,SAAU38C,EAAQpH,GAII,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,yBACN,yBACC,SAAU8jD,GACX,OAAO/jD,EAASoH,EAAQ28C,KAEC,iBAAVh0C,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,eAIVgH,EAAOi/C,WAAarmD,EAClBoH,EACAA,EAAO28C,YArBb,CAyBG38C,OAAQ,SAAkBA,EAAQ28C,GAMrC,SAASsC,KAGT,IAAIzS,EAAQyS,EAAWngD,UAAYwS,OAAOs4B,OAAQ+S,EAAW79C,WAkO7D,OA9NA0tC,EAAM0S,YAAc,WAClB3lD,KAAK4lD,cAAc,IAGrB3S,EAAM4S,cAAgB,WACpB7lD,KAAK4lD,cAAc,IAOrB3S,EAAM2S,aAAe,SAAUpC,GAK7B,IAAM,IADFC,GAFJD,OAAoB9uC,IAAX8uC,KAAgCA,GAEf,mBAAqB,sBACrCh3C,EAAE,EAAGA,EAAIxM,KAAK8lD,QAAQ9+C,OAAQwF,IAAM,CAC5C,IAAIu5C,EAAS/lD,KAAK8lD,QAAQt5C,GAC1BxM,KAAKsjD,gBAAiByC,EAAQvC,GAC9BuC,EAAQtC,GAAc,QAASzjD,MAG1ByG,EAAOi9C,eACVqC,EAAO9jD,MAAM+jD,YAAcxC,EAASxjD,KAAKimD,kBAAoB,MAMnEhT,EAAMgT,kBAAoB,OAS1BhT,EAAMkR,YAAc,SAAUzxB,EAAOuxB,GAEnC,GAA8B,SAAzBvxB,EAAMtP,OAAOgmB,UAA4C,SAArB1W,EAAMtP,OAAOrf,KAIpD,OAFA/D,KAAKg8C,eAAgB,cACdh8C,KAAK6jD,kBAId7jD,KAAKkmD,iBAAkBxzB,EAAOuxB,GAE9B,IAAIkC,EAAUrkD,SAAS+mB,cAClBs9B,GAAWA,EAAQtrB,MACtBsrB,EAAQtrB,OAGV76B,KAAKokD,qBAAsB1xB,GAC3B1yB,KAAKyzC,UAAW,eAAiB/gB,EAAOuxB,KAI1ChR,EAAMiT,iBAAmB,SAAUxzB,EAAOuxB,GAExCjkD,KAAKomD,iBAAmBhD,EAAWqC,gBAAiBxB,GAE5BjkD,KAAKqmD,+BAAgC3zB,EAAOuxB,IAElEvxB,EAAMroB,kBAKV4oC,EAAMoT,+BAAiC,SAAU3zB,GAE/C,MAAgC,UAAzBA,EAAMtP,OAAOgmB,UAUtB6J,EAAM6R,YAAc,SAAUpyB,EAAOuxB,GACnC,IAAIqC,EAAatmD,KAAKumD,iBAAkB7zB,EAAOuxB,GAC/CjkD,KAAKyzC,UAAW,eAAiB/gB,EAAOuxB,EAASqC,IACjDtmD,KAAKwmD,UAAW9zB,EAAOuxB,EAASqC,IAIlCrT,EAAMsT,iBAAmB,SAAU7zB,EAAOuxB,GACxC,IAAIwC,EAAYrD,EAAWqC,gBAAiBxB,GACxCqC,GACFhoB,EAAGmoB,EAAUnoB,EAAIt+B,KAAKomD,iBAAiB9nB,EACvCC,EAAGkoB,EAAUloB,EAAIv+B,KAAKomD,iBAAiB7nB,GAMzC,OAHMv+B,KAAK0mD,YAAc1mD,KAAK2mD,eAAgBL,IAC5CtmD,KAAK4mD,WAAYl0B,EAAOuxB,GAEnBqC,GAITrT,EAAM0T,eAAiB,SAAUL,GAC/B,OAAOr9C,KAAKq3B,IAAKgmB,EAAWhoB,GAAM,GAAKr1B,KAAKq3B,IAAKgmB,EAAW/nB,GAAM,GAWpE0U,EAAMkS,UAAY,SAAUzyB,EAAOuxB,GACjCjkD,KAAKyzC,UAAW,aAAe/gB,EAAOuxB,IACtCjkD,KAAK6mD,eAAgBn0B,EAAOuxB,IAG9BhR,EAAM4T,eAAiB,SAAUn0B,EAAOuxB,GACjCjkD,KAAK0mD,WACR1mD,KAAK8mD,SAAUp0B,EAAOuxB,GAGtBjkD,KAAK+mD,aAAcr0B,EAAOuxB,IAO9BhR,EAAM2T,WAAa,SAAUl0B,EAAOuxB,GAClCjkD,KAAK0mD,YAAa,EAClB1mD,KAAKgnD,eAAiB5D,EAAWqC,gBAAiBxB,GAElDjkD,KAAKinD,oBAAqB,EAE1BjnD,KAAKknD,UAAWx0B,EAAOuxB,IAGzBhR,EAAMiU,UAAY,SAAUx0B,EAAOuxB,GACjCjkD,KAAKyzC,UAAW,aAAe/gB,EAAOuxB,KAIxChR,EAAMuT,UAAY,SAAU9zB,EAAOuxB,EAASqC,GAEpCtmD,KAAK0mD,YAIX1mD,KAAKmnD,SAAUz0B,EAAOuxB,EAASqC,IAGjCrT,EAAMkU,SAAW,SAAUz0B,EAAOuxB,EAASqC,GACzC5zB,EAAMroB,iBACNrK,KAAKyzC,UAAW,YAAc/gB,EAAOuxB,EAASqC,KAIhDrT,EAAM6T,SAAW,SAAUp0B,EAAOuxB,GAEhCjkD,KAAK0mD,YAAa,EAElBx/C,WAAY,kBACHlH,KAAKinD,oBACZG,KAAMpnD,OAERA,KAAKqnD,QAAS30B,EAAOuxB,IAGvBhR,EAAMoU,QAAU,SAAU30B,EAAOuxB,GAC/BjkD,KAAKyzC,UAAW,WAAa/gB,EAAOuxB,KAMtChR,EAAMhK,QAAU,SAAUvW,GACnB1yB,KAAKinD,oBACRv0B,EAAMroB,kBAOV4oC,EAAM8T,aAAe,SAAUr0B,EAAOuxB,GAEpC,IAAKjkD,KAAKsnD,mBAAmC,WAAd50B,EAAM3uB,KAArC,CAKA,IAAIqlC,EAAW1W,EAAMtP,OAAOgmB,SACX,SAAZA,GAAmC,YAAZA,GAC1B1W,EAAMtP,OAAOiI,QAEfrrB,KAAKunD,YAAa70B,EAAOuxB,GAGN,WAAdvxB,EAAM3uB,OACT/D,KAAKsnD,mBAAoB,EAEzBpgD,WAAY,kBACHlH,KAAKsnD,mBACZF,KAAMpnD,MAAQ,QAIpBizC,EAAMsU,YAAc,SAAU70B,EAAOuxB,GACnCjkD,KAAKyzC,UAAW,eAAiB/gB,EAAOuxB,KAK1CyB,EAAWD,gBAAkBrC,EAAWqC,gBAIjCC,IAKL,SAAUj/C,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,oBACN,aACA,wBACA,wBACC,SAAUm5C,EAAUiN,EAAYlkD,GACjC,OAAOnC,EAASoH,EAAQgyC,EAAUiN,EAAYlkD,KAErB,iBAAV4N,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,cACRA,QAAQ,cACRA,QAAQ,mBAIVgH,EAAOgyC,SAAWp5C,EAChBoH,EACAA,EAAOgyC,SACPhyC,EAAOi/C,WACPj/C,EAAO+vC,cA1Bb,CA8BG/vC,OAAQ,SAAkBA,EAAQgyC,EAAUiN,EAAYlkD,GA0I3D,SAASgmD,EAAmB90B,GAC1B,IAAI+0B,EAA6B,cAAd/0B,EAAM3uB,KACrB2jD,EAAsC,SAArBh1B,EAAMi1B,YACvBC,EAAcC,EAAYn1B,EAAMtP,OAAOgmB,UAC3C,OAAOqe,GAAgBC,GAAkBE,EAyM3C,SAASE,IACP,OACExpB,EAAG73B,EAAOshD,YACVxpB,EAAG93B,EAAOuhD,aApVdxmD,EAAMV,OAAQ23C,EAAS13C,UACrBknD,WAAW,EACXC,cAAe,IAKjBzP,EAASwF,cAAcnwC,KAAK,eAI5B,IAAImlC,EAAQwF,EAASlzC,UACrB/D,EAAMV,OAAQmyC,EAAOyS,EAAWngD,WAChC0tC,EAAMgT,kBAAoB,QAI1B,IAAIkC,EAAU,gBAAiBrmD,SAC3BsmD,GAA4B,EAEhCnV,EAAMoV,YAAc,WAClBroD,KAAK8F,GAAI,WAAY9F,KAAKsoD,UAC1BtoD,KAAK8F,GAAI,WAAY9F,KAAKuoD,eAC1BvoD,KAAK8F,GAAI,qBAAsB9F,KAAKwoD,yBACpCxoD,KAAK8F,GAAI,aAAc9F,KAAKyoD,YAGvBN,IAAYC,IACf3hD,EAAOmxC,iBAAkB,YAAa,cACtCwQ,GAA4B,IAIhCnV,EAAMqV,SAAW,WACTtoD,KAAKF,QAAQmoD,YAAajoD,KAAK0oD,cAGrC1oD,KAAKC,QAAQm6C,UAAU52B,IAAI,gBAC3BxjB,KAAK8lD,SAAY9lD,KAAKm+C,UACtBn+C,KAAK2lD,cACL3lD,KAAK0oD,aAAc,IAGrBzV,EAAMwV,WAAa,WACXzoD,KAAK0oD,cAGX1oD,KAAKC,QAAQm6C,UAAUzrC,OAAO,gBAC9B3O,KAAK6lD,uBACE7lD,KAAK0oD,cAGdzV,EAAMsV,cAAgB,kBACbvoD,KAAKi8C,iBAGdhJ,EAAMuV,wBAA0B,SAAU91B,GACxCA,EAAMroB,iBACNrK,KAAK2oD,iBAAkBj2B,IAMzB,IAAIk2B,GACFC,UAAU,EACVC,OAAO,EACPC,QAAQ,GAINC,GACFC,OAAO,EACPC,UAAU,EACV/lB,QAAQ,EACRgmB,QAAQ,EACR/zB,OAAO,EACPg0B,MAAM,GAGRnW,EAAMkR,YAAc,SAAUzxB,EAAOuxB,GAInC,GAFoB2E,EAAal2B,EAAMtP,OAAOgmB,YAC3C4f,EAAYt2B,EAAMtP,OAAOrf,MAK1B,OAFA/D,KAAKg8C,eAAgB,cACdh8C,KAAK6jD,kBAId7jD,KAAKkmD,iBAAkBxzB,EAAOuxB,GAG9B,IAAIkC,EAAUrkD,SAAS+mB,cAClBs9B,GAAWA,EAAQtrB,MAAQsrB,GAAWnmD,KAAKC,SAE9CkmD,GAAWrkD,SAASuG,MACpB89C,EAAQtrB,OAEV76B,KAAK2oD,iBAAkBj2B,GAEvB1yB,KAAK+8C,MAAQ/8C,KAAKs+B,EAClBt+B,KAAKm+C,SAAS/D,UAAU52B,IAAI,mBAE5BxjB,KAAKokD,qBAAsB1xB,GAE3B1yB,KAAKqpD,kBAAoBvB,IACzBrhD,EAAOmxC,iBAAkB,SAAU53C,MAEnCA,KAAK47C,cAAe,cAAelpB,GAASuxB,KAG9ChR,EAAM0V,iBAAmB,SAAUj2B,GAEjC,IAAI42B,EAAiB9B,EAAmB90B,GACxC,GAAM1yB,KAAKF,QAAQ69C,gBAAiB2L,EAApC,CAGA,IAAIC,EAAc9iD,EAAOuhD,YACzBhoD,KAAKC,QAAQorB,QAER5kB,EAAOuhD,aAAeuB,GACzB9iD,EAAO+iD,SAAU/iD,EAAOshD,YAAawB,KAIzC,IAAI1B,GACFiB,OAAO,EACPW,QAAQ,GAyNV,OA/MAxW,EAAMoT,+BAAiC,SAAU3zB,GAG/C,OADqB80B,EAAmB90B,IAM1CugB,EAAM0T,eAAiB,SAAUL,GAC/B,OAAOr9C,KAAKq3B,IAAKgmB,EAAWhoB,GAAMt+B,KAAKF,QAAQooD,eAKjDjV,EAAMkS,UAAY,SAAUzyB,EAAOuxB,UAC1BjkD,KAAK0pD,iBACZ1pD,KAAKm+C,SAAS/D,UAAUzrC,OAAO,mBAC/B3O,KAAK47C,cAAe,YAAalpB,GAASuxB,IAC1CjkD,KAAK6mD,eAAgBn0B,EAAOuxB,IAG9BhR,EAAMmS,YAAc,WAClB3+C,EAAOw8C,oBAAqB,SAAUjjD,aAC/BA,KAAKqpD,mBAKdpW,EAAMiU,UAAY,SAAUx0B,EAAOuxB,GACjCjkD,KAAK2pD,kBAAoB3pD,KAAKs+B,EAC9Bt+B,KAAK06C,iBACLj0C,EAAOw8C,oBAAqB,SAAUjjD,MACtCA,KAAK47C,cAAe,YAAalpB,GAASuxB,KAG5ChR,EAAM6R,YAAc,SAAUpyB,EAAOuxB,GACnC,IAAIqC,EAAatmD,KAAKumD,iBAAkB7zB,EAAOuxB,GAC/CjkD,KAAK47C,cAAe,cAAelpB,GAASuxB,EAASqC,IACrDtmD,KAAKwmD,UAAW9zB,EAAOuxB,EAASqC,IAGlCrT,EAAMkU,SAAW,SAAUz0B,EAAOuxB,EAASqC,GACzC5zB,EAAMroB,iBAENrK,KAAK4pD,cAAgB5pD,KAAK+8C,MAE1B,IAAI8M,EAAY7pD,KAAKF,QAAQw7C,aAAe,EAAI,EAC5CyB,EAAQ/8C,KAAK2pD,kBAAoBrD,EAAWhoB,EAAIurB,EAEpD,IAAM7pD,KAAKF,QAAQq7C,YAAcn7C,KAAK86B,OAAO9zB,OAAS,CAEpD,IAAI8iD,EAAc7gD,KAAKC,KAAMlJ,KAAK86B,OAAO,GAAG1X,OAAQpjB,KAAK2pD,mBACzD5M,EAAQA,EAAQ+M,EAAwC,IAAxB/M,EAAQ+M,GAAsB/M,EAC9D,IAAIiE,EAAW/3C,KAAK22B,KAAM5/B,KAAKg/C,eAAe57B,OAAQpjB,KAAK2pD,mBAC3D5M,EAAQA,EAAQiE,EAAkC,IAArBjE,EAAQiE,GAAmBjE,EAG1D/8C,KAAK+8C,MAAQA,EAEb/8C,KAAK+pD,aAAe,IAAI5nB,KACxBniC,KAAK47C,cAAe,WAAYlpB,GAASuxB,EAASqC,KAGpDrT,EAAMoU,QAAU,SAAU30B,EAAOuxB,GAC1BjkD,KAAKF,QAAQkqD,aAChBhqD,KAAKi8C,iBAAkB,GAGzB,IAAInvC,EAAQ9M,KAAKiqD,uBAEjB,GAAKjqD,KAAKF,QAAQkqD,aAAehqD,KAAKF,QAAQq7C,WAAa,CAIzD,IAAI+O,EAAWlqD,KAAK68C,qBACpB78C,KAAKi8C,iBAAmBiO,EAAWlqD,KAAK86B,OAAO,GAAG1X,SAC/C8mC,EAAWlqD,KAAKg/C,eAAe57B,YACvBpjB,KAAKF,QAAQkqD,YAAcl9C,GAAS9M,KAAKI,gBAEpD0M,GAAS9M,KAAKmqD,6BAETnqD,KAAK4pD,cAIZ5pD,KAAK4hD,aAAe5hD,KAAKF,QAAQq7C,WACjCn7C,KAAKmG,OAAQ2G,UACN9M,KAAK4hD,aACZ5hD,KAAK47C,cAAe,UAAWlpB,GAASuxB,KAG1ChR,EAAMgX,qBAAuB,WAC3B,IAAIC,EAAWlqD,KAAK68C,qBAEhBnU,EAAWz/B,KAAKq3B,IAAKtgC,KAAKoqD,kBAAmBF,EAAUlqD,KAAKI,gBAE5DiqD,EAAkBrqD,KAAKsqD,mBAAoBJ,EAAUxhB,EAAU,GAC/D6hB,EAAkBvqD,KAAKsqD,mBAAoBJ,EAAUxhB,GAAW,GAIpE,OAFY2hB,EAAgB3hB,SAAW6hB,EAAgB7hB,SACrD2hB,EAAgBv9C,MAAQy9C,EAAgBz9C,OAY5CmmC,EAAMqX,mBAAqB,SAAUJ,EAAUxhB,EAAUgY,GAMvD,IALA,IAAI5zC,EAAQ9M,KAAKI,cACboqD,EAAcC,EAAAA,EACdC,EAAY1qD,KAAKF,QAAQ6gD,UAAY3gD,KAAKF,QAAQq7C,WAEpD,SAAU3W,EAAGmmB,GAAO,OAAOnmB,GAAKmmB,GAAQ,SAAUnmB,EAAGmmB,GAAO,OAAOnmB,EAAImmB,GACjED,EAAWhiB,EAAU8hB,KAE3B19C,GAAS4zC,EACT8J,EAAc9hB,EAEI,QADlBA,EAAW1oC,KAAKoqD,kBAAmBF,EAAUp9C,MAI7C47B,EAAWz/B,KAAKq3B,IAAKoI,GAEvB,OACEA,SAAU8hB,EAEV19C,MAAOA,EAAQ4zC,IASnBzN,EAAMmX,iBAAmB,SAAU9rB,EAAGxxB,GACpC,IAAIwyC,EAAMt/C,KAAK86B,OAAO9zB,OAElB4jD,EAAe5qD,KAAKF,QAAQq7C,YAAcmE,EAAM,EAChDmD,EAAamI,EAAeppD,EAAMi1C,OAAQ3pC,EAAOwyC,GAAQxyC,EACzDowB,EAAQl9B,KAAK86B,OAAQ2nB,GACzB,IAAMvlB,EACJ,OAAO,KAGT,IAAI2tB,EAAOD,EAAe5qD,KAAKq5C,eAAiBpwC,KAAK42B,MAAO/yB,EAAQwyC,GAAQ,EAC5E,OAAOhhB,GAAMpB,EAAM9Z,OAASynC,IAG9B5X,EAAMkX,mBAAqB,WAEzB,QAA4Bz1C,IAAvB1U,KAAK4pD,gBAAgC5pD,KAAK+pD,cAE7C,IAAI5nB,KAASniC,KAAK+pD,aAAe,IACjC,OAAO,EAGT,IAAIrhB,EAAW1oC,KAAKoqD,kBAAmBpqD,KAAK+8C,MAAO/8C,KAAKI,eACpDqhD,EAAQzhD,KAAK4pD,cAAgB5pD,KAAK+8C,MACtC,OAAKrU,EAAW,GAAK+Y,EAAQ,EAEpB,EACG/Y,EAAW,GAAK+Y,EAAQ,GAE1B,EAEH,GAKTxO,EAAMsU,YAAc,SAAU70B,EAAOuxB,GAEnC,IAAI6G,EAAc9qD,KAAKqiD,cAAe3vB,EAAMtP,QACxC27B,EAAW+L,GAAeA,EAAY7qD,QACtCugD,EAAYsK,GAAe9qD,KAAKw5C,MAAM10C,QAASgmD,GACnD9qD,KAAK47C,cAAe,cAAelpB,GAASuxB,EAASlF,EAAUyB,KAKjEvN,EAAM8X,SAAW,WACf,IAAIC,EAASlD,IACTmD,EAAcjrD,KAAKqpD,kBAAkB/qB,EAAI0sB,EAAO1sB,EAChD4sB,EAAclrD,KAAKqpD,kBAAkB9qB,EAAIysB,EAAOzsB,GAE/Ct1B,KAAKq3B,IAAK2qB,GAAgB,GAAKhiD,KAAKq3B,IAAK4qB,GAAgB,IAC5DlrD,KAAKklD,gBAeFzM,IAYL,SAAUhyC,EAAQpH,GAII,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,6BACN,yBACC,SAAU8jD,GACX,OAAO/jD,EAASoH,EAAQ28C,KAEC,iBAAVh0C,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,eAIVgH,EAAO0kD,YAAc9rD,EACnBoH,EACAA,EAAO28C,YArBb,CAyBG38C,OAAQ,SAAkBA,EAAQ28C,GAMrC,SAAS+H,EAAa/b,GACpBpvC,KAAKorD,QAAShc,GAIhB,IAAI6D,EAAQkY,EAAY5lD,UAAYwS,OAAOs4B,OAAQ+S,EAAW79C,WAkE9D,OA5DA0tC,EAAMmY,QAAU,SAAUhc,GAClBA,IAGNpvC,KAAKqrD,YACLrrD,KAAKsrD,WAAalc,EAClBpvC,KAAKsjD,gBAAiBlU,GAAM,KAG9B6D,EAAMoY,UAAY,WACVrrD,KAAKsrD,aAGXtrD,KAAKsjD,gBAAiBtjD,KAAKsrD,YAAY,UAChCtrD,KAAKsrD,aAQdrY,EAAMkS,UAAY,SAAUzyB,EAAOuxB,GAEjC,IAAKjkD,KAAKsnD,mBAAmC,WAAd50B,EAAM3uB,KAArC,CAIA,IAAIwnD,EAAenI,EAAWqC,gBAAiBxB,GAC3CuH,EAAexrD,KAAKsrD,WAAW3nB,wBAC/B8nB,EAAUhlD,EAAOshD,YACjB2D,EAAUjlD,EAAOuhD,YAYrB,GAVeuD,EAAajtB,GAAKktB,EAAa5iD,KAAO6iD,GACnDF,EAAajtB,GAAKktB,EAAavnB,MAAQwnB,GACvCF,EAAahtB,GAAKitB,EAAa7iD,IAAM+iD,GACrCH,EAAahtB,GAAKitB,EAAarnB,OAASunB,GAGxC1rD,KAAKyzC,UAAW,OAAS/gB,EAAOuxB,IAIf,WAAdvxB,EAAM3uB,KAAoB,CAC7B/D,KAAKsnD,mBAAoB,EAEzB,IAAI5P,EAAQ13C,KACZkH,WAAY,kBACHwwC,EAAM4P,mBACZ,QAIPrU,EAAMhO,QAAU,WACdjlC,KAAKolD,cACLplD,KAAKqrD,aAKAF,IAKL,SAAU1kD,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,gCACN,aACA,4BACA,wBACC,SAAUm5C,EAAU0S,EAAa3pD,GAClC,OAAOnC,EAASoH,EAAQgyC,EAAU0S,EAAa3pD,KAEtB,iBAAV4N,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,cACRA,QAAQ,gBACRA,QAAQ,mBAIVJ,EACEoH,EACAA,EAAOgyC,SACPhyC,EAAO0kD,YACP1kD,EAAO+vC,cA1Bb,CA8BG/vC,OAAQ,SAAkBA,EAAQgyC,EAAU0S,EAAa3pD,GAC5D,aAMA,SAASmqD,EAAgB9B,EAAWzhD,GAClCpI,KAAK6pD,UAAYA,EACjB7pD,KAAKoI,OAASA,EACdpI,KAAKy9C,UAgEP,SAASmO,EAAmBC,GAE1B,MAAqB,iBAATA,EACHA,EAGF,KAAOA,EAAMC,GAAK,SACfD,EAAME,GAAK,KAAQF,EAAMG,GAAK,IACtC,MAAQH,EAAMI,GAAK,KAAQJ,EAAMK,GAAK,IACtC,MAAQL,EAAMM,GAAK,UACXN,EAAMI,GAAK,KAAQ,GAAKJ,EAAMK,IACtC,MAAQL,EAAME,GAAK,KAAQ,GAAKF,EAAMG,IACtC,KAnFJ,IAAII,EAAS,8BAUbT,EAAepmD,UAAY,IAAI4lD,GAEN1N,QAAU,WAEjCz9C,KAAKqsD,WAAY,EACjBrsD,KAAKssD,YAAgC,GAAnBtsD,KAAK6pD,UACvB,IAAI0C,EAAgBvsD,KAAKoI,OAAOtI,QAAQw7C,YAAc,GAAK,EAC3Dt7C,KAAKwsD,OAASxsD,KAAK6pD,WAAa0C,EAEhC,IAAItsD,EAAUD,KAAKC,QAAU6B,SAASC,cAAc,UACpD9B,EAAQ+B,UAAY,4BACpB/B,EAAQ+B,WAAahC,KAAKssD,WAAa,YAAc,QAErDrsD,EAAQyF,aAAc,OAAQ,UAE9B1F,KAAK+H,UAEL9H,EAAQyF,aAAc,aAAc1F,KAAKssD,WAAa,WAAa,QAGnE,IAAIG,EAAMzsD,KAAK0sD,YACfzsD,EAAQy0C,YAAa+X,GAErBzsD,KAAK8F,GAAI,MAAO9F,KAAK0tC,OACrB1tC,KAAKoI,OAAOtC,GAAI,SAAU9F,KAAK+kB,OAAOqiC,KAAMpnD,OAC5CA,KAAK8F,GAAI,cAAe9F,KAAKoI,OAAOu6C,mBAAmByE,KAAMpnD,KAAKoI,UAGpEujD,EAAepmD,UAAUQ,SAAW,WAClC/F,KAAKorD,QAASprD,KAAKC,SAEnBD,KAAKC,QAAQ23C,iBAAkB,QAAS53C,MAExCA,KAAKoI,OAAOnI,QAAQy0C,YAAa10C,KAAKC,UAGxC0rD,EAAepmD,UAAU4nB,WAAa,WAEpCntB,KAAKoI,OAAOnI,QAAQ20C,YAAa50C,KAAKC,SAEtCkrD,EAAY5lD,UAAU0/B,QAAQr6B,KAAM5K,MAEpCA,KAAKC,QAAQgjD,oBAAqB,QAASjjD,OAG7C2rD,EAAepmD,UAAUmnD,UAAY,WACnC,IAAID,EAAM3qD,SAAS6qD,gBAAiBP,EAAQ,OAC5CK,EAAI/mD,aAAc,UAAW,eAC7B,IAAIuR,EAAOnV,SAAS6qD,gBAAiBP,EAAQ,QACzCQ,EAAgBhB,EAAmB5rD,KAAKoI,OAAOtI,QAAQ+sD,YAQ3D,OAPA51C,EAAKvR,aAAc,IAAKknD,GACxB31C,EAAKvR,aAAc,QAAS,SAEtB1F,KAAKwsD,QACTv1C,EAAKvR,aAAc,YAAa,oCAElC+mD,EAAI/X,YAAaz9B,GACVw1C,GAmBTd,EAAepmD,UAAUmoC,MAAQ,WAC/B,GAAM1tC,KAAKqsD,UAAX,CAGArsD,KAAKoI,OAAOs6C,WACZ,IAAIphC,EAASthB,KAAKssD,WAAa,WAAa,OAC5CtsD,KAAKoI,OAAQkZ,OAGfqqC,EAAepmD,UAAUwxC,YAAcv1C,EAAMu1C,YAE7C4U,EAAepmD,UAAU0jC,QAAU,WAEjC,IAAIkd,EAAUrkD,SAAS+mB,cAClBs9B,GAAWA,GAAWnmD,KAAKC,SAC9BD,KAAK0tC,SAMTie,EAAepmD,UAAU0C,OAAS,WAC3BjI,KAAKqsD,YAGVrsD,KAAKC,QAAQ+H,UAAW,EACxBhI,KAAKqsD,WAAY,IAGnBV,EAAepmD,UAAUwC,QAAU,WAC3B/H,KAAKqsD,YAGXrsD,KAAKC,QAAQ+H,UAAW,EACxBhI,KAAKqsD,WAAY,IAGnBV,EAAepmD,UAAUwf,OAAS,WAEhC,IAAI+V,EAAS96B,KAAKoI,OAAO0yB,OAEzB,GAAK96B,KAAKoI,OAAOtI,QAAQq7C,YAAcrgB,EAAO9zB,OAAS,EACrDhH,KAAKiI,aADP,CAIA,IAAI6kD,EAAYhyB,EAAO9zB,OAAS8zB,EAAO9zB,OAAS,EAAI,EAChD+lD,EAAa/sD,KAAKssD,WAAa,EAAIQ,EAEvC9sD,KADaA,KAAKoI,OAAOhI,eAAiB2sD,EAAa,UAAY,cAIrEpB,EAAepmD,UAAU0/B,QAAU,WACjCjlC,KAAKmtB,cAKP3rB,EAAMV,OAAQ23C,EAAS13C,UACrBisD,iBAAiB,EACjBH,YACEf,GAAI,GACJC,GAAI,GAAIC,GAAI,GACZC,GAAI,GAAIC,GAAI,GACZC,GAAI,MAIR1T,EAASwF,cAAcnwC,KAAK,0BAC5B,IAAImlC,EAAQwF,EAASlzC,UA6BrB,OA3BA0tC,EAAMga,uBAAyB,WACvBjtD,KAAKF,QAAQktD,kBAInBhtD,KAAKktD,WAAa,IAAIvB,GAAiB,EAAG3rD,MAC1CA,KAAKmtD,WAAa,IAAIxB,EAAgB,EAAG3rD,MAEzCA,KAAK8F,GAAI,WAAY9F,KAAKotD,2BAG5Bna,EAAMma,wBAA0B,WAC9BptD,KAAKktD,WAAWnnD,WAChB/F,KAAKmtD,WAAWpnD,WAChB/F,KAAK8F,GAAI,aAAc9F,KAAKqtD,4BAG9Bpa,EAAMoa,0BAA4B,WAChCrtD,KAAKktD,WAAW//B,aAChBntB,KAAKmtD,WAAWhgC,aAChBntB,KAAKyO,IAAK,aAAczO,KAAKqtD,4BAK/B5U,EAASkT,eAAiBA,EAEnBlT,IAKL,SAAUhyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,yBACN,aACA,4BACA,wBACC,SAAUm5C,EAAU0S,EAAa3pD,GAClC,OAAOnC,EAASoH,EAAQgyC,EAAU0S,EAAa3pD,KAEtB,iBAAV4N,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,cACRA,QAAQ,gBACRA,QAAQ,mBAIVJ,EACEoH,EACAA,EAAOgyC,SACPhyC,EAAO0kD,YACP1kD,EAAO+vC,cA1Bb,CA8BG/vC,OAAQ,SAAkBA,EAAQgyC,EAAU0S,EAAa3pD,GAM5D,SAAS8rD,EAAUllD,GACjBpI,KAAKoI,OAASA,EACdpI,KAAKy9C,WAGP6P,EAAS/nD,UAAY,IAAI4lD,GAEN1N,QAAU,WAE3Bz9C,KAAKutD,OAASzrD,SAASC,cAAc,MACrC/B,KAAKutD,OAAOvrD,UAAY,qBAExBhC,KAAKwtD,QAELxtD,KAAK8F,GAAI,MAAO9F,KAAK0tC,OACrB1tC,KAAK8F,GAAI,cAAe9F,KAAKoI,OAAOu6C,mBAAmByE,KAAMpnD,KAAKoI,UAGpEklD,EAAS/nD,UAAUQ,SAAW,WAC5B/F,KAAKytD,UACLztD,KAAKorD,QAASprD,KAAKutD,QAEnBvtD,KAAKoI,OAAOnI,QAAQy0C,YAAa10C,KAAKutD,SAGxCD,EAAS/nD,UAAU4nB,WAAa,WAE9BntB,KAAKoI,OAAOnI,QAAQ20C,YAAa50C,KAAKutD,QACtCpC,EAAY5lD,UAAU0/B,QAAQr6B,KAAM5K,OAGtCstD,EAAS/nD,UAAUkoD,QAAU,WAE3B,IAAIhM,EAAQzhD,KAAKoI,OAAO0yB,OAAO9zB,OAAShH,KAAKwtD,KAAKxmD,OAC7Cy6C,EAAQ,EACXzhD,KAAK0tD,QAASjM,GACJA,EAAQ,GAClBzhD,KAAK2tD,YAAalM,IAItB6L,EAAS/nD,UAAUmoD,QAAU,SAAU1zC,GAGrC,IAFA,IAAI4zC,EAAW9rD,SAAS+rD,yBACpBC,KACI9zC,GAAQ,CACd,IAAI+zC,EAAMjsD,SAASC,cAAc,MACjCgsD,EAAI/rD,UAAY,MAChB4rD,EAASlZ,YAAaqZ,GACtBD,EAAQhgD,KAAMigD,GACd/zC,IAEFha,KAAKutD,OAAO7Y,YAAakZ,GACzB5tD,KAAKwtD,KAAOxtD,KAAKwtD,KAAK71C,OAAQm2C,IAGhCR,EAAS/nD,UAAUooD,WAAa,SAAU3zC,GAEvBha,KAAKwtD,KAAKzgC,OAAQ/sB,KAAKwtD,KAAKxmD,OAASgT,EAAOA,GAElDshB,QAAS,SAAUyyB,GAC5B/tD,KAAKutD,OAAO3Y,YAAamZ,IACxB/tD,OAGLstD,EAAS/nD,UAAUyoD,eAAiB,WAE7BhuD,KAAKiuD,cACRjuD,KAAKiuD,YAAYjsD,UAAY,OAGzBhC,KAAKwtD,KAAKxmD,SAGhBhH,KAAKiuD,YAAcjuD,KAAKwtD,KAAMxtD,KAAKoI,OAAOhI,eAC1CJ,KAAKiuD,YAAYjsD,UAAY,oBAG/BsrD,EAAS/nD,UAAUmoC,MAAQ,SAAUhb,GACnC,IAAItP,EAASsP,EAAMtP,OAEnB,GAAwB,MAAnBA,EAAOgmB,SAAZ,CAIAppC,KAAKoI,OAAOs6C,WACZ,IAAI51C,EAAQ9M,KAAKwtD,KAAK1oD,QAASse,GAC/BpjB,KAAKoI,OAAOjC,OAAQ2G,KAGtBwgD,EAAS/nD,UAAU0/B,QAAU,WAC3BjlC,KAAKmtB,cAGPsrB,EAAS6U,SAAWA,EAIpB9rD,EAAMV,OAAQ23C,EAAS13C,UACrBmtD,UAAU,IAGZzV,EAASwF,cAAcnwC,KAAK,mBAE5B,IAAImlC,EAAQwF,EAASlzC,UAmCrB,OAjCA0tC,EAAMkb,gBAAkB,WAChBnuD,KAAKF,QAAQouD,WAGnBluD,KAAKkuD,SAAW,IAAIZ,EAAUttD,MAE9BA,KAAK8F,GAAI,WAAY9F,KAAKouD,kBAC1BpuD,KAAK8F,GAAI,SAAU9F,KAAKquD,wBACxBruD,KAAK8F,GAAI,aAAc9F,KAAKsuD,gBAC5BtuD,KAAK8F,GAAI,SAAU9F,KAAKsuD,gBACxBtuD,KAAK8F,GAAI,aAAc9F,KAAKuuD,sBAG9Btb,EAAMmb,iBAAmB,WACvBpuD,KAAKkuD,SAASnoD,YAGhBktC,EAAMob,uBAAyB,WAC7BruD,KAAKkuD,SAASF,kBAGhB/a,EAAMqb,eAAiB,WACrBtuD,KAAKkuD,SAAST,WAGhBxa,EAAMsb,mBAAqB,WACzBvuD,KAAKkuD,SAAS/gC,cAKhBsrB,EAAS6U,SAAWA,EAEb7U,IAKL,SAAUhyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,sBACN,wBACA,uBACA,cACC,SAAU0zC,EAAWxxC,EAAOi3C,GAC7B,OAAOp5C,EAAS2zC,EAAWxxC,EAAOi3C,KAET,iBAAVrpC,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfI,QAAQ,cACRA,QAAQ,kBACRA,QAAQ,eAIVJ,EACEoH,EAAOusC,UACPvsC,EAAO+vC,aACP/vC,EAAOgyC,UAxBb,CA4BGhyC,OAAQ,SAAkBusC,EAAWxxC,EAAOi3C,GAkB/C,SAAS+V,EAAQpmD,GACfpI,KAAKoI,OAASA,EACdpI,KAAK0iB,MAAQ,UAER+rC,IACHzuD,KAAK0uD,mBAAqB,WACxB1uD,KAAK2uD,oBACLvH,KAAMpnD,MACRA,KAAK4uD,iBAAmB,WACtB5uD,KAAK6uD,kBACLzH,KAAMpnD,OArBZ,IAAI8uD,EAAgBL,EACf,WAAY3sD,UACfgtD,EAAiB,SACjBL,EAAkB,oBACR,iBAAkB3sD,WAC5BgtD,EAAiB,eACjBL,EAAkB,2BAmBpBD,EAAOjpD,UAAYwS,OAAOs4B,OAAQ2C,EAAUztC,YAG3BwpD,KAAO,WACtB,GAAmB,WAAd/uD,KAAK0iB,MAAV,CAIA,IAAIssC,EAAeltD,SAAUgtD,GACxBL,GAAmBO,EACtBltD,SAAS81C,iBAAkB6W,EAAiBzuD,KAAK4uD,mBAInD5uD,KAAK0iB,MAAQ,UAER+rC,GACH3sD,SAAS81C,iBAAkB6W,EAAiBzuD,KAAK0uD,oBAGnD1uD,KAAKivD,UAGPT,EAAOjpD,UAAU0pD,KAAO,WAEtB,GAAmB,WAAdjvD,KAAK0iB,MAAV,CAIA,IAAIwsC,EAAOlvD,KAAKoI,OAAOtI,QAAQqvD,SAE/BD,EAAsB,iBAARA,EAAmBA,EAAO,IACxC,IAAIxX,EAAQ13C,KAEZA,KAAK8H,QACL9H,KAAKoZ,QAAUlS,WAAY,WACzBwwC,EAAMtvC,OAAOg0B,MAAM,GACnBsb,EAAMuX,QACLC,KAGLV,EAAOjpD,UAAU6oB,KAAO,WACtBpuB,KAAK0iB,MAAQ,UACb1iB,KAAK8H,QAEA2mD,GACH3sD,SAASmhD,oBAAqBwL,EAAiBzuD,KAAK0uD,qBAIxDF,EAAOjpD,UAAUuC,MAAQ,WACvB1B,aAAcpG,KAAKoZ,UAGrBo1C,EAAOjpD,UAAU6pD,MAAQ,WACJ,WAAdpvD,KAAK0iB,QACR1iB,KAAK0iB,MAAQ,SACb1iB,KAAK8H,UAIT0mD,EAAOjpD,UAAU8pD,QAAU,WAEN,UAAdrvD,KAAK0iB,OACR1iB,KAAK+uD,QAKTP,EAAOjpD,UAAUopD,iBAAmB,WAElC3uD,KADmB8B,SAAUgtD,GACR,QAAU,cAGjCN,EAAOjpD,UAAUspD,eAAiB,WAChC7uD,KAAK+uD,OACLjtD,SAASmhD,oBAAqBwL,EAAiBzuD,KAAK4uD,mBAKtDptD,EAAMV,OAAQ23C,EAAS13C,UACrBuuD,sBAAsB,IAGxB7W,EAASwF,cAAcnwC,KAAK,iBAC5B,IAAImlC,EAAQwF,EAASlzC,UA+DrB,OA7DA0tC,EAAMsc,cAAgB,WACpBvvD,KAAKwvD,OAAS,IAAIhB,EAAQxuD,MAE1BA,KAAK8F,GAAI,WAAY9F,KAAKyvD,gBAC1BzvD,KAAK8F,GAAI,WAAY9F,KAAK0vD,YAC1B1vD,KAAK8F,GAAI,cAAe9F,KAAK0vD,YAC7B1vD,KAAK8F,GAAI,aAAc9F,KAAK2vD,mBAG9B1c,EAAMwc,eAAiB,WACfzvD,KAAKF,QAAQqvD,WAGnBnvD,KAAKwvD,OAAOT,OACZ/uD,KAAKC,QAAQ23C,iBAAkB,aAAc53C,QAK/CizC,EAAM2c,WAAa,WACjB5vD,KAAKwvD,OAAOT,QAGd9b,EAAMyc,WAAa,WACjB1vD,KAAKwvD,OAAOphC,QAGd6kB,EAAM4c,YAAc,WAClB7vD,KAAKwvD,OAAOJ,SAGdnc,EAAM6c,cAAgB,WACpB9vD,KAAKwvD,OAAOH,WAGdpc,EAAM0c,iBAAmB,WACvB3vD,KAAKwvD,OAAOphC,OACZpuB,KAAKC,QAAQgjD,oBAAqB,aAAcjjD,OAMlDizC,EAAM8c,aAAe,WACb/vD,KAAKF,QAAQwvD,uBAGnBtvD,KAAKwvD,OAAOJ,QACZpvD,KAAKC,QAAQ23C,iBAAkB,aAAc53C,QAI/CizC,EAAM+c,aAAe,WACnBhwD,KAAKwvD,OAAOH,UACZrvD,KAAKC,QAAQgjD,oBAAqB,aAAcjjD,OAKlDy4C,EAAS+V,OAASA,EAEX/V,IAKL,SAAUhyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,+BACN,aACA,wBACC,SAAUm5C,EAAUj3C,GACrB,OAAOnC,EAASoH,EAAQgyC,EAAUj3C,KAET,iBAAV4N,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,cACRA,QAAQ,mBAIVJ,EACEoH,EACAA,EAAOgyC,SACPhyC,EAAO+vC,cAvBb,CA2BG/vC,OAAQ,SAAkBA,EAAQgyC,EAAUj3C,GAK/C,SAASyuD,EAAkBzW,GACzB,IAAIoU,EAAW9rD,SAAS+rD,yBAIxB,OAHArU,EAAMle,QAAS,SAAUoe,GACvBkU,EAASlZ,YAAagF,EAAKz5C,WAEtB2tD,EAKT,IAAI3a,EAAQwF,EAASlzC,UAwIrB,OAjIA0tC,EAAMid,OAAS,SAAUjZ,EAAOnqC,GAC9B,IAAI0sC,EAAQx5C,KAAK4+C,WAAY3H,GAC7B,GAAMuC,GAAUA,EAAMxyC,OAAtB,CAGA,IAAIs4C,EAAMt/C,KAAKw5C,MAAMxyC,OAErB8F,OAAkB4H,IAAV5H,EAAsBwyC,EAAMxyC,EAEpC,IAAI8gD,EAAWqC,EAAkBzW,GAE7B2W,EAAWrjD,GAASwyC,EACxB,GAAK6Q,EACHnwD,KAAKu7C,OAAO7G,YAAakZ,OACpB,CACL,IAAIwC,EAAoBpwD,KAAKw5C,MAAO1sC,GAAQ7M,QAC5CD,KAAKu7C,OAAO8U,aAAczC,EAAUwC,GAGtC,GAAe,IAAVtjD,EAEH9M,KAAKw5C,MAAQA,EAAM7hC,OAAQ3X,KAAKw5C,YAC3B,GAAK2W,EAEVnwD,KAAKw5C,MAAQx5C,KAAKw5C,MAAM7hC,OAAQ6hC,OAC3B,CAEL,IAAI8W,EAAWtwD,KAAKw5C,MAAMzsB,OAAQjgB,EAAOwyC,EAAMxyC,GAC/C9M,KAAKw5C,MAAQx5C,KAAKw5C,MAAM7hC,OAAQ6hC,GAAQ7hC,OAAQ24C,GAGlDtwD,KAAKi/C,WAAYzF,GAEjB,IAAI+W,EAAqBzjD,EAAQ9M,KAAKI,cAAgB,EAAIo5C,EAAMxyC,OAChEhH,KAAKwwD,kBAAmB1jD,EAAOyjD,KAGjCtd,EAAM1lC,OAAS,SAAU0pC,GACvBj3C,KAAKkwD,OAAQjZ,EAAOj3C,KAAKw5C,MAAMxyC,SAGjCisC,EAAMnQ,QAAU,SAAUmU,GACxBj3C,KAAKkwD,OAAQjZ,EAAO,IAOtBhE,EAAMtkC,OAAS,SAAUsoC,GACvB,IAGIzqC,EAAGktC,EAHHF,EAAQx5C,KAAKoiD,SAAUnL,GACvBsZ,EAAqB,EACrBjR,EAAM9F,EAAMxyC,OAGhB,IAAMwF,EAAE,EAAGA,EAAI8yC,EAAK9yC,IAClBktC,EAAOF,EAAMhtC,GAEb+jD,GADgBvwD,KAAKw5C,MAAM10C,QAAS40C,GAAS15C,KAAKI,cAChB,EAAI,EAGxC,IAAMoM,EAAE,EAAGA,EAAI8yC,EAAK9yC,KAClBktC,EAAOF,EAAMhtC,IACRmC,SAELnN,EAAMm1C,WAAY32C,KAAKw5C,MAAOE,GAG3BF,EAAMxyC,QAEThH,KAAKwwD,kBAAmB,EAAGD,IAK/Btd,EAAMud,kBAAoB,SAAUC,EAAkBF,GAEpDA,EAAqBA,GAAsB,EAC3CvwD,KAAKI,eAAiBmwD,EACtBvwD,KAAKI,cAAgB6I,KAAKC,IAAK,EAAGD,KAAK22B,IAAK5/B,KAAK86B,OAAO9zB,OAAS,EAAGhH,KAAKI,gBAEzEJ,KAAK0wD,WAAYD,GAAkB,GAEnCzwD,KAAKyzC,UAAW,oBAAsBgd,EAAkBF,KAO1Dtd,EAAM0d,eAAiB,SAAUvhB,GAC/B,IAAIsK,EAAO15C,KAAKmiD,QAAS/S,GACzB,GAAMsK,EAAN,CAGAA,EAAK9F,UAEL,IAAI9mC,EAAQ9M,KAAKw5C,MAAM10C,QAAS40C,GAChC15C,KAAK0wD,WAAY5jD,KAOnBmmC,EAAMyd,WAAa,SAAUD,EAAkBG,GAC7C,IAAIC,EAAqB7wD,KAAKq5C,eAM9B,GALAr5C,KAAKk/C,eAAgBuR,GACrBzwD,KAAK8+C,qBACL9+C,KAAKg+C,iBACLh+C,KAAKyzC,UAAW,cAAgBgd,IAE3BzwD,KAAKF,QAAQkqD,WAAa,CAG7B,IAAI8G,EAASD,EAAqB7wD,KAAKq5C,eACvCr5C,KAAKs+B,GAAKwyB,EAAS9wD,KAAKk5C,UACxBl5C,KAAKg7C,sBAGA4V,GACH5wD,KAAK67C,2BAEP77C,KAAKmG,OAAQnG,KAAKI,gBAMfq4C,IAKL,SAAUhyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,wBACN,aACA,wBACC,SAAUm5C,EAAUj3C,GACrB,OAAOnC,EAASoH,EAAQgyC,EAAUj3C,KAET,iBAAV4N,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,cACRA,QAAQ,mBAIVJ,EACEoH,EACAA,EAAOgyC,SACPhyC,EAAO+vC,cAvBb,CA2BG/vC,OAAQ,SAAkBA,EAAQgyC,EAAUj3C,GAC/C,aA6BA,SAASuvD,EAAmBhS,GAE1B,GAA0B,OAArBA,EAAS3V,UACZ2V,EAASxG,aAAa,0BACtB,OAASwG,GAGX,IAAIiS,EAAOjS,EAAS1H,iBAAiB,+BACrC,OAAO71C,EAAM2oB,UAAW6mC,GAQ1B,SAASC,EAAYC,EAAKC,GACxBnxD,KAAKkxD,IAAMA,EACXlxD,KAAKmxD,SAAWA,EAChBnxD,KAAKoxD,OA9CP3Y,EAASwF,cAAcnwC,KAAK,mBAC5B,IAAImlC,EAAQwF,EAASlzC,UAoFrB,OAlFA0tC,EAAMoe,gBAAkB,WACtBrxD,KAAK8F,GAAI,SAAU9F,KAAKsxD,WAG1Bre,EAAMqe,SAAW,WACf,IAAIA,EAAWtxD,KAAKF,QAAQwxD,SAC5B,GAAMA,EAAN,CAIA,IAAI/O,EAA8B,iBAAZ+O,EAAuBA,EAAW,EAGpDC,KAFYvxD,KAAKsiD,wBAAyBC,GAGpCjnB,QAAS,SAAUyjB,GAC3B,IAAIyS,EAAiBT,EAAmBhS,GACxCwS,EAAaA,EAAW55C,OAAQ65C,KAGlCD,EAAWj2B,QAAS,SAAU41B,GAC5B,IAAID,EAAYC,EAAKlxD,OACpBA,QAyBLixD,EAAW1rD,UAAUwxC,YAAcv1C,EAAMu1C,YAEzCka,EAAW1rD,UAAU6rD,KAAO,WAC1BpxD,KAAKkxD,IAAItZ,iBAAkB,OAAQ53C,MACnCA,KAAKkxD,IAAItZ,iBAAkB,QAAS53C,MAEpCA,KAAKkxD,IAAIx1B,IAAM17B,KAAKkxD,IAAI3Y,aAAa,0BAErCv4C,KAAKkxD,IAAIlO,gBAAgB,2BAG3BiO,EAAW1rD,UAAUksD,OAAS,SAAU/+B,GACtC1yB,KAAKwuB,SAAUkE,EAAO,wBAGxBu+B,EAAW1rD,UAAUmsD,QAAU,SAAUh/B,GACvC1yB,KAAKwuB,SAAUkE,EAAO,uBAGxBu+B,EAAW1rD,UAAUipB,SAAW,SAAUkE,EAAO1wB,GAE/ChC,KAAKkxD,IAAIjO,oBAAqB,OAAQjjD,MACtCA,KAAKkxD,IAAIjO,oBAAqB,QAASjjD,MAEvC,IAAI05C,EAAO15C,KAAKmxD,SAAS9O,cAAeriD,KAAKkxD,KACzCnS,EAAWrF,GAAQA,EAAKz5C,QAC5BD,KAAKmxD,SAASR,eAAgB5R,GAE9B/+C,KAAKkxD,IAAI9W,UAAU52B,IAAKxhB,GACxBhC,KAAKmxD,SAASvV,cAAe,WAAYlpB,EAAOqsB,IAKlDtG,EAASwY,WAAaA,EAEfxY,IAeP,SAAYhyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,qBACN,aACA,SACA,qBACA,cACA,WACA,oBACA,cACCD,GACwB,iBAAV+P,QAAsBA,OAAO5P,UAE9C4P,OAAO5P,QAAUH,EACfI,QAAQ,cACRA,QAAQ,UACRA,QAAQ,sBACRA,QAAQ,eACRA,QAAQ,YACRA,QAAQ,qBACRA,QAAQ,gBAvBd,CA2BIgH,OAAQ,SAAkBgyC,GAE5B,OAAOA,IAUP,SAAUhyC,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,kCACN,oBACA,wBACCD,GACwB,iBAAV+P,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfI,QAAQ,YACRA,QAAQ,mBAIVgH,EAAOgyC,SAAWp5C,EAChBoH,EAAOgyC,SACPhyC,EAAO+vC,cAnBb,CAuBG/vC,OAAQ,SAAkBgyC,EAAUj3C,GA0EvC,SAASmwD,EAAMp8C,EAAGC,EAAGmkB,GACnB,OAASnkB,EAAID,GAAMokB,EAAIpkB,EAnEzBkjC,EAASwF,cAAcnwC,KAAK,mBAE5B,IAAImlC,EAAQwF,EAASlzC,UA2GrB,OAzGA0tC,EAAM2e,gBAAkB,WACtB5xD,KAAK8F,GAAI,WAAY9F,KAAK6xD,kBAC1B7xD,KAAK8F,GAAI,aAAc9F,KAAK8xD,oBAC5B9xD,KAAK8F,GAAI,UAAW9F,KAAK+xD,iBAEzB,IAAIC,EAAiBhyD,KAAKF,QAAQmyD,SAClC,GAAMD,EAAN,CAIA,IAAIta,EAAQ13C,KACZkH,WAAY,WACVwwC,EAAMwa,gBAAiBF,OAI3B/e,EAAMif,gBAAkB,SAAU9iB,GAChCA,EAAO5tC,EAAMs1C,gBAAiB1H,GAC9B,IAAI+iB,EAAY1Z,EAASzyC,KAAMopC,GAE/B,GAAM+iB,GAAaA,GAAanyD,KAAhC,CAIAA,KAAKoyD,aAAeD,EAEpB,IAAIza,EAAQ13C,KACZA,KAAKqyD,qBAAuB,WAC1B3a,EAAM4a,sBAERH,EAAUrsD,GAAI,SAAU9F,KAAKqyD,sBAE7BryD,KAAK8F,GAAI,cAAe9F,KAAKuyD,kBAE7BvyD,KAAKsyD,oBAAoB,KAG3Brf,EAAMqf,mBAAqB,SAAUhR,GACnC,GAAMthD,KAAKoyD,aAAX,CAIA,IAAIpQ,EAAehiD,KAAKoyD,aAAatQ,cAAc,GAC/C0Q,EAAaxyD,KAAKoyD,aAAa5Y,MAAM10C,QAASk9C,GAC9C8K,EAAY0F,EAAaxyD,KAAKoyD,aAAatQ,cAAc96C,OAAS,EAClEyrD,EAAcxpD,KAAK42B,MAAO8xB,EAAMa,EAAY1F,EAC9C9sD,KAAKoyD,aAAalZ,YAKpB,GAJAl5C,KAAKkiD,WAAYuQ,GAAa,EAAOnR,GAErCthD,KAAK0yD,8BAEAD,GAAezyD,KAAKw5C,MAAMxyC,QAA/B,CAIA,IAAI86C,EAAgB9hD,KAAKw5C,MAAMhuC,MAAOgnD,EAAY1F,EAAY,GAC9D9sD,KAAK2yD,oBAAsB7Q,EAAcn0C,IAAK,SAAU+rC,GACtD,OAAOA,EAAKz5C,UAEdD,KAAK4yD,uBAAuB,UAO9B3f,EAAM2f,uBAAyB,SAAUtxC,GACvCthB,KAAK2yD,oBAAoBr3B,QAAS,SAAUu3B,GAC1CA,EAAQzY,UAAW94B,GAAS,sBAIhC2xB,EAAM4e,iBAAmB,WACvB7xD,KAAKsyD,oBAAoB,IAG3Brf,EAAMyf,0BAA4B,WAC1B1yD,KAAK2yD,sBAGX3yD,KAAK4yD,uBAAuB,iBACrB5yD,KAAK2yD,sBAGd1f,EAAMsf,iBAAmB,SAAU7/B,EAAOuxB,EAAS6O,EAAatS,GACrC,iBAAbA,GACVxgD,KAAKoyD,aAAalQ,WAAY1B,IAIlCvN,EAAM6e,mBAAqB,WACzB9xD,KAAK0yD,6BAGPzf,EAAM8e,gBAAkB,WAChB/xD,KAAKoyD,eAGXpyD,KAAKoyD,aAAa3jD,IAAK,SAAUzO,KAAKqyD,sBACtCryD,KAAKyO,IAAK,cAAezO,KAAKuyD,yBACvBvyD,KAAKoyD,eAKP3Z,IAUP,SAAYhyC,EAAQpH,GAAY,aAKR,mBAAVC,QAAwBA,OAAOC,IAEzCD,OAAQ,6BACN,yBACC,SAAU0zC,GACX,OAAO3zC,EAASoH,EAAQusC,KAEC,iBAAV5jC,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,eAIVgH,EAAOssD,aAAe1zD,EACpBoH,EACAA,EAAOusC,WAtBb,CA0BsB,oBAAXvsC,OAAyBA,OAASzG,KAI7C,SAAkByG,EAAQusC,GAU1B,SAASlyC,EAAQyU,EAAGC,GAClB,IAAM,IAAIsvB,KAAQtvB,EAChBD,EAAGuvB,GAAStvB,EAAGsvB,GAEjB,OAAOvvB,EAIT,SAAS4U,EAAWlV,GAClB,IAAIyhC,KACJ,GAAKnvC,MAAMC,QAASyN,GAElByhC,EAAMzhC,OACD,GAA0B,iBAAdA,EAAIjO,OAErB,IAAM,IAAIwF,EAAE,EAAGA,EAAIyI,EAAIjO,OAAQwF,IAC7BkqC,EAAI5oC,KAAMmH,EAAIzI,SAIhBkqC,EAAI5oC,KAAMmH,GAEZ,OAAOyhC,EAUT,SAASsc,EAAc5jB,EAAMtvC,EAASmzD,GAEpC,KAAQjzD,gBAAgBgzD,GACtB,OAAO,IAAIA,EAAc5jB,EAAMtvC,EAASmzD,GAGtB,iBAAR7jB,IACVA,EAAOttC,SAASu1C,iBAAkBjI,IAGpCpvC,KAAKkzD,SAAW/oC,EAAWilB,GAC3BpvC,KAAKF,QAAUgB,KAAYd,KAAKF,SAET,mBAAXA,EACVmzD,EAAWnzD,EAEXgB,EAAQd,KAAKF,QAASA,GAGnBmzD,GACHjzD,KAAK8F,GAAI,SAAUmtD,GAGrBjzD,KAAKmzD,YAEAxzD,IAEHK,KAAKozD,WAAa,IAAIzzD,EAAE2Q,UAI1BpJ,WAAY,WACVlH,KAAKqzD,SACLjM,KAAMpnD,OA6IV,SAASszD,EAAcpC,GACrBlxD,KAAKkxD,IAAMA,EA+Db,SAASqC,EAAYxnD,EAAK9L,GACxBD,KAAK+L,IAAMA,EACX/L,KAAKC,QAAUA,EACfD,KAAKkxD,IAAM,IAAIsC,MAvRjB,IAAI7zD,EAAI8G,EAAO/G,OACXozC,EAAUrsC,EAAOqsC,QAyErBkgB,EAAaztD,UAAYwS,OAAOs4B,OAAQ2C,EAAUztC,WAElDytD,EAAaztD,UAAUzF,WAEvBkzD,EAAaztD,UAAU4tD,UAAY,WACjCnzD,KAAKyzD,UAGLzzD,KAAKkzD,SAAS53B,QAASt7B,KAAK0zD,iBAAkB1zD,OAMhDgzD,EAAaztD,UAAUmuD,iBAAmB,SAAUtkB,GAE5B,OAAjBA,EAAKhG,UACRppC,KAAK2zD,SAAUvkB,IAGgB,IAA5BpvC,KAAKF,QAAQ8zD,YAChB5zD,KAAK6zD,2BAA4BzkB,GAKnC,IAAIre,EAAWqe,EAAKre,SACpB,GAAMA,GAAa+iC,EAAkB/iC,GAArC,CAKA,IAAM,IAFFgjC,EAAY3kB,EAAKiI,iBAAiB,OAE5B7qC,EAAE,EAAGA,EAAIunD,EAAU/sD,OAAQwF,IAAM,CACzC,IAAI0kD,EAAM6C,EAAUvnD,GACpBxM,KAAK2zD,SAAUzC,GAIjB,GAAuC,iBAA3BlxD,KAAKF,QAAQ8zD,WAAyB,CAChD,IAAI3tD,EAAWmpC,EAAKiI,iBAAkBr3C,KAAKF,QAAQ8zD,YACnD,IAAMpnD,EAAE,EAAGA,EAAIvG,EAASe,OAAQwF,IAAM,CACpC,IAAIwnD,EAAQ/tD,EAASuG,GACrBxM,KAAK6zD,2BAA4BG,OAKvC,IAAIF,GACFG,GAAG,EACHC,GAAG,EACHC,IAAI,GA2MN,OAxMAnB,EAAaztD,UAAUsuD,2BAA6B,SAAUzkB,GAC5D,IAAIntC,EAAQqjC,iBAAkB8J,GAC9B,GAAMntC,EAON,IAFA,IAAImyD,EAAQ,0BACR37C,EAAU27C,EAAM/nC,KAAMpqB,EAAMoyD,iBACZ,OAAZ57C,GAAmB,CACzB,IAAI1M,EAAM0M,GAAWA,EAAQ,GACxB1M,GACH/L,KAAKs0D,cAAevoD,EAAKqjC,GAE3B32B,EAAU27C,EAAM/nC,KAAMpqB,EAAMoyD,mBAOhCrB,EAAaztD,UAAUouD,SAAW,SAAUzC,GAC1C,IAAIqD,EAAe,IAAIjB,EAAcpC,GACrClxD,KAAKyzD,OAAO3lD,KAAMymD,IAGpBvB,EAAaztD,UAAU+uD,cAAgB,SAAUvoD,EAAKqjC,GACpD,IAAIwkB,EAAa,IAAIL,EAAYxnD,EAAKqjC,GACtCpvC,KAAKyzD,OAAO3lD,KAAM8lD,IAGpBZ,EAAaztD,UAAU8tD,MAAQ,WAU7B,SAASmB,EAAYp/B,EAAOga,EAAM2D,GAEhC7rC,WAAY,WACVwwC,EAAMgE,SAAUtmB,EAAOga,EAAM2D,KAZjC,IAAI2E,EAAQ13C,KACZA,KAAKy0D,gBAAkB,EACvBz0D,KAAK00D,cAAe,EAEd10D,KAAKyzD,OAAOzsD,OAYlBhH,KAAKyzD,OAAOn4B,QAAS,SAAUi5B,GAC7BA,EAAajhB,KAAM,WAAYkhB,GAC/BD,EAAalB,UAbbrzD,KAAKwuB,YAiBTwkC,EAAaztD,UAAUm2C,SAAW,SAAUtmB,EAAOga,EAAM2D,GACvD/yC,KAAKy0D,kBACLz0D,KAAK00D,aAAe10D,KAAK00D,eAAiBt/B,EAAM6I,SAEhDj+B,KAAKyzC,UAAW,YAAczzC,KAAMo1B,EAAOga,IACtCpvC,KAAKozD,YAAcpzD,KAAKozD,WAAWnxC,QACtCjiB,KAAKozD,WAAWnxC,OAAQjiB,KAAMo1B,GAG3Bp1B,KAAKy0D,iBAAmBz0D,KAAKyzD,OAAOzsD,QACvChH,KAAKwuB,WAGFxuB,KAAKF,QAAQ60D,OAAS7hB,GACzBA,EAAQ8hB,IAAK,aAAe7hB,EAAS3d,EAAOga,IAIhD4jB,EAAaztD,UAAUipB,SAAW,WAChC,IAAI0kB,EAAYlzC,KAAK00D,aAAe,OAAS,OAI7C,GAHA10D,KAAKm+B,YAAa,EAClBn+B,KAAKyzC,UAAWP,GAAalzC,OAC7BA,KAAKyzC,UAAW,UAAYzzC,OACvBA,KAAKozD,WAAa,CACrB,IAAIyB,EAAW70D,KAAK00D,aAAe,SAAW,UAC9C10D,KAAKozD,WAAYyB,GAAY70D,QAUjCszD,EAAa/tD,UAAYwS,OAAOs4B,OAAQ2C,EAAUztC,WAElD+tD,EAAa/tD,UAAU8tD,MAAQ,WAGZrzD,KAAK80D,qBAGpB90D,KAAK+0D,QAAmC,IAA1B/0D,KAAKkxD,IAAIpvB,aAAoB,iBAK7C9hC,KAAKg1D,WAAa,IAAIxB,MACtBxzD,KAAKg1D,WAAWpd,iBAAkB,OAAQ53C,MAC1CA,KAAKg1D,WAAWpd,iBAAkB,QAAS53C,MAE3CA,KAAKkxD,IAAItZ,iBAAkB,OAAQ53C,MACnCA,KAAKkxD,IAAItZ,iBAAkB,QAAS53C,MACpCA,KAAKg1D,WAAWt5B,IAAM17B,KAAKkxD,IAAIx1B,MAGjC43B,EAAa/tD,UAAUuvD,mBAAqB,WAC1C,OAAO90D,KAAKkxD,IAAI1iC,eAAsC9Z,IAA1B1U,KAAKkxD,IAAIpvB,cAGvCwxB,EAAa/tD,UAAUwvD,QAAU,SAAU92B,EAAU8U,GACnD/yC,KAAKi+B,SAAWA,EAChBj+B,KAAKyzC,UAAW,YAAczzC,KAAMA,KAAKkxD,IAAKne,KAMhDugB,EAAa/tD,UAAUwxC,YAAc,SAAUrkB,GAC7C,IAAIpR,EAAS,KAAOoR,EAAM3uB,KACrB/D,KAAMshB,IACTthB,KAAMshB,GAAUoR,IAIpB4gC,EAAa/tD,UAAUksD,OAAS,WAC9BzxD,KAAK+0D,SAAS,EAAM,UACpB/0D,KAAKi1D,gBAGP3B,EAAa/tD,UAAUmsD,QAAU,WAC/B1xD,KAAK+0D,SAAS,EAAO,WACrB/0D,KAAKi1D,gBAGP3B,EAAa/tD,UAAU0vD,aAAe,WACpCj1D,KAAKg1D,WAAW/R,oBAAqB,OAAQjjD,MAC7CA,KAAKg1D,WAAW/R,oBAAqB,QAASjjD,MAC9CA,KAAKkxD,IAAIjO,oBAAqB,OAAQjjD,MACtCA,KAAKkxD,IAAIjO,oBAAqB,QAASjjD,OAYzCuzD,EAAWhuD,UAAYwS,OAAOs4B,OAAQijB,EAAa/tD,WAEnDguD,EAAWhuD,UAAU8tD,MAAQ,WAC3BrzD,KAAKkxD,IAAItZ,iBAAkB,OAAQ53C,MACnCA,KAAKkxD,IAAItZ,iBAAkB,QAAS53C,MACpCA,KAAKkxD,IAAIx1B,IAAM17B,KAAK+L,IAEH/L,KAAK80D,uBAEpB90D,KAAK+0D,QAAmC,IAA1B/0D,KAAKkxD,IAAIpvB,aAAoB,gBAC3C9hC,KAAKi1D,iBAIT1B,EAAWhuD,UAAU0vD,aAAe,WAClCj1D,KAAKkxD,IAAIjO,oBAAqB,OAAQjjD,MACtCA,KAAKkxD,IAAIjO,oBAAqB,QAASjjD,OAGzCuzD,EAAWhuD,UAAUwvD,QAAU,SAAU92B,EAAU8U,GACjD/yC,KAAKi+B,SAAWA,EAChBj+B,KAAKyzC,UAAW,YAAczzC,KAAMA,KAAKC,QAAS8yC,KAKpDigB,EAAakC,iBAAmB,SAAUx1D,IACxCA,EAASA,GAAU+G,EAAO/G,WAK1BC,EAAID,GAEFkP,GAAGmkD,aAAe,SAAUjzD,EAASuiB,GAErC,OADe,IAAI2wC,EAAchzD,KAAMF,EAASuiB,GAChC+wC,WAAWlpC,QAASvqB,EAAEK,UAI1CgzD,EAAakC,mBAINlC,IAWL,SAAUvsD,EAAQpH,GAGI,mBAAVC,QAAwBA,OAAOC,IAEzCD,QACE,oBACA,6BACC,SAAUm5C,EAAUsa,GACrB,OAAO1zD,EAASoH,EAAQgyC,EAAUsa,KAET,iBAAV3jD,QAAsBA,OAAO5P,QAE9C4P,OAAO5P,QAAUH,EACfoH,EACAhH,QAAQ,YACRA,QAAQ,iBAIVgH,EAAOgyC,SAAWp5C,EAChBoH,EACAA,EAAOgyC,SACPhyC,EAAOssD,cAvBb,CA2BGtsD,OAAQ,SAAkBA,EAAQgyC,EAAUsa,GAC/C,aAEAta,EAASwF,cAAcnwC,KAAK,uBAE5B,IAAImlC,EAAQwF,EAASlzC,UAqBrB,OAnBA0tC,EAAMkiB,oBAAsB,WAC1Bn1D,KAAK8F,GAAI,WAAY9F,KAAK+yD,eAG5B9f,EAAM8f,aAAe,WACnB,GAAM/yD,KAAKF,QAAQizD,aAAnB,CAGA,IAAIrb,EAAQ13C,KAQZ+yD,EAAc/yD,KAAKu7C,QAASz1C,GAAI,WAPhC,SAAiCmJ,EAAUmmB,GACzC,IAAIskB,EAAOhC,EAAM2K,cAAejtB,EAAM87B,KACtCxZ,EAAMiZ,eAAgBjX,GAAQA,EAAKz5C,SAC7By3C,EAAM53C,QAAQkqD,YAClBtS,EAAMmE,+BAMLpD;CC1gJN,SAAUp5C,GACa,mBAAXC,QAAyBA,OAAOC,IAC3CD,QAAS,UAAWD,GACQ,iBAAX+P,QAAuBA,OAAO5P,QAC/C4P,OAAO5P,QAAUH,EAASI,QAAS,WAEnCJ,EAASK,QANX,CAQE,SAAUC,GAEZA,EAAEmB,OAAQnB,EAAEiP,IAGXwmD,SAAU,SAAUt1D,GAGnB,GAAME,KAAKgH,OAAX,CAQA,IAAIquD,EAAY11D,EAAEqG,KAAMhG,KAAM,GAAK,aACnC,OAAKq1D,IAKLr1D,KAAK4nB,KAAM,aAAc,cAEzBytC,EAAY,IAAI11D,EAAE01D,UAAWv1D,EAASE,KAAM,IAC5CL,EAAEqG,KAAMhG,KAAM,GAAK,YAAaq1D,GAE3BA,EAAU//B,SAASggC,WAEvBt1D,KAAK8F,GAAI,iBAAkB,UAAW,SAAU4sB,GAI/C2iC,EAAUE,aAAe7iC,EAAMmB,cAG1Bl0B,EAAGK,MAAOw8B,SAAU,YACxB64B,EAAUG,cAAe,QAIkB9gD,IAAvC/U,EAAGK,MAAO4nB,KAAM,oBACpBytC,EAAUG,cAAe,KAK3Bx1D,KAAK8F,GAAI,kBAAmB,SAAU4sB,GAMrC,SAASqzB,IACR,IAAI9W,EAAQ/iC,EAcZ,OAPKmpD,EAAUE,eAAkBF,EAAU//B,SAASmgC,eAAiBJ,EAAUK,iBAC9EzmB,EAAStvC,EAAG,0BACVioB,KAAM,OAAQytC,EAAUE,aAAav+C,MACrCjQ,IAAKpH,EAAG01D,EAAUE,cAAexuD,OACjChE,SAAUsyD,EAAUM,eAGlBN,EAAU//B,SAASmgC,gBACvBvpD,EAASmpD,EAAU//B,SAASmgC,cAAc7qD,KAAMyqD,EAAWA,EAAUM,YAAajjC,GAC7Euc,GAGJA,EAAOtgC,cAEQ+F,IAAXxI,GACGA,GAQV,OApCKmpD,EAAU//B,SAASq/B,OAGvBjiC,EAAMroB,iBAiCFgrD,EAAUG,cACdH,EAAUG,cAAe,EAClBzP,KAEHsP,EAAUO,OACTP,EAAUQ,gBACdR,EAAUK,eAAgB,GACnB,GAED3P,KAEPsP,EAAUS,gBACH,MAKHT,GA5FDv1D,GAAWA,EAAQ60D,OAASluD,OAAOqsC,SACvCA,QAAQijB,KAAM,yDA+FjBC,MAAO,WACN,IAAIA,EAAOX,EAAWY,EAgBtB,OAdKt2D,EAAGK,KAAM,IAAMwR,GAAI,QACvBwkD,EAAQh2D,KAAKo1D,WAAWQ,QAExBK,KACAD,GAAQ,EACRX,EAAY11D,EAAGK,KAAM,GAAI41D,MAAOR,WAChCp1D,KAAKgN,KAAM,YACVgpD,EAAQX,EAAUp1D,QAASD,OAAUg2D,KAEpCC,EAAYA,EAAUt+C,OAAQ09C,EAAUY,cAG1CZ,EAAUY,UAAYA,GAEhBD,GAIRE,MAAO,SAAUlxB,EAASmxB,GACzB,IACC7gC,EAAU8gC,EAAaC,EAAerwD,EAAM6F,EAAOyqD,EADhDr2D,EAAUD,KAAM,GAIpB,GAAgB,MAAXC,KAICA,EAAQ21D,MAAQ31D,EAAQs2D,aAAc,qBAC3Ct2D,EAAQ21D,KAAO51D,KAAKqjB,QAAS,QAAU,GACvCpjB,EAAQ+W,KAAOhX,KAAK4nB,KAAM,SAGN,MAAhB3nB,EAAQ21D,MAAb,CAIA,GAAK5wB,EAIJ,OAHA1P,EAAW31B,EAAEqG,KAAM/F,EAAQ21D,KAAM,aAActgC,SAC/C8gC,EAAc9gC,EAAS4gC,MACvBG,EAAgB12D,EAAE01D,UAAUe,YAAan2D,GAChC+kC,GACT,IAAK,MACJrlC,EAAEmB,OAAQu1D,EAAe12D,EAAE01D,UAAUmB,cAAeL,WAG7CE,EAAcI,SACrBL,EAAan2D,EAAQ+W,MAASq/C,EACzBF,EAASM,WACbnhC,EAASmhC,SAAUx2D,EAAQ+W,MAASrX,EAAEmB,OAAQw0B,EAASmhC,SAAUx2D,EAAQ+W,MAAQm/C,EAASM,WAE3F,MACD,IAAK,SACJ,OAAMN,GAING,KACA32D,EAAEqN,KAAMmpD,EAASnrD,MAAO,MAAQ,SAAU8B,EAAOwU,GAChDg1C,EAAUh1C,GAAW+0C,EAAe/0C,UAC7B+0C,EAAe/0C,KAEhBg1C,WARCF,EAAan2D,EAAQ+W,MACrBq/C,GAkCV,OAvBArwD,EAAOrG,EAAE01D,UAAUqB,eACnB/2D,EAAEmB,UAEDnB,EAAE01D,UAAUsB,WAAY12D,GACxBN,EAAE01D,UAAUuB,eAAgB32D,GAC5BN,EAAE01D,UAAUwB,UAAW52D,GACvBN,EAAE01D,UAAUe,YAAan2D,IACvBA,IAGO62D,WACTjrD,EAAQ7F,EAAK8wD,gBACN9wD,EAAK8wD,SACZ9wD,EAAOrG,EAAEmB,QAAUg2D,SAAUjrD,GAAS7F,IAIlCA,EAAK+wD,SACTlrD,EAAQ7F,EAAK+wD,cACN/wD,EAAK+wD,OACZ/wD,EAAOrG,EAAEmB,OAAQkF,GAAQ+wD,OAAQlrD,KAG3B7F,MAKTrG,EAAEmB,OAAQnB,EAAEq3D,KAAKC,SAAWt3D,EAAEq3D,KAAM,MAGnCE,MAAO,SAAU3hD,GAChB,OAAQ5V,EAAEsL,KAAM,GAAKtL,EAAG4V,GAAIxO,QAI7BowD,OAAQ,SAAU5hD,GACjB,IAAIxO,EAAMpH,EAAG4V,GAAIxO,MACjB,OAAe,OAARA,KAAkBpH,EAAEsL,KAAM,GAAKlE,IAIvCqwD,UAAW,SAAU7hD,GACpB,OAAQ5V,EAAG4V,GAAIuvB,KAAM,cAKvBnlC,EAAE01D,UAAY,SAAUv1D,EAAS81D,GAChC51D,KAAKs1B,SAAW31B,EAAEmB,QAAQ,KAAUnB,EAAE01D,UAAUt0D,SAAUjB,GAC1DE,KAAK21D,YAAcC,EACnB51D,KAAK+6B,QAINp7B,EAAE01D,UAAUtvB,OAAS,SAAUsxB,EAAQ9zD,GACtC,OAA0B,IAArBwL,UAAU/H,OACP,WACN,IAAI8H,EAAOnP,EAAEwqB,UAAWpb,WAExB,OADAD,EAAK41B,QAAS2yB,GACP13D,EAAE01D,UAAUtvB,OAAO/iB,MAAOhjB,KAAM8O,SAGzB4F,IAAXnR,EACG8zD,GAEHtoD,UAAU/H,OAAS,GAAKzD,EAAOi6C,cAAgBj2C,QACnDhE,EAAS5D,EAAEwqB,UAAWpb,WAAYvD,MAAO,IAErCjI,EAAOi6C,cAAgBj2C,QAC3BhE,GAAWA,IAEZ5D,EAAEqN,KAAMzJ,EAAQ,SAAUiJ,EAAGivB,GAC5B47B,EAASA,EAAO31D,QAAS,IAAIgC,OAAQ,MAAQ8I,EAAI,MAAO,KAAO,WAC9D,OAAOivB,MAGF47B,IAGR13D,EAAEmB,OAAQnB,EAAE01D,WAEXt0D,UACC01D,YACAa,UACApB,SACAqB,WAAY,QACZC,aAAc,UACdC,WAAY,QACZC,aAAc,QACdC,cAAc,EACd7B,cAAc,EACd8B,eAAgBj4D,MAChBk4D,oBAAqBl4D,MACrB21D,UAAU,EACV5yB,OAAQ,UACRo1B,aAAa,EACbC,UAAW,SAAU93D,GACpBD,KAAKg4D,WAAa/3D,EAGbD,KAAKs1B,SAASqiC,eACb33D,KAAKs1B,SAAS2iC,aAClBj4D,KAAKs1B,SAAS2iC,YAAYrtD,KAAM5K,KAAMC,EAASD,KAAKs1B,SAASiiC,WAAYv3D,KAAKs1B,SAASmiC,YAExFz3D,KAAKk4D,UAAWl4D,KAAKm4D,UAAWl4D,MAGlCm4D,WAAY,SAAUn4D,GACfD,KAAKq4D,UAAWp4D,MAAeA,EAAQ+W,QAAQhX,KAAKs4D,YAAct4D,KAAKu4D,SAAUt4D,IACtFD,KAAKC,QAASA,IAGhBu4D,QAAS,SAAUv4D,EAASyyB,GAqBN,IAAhBA,EAAM3oB,OAAgD,KAAjC/J,KAAKy4D,aAAcx4D,KAAkE,IAA9CN,EAAEkO,QAAS6kB,EAAMiK,SAJjF,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GACxB,GAAI,GAAI,GAAI,GAAI,IAAK,QAKV18B,EAAQ+W,QAAQhX,KAAKs4D,WAAar4D,EAAQ+W,QAAQhX,KAAK04D,UAClE14D,KAAKC,QAASA,IAGhBgpC,QAAS,SAAUhpC,GAGbA,EAAQ+W,QAAQhX,KAAKs4D,UACzBt4D,KAAKC,QAASA,GAGHA,EAAQ42C,WAAW7/B,QAAQhX,KAAKs4D,WAC3Ct4D,KAAKC,QAASA,EAAQ42C,aAGxB8hB,UAAW,SAAU14D,EAASs3D,EAAYE,GACnB,UAAjBx3D,EAAQ8D,KACZ/D,KAAK44D,WAAY34D,EAAQ+W,MAAO5J,SAAUmqD,GAAarxD,YAAauxD,GAEpE93D,EAAGM,GAAUmN,SAAUmqD,GAAarxD,YAAauxD,IAGnDQ,YAAa,SAAUh4D,EAASs3D,EAAYE,GACrB,UAAjBx3D,EAAQ8D,KACZ/D,KAAK44D,WAAY34D,EAAQ+W,MAAO9Q,YAAaqxD,GAAanqD,SAAUqqD,GAEpE93D,EAAGM,GAAUiG,YAAaqxD,GAAanqD,SAAUqqD,KAMpDoB,YAAa,SAAUvjC,GACtB31B,EAAEmB,OAAQnB,EAAE01D,UAAUt0D,SAAUu0B,IAGjCmhC,UACCK,SAAU,0BACVC,OAAQ,yBACR+B,MAAO,sCACP/sD,IAAK,4BACLgtD,KAAM,6BACNC,QAAS,mCACTlZ,OAAQ,+BACRllC,OAAQ,4BACRq+C,QAAS,qCACTC,UAAWv5D,EAAE01D,UAAUtvB,OAAQ,6CAC/BozB,UAAWx5D,EAAE01D,UAAUtvB,OAAQ,yCAC/BqzB,YAAaz5D,EAAE01D,UAAUtvB,OAAQ,6DACjCt8B,MAAO9J,EAAE01D,UAAUtvB,OAAQ,6CAC3B78B,IAAKvJ,EAAE01D,UAAUtvB,OAAQ,mDACzBnG,IAAKjgC,EAAE01D,UAAUtvB,OAAQ,sDACzB7uB,KAAMvX,EAAE01D,UAAUtvB,OAAQ,oCAG3BszB,kBAAkB,EAElB9zD,WAECw1B,KAAM,WA0BL,SAASu+B,EAAU5mC,IAGZ1yB,KAAK41D,MAAQ51D,KAAKu2D,aAAc,qBACrCv2D,KAAK41D,KAAOj2D,EAAGK,MAAOqjB,QAAS,QAAU,GACzCrjB,KAAKgX,KAAOrX,EAAGK,MAAO4nB,KAAM,SAG7B,IAAIytC,EAAY11D,EAAEqG,KAAMhG,KAAK41D,KAAM,aAClC2D,EAAY,KAAO7mC,EAAM3uB,KAAKrC,QAAS,YAAa,IACpD4zB,EAAW+/B,EAAU//B,SACjBA,EAAUikC,KAAgB55D,EAAGK,MAAOwR,GAAI8jB,EAASoN,SACrDpN,EAAUikC,GAAY3uD,KAAMyqD,EAAWr1D,KAAM0yB,GArC/C1yB,KAAKw5D,eAAiB75D,EAAGK,KAAKs1B,SAASuiC,qBACvC73D,KAAKy5D,aAAez5D,KAAKw5D,eAAexyD,QAAUhH,KAAKw5D,gBAAkB75D,EAAGK,KAAK21D,aACjF31D,KAAK05D,WAAa/5D,EAAGK,KAAKs1B,SAASsiC,gBAAiBp0C,IAAKxjB,KAAKs1B,SAASuiC,qBACvE73D,KAAKs4D,aACLt4D,KAAK25D,cACL35D,KAAK61D,eAAiB,EACtB71D,KAAK45D,WACL55D,KAAK04D,WACL14D,KAAKiuC,QAEL,IACCioB,EADGoB,EAAWt3D,KAAKs3D,UAEpB33D,EAAEqN,KAAMhN,KAAKs1B,SAASgiC,OAAQ,SAAU7iD,EAAKnU,GACtB,iBAAVA,IACXA,EAAQA,EAAM0K,MAAO,OAEtBrL,EAAEqN,KAAM1M,EAAO,SAAUwM,EAAOkK,GAC/BsgD,EAAQtgD,GAASvC,MAGnByhD,EAAQl2D,KAAKs1B,SAAS4gC,MACtBv2D,EAAEqN,KAAMkpD,EAAO,SAAUzhD,EAAKnU,GAC7B41D,EAAOzhD,GAAQ9U,EAAE01D,UAAUmB,cAAel2D,KAmB3CX,EAAGK,KAAK21D,aACN7vD,GAAI,oDACJ,0VAGyEwzD,GAIzExzD,GAAI,iBAAkB,oDAAqDwzD,GAExEt5D,KAAKs1B,SAASukC,gBAClBl6D,EAAGK,KAAK21D,aAAc7vD,GAAI,wBAAyB9F,KAAKs1B,SAASukC,iBAKnEjE,KAAM,WAQL,OAPA51D,KAAK85D,YACLn6D,EAAEmB,OAAQd,KAAKs4D,UAAWt4D,KAAK+5D,UAC/B/5D,KAAK04D,QAAU/4D,EAAEmB,UAAYd,KAAK+5D,UAC5B/5D,KAAKg2D,SACVr2D,EAAGK,KAAK21D,aAAcqE,eAAgB,gBAAkBh6D,OAEzDA,KAAKi6D,aACEj6D,KAAKg2D,SAGb8D,UAAW,WACV95D,KAAKk6D,cACL,IAAM,IAAI1tD,EAAI,EAAG0mD,EAAalzD,KAAKm6D,gBAAkBn6D,KAAKkzD,WAAcA,EAAU1mD,GAAKA,IACtFxM,KAAKqzD,MAAOH,EAAU1mD,IAEvB,OAAOxM,KAAKg2D,SAIb/1D,QAAS,SAAUA,GAClB,IAICm6D,EAAI//B,EAJDggC,EAAer6D,KAAKs6D,MAAOr6D,GAC9Bs6D,EAAev6D,KAAKw6D,oBAAqBH,GACzCI,EAAIz6D,KACJkM,GAAS,EA2CV,YAxCsBwI,IAAjB6lD,SACGv6D,KAAK04D,QAAS2B,EAAarjD,OAElChX,KAAK06D,eAAgBH,GACrBv6D,KAAKm6D,gBAAkBx6D,EAAG46D,IAI1BlgC,EAAQr6B,KAAKs3D,OAAQiD,EAAavjD,QAEjCrX,EAAEqN,KAAMhN,KAAKs3D,OAAQ,SAAUtgD,EAAM2jD,GAC/BA,IAActgC,GAASrjB,IAASujD,EAAavjD,OACjDqjD,EAAeI,EAAED,oBAAqBC,EAAEH,MAAOG,EAAE7B,WAAY5hD,OACxCqjD,EAAarjD,QAAQyjD,EAAE/B,UAC3C+B,EAAEN,gBAAgBrsD,KAAMusD,GACxBnuD,EAASuuD,EAAEpH,MAAOgH,IAAkBnuD,KAMxCkuD,GAAoC,IAA/Bp6D,KAAKqzD,MAAOkH,GACjBruD,EAASA,GAAUkuD,EAElBp6D,KAAK04D,QAAS6B,EAAavjD,OADvBojD,EAMCp6D,KAAK46D,qBAGV56D,KAAK66D,OAAS76D,KAAK66D,OAAOr3C,IAAKxjB,KAAK05D,aAErC15D,KAAKi6D,aAGLt6D,EAAGM,GAAU2nB,KAAM,gBAAiBwyC,IAG9BluD,GAIR+tD,WAAY,SAAUa,GACrB,GAAKA,EAAS,CACb,IAAIzF,EAAYr1D,KAGhBL,EAAEmB,OAAQd,KAAK+5D,SAAUe,GACzB96D,KAAKi2D,UAAYt2D,EAAEgO,IAAK3N,KAAK+5D,SAAU,SAAUhnB,EAAS/7B,GACzD,OACC+7B,QAASA,EACT9yC,QAASo1D,EAAUuD,WAAY5hD,GAAQ,MAKzChX,KAAK+6D,YAAcp7D,EAAE4L,KAAMvL,KAAK+6D,YAAa,SAAU96D,GACtD,QAAUA,EAAQ+W,QAAQ8jD,KAGvB96D,KAAKs1B,SAAS2kC,WAClBj6D,KAAKs1B,SAAS2kC,WAAWrvD,KAAM5K,KAAMA,KAAK+5D,SAAU/5D,KAAKi2D,WAEzDj2D,KAAKg7D,qBAKPC,UAAW,WACLt7D,EAAEiP,GAAGqsD,WACTt7D,EAAGK,KAAK21D,aAAcsF,YAEvBj7D,KAAK04D,WACL14D,KAAKs4D,aACLt4D,KAAKk6D,cACLl6D,KAAKk7D,aACL,IAAIhI,EAAWlzD,KAAKkzD,WAClBxkD,WAAY,iBACZsvB,WAAY,gBAEdh+B,KAAKm7D,cAAejI,IAGrBiI,cAAe,SAAUjI,GACxB,IAAI1mD,EAEJ,GAAKxM,KAAKs1B,SAAS2iC,YAClB,IAAMzrD,EAAI,EAAG0mD,EAAU1mD,GAAKA,IAC3BxM,KAAKs1B,SAAS2iC,YAAYrtD,KAAM5K,KAAMkzD,EAAU1mD,GAC/CxM,KAAKs1B,SAASiiC,WAAY,IAC3Bv3D,KAAK44D,WAAY1F,EAAU1mD,GAAIwK,MAAO9Q,YAAalG,KAAKs1B,SAASmiC,iBAGlEvE,EACEhtD,YAAalG,KAAKs1B,SAASiiC,YAC3BrxD,YAAalG,KAAKs1B,SAASmiC,aAI/BmD,iBAAkB,WACjB,OAAO56D,KAAKo7D,aAAcp7D,KAAK04D,UAGhC0C,aAAc,SAAUnmD,GAEvB,IACCzI,EADGwN,EAAQ,EAEZ,IAAMxN,KAAKyI,OAIQP,IAAbO,EAAKzI,IAAkC,OAAbyI,EAAKzI,KAA6B,IAAbyI,EAAKzI,IACxDwN,IAGF,OAAOA,GAGRkhD,WAAY,WACXl7D,KAAKk4D,UAAWl4D,KAAK66D,SAGtB3C,UAAW,SAAU4C,GACpBA,EAAOO,IAAKr7D,KAAK05D,YAAa5vD,KAAM,IACpC9J,KAAKs7D,WAAYR,GAAS3zD,QAG3B6uD,MAAO,WACN,OAAuB,IAAhBh2D,KAAKg0C,QAGbA,KAAM,WACL,OAAOh0C,KAAKi2D,UAAUjvD,QAGvB8uD,aAAc,WACb,GAAK91D,KAAKs1B,SAASwgC,aAClB,IACCn2D,EAAGK,KAAKu7D,kBAAoBv7D,KAAKi2D,UAAUjvD,QAAUhH,KAAKi2D,UAAW,GAAIh2D,aACxEkL,OAAQ,YACRkgB,QAGAvI,QAAS,WACT,MAAQpc,MAOZ60D,eAAgB,WACf,IAAIvD,EAAah4D,KAAKg4D,WACtB,OAAOA,GAEQ,IAFMr4D,EAAE4L,KAAMvL,KAAKi2D,UAAW,SAAUx6B,GACtD,OAAOA,EAAEx7B,QAAQ+W,OAASghD,EAAWhhD,OAClChQ,QAAgBgxD,GAGrB9E,SAAU,WACT,IAAImC,EAAYr1D,KACfw7D,KAGD,OAAO77D,EAAGK,KAAK21D,aACd3nD,KAAM,8CACNqtD,IAAK,sCACLA,IAAKr7D,KAAKs1B,SAASoN,QACnBv3B,OAAQ,WACR,IAAI6L,EAAOhX,KAAKgX,MAAQrX,EAAGK,MAAO4nB,KAAM,QAYxC,OAXM5Q,GAAQq+C,EAAU//B,SAASq/B,OAASluD,OAAOqsC,SAChDA,QAAQve,MAAO,0BAA2Bv0B,MAItCA,KAAKu2D,aAAc,qBACvBv2D,KAAK41D,KAAOj2D,EAAGK,MAAOqjB,QAAS,QAAU,GACzCrjB,KAAKgX,KAAOA,KAIRA,KAAQwkD,IAAenG,EAAU+F,aAAcz7D,EAAGK,MAAOk2D,YAI9DsF,EAAYxkD,IAAS,GACd,MAITsjD,MAAO,SAAUtmC,GAChB,OAAOr0B,EAAGq0B,GAAY,IAGvB8mC,OAAQ,WACP,IAAIvD,EAAav3D,KAAKs1B,SAASiiC,WAAWvsD,MAAO,KAAMkH,KAAM,KAC7D,OAAOvS,EAAGK,KAAKs1B,SAASoiC,aAAe,IAAMH,EAAYv3D,KAAKy5D,eAG/DgC,eAAgB,WACfz7D,KAAK+6D,eACL/6D,KAAKi2D,aACLj2D,KAAK+5D,YACL/5D,KAAK07D,OAAS/7D,MACdK,KAAK66D,OAASl7D,OAGfsuC,MAAO,WACNjuC,KAAKy7D,iBACLz7D,KAAKm6D,gBAAkBx6D,OAGxBu6D,YAAa,WACZl6D,KAAKiuC,QACLjuC,KAAK66D,OAAS76D,KAAK86D,SAASt3C,IAAKxjB,KAAK05D,aAGvCgB,eAAgB,SAAUz6D,GACzBD,KAAKiuC,QACLjuC,KAAK66D,OAAS76D,KAAKm4D,UAAWl4D,IAG/Bw4D,aAAc,SAAUx4D,GACvB,IAEC8G,EAAK40D,EAFFpe,EAAW59C,EAAGM,GACjB8D,EAAO9D,EAAQ8D,KAGhB,MAAc,UAATA,GAA6B,aAATA,EACjB/D,KAAK44D,WAAY34D,EAAQ+W,MAAO7L,OAAQ,YAAapE,MACxC,WAAThD,QAAiD,IAArB9D,EAAQ27D,SACxC37D,EAAQ27D,SAASC,SAAW,MAAQte,EAASx2C,OAIpDA,EADI9G,EAAQs2D,aAAc,mBACpBhZ,EAASzzC,OAETyzC,EAASx2C,MAGF,SAAThD,EAGyB,mBAAxBgD,EAAI2G,OAAQ,EAAG,IACZ3G,EAAI2G,OAAQ,KAKpBiuD,EAAM50D,EAAI+0D,YAAa,OACX,EACJ/0D,EAAI2G,OAAQiuD,EAAM,IAI1BA,EAAM50D,EAAI+0D,YAAa,QACX,EACJ/0D,EAAI2G,OAAQiuD,EAAM,GAInB50D,EAGY,iBAARA,EACJA,EAAIrF,QAAS,MAAO,IAErBqF,IAGRssD,MAAO,SAAUpzD,GAChBA,EAAUD,KAAKw6D,oBAAqBx6D,KAAKs6D,MAAOr6D,IAEhD,IAMCiM,EAAQoV,EAAQy6C,EAAMC,EANnB9F,EAAQv2D,EAAGM,GAAUi2D,QACxB+F,EAAat8D,EAAEgO,IAAKuoD,EAAO,SAAUz6B,EAAGjvB,GACvC,OAAOA,IACJxF,OACJk1D,GAAqB,EACrBn1D,EAAM/G,KAAKy4D,aAAcx4D,GAc1B,GATiC,mBAArBi2D,EAAM8F,WACjBA,EAAa9F,EAAM8F,WAC4B,mBAA7Bh8D,KAAKs1B,SAAS0mC,aAChCA,EAAah8D,KAAKs1B,SAAS0mC,YAMvBA,EAAa,CAGjB,GAAoB,iBAFpBj1D,EAAMi1D,EAAWpxD,KAAM3K,EAAS8G,IAG/B,MAAM,IAAIo1D,UAAW,uDAIfjG,EAAM8F,WAGd,IAAM16C,KAAU40C,EAAQ,CACvB6F,GAASz6C,OAAQA,EAAQ86C,WAAYlG,EAAO50C,IAC5C,IAKC,GAAgB,yBAJhBpV,EAASvM,EAAE01D,UAAU1tC,QAASrG,GAAS1W,KAAM5K,KAAM+G,EAAK9G,EAAS87D,EAAKK,cAId,IAAfH,EAAmB,CAC3DC,GAAqB,EACrB,SAID,GAFAA,GAAqB,EAEL,YAAXhwD,EAEJ,YADAlM,KAAK66D,OAAS76D,KAAK66D,OAAOQ,IAAKr7D,KAAKm4D,UAAWl4D,KAIhD,IAAMiM,EAEL,OADAlM,KAAKq8D,aAAcp8D,EAAS87D,IACrB,EAEP,MAAQr1D,GAQT,MAPK1G,KAAKs1B,SAASq/B,OAASluD,OAAOqsC,SAClCA,QAAQ8hB,IAAK,4CAA8C30D,EAAQua,GAAK,gBAAkBuhD,EAAKz6C,OAAS,YAAa5a,GAEjHA,aAAay1D,YACjBz1D,EAAEqsC,SAAW,+CAAiD9yC,EAAQua,GAAK,gBAAkBuhD,EAAKz6C,OAAS,aAGtG5a,GAGR,IAAKw1D,EAML,OAHKl8D,KAAKo7D,aAAclF,IACvBl2D,KAAK+6D,YAAYjtD,KAAM7N,IAEjB,GAMRq8D,kBAAmB,SAAUr8D,EAASqhB,GACrC,OAAO3hB,EAAGM,GAAU+F,KAAM,MAAQsb,EAAOua,OAAQ,GAAI0gC,cACpDj7C,EAAO+f,UAAW,GAAIx8B,gBAAmBlF,EAAGM,GAAU+F,KAAM,QAI9Dw2D,cAAe,SAAUxlD,EAAMsK,GAC9B,IAAIomB,EAAI1nC,KAAKs1B,SAASmhC,SAAUz/C,GAChC,OAAO0wB,IAAOA,EAAE8V,cAAgBif,OAAS/0B,EAAIA,EAAGpmB,KAIjDo7C,YAAa,WACZ,IAAM,IAAIlwD,EAAI,EAAGA,EAAIuC,UAAU/H,OAAQwF,IACtC,QAAwBkI,IAAnB3F,UAAWvC,GACf,OAAOuC,UAAWvC,IAerBmwD,eAAgB,SAAU18D,EAAS87D,GACb,iBAATA,IACXA,GAASz6C,OAAQy6C,IAGlB,IAAIhpB,EAAU/yC,KAAK08D,YACjB18D,KAAKw8D,cAAev8D,EAAQ+W,KAAM+kD,EAAKz6C,QACvCthB,KAAKs8D,kBAAmBr8D,EAAS87D,EAAKz6C,SAGrCthB,KAAKs1B,SAASwiC,aAAe73D,EAAQ2xC,YAASl9B,EAC/C/U,EAAE01D,UAAUoB,SAAUsF,EAAKz6C,QAC3B,2CAA6CrhB,EAAQ+W,KAAO,aAE7D4lD,EAAW,gBAOZ,MANwB,mBAAZ7pB,EACXA,EAAUA,EAAQnoC,KAAM5K,KAAM+7D,EAAKK,WAAYn8D,GACpC28D,EAASntD,KAAMsjC,KAC1BA,EAAUpzC,EAAE01D,UAAUtvB,OAAQgN,EAAQrxC,QAASk7D,EAAU,QAAUb,EAAKK,aAGlErpB,GAGRspB,aAAc,SAAUp8D,EAAS87D,GAChC,IAAIhpB,EAAU/yC,KAAK28D,eAAgB18D,EAAS87D,GAE5C/7D,KAAKi2D,UAAUnoD,MACdilC,QAASA,EACT9yC,QAASA,EACTqhB,OAAQy6C,EAAKz6C,SAGdthB,KAAK+5D,SAAU95D,EAAQ+W,MAAS+7B,EAChC/yC,KAAKs4D,UAAWr4D,EAAQ+W,MAAS+7B,GAGlCuoB,WAAY,SAAUuB,GAIrB,OAHK78D,KAAKs1B,SAASwnC,UAClBD,EAAWA,EAASr5C,IAAKq5C,EAASz0D,OAAQpI,KAAKs1B,SAASwnC,WAElDD,GAGR7B,kBAAmB,WAClB,IAAIxuD,EAAG0mD,EAAU3+B,EACjB,IAAM/nB,EAAI,EAAGxM,KAAKi2D,UAAWzpD,GAAKA,IACjC+nB,EAAQv0B,KAAKi2D,UAAWzpD,GACnBxM,KAAKs1B,SAASqjC,WAClB34D,KAAKs1B,SAASqjC,UAAU/tD,KAAM5K,KAAMu0B,EAAMt0B,QAASD,KAAKs1B,SAASiiC,WAAYv3D,KAAKs1B,SAASmiC,YAE5Fz3D,KAAK+8D,UAAWxoC,EAAMt0B,QAASs0B,EAAMwe,SAKtC,GAHK/yC,KAAKi2D,UAAUjvD,SACnBhH,KAAK07D,OAAS17D,KAAK07D,OAAOl4C,IAAKxjB,KAAK05D,aAEhC15D,KAAKs1B,SAASwL,QAClB,IAAMt0B,EAAI,EAAGxM,KAAK+6D,YAAavuD,GAAKA,IACnCxM,KAAK+8D,UAAW/8D,KAAK+6D,YAAavuD,IAGpC,GAAKxM,KAAKs1B,SAAS2iC,YAClB,IAAMzrD,EAAI,EAAG0mD,EAAWlzD,KAAKg9D,gBAAiB9J,EAAU1mD,GAAKA,IAC5DxM,KAAKs1B,SAAS2iC,YAAYrtD,KAAM5K,KAAMkzD,EAAU1mD,GAAKxM,KAAKs1B,SAASiiC,WAAYv3D,KAAKs1B,SAASmiC,YAG/Fz3D,KAAK66D,OAAS76D,KAAK66D,OAAOQ,IAAKr7D,KAAK07D,QACpC17D,KAAKk7D,aACLl7D,KAAKs7D,WAAYt7D,KAAK07D,QAASryD,QAGhC2zD,cAAe,WACd,OAAOh9D,KAAKm6D,gBAAgBkB,IAAKr7D,KAAKi9D,oBAGvCA,gBAAiB,WAChB,OAAOt9D,EAAGK,KAAKi2D,WAAYtoD,IAAK,WAC/B,OAAO3N,KAAKC,WAId88D,UAAW,SAAU98D,EAAS8yC,GAC7B,IAAImqB,EAAO7iC,EAAO8iC,EAAS1C,EAC1BlmC,EAAQv0B,KAAKm4D,UAAWl4D,GACxBm9D,EAAYp9D,KAAKq9D,SAAUp9D,GAC3Bq9D,EAAc39D,EAAGM,GAAU2nB,KAAM,oBAE7B2M,EAAMvtB,QAGVutB,EAAMruB,YAAalG,KAAKs1B,SAASmiC,YAAarqD,SAAUpN,KAAKs1B,SAASiiC,YAGtEhjC,EAAM5uB,KAAMotC,KAUZmqB,EANA3oC,EAAQ50B,EAAG,IAAMK,KAAKs1B,SAASoiC,aAAe,KAC5C9vC,KAAM,KAAMw1C,EAAY,UACxBhwD,SAAUpN,KAAKs1B,SAASiiC,YACxB5xD,KAAMotC,GAAW,IAId/yC,KAAKs1B,SAASwnC,UAIlBI,EAAQ3oC,EAAMptB,OAAOkC,OAAOwhD,KAAM,IAAM7qD,KAAKs1B,SAASwnC,QAAU,MAAO10D,UAEnEpI,KAAKw5D,eAAexyD,OACxBhH,KAAKw5D,eAAejsD,OAAQ2vD,GACjBl9D,KAAKs1B,SAASioC,eACzBv9D,KAAKs1B,SAASioC,eAAe3yD,KAAM5K,KAAMk9D,EAAOv9D,EAAGM,IAEnDi9D,EAAMl6B,YAAa/iC,GAIfs0B,EAAM/iB,GAAI,SAGd+iB,EAAM3M,KAAM,MAAOw1C,GAI2E,IAAnF7oC,EAAMipC,QAAS,cAAgBx9D,KAAKy9D,cAAeL,GAAc,MAAOp2D,SACnFm2D,EAAU5oC,EAAM3M,KAAM,MAGhB01C,EAEOA,EAAYpxC,MAAO,IAAIxoB,OAAQ,MAAQ1D,KAAKy9D,cAAeN,GAAY,UAGnFG,GAAe,IAAMH,GAJrBG,EAAcH,EAMfx9D,EAAGM,GAAU2nB,KAAM,mBAAoB01C,IAGvCjjC,EAAQr6B,KAAKs3D,OAAQr3D,EAAQ+W,SAE5ByjD,EAAIz6D,KACJL,EAAEqN,KAAMytD,EAAEnD,OAAQ,SAAUtgD,EAAM2jD,GAC5BA,IAActgC,GAClB16B,EAAG,UAAY86D,EAAEgD,cAAezmD,GAAS,KAAMyjD,EAAE9E,aAC/C/tC,KAAM,mBAAoB2M,EAAM3M,KAAM,aAMvCmrB,GAAW/yC,KAAKs1B,SAASwL,UAC9BvM,EAAMzqB,KAAM,IAC0B,iBAA1B9J,KAAKs1B,SAASwL,QACzBvM,EAAMnnB,SAAUpN,KAAKs1B,SAASwL,SAE9B9gC,KAAKs1B,SAASwL,QAASvM,EAAOt0B,IAGhCD,KAAK07D,OAAS17D,KAAK07D,OAAOl4C,IAAK+Q,IAGhC4jC,UAAW,SAAUl4D,GACpB,IAAI+W,EAAOhX,KAAKy9D,cAAez9D,KAAKq9D,SAAUp9D,IAC7Cy9D,EAAY/9D,EAAGM,GAAU2nB,KAAM,oBAC/BoM,EAAW,cAAgBhd,EAAO,kBAAoBA,EAAO,OAQ9D,OALK0mD,IACJ1pC,EAAWA,EAAW,MAAQh0B,KAAKy9D,cAAeC,GAChDh8D,QAAS,OAAQ,QAGb1B,KACL86D,SACA3vD,OAAQ6oB,IAMXypC,cAAe,SAAUE,GACxB,OAAOA,EAAOj8D,QAAS,yCAA0C,SAGlE27D,SAAU,SAAUp9D,GACnB,OAAOD,KAAKs3D,OAAQr3D,EAAQ+W,QAAYhX,KAAKq4D,UAAWp4D,GAAYA,EAAQ+W,KAAO/W,EAAQua,IAAMva,EAAQ+W,OAG1GwjD,oBAAqB,SAAUv6D,GAQ9B,OALKD,KAAKq4D,UAAWp4D,KACpBA,EAAUD,KAAK44D,WAAY34D,EAAQ+W,OAI7BrX,EAAGM,GAAUo7D,IAAKr7D,KAAKs1B,SAASoN,QAAU,IAGlD21B,UAAW,SAAUp4D,GACpB,MAAO,kBAAsBwP,KAAMxP,EAAQ8D,OAG5C60D,WAAY,SAAU5hD,GACrB,OAAOrX,EAAGK,KAAK21D,aAAc3nD,KAAM,UAAYhO,KAAKy9D,cAAezmD,GAAS,OAG7E4mD,UAAW,SAAUt9D,EAAOL,GAC3B,OAASA,EAAQmpC,SAASvkC,eAC1B,IAAK,SACJ,OAAOlF,EAAG,kBAAmBM,GAAU+G,OACxC,IAAK,QACJ,GAAKhH,KAAKq4D,UAAWp4D,GACpB,OAAOD,KAAK44D,WAAY34D,EAAQ+W,MAAO7L,OAAQ,YAAanE,OAG9D,OAAO1G,EAAM0G,QAGd62D,OAAQ,SAAUhyD,EAAO5L,GACxB,OAAOD,KAAK89D,mBAAoBjyD,IAAU7L,KAAK89D,mBAAoBjyD,GAASA,EAAO5L,IAGpF69D,aACCC,QAAW,SAAUlyD,GACpB,OAAOA,GAER8xD,OAAU,SAAU9xD,EAAO5L,GAC1B,QAASN,EAAGkM,EAAO5L,EAAQ21D,MAAO5uD,QAEnCg3D,SAAY,SAAUnyD,EAAO5L,GAC5B,OAAO4L,EAAO5L,KAIhBs4D,SAAU,SAAUt4D,GACnB,IAAI8G,EAAM/G,KAAKy4D,aAAcx4D,GAC7B,OAAQN,EAAE01D,UAAU1tC,QAAQmvC,SAASlsD,KAAM5K,KAAM+G,EAAK9G,IAAa,uBAGpEg+D,aAAc,SAAUh+D,GACjBD,KAAK45D,QAAS35D,EAAQ+W,QAC3BhX,KAAK61D,iBACLl2D,EAAGM,GAAUmN,SAAUpN,KAAKs1B,SAASkiC,cACrCx3D,KAAK45D,QAAS35D,EAAQ+W,OAAS,IAIjCknD,YAAa,SAAUj+D,EAAS+1D,GAC/Bh2D,KAAK61D,iBAGA71D,KAAK61D,eAAiB,IAC1B71D,KAAK61D,eAAiB,UAEhB71D,KAAK45D,QAAS35D,EAAQ+W,MAC7BrX,EAAGM,GAAUiG,YAAalG,KAAKs1B,SAASkiC,cACnCxB,GAAiC,IAAxBh2D,KAAK61D,gBAAwB71D,KAAK01D,eAAiB11D,KAAK41D,QACrEj2D,EAAGK,KAAK21D,aAAcxM,SAMjBnpD,KAAKu1D,cACT51D,EAAG,sBAAwBK,KAAKu1D,aAAav+C,KAAO,KAAMhX,KAAK21D,aAAchnD,SAG9E3O,KAAK01D,eAAgB,IACTM,GAAiC,IAAxBh2D,KAAK61D,gBAAwB71D,KAAK01D,gBACvD/1D,EAAGK,KAAK21D,aAAcqE,eAAgB,gBAAkBh6D,OACxDA,KAAK01D,eAAgB,IAIvByI,cAAe,SAAUl+D,EAASqhB,GAGjC,OAFAA,EAA2B,iBAAXA,GAAuBA,GAAU,SAE1C3hB,EAAEqG,KAAM/F,EAAS,kBAAqBN,EAAEqG,KAAM/F,EAAS,iBAC7Dm+D,IAAK,KACLpI,OAAO,EACPjjB,QAAS/yC,KAAK28D,eAAgB18D,GAAWqhB,OAAQA,OAKnD2jB,QAAS,WACRjlC,KAAKi7D,YAELt7D,EAAGK,KAAK21D,aACNlnD,IAAK,aACLC,WAAY,aACZV,KAAM,0BACLS,IAAK,qBACLvI,YAAa,2BAKlBm4D,mBACCvH,UAAYA,UAAU,GACtBgC,OAASA,OAAO,GAChB/sD,KAAOA,KAAK,GACZgtD,MAAQA,MAAM,GACdC,SAAWA,SAAS,GACpBlZ,QAAUA,QAAQ,GAClBllC,QAAUA,QAAQ,GAClB0jD,YAAcA,YAAY,IAG3BC,cAAe,SAAUv8D,EAAWk0D,GAC9Bl0D,EAAUw7C,cAAgBif,OAC9Bz8D,KAAKq+D,kBAAmBr8D,GAAck0D,EAEtCv2D,EAAEmB,OAAQd,KAAKq+D,kBAAmBr8D,IAIpC20D,WAAY,SAAU12D,GACrB,IAAIi2D,KACHl1D,EAAUrB,EAAGM,GAAU2nB,KAAM,SAS9B,OAPK5mB,GACJrB,EAAEqN,KAAMhM,EAAQgK,MAAO,KAAO,WACxBhL,QAAQL,EAAE01D,UAAUgJ,mBACxB1+D,EAAEmB,OAAQo1D,EAAOv2D,EAAE01D,UAAUgJ,kBAAmBr+D,SAI5Ck2D,GAGRsI,uBAAwB,SAAUtI,EAAOnyD,EAAMud,EAAQhhB,GAIjD,eAAemP,KAAM6R,KAAuB,OAATvd,GAAiB,oBAAoB0L,KAAM1L,MAClFzD,EAAQm+D,OAAQn+D,GAGXgrB,MAAOhrB,KACXA,OAAQoU,IAILpU,GAAmB,IAAVA,EACb41D,EAAO50C,GAAWhhB,EACPyD,IAASud,GAAmB,UAATvd,IAI9BmyD,EAAO50C,IAAW,IAIpBs1C,eAAgB,SAAU32D,GACzB,IAGCqhB,EAAQhhB,EAHL41D,KACH3Y,EAAW59C,EAAGM,GACd8D,EAAO9D,EAAQs4C,aAAc,QAG9B,IAAMj3B,KAAU3hB,EAAE01D,UAAU1tC,QAGX,aAAXrG,GAKW,MAJfhhB,EAAQL,EAAQs4C,aAAcj3B,MAK7BhhB,GAAQ,GAITA,IAAUA,GAEVA,EAAQi9C,EAAS31B,KAAMtG,GAGxBthB,KAAKw+D,uBAAwBtI,EAAOnyD,EAAMud,EAAQhhB,GAQnD,OAJK41D,EAAMgD,WAAa,uBAAuBzpD,KAAMymD,EAAMgD,mBACnDhD,EAAMgD,UAGPhD,GAGRW,UAAW,SAAU52D,GACpB,IAGCqhB,EAAQhhB,EAHL41D,KACH3Y,EAAW59C,EAAGM,GACd8D,EAAO9D,EAAQs4C,aAAc,QAG9B,IAAMj3B,KAAU3hB,EAAE01D,UAAU1tC,QAC3BrnB,EAAQi9C,EAASv3C,KAAM,OAASsb,EAAOua,OAAQ,GAAI0gC,cAAgBj7C,EAAO+f,UAAW,GAAIx8B,eACzF7E,KAAKw+D,uBAAwBtI,EAAOnyD,EAAMud,EAAQhhB,GAEnD,OAAO41D,GAGRE,YAAa,SAAUn2D,GACtB,IAAIi2D,KACHb,EAAY11D,EAAEqG,KAAM/F,EAAQ21D,KAAM,aAKnC,OAHKP,EAAU//B,SAAS4gC,QACvBA,EAAQv2D,EAAE01D,UAAUmB,cAAenB,EAAU//B,SAAS4gC,MAAOj2D,EAAQ+W,YAE/Dk/C,GAGRQ,eAAgB,SAAUR,EAAOj2D,GAmEhC,OAhEAN,EAAEqN,KAAMkpD,EAAO,SAAUpxB,EAAM/9B,GAG9B,IAAa,IAARA,GAIL,GAAKA,EAAI8E,OAAS9E,EAAI23D,QAAU,CAC/B,IAAIC,GAAW,EACf,cAAgB53D,EAAI23D,SACpB,IAAK,SACJC,IAAah/D,EAAGoH,EAAI23D,QAASz+D,EAAQ21D,MAAO5uD,OAC5C,MACD,IAAK,WACJ23D,EAAW53D,EAAI23D,QAAQ9zD,KAAM3K,EAASA,GAGlC0+D,EACJzI,EAAOpxB,QAAuBpwB,IAAd3N,EAAI8E,OAAsB9E,EAAI8E,OAE9ClM,EAAEqG,KAAM/F,EAAQ21D,KAAM,aAAcuF,cAAex7D,EAAGM,WAC/Ci2D,EAAOpxB,iBAjBRoxB,EAAOpxB,KAuBhBnlC,EAAEqN,KAAMkpD,EAAO,SAAU6F,EAAM6C,GAC9B1I,EAAO6F,GAASp8D,EAAEiM,WAAYgzD,IAAwB,eAAT7C,EAAwB6C,EAAW3+D,GAAY2+D,IAI7Fj/D,EAAEqN,MAAQ,YAAa,aAAe,WAChCkpD,EAAOl2D,QACXk2D,EAAOl2D,MAASy+D,OAAQvI,EAAOl2D,UAGjCL,EAAEqN,MAAQ,cAAe,SAAW,WACnC,IAAIjC,EACCmrD,EAAOl2D,QACNL,EAAE6H,QAAS0uD,EAAOl2D,OACtBk2D,EAAOl2D,OAAWy+D,OAAQvI,EAAOl2D,MAAQ,IAAOy+D,OAAQvI,EAAOl2D,MAAQ,KACnC,iBAAlBk2D,EAAOl2D,QACzB+K,EAAQmrD,EAAOl2D,MAAO0B,QAAS,UAAW,IAAKsJ,MAAO,UACtDkrD,EAAOl2D,OAAWy+D,OAAQ1zD,EAAO,IAAO0zD,OAAQ1zD,EAAO,SAKrDpL,EAAE01D,UAAUgE,mBAGE,MAAbnD,EAAMt2B,KAA4B,MAAbs2B,EAAMhtD,MAC/BgtD,EAAMzsD,OAAUysD,EAAMt2B,IAAKs2B,EAAMhtD,YAC1BgtD,EAAMt2B,WACNs2B,EAAMhtD,KAEU,MAAnBgtD,EAAMiD,WAAwC,MAAnBjD,EAAMgD,YACrChD,EAAMkD,aAAgBlD,EAAMiD,UAAWjD,EAAMgD,kBACtChD,EAAMiD,iBACNjD,EAAMgD,YAIRhD,GAIRM,cAAe,SAAUxwD,GACxB,GAAqB,iBAATA,EAAoB,CAC/B,IAAI64D,KACJl/D,EAAEqN,KAAMhH,EAAKgF,MAAO,MAAQ,WAC3B6zD,EAAa7+D,OAAS,IAEvBgG,EAAO64D,EAER,OAAO74D,GAIR84D,UAAW,SAAU9nD,EAAMsK,EAAQyxB,GAClCpzC,EAAE01D,UAAU1tC,QAAS3Q,GAASsK,EAC9B3hB,EAAE01D,UAAUoB,SAAUz/C,QAAqBtC,IAAZq+B,EAAwBA,EAAUpzC,EAAE01D,UAAUoB,SAAUz/C,GAClFsK,EAAOta,OAAS,GACpBrH,EAAE01D,UAAUkJ,cAAevnD,EAAMrX,EAAE01D,UAAUmB,cAAex/C,KAK9D2Q,SAGCmvC,SAAU,SAAUx2D,EAAOL,EAAS4L,GAGnC,IAAM7L,KAAK69D,OAAQhyD,EAAO5L,GACzB,MAAO,sBAER,GAAwC,WAAnCA,EAAQmpC,SAASvkC,cAA6B,CAGlD,IAAIkC,EAAMpH,EAAGM,GAAU8G,MACvB,OAAOA,GAAOA,EAAIC,OAAS,EAE5B,OAAKhH,KAAKq4D,UAAWp4D,GACbD,KAAK49D,UAAWt9D,EAAOL,GAAY,EAEpCK,EAAM0G,OAAS,GAIvB8xD,MAAO,SAAUx4D,EAAOL,GAMvB,OAAOD,KAAKu4D,SAAUt4D,IAAa,wIAAwIwP,KAAMnP,IAIlLyL,IAAK,SAAUzL,EAAOL,GAMrB,OAAOD,KAAKu4D,SAAUt4D,IAAa,2cAA2cwP,KAAMnP,IAIrfy4D,KAAM,SAAUz4D,EAAOL,GACtB,OAAOD,KAAKu4D,SAAUt4D,KAAc,cAAcwP,KAAM,IAAI0yB,KAAM7hC,GAAQixC,aAI3EynB,QAAS,SAAU14D,EAAOL,GACzB,OAAOD,KAAKu4D,SAAUt4D,IAAa,+DAA+DwP,KAAMnP,IAIzGw/C,OAAQ,SAAUx/C,EAAOL,GACxB,OAAOD,KAAKu4D,SAAUt4D,IAAa,8CAA8CwP,KAAMnP,IAIxFsa,OAAQ,SAAUta,EAAOL,GACxB,OAAOD,KAAKu4D,SAAUt4D,IAAa,QAAQwP,KAAMnP,IAIlD64D,UAAW,SAAU74D,EAAOL,EAAS4L,GACpC,IAAI7E,EAASrH,EAAE6H,QAASlH,GAAUA,EAAM0G,OAAShH,KAAK49D,UAAWt9D,EAAOL,GACxE,OAAOD,KAAKu4D,SAAUt4D,IAAa+G,GAAU6E,GAI9CqtD,UAAW,SAAU54D,EAAOL,EAAS4L,GACpC,IAAI7E,EAASrH,EAAE6H,QAASlH,GAAUA,EAAM0G,OAAShH,KAAK49D,UAAWt9D,EAAOL,GACxE,OAAOD,KAAKu4D,SAAUt4D,IAAa+G,GAAU6E,GAI9CutD,YAAa,SAAU94D,EAAOL,EAAS4L,GACtC,IAAI7E,EAASrH,EAAE6H,QAASlH,GAAUA,EAAM0G,OAAShH,KAAK49D,UAAWt9D,EAAOL,GACxE,OAAOD,KAAKu4D,SAAUt4D,IAAe+G,GAAU6E,EAAO,IAAO7E,GAAU6E,EAAO,IAI/E+zB,IAAK,SAAUt/B,EAAOL,EAAS4L,GAC9B,OAAO7L,KAAKu4D,SAAUt4D,IAAaK,GAASuL,GAI7C3C,IAAK,SAAU5I,EAAOL,EAAS4L,GAC9B,OAAO7L,KAAKu4D,SAAUt4D,IAAaK,GAASuL,GAI7CpC,MAAO,SAAUnJ,EAAOL,EAAS4L,GAChC,OAAO7L,KAAKu4D,SAAUt4D,IAAeK,GAASuL,EAAO,IAAOvL,GAASuL,EAAO,IAI7EqL,KAAM,SAAU5W,EAAOL,EAAS4L,GAC/B,IAkBCkzD,EAlBGh7D,EAAOpE,EAAGM,GAAU2nB,KAAM,QAC7Bo3C,EAAe,gCAAkCj7D,EAAO,qBAExDk7D,EAAK,IAAIv7D,OAAQ,MAAQK,EAAO,OAEhCm7D,EAAgB,SAAUprB,GACzB,IAAI5nB,GAAU,GAAK4nB,GAAM5nB,MAAO,iBAChC,OAAMA,GAKCA,EAAO,GAAMA,EAAO,GAAIllB,OAJvB,GAMTm4D,EAAQ,SAAUrrB,GACjB,OAAO7qC,KAAKynB,MAAOojB,EAAM7qC,KAAK8/B,IAAK,GAAIg2B,KAExC/I,GAAQ,EAKT,GAlBgBjyD,IAASk7D,EAAGxvD,MAFR,OAAQ,SAAU,SAEWyC,QAmBhD,MAAM,IAAIktD,MAAOJ,GAUlB,OAPAD,EAAWG,EAAerzD,IAGrBqzD,EAAe5+D,GAAUy+D,GAAYI,EAAO7+D,GAAU6+D,EAAOtzD,IAAY,KAC7EmqD,GAAQ,GAGFh2D,KAAKu4D,SAAUt4D,IAAa+1D,GAIpCiD,QAAS,SAAU34D,EAAOL,EAAS4L,GAGlC,IAAIuX,EAASzjB,EAAGkM,GAMhB,OALK7L,KAAKs1B,SAAS8iC,YAAch1C,EAAOi4C,IAAK,0BAA2Br0D,QACvEoc,EAAOhW,SAAU,yBAA0BtH,GAAI,wBAAyB,WACvEnG,EAAGM,GAAU+1D,UAGR11D,IAAU8iB,EAAOrc,OAIzBgwD,OAAQ,SAAUz2D,EAAOL,EAAS4L,EAAOyV,GACxC,GAAKthB,KAAKu4D,SAAUt4D,GACnB,MAAO,sBAGRqhB,EAA2B,iBAAXA,GAAuBA,GAAU,SAEjD,IACC+zC,EAAWrvD,EAAMq5D,EADdljC,EAAWn8B,KAAKm+D,cAAel+D,EAASqhB,GAW5C,OARMthB,KAAKs1B,SAASmhC,SAAUx2D,EAAQ+W,QACrChX,KAAKs1B,SAASmhC,SAAUx2D,EAAQ+W,UAEjCmlB,EAASmjC,gBAAkBnjC,EAASmjC,iBAAmBt/D,KAAKs1B,SAASmhC,SAAUx2D,EAAQ+W,MAAQsK,GAC/FthB,KAAKs1B,SAASmhC,SAAUx2D,EAAQ+W,MAAQsK,GAAW6a,EAAS4W,QAE5DlnC,EAAyB,iBAAVA,IAAwBE,IAAKF,IAAWA,EACvDwzD,EAAmB1/D,EAAEkM,MAAOlM,EAAEmB,QAAUkF,KAAM1F,GAASuL,EAAM7F,OACxDm2B,EAASiiC,MAAQiB,EACdljC,EAAS65B,OAGjB75B,EAASiiC,IAAMiB,EACfhK,EAAYr1D,KACZA,KAAKi+D,aAAch+D,GACnB+F,KACAA,EAAM/F,EAAQ+W,MAAS1W,EACvBX,EAAEqM,KAAMrM,EAAEmB,QAAQ,GACjBy+D,KAAM,QACNC,KAAM,WAAav/D,EAAQ+W,KAC3B1S,SAAU,OACV0B,KAAMA,EACNy5D,QAASpK,EAAUM,YACnB70B,QAAS,SAAU77B,GAClB,IACC61D,EAAQ/nB,EAASulB,EADdtC,GAAqB,IAAb/wD,GAAkC,SAAbA,EAGjCowD,EAAU//B,SAASmhC,SAAUx2D,EAAQ+W,MAAQsK,GAAW6a,EAASmjC,gBAC5DtJ,GACJsC,EAAYjD,EAAUK,cACtBL,EAAUoG,iBACVpG,EAAUwF,OAASxF,EAAU8C,UAAWl4D,GACxCo1D,EAAUK,cAAgB4C,EAC1BjD,EAAU0F,YAAYjtD,KAAM7N,GAC5Bo1D,EAAUqD,QAASz4D,EAAQ+W,OAAS,EACpCq+C,EAAU4E,eAEVa,KACA/nB,EAAU9tC,GAAYowD,EAAUsH,eAAgB18D,GAAWqhB,OAAQA,EAAQ86C,WAAY97D,IACvFw6D,EAAQ76D,EAAQ+W,MAASmlB,EAAS4W,QAAUA,EAC5CsiB,EAAUqD,QAASz4D,EAAQ+W,OAAS,EACpCq+C,EAAU4E,WAAYa,IAEvB3+B,EAAS65B,MAAQA,EACjBX,EAAU6I,YAAaj+D,EAAS+1D,KAE/BnqD,IACI,eAUV,IACCG,EADG0zD,KA+BJ,OA3BK//D,EAAEggE,cACNhgE,EAAEggE,cAAe,SAAUrqC,EAAUsqC,EAAGC,GACvC,IAAIL,EAAOlqC,EAASkqC,KACG,UAAlBlqC,EAASiqC,OACRG,EAAiBF,IACrBE,EAAiBF,GAAOn4D,QAEzBq4D,EAAiBF,GAASK,MAM5B7zD,EAAOrM,EAAEqM,KACTrM,EAAEqM,KAAO,SAAUspB,GAClB,IAAIiqC,GAAS,SAAUjqC,EAAWA,EAAW31B,EAAEkD,cAAe08D,KAC7DC,GAAS,SAAUlqC,EAAWA,EAAW31B,EAAEkD,cAAe28D,KAC3D,MAAc,UAATD,GACCG,EAAiBF,IACrBE,EAAiBF,GAAOn4D,QAEzBq4D,EAAiBF,GAASxzD,EAAKgX,MAAOhjB,KAAM+O,WACrC2wD,EAAiBF,IAElBxzD,EAAKgX,MAAOhjB,KAAM+O,aAGpBpP;CCzjDN,SAASN,GACN,mBAAqBC,QAAUA,OAAOC,IAAMD,QAAS,UAAYD,GAAWA,EAAQ,iBAAmBG,QAAUC,QAAQ,UAAYC,QADxI,CAEC,SAASC,GACP,IAAImgE,EAAgBC,EAAK56B,UAAUC,UAAW46B,EAAS,UAAUvwD,KAAKswD,GAAKE,EAAS,UAAUxwD,KAAKswD,GAAKG,EAAU,WAAWzwD,KAAKswD,GAClIpgE,EAAEwgE,MACEC,aACIlM,EAAK,QACL3+C,EAAG,WACH8qD,IAAK,eAETC,WAAW,EACXC,SAAU,YACVC,YAAa,KACd7gE,EAAEiP,GAAG9N,QACJ2/D,MAAO,SAASC,EAAOnhC,GACnB,IAAI91B,EACJ,GAAI,IAAMzJ,KAAKgH,SAAWhH,KAAKwR,GAAG,WAAY,MAAO,iBAAmBkvD,GAASnhC,EAAM,iBAAmBA,EAAMA,EAAMmhC,EACtH1gE,KAAKgN,KAAK,WACNhN,KAAK2gE,kBAAoB3gE,KAAK2gE,kBAAkBD,EAAOnhC,GAAOv/B,KAAK4gE,mBAAoBn3D,EAAQzJ,KAAK4gE,mBAC9FC,UAAS,GAAKp3D,EAAMq3D,QAAQ,YAAavhC,GAAM91B,EAAMI,UAAU,YAAa62D,GAClFj3D,EAAMtD,cACHnG,KAAK,GAAG2gE,mBAAqBD,EAAQ1gE,KAAK,GAAG2J,eAAgB41B,EAAMv/B,KAAK,GAAG+oB,cAAgBjnB,SAAST,WAAaS,SAAST,UAAUuI,cAAgBH,EAAQ3H,SAAST,UAAUuI,cACtL82D,EAAQ,EAAIj3D,EAAMs3D,YAAYl3D,UAAU,aAAc,KAAM01B,EAAMmhC,EAAQj3D,EAAMK,KAAK9C,SAEjF05D,MAAOA,EACPnhC,IAAKA,KAGbyhC,OAAQ,WACJ,OAAOhhE,KAAK8iB,QAAQ,WAExBq9C,KAAM,SAASA,EAAM7qC,GACjB,IAAI2rC,EAAOC,EAAMC,EAAOC,EAAiBC,EAAiBC,EAAwBhiB,EAAKiiB,EACvF,IAAKpB,GAAQngE,KAAKgH,OAAS,EAAG,CAE1B,IAAI4H,GADJqyD,EAAQthE,EAAEK,KAAK,KACAgG,KAAKrG,EAAEwgE,KAAKI,UAC3B,OAAO3xD,EAAKA,SAAO,EAEvB,OAAO0mB,EAAW31B,EAAEmB,QAChBw/D,UAAW3gE,EAAEwgE,KAAKG,UAClBE,YAAa7gE,EAAEwgE,KAAKK,YACpBgB,UAAW,MACZlsC,GAAW4rC,EAAOvhE,EAAEwgE,KAAKC,YAAae,KAAYC,EAAkB9hB,EAAM6gB,EAAKn5D,OAClFq6D,EAAkB,KAAM1hE,EAAEqN,KAAKmzD,EAAKn1D,MAAM,IAAK,SAASwB,EAAGi1D,GACvD,KAAOA,GAAKniB,IAAO8hB,EAAkB50D,GAAK00D,EAAKO,IAAMN,EAAMrzD,KAAK,IAAIpK,OAAOw9D,EAAKO,KAChF,OAASJ,IAAoBA,EAAkBF,EAAMn6D,OAAS,GAAIo6D,EAAkB50D,IAAM80D,EAAyBH,EAAMn6D,OAAS,IAAMm6D,EAAMrzD,KAAK,QACnJ9N,KAAK8iB,QAAQ,UAAU9V,KAAK,WAC5B,SAAS00D,IACL,GAAIpsC,EAASksC,UAAW,CACpB,IAAK,IAAIh1D,EAAI60D,EAAiBC,GAA0B90D,EAAGA,IAAK,GAAI20D,EAAM30D,IAAMm1D,EAAOn1D,KAAOo1D,EAAep1D,GAAI,OACjH8oB,EAASksC,UAAU52D,KAAKq2D,IAGhC,SAASW,EAAep1D,GACpB,OAAO8oB,EAASkrC,YAAY3kC,OAAOrvB,EAAI8oB,EAASkrC,YAAYx5D,OAASwF,EAAI,GAE7E,SAASq1D,EAAS5kC,GACd,OAAQA,EAAMqiB,IAAQ6hB,EAAMlkC,KAC5B,OAAOA,EAEX,SAAS6kC,EAAS7kC,GACd,OAAQA,GAAO,IAAMkkC,EAAMlkC,KAC3B,OAAOA,EAEX,SAAS8kC,EAAOrB,EAAOnhC,GACnB,IAAI/yB,EAAGggB,EACP,KAAM,EAAIk0C,GAAQ,CACd,IAAKl0D,EAAIk0D,EAAOl0C,EAAIq1C,EAAStiC,GAAM+f,EAAM9yC,EAAGA,IAAK,GAAI20D,EAAM30D,GAAI,CAC3D,KAAM8yC,EAAM9yB,GAAK20C,EAAM30D,GAAGiD,KAAKkyD,EAAOn1C,KAAM,MAC5Cm1C,EAAOn1D,GAAKm1D,EAAOn1C,GAAIm1C,EAAOn1C,GAAKo1C,EAAep1C,GAAIA,EAAIq1C,EAASr1C,GAEvEw1C,IAAef,EAAMR,MAAMx3D,KAAKC,IAAIm4D,EAAiBX,KAG7D,SAASuB,EAAOhlC,GACZ,IAAIzwB,EAAGi1D,EAAGj1C,EAAGmN,EACb,IAAKntB,EAAIywB,EAAKwkC,EAAIG,EAAe3kC,GAAMqiB,EAAM9yC,EAAGA,IAAK,GAAI20D,EAAM30D,GAAI,CAC/D,GAAIggB,EAAIq1C,EAASr1D,GAAImtB,EAAIgoC,EAAOn1D,GAAIm1D,EAAOn1D,GAAKi1D,IAAKniB,EAAM9yB,GAAK20C,EAAM30C,GAAG/c,KAAKkqB,IAAK,MACnF8nC,EAAI9nC,GAeZ,SAASuoC,IACLC,IAAYlB,EAAMl6D,OAASq7D,GAAanB,EAAMoB,SA8BlD,SAASC,EAAYptD,EAAOqqB,GACxB,IAAI/yB,EACJ,IAAKA,EAAI0I,EAAOqqB,EAAM/yB,GAAK8yC,EAAM9yC,EAAGA,IAAK20D,EAAM30D,KAAOm1D,EAAOn1D,GAAKo1D,EAAep1D,IAErF,SAASw1D,IACLf,EAAMl6D,IAAI46D,EAAOzvD,KAAK,KAE1B,SAASiwD,EAASI,GACd,IAAI/1D,EAAGi1D,EAAGxkC,EAAKxtB,EAAOwxD,EAAMl6D,MAAOy7D,GAAa,EAChD,IAAKh2D,EAAI,EAAGywB,EAAM,EAAGqiB,EAAM9yC,EAAGA,IAAK,GAAI20D,EAAM30D,GAAI,CAC7C,IAAKm1D,EAAOn1D,GAAKo1D,EAAep1D,GAAIywB,IAAQxtB,EAAKzI,QAAU,GAAIy6D,EAAIhyD,EAAKosB,OAAOoB,EAAM,GACrFkkC,EAAM30D,GAAGiD,KAAKgyD,GAAI,CACdE,EAAOn1D,GAAKi1D,EAAGe,EAAYh2D,EAC3B,MAEJ,GAAIywB,EAAMxtB,EAAKzI,OAAQ,CACnBs7D,EAAY91D,EAAI,EAAG8yC,GACnB,YAEDqiB,EAAOn1D,KAAOiD,EAAKosB,OAAOoB,IAAQA,IAAOmkC,EAAkB50D,IAAMg2D,EAAYh2D,GACpF,OAAO+1D,EAAQP,IAAgBZ,EAAkBoB,EAAY,EAAIltC,EAASgrC,WAAaqB,EAAOzvD,KAAK,MAAQuwD,GAAiBxB,EAAMl6D,OAASk6D,EAAMl6D,IAAI,IACrJu7D,EAAY,EAAGhjB,IAAQ0iB,KAAiBA,IAAef,EAAMl6D,IAAIk6D,EAAMl6D,MAAMs6B,UAAU,EAAGmhC,EAAY,KACtGpB,EAAkB50D,EAAI60D,EAE1B,IAAIJ,EAAQthE,EAAEK,MAAO2hE,EAAShiE,EAAEgO,IAAIwyD,EAAKn1D,MAAM,IAAK,SAASy2D,EAAGj1D,GAC5D,MAAO,KAAOi1D,EAAIP,EAAKO,GAAKG,EAAep1D,GAAKi1D,OAAI,IACpDgB,EAAgBd,EAAOzvD,KAAK,IAAKkwD,EAAYnB,EAAMl6D,MACvDk6D,EAAMj7D,KAAKrG,EAAEwgE,KAAKI,SAAU,WACxB,OAAO5gE,EAAEgO,IAAIg0D,EAAQ,SAASF,EAAGj1D,GAC7B,OAAO20D,EAAM30D,IAAMi1D,GAAKG,EAAep1D,GAAKi1D,EAAI,OACjDvvD,KAAK,MACR+uD,EAAM39C,IAAI,SAAU,WACpB29C,EAAMxyD,IAAI,SAASC,WAAW/O,EAAEwgE,KAAKI,YACtCz6D,GAAG,aAAc,WAChB,IAAKm7D,EAAMn8B,KAAK,YAAa,CACzB1+B,aAAa05D,GACb,IAAI7iC,EACJmlC,EAAYnB,EAAMl6D,MAAOk2B,EAAMklC,IAAYrC,EAAiB54D,WAAW,WACnE+5D,EAAMr7D,IAAI,KAAO9D,SAAS+mB,gBAAkBm5C,IAAe/kC,GAAOkjC,EAAKz+D,QAAQ,IAAK,IAAIsF,OAASi6D,EAAMR,MAAM,EAAGxjC,GAAOgkC,EAAMR,MAAMxjC,KACpI,OAERn3B,GAAG,YAAao8D,GAAWp8D,GAAG,eArEjC,SAAsBY,GAClB,IAAKu6D,EAAMn8B,KAAK,YAAa,CACzB,IAAI7H,EAAKyjC,EAAOnhC,EAAKmjC,EAAIh8D,EAAEqD,OAASrD,EAAEi2B,QACtC4kC,EAASN,EAAMl6D,MAAO,IAAM27D,GAAK,KAAOA,GAAK1C,GAAU,MAAQ0C,GAAKzlC,EAAMgkC,EAAMR,QAChFC,EAAQzjC,EAAIyjC,OAAOnhC,EAAMtC,EAAIsC,KAAWmhC,GAAU,IAAMA,EAAQ,KAAOgC,EAAIZ,EAASpB,GAASnhC,EAAMsiC,EAASnB,EAAQ,GACpHnhC,EAAM,KAAOmjC,EAAIb,EAAStiC,GAAOA,GAAM+iC,EAAY5B,EAAOnhC,GAAMwiC,EAAOrB,EAAOnhC,EAAM,GACpF74B,EAAE2D,kBAAoB,KAAOq4D,EAAIR,EAAUt3D,KAAK5K,KAAM0G,GAAK,KAAOg8D,IAAMzB,EAAMl6D,IAAIq7D,GAClFnB,EAAMR,MAAM,EAAG0B,KAAaz7D,EAAE2D,qBA8DyBvE,GAAG,gBA3DlE,SAAuBY,GACnB,IAAKu6D,EAAMn8B,KAAK,YAAa,CACzB,IAAI6C,EAAG85B,EAAGrlC,EAAMsmC,EAAIh8D,EAAEqD,OAASrD,EAAEi2B,QAASM,EAAMgkC,EAAMR,QAChD/5D,EAAEi8D,SAAWj8D,EAAEk8D,QAAUl8D,EAAEm8D,SAAW,GAAKH,IAAMA,GAAK,KAAOA,IAC3DzlC,EAAIsC,IAAMtC,EAAIyjC,OAAU,IAAM4B,EAAYrlC,EAAIyjC,MAAOzjC,EAAIsC,KAAMwiC,EAAO9kC,EAAIyjC,MAAOzjC,EAAIsC,IAAM,IAC/FoI,EAAIk6B,EAAS5kC,EAAIyjC,MAAQ,GAAIphB,EAAM3X,IAAM85B,EAAIhF,OAAOqG,aAAaJ,GAAIvB,EAAMx5B,GAAGl4B,KAAKgyD,MAC3EQ,EAAOt6B,GAAIg6B,EAAOh6B,GAAK85B,EAAGO,IAAe5lC,EAAOylC,EAASl6B,GAAIu4B,EAI7Dh5D,WAHY,WACRvH,EAAEgS,MAAMhS,EAAEiP,GAAG6xD,MAAOQ,EAAO7kC,EAA3Bz8B,IAEc,GACfshE,EAAMR,MAAMrkC,GACnBa,EAAIyjC,OAASY,GAA0BI,KAE3Ch7D,EAAE2D,qBA6CoFvE,GAAG,wBAAyB,WAC1Hm7D,EAAMn8B,KAAK,aAAe59B,WAAW,WACjC,IAAI+1B,EAAMklC,GAAS,GACnBlB,EAAMR,MAAMxjC,GAAMykC,KACnB,KACHzB,GAAUC,GAAWe,EAAMxyD,IAAI,cAAc3I,GAAG,aAzFpD,WACI,IAAIi9D,EAAS9B,EAAMl6D,MAAOk2B,EAAMgkC,EAAMR,QACtC,GAAIc,GAAUA,EAAOv6D,QAAUu6D,EAAOv6D,OAAS+7D,EAAO/7D,OAAQ,CAC1D,IAAKm7D,GAAS,GAAKllC,EAAIyjC,MAAQ,IAAMS,EAAMlkC,EAAIyjC,MAAQ,IAAMzjC,EAAIyjC,QACjE,GAAI,IAAMzjC,EAAIyjC,MAAO,KAAMzjC,EAAIyjC,MAAQW,IAAoBF,EAAMlkC,EAAIyjC,QAAUzjC,EAAIyjC,QACnFO,EAAMR,MAAMxjC,EAAIyjC,MAAOzjC,EAAIyjC,WACxB,CACH,IAAKyB,GAAS,GAAKllC,EAAIyjC,MAAQphB,IAAQ6hB,EAAMlkC,EAAIyjC,QAAUzjC,EAAIyjC,QAC/DO,EAAMR,MAAMxjC,EAAIyjC,MAAOzjC,EAAIyjC,OAE/BgB,MAgFJS;CCtKd,SAAS9iE,GACY,mBAAXC,QAAyBA,OAAOC,IAE1CD,QAAQ,UAAWD,GACU,iBAAZG,QAEjB4P,OAAO5P,QAAUH,EAAQM,GAAKF,QAAQ,WAEtCJ,EAAQK,QART,CAUC,SAASC,GAEV,aA+BA,SAASqjE,EAAO/iE,EAASH,GACxBE,KAAKC,QAAUA,EACfD,KAAKF,QAAUH,EAAEmB,UAAWC,EAAUjB,GACtC,IAAImjE,EAASjjE,KAAKF,QAAQmjE,YACWvuD,IAAjC1U,KAAKF,QAAQojE,QAAQD,IACxBtjE,EAAEmB,OAAOd,KAAKF,QAASE,KAAKF,QAAQojE,QAAQD,IAE7CjjE,KAAK+6B,OAigCN,SAASooC,EAAgBz8D,GAGxB,IAAK/G,EAAE+G,EAAE0c,QAAQo6C,UAAUhhC,SAAS,iBAAwC,UAArB91B,EAAE0c,OAAOgmB,UAC3DzpC,EAAE,2BAA2BqH,OAAQ,CACxC,IAAIo8D,EAAYzjE,EAAE,2BAChB2pB,EAAS3pB,EAAE,iCAAkCyjE,GAC7CC,EAAW1jE,EAAE,6BAA8ByjE,GACrCA,EAAUp1D,KAAK,UAAUhI,KAAK,IAAMs9D,GAAYxjE,QAGpDyjE,eAAe34D,KAAKw4D,GAEpB95C,EAAOtiB,QAAQsiB,EAAOviB,IAAI,IAAIy8D,QAClCH,EAASl8D,OAAO6G,KAAK,UAAUZ,SAAS,YACxCg2D,EAAUl9D,YAAY,mCApjCzB,IAAIo9D,EAAa,SACfviE,GACC0iE,SAAU,UACVC,gBAAiB,iBACjBC,WAAY,WACZC,WAAY,qBACZC,kBAAmB,cACnBC,cAAc,EACdC,kBAAmB,GACnBC,qBAAsB,wBACtBC,wBAAyB,WACzBC,qBAAsB,EACtBC,wBAAwB,EACxBlB,OAAQ,KACRC,SACC5qC,IACCorC,gBAAiB,mBACjBC,WAAY,YACZC,WAAY,qBACZC,kBAAmB,YACnBG,qBAAsB,mBACtBC,wBAAyB,cAG3BG,eAAgB,aAChBb,eAAgB,aAChBc,aAAc,cAajBrB,EAAOz9D,WAGNw1B,KAAM,WAQL,SAASupC,SACc5vD,IAAlB7U,EAAG+nB,KAAK,OAAyC,KAAlB/nB,EAAG+nB,KAAK,QAC1C5nB,KAAKwa,GAAK3a,EAAG+nB,KAAK,MAAQ28C,EAAId,UAE/BzjE,KAAK4xC,MAAQ/xC,EAAG+nB,KAAK,SACrB5nB,KAAKgB,QAAUnB,EAAG+nB,KAAK,SACvB5nB,KAAKgG,KAAOnG,EAAGmG,OAZhB,IAAInG,EAAKF,EAAEK,KAAKC,SACZskE,EAAMvkE,KAAKF,QAEX0kE,KAAOr/B,UAAUC,UAAUlZ,MAAM,wBAA2BiZ,UAAUC,UAAUlZ,MAAM,sBACtFu4C,KAAWt/B,UAAUC,UAAUlZ,MAAM,aAAgBiZ,UAAUC,UAAUlZ,MAAM,sBAYnF,GAAIrsB,EAAG2R,GAAG,aAAc,CAEvB,IAAIkzD,EAAiB,WAEpB,IAAIC,EAAM,IAAIL,EACVpb,EAAWvpD,EAAE,uEACfioB,MACApN,GAAImqD,EAAInqD,GACRo3B,MAAO+yB,EAAI/yB,QAEXxkC,SAASu3D,EAAI3jE,SACbgF,KAAK2+D,EAAI3+D,MAGXnG,EAAGojB,MAAMimC,GAAU9tB,UAAU8tB,GACzBrpD,EAAG2R,GAAG,aAAa03C,EAAS97C,SAAS,WACrCvN,EAAG2R,GAAG,cAAc03C,EAAS97C,SAAS,YAG1C87C,EAAS0b,MAAM,SAASl+D,GACvBA,EAAE2D,iBACFxK,EAAGm6D,eAAe,SACb9Q,EAAS13C,GAAG,eACZ3R,EAAG2R,GAAG,aACT3R,EAAGilC,KAAK,WAAW,GACnBokB,EAAShjD,YAAY,aAErBrG,EAAGilC,KAAK,WAAW,GACnBokB,EAAS97C,SAAS,YAEnBvN,EAAGwrB,QAAQg3C,YAIbxiE,EAAGwjB,QAAQ,SAASG,IAAI,cAAgB3jB,EAAG+nB,KAAK,MAAQ,MAAM9hB,GAAG,eAAgB,SAASY,GACpF/G,EAAE+G,EAAE0c,QAAQ5R,GAAG,MAAS7R,EAAE+G,EAAE0c,QAAQC,QAAQ6lC,GAAUliD,SAC1DkiD,EAAS8Q,eAAe,SACxBtzD,EAAE2D,oBAIJxK,EAAGiG,GAAG,gBAAiB,WAClBjG,EAAG2R,GAAG,YAAa03C,EAAS97C,SAAS,WACpC87C,EAAShjD,YAAY,aAG1BJ,GAAG,iBAAkB,SAASY,GACf,IAAXA,EAAEqD,OAAam/C,EAAS0b,UAE5B9+D,GAAG,eAAgB,WACdojD,EAAS13C,GAAG,cAAc03C,EAAS97C,SAAS,aAEjDtH,GAAG,cAAe,WAClBojD,EAAShjD,YAAY,cAKvBw+D,IAGA7kE,EAAGiG,GAAG,UAAW,WAChBjG,EAAGwjB,QAAQ,SAASG,IAAI,cAAgB3jB,EAAG+nB,KAAK,MAAQ,MAAMnZ,IAAI,WAClE5O,EAAG4O,IAAI,WAAWrG,SAASwkB,OAAO/sB,GAAI8O,SACtC+1D,WAMK,GAAI7kE,EAAG2R,GAAG,UAAW,CAE3B,IAAIqzD,EAAc,WAEjB,IAAIF,EAAM,IAAIL,EACVrb,EAAQtpD,EAAE,iEACZioB,MACApN,GAAImqD,EAAInqD,GACRo3B,MAAO+yB,EAAI/yB,QAEXxkC,SAASu3D,EAAI3jE,SACbgF,KAAK2+D,EAAI3+D,MAGXnG,EAAGojB,MAAMgmC,GAAO7tB,UAAU6tB,GACtBppD,EAAG2R,GAAG,aAAay3C,EAAM77C,SAAS,WAClCvN,EAAG2R,GAAG,cAAcy3C,EAAM77C,SAAS,YAIvCzN,EAAEiP,GAAGk2D,cAAgB,WACpB,IAAIC,EAAa/kE,KACjB,OAAO+kE,EAAW53D,QAAQqwD,UAAUryD,OAAO,WAC1C,OAAOxL,EAAEK,MAAMgO,KAAK+2D,GAAY/9D,SAAW+9D,EAAW/9D,UAGxDrH,EAAEiP,GAAGo2D,aAAe,WACnB,OAAOrlE,EAAEK,MAAM8kE,gBAAgB33D,SAIhC87C,EAAM2b,MAAM,SAASl+D,GAGpB,GAFAA,EAAE2D,iBACFxK,EAAGm6D,eAAe,UACb/Q,EAAMz3C,GAAG,aAAc,CAC3B,IAAIyzD,EAAYtlE,EAAE,eAAiBE,EAAG+nB,KAAK,QAAU,MACrDq9C,EAAUD,eAAeh3D,KAAKi3D,GAAWngC,KAAK,WAAW,GAAO18B,SAASlC,YAAY,WACrFrG,EAAGilC,KAAK,WAAW,GAAM18B,SAASgF,SAAS,WAC3CvN,EAAGwrB,QAAQg3C,YAIbxiE,EAAGwjB,QAAQ,SAASG,IAAI,cAAgB3jB,EAAG+nB,KAAK,MAAQ,MAAM9hB,GAAG,eAAgB,SAASY,GACpF/G,EAAE+G,EAAE0c,QAAQ5R,GAAG,MAAS7R,EAAE+G,EAAE0c,QAAQC,QAAQ4lC,GAAOjiD,SACvDiiD,EAAM+Q,eAAe,SACrBtzD,EAAE2D,oBAIJxK,EAAGiG,GAAG,gBAAiB,WACtBjG,EAAGuI,SAASgF,SAAS,aAErBtH,GAAG,eAAgB,WACdmjD,EAAMz3C,GAAG,cAAcy3C,EAAM77C,SAAS,aAE3CtH,GAAG,cAAe,WAClBmjD,EAAM/iD,YAAY,cAKpB2+D,IAGAhlE,EAAGiG,GAAG,UAAW,WAChBjG,EAAGwjB,QAAQ,SAASG,IAAI,cAAgB3jB,EAAG+nB,KAAK,MAAQ,MAAMnZ,IAAI,WAClE5O,EAAG4O,IAAI,WAAWrG,SAASwkB,OAAO/sB,GAAI8O,SACtCk2D,WAMK,GAAIhlE,EAAG2R,GAAG,SAAU,CAE1B,IAAI0zD,EAAa,WAEhB,IAAIP,EAAM,IAAIL,EACV9D,EAAc3gE,EAAGmG,KAAK,oBACN0O,IAAhB8rD,IAA2BA,EAAc+D,EAAIb,iBACjD,IAAIyB,EAAStlE,EAAGmG,KAAK,eACN0O,IAAXywD,GAAmC,KAAXA,IAAeA,EAASZ,EAAIZ,YAExD,IAAIva,EACHzpD,EAAE,mDACgC6gE,EAAc,sCACZ2E,EAAS,gBAE5Cv9C,MACApN,GAAImqD,EAAInqD,GACRo3B,MAAO+yB,EAAI/yB,QAEXxkC,SAASu3D,EAAI3jE,SACbgF,KAAK2+D,EAAI3+D,MAGXnG,EAAGojB,MAAMmmC,GAAMrmD,SAASqmD,GACpBvpD,EAAG2R,GAAG,cAAc43C,EAAKh8C,SAAS,YAEtC,IAAI9M,EAAQT,EAAGkH,MACXiQ,EAAOrX,EAAE,oBAAqBypD,GAG9B9oD,GAAO0W,EAAKlN,KAAKxJ,EAAMoB,QAAQ,WAAY,KAE/C7B,EAAGiG,GAAG,gBAAiB,WACtB,IAAIxF,EAAQT,EAAGkH,MACf,GAAIlH,EAAG2R,GAAG,cAAe,CACxBlR,EAAQ,GACR,IAAI8kE,EAAQvlE,EAAG,GAAGulE,MAAMp+D,OACxB,GAAIo+D,EAAQ,EAAG,CACd,IAAItlB,EAASjgD,EAAGmG,KAAK,eACN0O,IAAXorC,IAAsBA,EAASykB,EAAIX,YAEvCtjE,EADAw/C,EAASA,EAAOp+C,QAAQ,KAAM0jE,IAIhCpuD,EAAKlN,KAAKxJ,EAAMoB,QAAQ,WAAY,KACtB,KAAVpB,GACH0W,EAAKlN,KAAK02D,GACVpX,EAAKljD,YAAY,YAEjBkjD,EAAKh8C,SAAS,aAGftH,GAAG,eAAgB,WACnBsjD,EAAKh8C,SAAS,aAEdtH,GAAG,cAAe,WAClBsjD,EAAKljD,YAAY,aAEjBJ,GAAG,eAAgB,WACnBsjD,EAAKljD,YAAY,cAKnBg/D,IAGArlE,EAAGiG,GAAG,UAAW,WAChBjG,EAAG4O,IAAI,WAAWrG,SAASwkB,OAAO/sB,GAAI8O,SACtCu2D,WAMK,GAAIrlE,EAAG2R,GAAG,wBAAyB,CAEzC,IAAI6zD,EAAe,WAElB,IAAIV,EAAM,IAAIL,EACVxkB,EACHngD,EAAE,kHAIDioB,MACApN,GAAImqD,EAAInqD,GACRo3B,MAAO+yB,EAAI/yB,QAEXxkC,SAASu3D,EAAI3jE,SACbgF,KAAK2+D,EAAI3+D,MAGXnG,EAAGojB,MAAM68B,GAAQ1kB,UAAU0kB,GAAQ+K,KAAK,wCACpChrD,EAAG2R,GAAG,cAAcsuC,EAAO1yC,SAAS,YAExC,IAAIwyB,EACF12B,EACAgO,EACAkC,EAAU,KACVksD,EAAW,UACU5wD,IAAnB7U,EAAG+nB,KAAK,SAAsBgY,EAAM//B,EAAG+nB,KAAK,aACzBlT,IAAnB7U,EAAG+nB,KAAK,SAAsB1e,EAAMrJ,EAAG+nB,KAAK,QAE/C1Q,OADuBxC,IAApB7U,EAAG+nB,KAAK,SAAyBjoB,EAAE6mB,UAAU3mB,EAAG+nB,KAAK,SACjD62C,OAAO5+D,EAAG+nB,KAAK,SAEf62C,OAAO,GAEf,IAAI8G,EAAc,SAASC,GAC1B,IACEC,EADEnlE,EAAQT,EAAGkH,MAGVpH,EAAE6mB,UAAUlmB,KAChBA,EAAQ,EACRT,EAAGkH,IAAI,MAGJy+D,EAAKh0D,GAAG,UACXi0D,EAAWhH,OAAOn+D,GAAS4W,EACjBsuD,EAAKh0D,GAAG,WAClBi0D,EAAWhH,OAAOn+D,GAAS4W,GAI5B,IAAI6nD,GAAY7nD,EAAKq6B,WAAWvmC,MAAM,KAAK,QAAUhE,OACrD,GAAI+3D,EAAW,EAAG,CAEjB,IADA,IAAI2G,EAAa,IACVA,EAAW1+D,QAAU+3D,GAAU2G,GAA0B,IAEhED,EAAWx8D,KAAKynB,MAAM+0C,EAAWC,GAAcA,EAG5C/lE,EAAE6mB,UAAUoZ,IAAQjgC,EAAE6mB,UAAUtd,GAC/Bu8D,GAAY7lC,GAAO6lC,GAAYv8D,GAAKrJ,EAAGkH,IAAI0+D,GACrC9lE,EAAE6mB,UAAUoZ,KAASjgC,EAAE6mB,UAAUtd,GACvCu8D,GAAY7lC,GAAK//B,EAAGkH,IAAI0+D,IACjB9lE,EAAE6mB,UAAUoZ,IAAQjgC,EAAE6mB,UAAUtd,GACvCu8D,GAAYv8D,GAAKrJ,EAAGkH,IAAI0+D,GAE5B5lE,EAAGkH,IAAI0+D,IAIJ3lB,EAAOtuC,GAAG,eACdsuC,EAAOh6C,GAAG,YAAa,sBAAuB,WAC7C,IAAI0/D,EAAO7lE,EAAEK,MACbulE,EAAYC,GACZpsD,EAAUlS,WAAW,WACpBo+D,EAAW9iD,YAAY,WAAY+iD,EAAYC,IAAU,KACvD,OACD1/D,GAAG,mBAAoB,sBAAuB,WAChDM,aAAagT,GACbmJ,cAAc+iD,KACZx/D,GAAG,UAAW,sBAAuB,WACvCjG,EAAGwiE,SAASv/C,QAAQ,WAErBjjB,EAAGiG,GAAG,eAAgB,WACrBg6C,EAAO1yC,SAAS,aAEhBtH,GAAG,cAAe,WAClBg6C,EAAO55C,YAAY,eAMtBm/D,IAGAxlE,EAAGiG,GAAG,UAAW,WAChBjG,EAAG4O,IAAI,WAAW4U,QAAQ,cAAcuJ,OAAO/sB,GAAI8O,SACnD02D,WAMK,GAAIxlE,EAAG2R,GAAG,UAAW,CAE3B,IAAIm0D,EAAkB,WAGrB,SAASC,EAAiB5xC,GAEzB,IAAI6xC,EAAa7xC,EAAS8Q,KAAK,gBAAkB9Q,EAASzrB,cACxDu9D,EAAa,KACbh9D,EAAY,KAEdkrB,EAASvlB,IAAI,6BAA6B3I,GAAG,4BAA6B,SAASY,GAOlFo/D,EAAcp/D,EAAE21B,cAAc0pC,OAAS,GAAKr/D,EAAE21B,cAAcypC,WAAa,EAAK,GAAK,IACnFh9D,EAAYkrB,EAASlrB,cAEH+8D,GAAcC,EAAa,GAAOh9D,GAAa,GAAKg9D,EAAa,KAClFp/D,EAAEw1B,kBACFx1B,EAAE2D,oBASL,SAAS27D,IACR,IAAK,IAAIx5D,EAAI,EAAGA,EAAIsX,EAAO9c,OAAQwF,IAAK,CACvC,IAAIy5D,EAAKniD,EAAOkI,GAAGxf,GACf05D,EAAK,GACPC,EAAU,GACVC,EAAY,GACZ5rD,EAAK,GACLo3B,EAAQ,GACRy0B,EAAW,GACXC,EAAc,GACdC,EAAgB,GAChBC,EAAgB,GAGdP,EAAGnhC,KAAK,cAAaqhC,EAAU,gBAC/BF,EAAGz0D,GAAG,eAAc20D,EAHT,YAIXF,EAAGz0D,GAAG,wBAAuB20D,EAHpB,8BAISzxD,IAAlBuxD,EAAGr+C,KAAK,OAAyC,KAAlBq+C,EAAGr+C,KAAK,QAAcpN,EAAK,QAAUyrD,EAAGr+C,KAAK,MAAQ28C,EAAId,SAAW,UAC9E/uD,IAArBuxD,EAAGr+C,KAAK,UAAmD,KAAzB9D,EAAO8D,KAAK,WAAiBgqB,EAAQ,WAAaq0B,EAAGr+C,KAAK,SAAW,UAClFlT,IAArBuxD,EAAGr+C,KAAK,WACX0+C,EAAc,IAAML,EAAGr+C,KAAK,SAC5B4+C,EAAgB,qBAAuBP,EAAGr+C,KAAK,SAAW,KAG3D,IAAI5hB,EAAOigE,EAAGjgE,OACd,IAAK,IAAI08D,KAAK18D,EACG,KAAZA,EAAK08D,KAAW2D,GAAY,SAAW3D,EAAI,KAAO18D,EAAK08D,GAAK,KAG3DyD,EAAUG,IAAiB,KAAOF,EAAY,WAAaD,EAAUG,EAAc,KACzFJ,EAAK,MAAQM,EAAgBH,EAAWD,EAAYx0B,EAAQp3B,EAAK,IAAKyrD,EAAGtgE,OAAQ,QAG7EsgE,EAAG79D,SAASoJ,GAAG,mBACgBkD,IAA9BuxD,EAAG79D,SAASwf,KAAK,WAAwB2+C,EAAgB,IAAMN,EAAG79D,SAASwf,KAAK,UACpFs+C,EAAK,MAAQM,EAAgBH,EAAW,WAAaF,EAAUG,EAAc,UAAYC,EAAgB,IAAM30B,EAAQp3B,EAAK,IAAKyrD,EAAGtgE,OAAQ,QACxIsgE,EAAGz0D,GAAG,kBACT00D,EAAK,sBAAwBK,EAAgB,KAAON,EAAG79D,SAASwf,KAAK,SAAW,QAAUs+C,IAI5F51B,GAAQ41B,GA5CV,IAAIpiD,EAASnkB,EAAE,SAAUE,GACrBywC,EAAO,GA0jBX,GAAIzwC,EAAG2R,GAAG,cAAe,CAKxB,GAAIizD,GAAWD,EAAK,QAjJrB,WAEC,IAAIG,EAAM,IAAIL,EACVlB,EACHzjE,EAAE,mDACDioB,MACApN,GAAImqD,EAAInqD,GACRo3B,MAAO+yB,EAAI/yB,QAEXxkC,SAASu3D,EAAI3jE,SACbgF,KAAK2+D,EAAI3+D,MAGXnG,EAAGojB,MAAMmgD,GAET4C,IACA5C,EAAU71D,OAAO,OAAS+iC,EAAO,SACjC,IAAIm2B,EAAK9mE,EAAE,KAAMyjE,GACb8C,EAAKvmE,EAAE,KAAMyjE,GACbpvB,EAAOn0C,EAAG+nB,KAAK,QACf8+C,EAAWD,EAAGl+D,cACdo+D,EAAWT,EAAG39D,mBACLmM,IAATs/B,GAAsBA,EAAO,EAChCyyB,EAAG5gE,KAAK2C,OAAUm+D,EAAW3yB,IAE7ByyB,EAAG5gE,KAAK2C,OAAqB,EAAXm+D,IAEfD,EAAWtD,EAAU56D,WACxBi+D,EAAG5gE,IAAI,YAAa,UACpB+/D,EAAiBa,GAEbP,EAAG/6D,OAAO,aAAanE,QAC1By/D,EAAG39D,UAAU29D,EAAG39D,YAAco9D,EAAG/6D,OAAO,aAAajJ,WAAWyG,MAKlE9I,EAAGu7B,UAAUgoC,GAGTvjE,EAAG2R,GAAG,cACT4xD,EAAUh2D,SAAS,YACnB0W,EAAO9W,KAAK,WACPrN,EAAEK,MAAMwR,GAAG,cAAc00D,EAAGl6C,GAAGrsB,EAAEK,MAAM8M,SAASM,SAAS,gBAO9D84D,EAAG/6D,OAAO,kCAAkCy5D,MAAM,SAASl+D,GAC1D7G,EAAGwrB,QACH,IAAIu7C,EAAOjnE,EAAEK,MAab,GAZI0G,EAAEi8D,SAAYj8D,EAAEm8D,SAAS+D,EAAKx5D,SAAS,YACvC1G,EAAEmgE,UAAUD,EAAKx5D,SAAS,SAC1B1G,EAAEi8D,SAAYj8D,EAAEm8D,SAAYn8D,EAAEmgE,UAAUD,EAAKviC,WAAWn+B,YAAY,mBAGrEQ,EAAEi8D,SAAWj8D,EAAEm8D,WACb+D,EAAKp1D,GAAG,aAAco1D,EAAK1gE,YAAY,kBACrC0gE,EAAKx5D,SAAS,kBACpBw5D,EAAKviC,WAAWn+B,YAAY,UAI1BQ,EAAEmgE,SAAU,CACd,IAAIviC,GAAO,EACTlI,GAAO,EACTwqC,EAAKviC,WAAWn+B,YAAY,YAAYm+B,SAAS,UAAUj3B,SAAS,YACpEw5D,EAAKE,UAAU95D,KAAK,WACfrN,EAAEK,MAAMwR,GAAG,YAAW8yB,GAAO,KAElCsiC,EAAKG,UAAU/5D,KAAK,WACfrN,EAAEK,MAAMwR,GAAG,YAAW4qB,GAAO,KAE9BkI,GACHsiC,EAAKE,UAAU95D,KAAK,WACnB,GAAIrN,EAAEK,MAAMwR,GAAG,aAAc,OAAO,EAC9B7R,EAAEK,MAAMq7D,IAAI,wBAAwBjuD,SAAS,cAGjDgvB,GACHwqC,EAAKG,UAAU/5D,KAAK,WACnB,GAAIrN,EAAEK,MAAMwR,GAAG,aAAc,OAAO,EAC9B7R,EAAEK,MAAMq7D,IAAI,wBAAwBjuD,SAAS,cAGhB,GAAjC84D,EAAG/6D,OAAO,aAAanE,QAAa4/D,EAAKx5D,SAAS,SAIvD0W,EAAOghB,KAAK,YAAY,GACxBohC,EAAG/6D,OAAO,aAAa6B,KAAK,WAC3B,IAAI2sB,EAAIh6B,EAAEK,MACN8M,EAAQ6sB,EAAE7sB,QACV6sB,EAAEnoB,GAAG,aAAY1E,GAAS6sB,EAAEmtC,QAAQ,aAAa9/D,QACrD8c,EAAOkI,GAAGlf,GAAOg4B,KAAK,YAAY,KAEnCjlC,EAAGwiE,WAKJv+C,EAAO9W,KAAK,SAASR,GACpB7M,EAAEK,MAAMgG,KAAK,cAAewG,KAE7B3M,EAAGiG,GAAG,gBAAiB,WACtBogE,EAAGhgE,YAAY,YACf,IAAI8gE,KACJljD,EAAO3Y,OAAO,aAAa6B,KAAK,WAC/Bg6D,EAAWl5D,KAAKnO,EAAEK,MAAMgG,KAAK,kBAE9BkgE,EAAG7K,IAAI,aAAalwD,OAAO,SAASqB,GACnC,OAAO7M,EAAEkO,QAAQrB,EAAGw6D,IAAe,IACjC55D,SAAS,cAEZtH,GAAG,eAAgB,WACnBs9D,EAAUh2D,SAAS,aAEnBtH,GAAG,cAAe,WAClBs9D,EAAUl9D,YAAY,aAInBwgE,EAAWtD,EAAU56D,UACxB3I,EAAGiG,GAAG,iBAAkB,SAASY,GAEjB,IAAXA,EAAEqD,OAA0B,IAAXrD,EAAEqD,OAA0B,IAAXrD,EAAEqD,OACvC08D,EAAG39D,UAAU29D,EAAG39D,YAAco9D,EAAG/6D,OAAO,aAAajJ,WAAWyG,IAAMg+D,GAGxD,IAAXjgE,EAAEqD,OAA0B,IAAXrD,EAAEqD,OAA0B,IAAXrD,EAAEqD,OACvC08D,EAAG39D,UAAU29D,EAAG39D,YAAco9D,EAAG/6D,OAAO,kBAAkBjJ,WAAWyG,IAAM89D,EAAGjiD,cAA2B,EAAXmiD,MAelGM,QAjhBD,WAEC,IAAItC,EAAM,IAAIL,EACV4C,EAAa,GACbrD,EAAoBhkE,EAAGmG,KAAK,eAC5B89D,EAAejkE,EAAGmG,KAAK,UACvB+9D,EAAoBlkE,EAAGmG,KAAK,gBAC5Bg+D,EAAuBnkE,EAAGmG,KAAK,oBAC/Bi+D,EAA0BpkE,EAAGmG,KAAK,sBAClCm+D,EAAyBtkE,EAAGmG,KAAK,0BAEX0O,IAAtBmvD,IAAiCA,EAAoBU,EAAIV,wBACxCnvD,IAAjBovD,GAA+C,KAAjBA,IAAqBA,EAAeS,EAAIT,mBAChDpvD,IAAtBqvD,GAAyD,KAAtBA,IAA0BA,EAAoBQ,EAAIR,wBAC5DrvD,IAAzBsvD,GAA+D,KAAzBA,IAA6BA,EAAuBO,EAAIP,2BAClEtvD,IAA5BuvD,IAAuCA,EAA0BM,EAAIN,8BAC1CvvD,IAA3ByvD,GAAmE,KAA3BA,IAA+BA,EAAyBI,EAAIJ,wBAExG,IAAIf,EACHzjE,EAAE,0NAODioB,MACApN,GAAImqD,EAAInqD,GACRo3B,MAAO+yB,EAAI/yB,QAEXxkC,SAASu3D,EAAI3jE,SACbgF,KAAK2+D,EAAI3+D,MAGXnG,EAAGojB,MAAMmgD,GAAWhoC,UAAUgoC,GAE9B,IAAI+D,EAAe/D,EAAUv9D,IAAI,WACjCshE,EAAgBA,EAAe,EAAMA,EAAe,EACpD,IAAIC,EAAYznE,EAAE,2BAA4ByjE,GAC1CiE,EAAU1nE,EAAE,gCAAiCyjE,GAC7CkE,EAAiBxjD,EAAO3Y,OAAO,aAEnC66D,IAEIlC,IAAcoD,EACjB,0FAA4FjD,EAA0B,gDAC5ED,EAAuB,UAClE,IAAIX,EACH1jE,EAAE,uCACAunE,EAAa,OAAS52B,EAAO,eAEhC8yB,EAAU71D,OAAO81D,GACjB,IAAIoD,EAAK9mE,EAAE,KAAM0jE,GACb6C,EAAKvmE,EAAE,KAAM0jE,GACb/5C,EAAS3pB,EAAE,QAAS0jE,GACpBkE,EAAW5nE,EAAE,8BAA+B0jE,GAAUl8D,OACtD++D,EAAGl/D,OAAS+8D,GAAmBz6C,EAAOlhB,SAASjB,OAIrB,KAA1B2c,EAAO3W,QAAQrD,QAAiBga,EAAO3W,QAAQqE,GAAG,eAAsC,IAAtBqyD,EACrEwD,EAAQv9D,KAAK+5D,GAAmBz2D,SAAS,eAEzCi6D,EAAQv9D,KAAKw9D,EAAex9D,QAI7B,IAAI09D,EAAe,EACjBC,EAAU,EAaZ,GAZAvB,EAAGrgE,KAAK1D,QAAW,iBACnB+jE,EAAGl5D,KAAK,WACP,IAAI06D,EAAI/nE,EAAEK,MACN0nE,EAAEjjD,aAAe+iD,IACpBA,EAAeE,EAAEjjD,aACjBgjD,EAAUC,EAAEvkE,WAGd+iE,EAAGrgE,KAAK1D,QAAW,KAIfklE,EAAQ71D,GAAG,iBAAoB61D,EAAQlkE,QAAUqkE,EACpDH,EAAQlkE,MAAMkkE,EAAQlkE,aAChB,CACN,IAAIwkE,EAAWvE,EAAUwE,QAAQ7kE,SAAS,QAAQI,MAAM,QACpD0kE,EAAgBF,EAASp+D,aAC7Bo+D,EAASh5D,SACLk5D,GAAiBzE,EAAU75D,cAC9B89D,EAAQlkE,MAAMskE,GAKZD,EAAepE,EAAUjgE,SAASkgE,EAASlgE,MAAMqkE,GAIvB,KAA1B1jD,EAAO3W,QAAQrD,QAA4C,KAA3BjK,EAAGmG,KAAK,gBAC3CkgE,EAAG/4D,QAAQhG,OAGZ,IAAI2gE,EAAe1E,EAAU76D,aAAY,GACrCw/D,EAAez+C,EAAOlhB,SAASG,aAAY,IAAS,EACpDy/D,EAAcvB,EAAG5gE,IAAI,cACrBoiE,EAAa/B,EAAG/6D,OAAO,aAE3B,GADI88D,EAAWjhE,OAAS,GAAGk/D,EAAG/4D,QAAQC,SAAS,qBAClBsH,IAAzBwxD,EAAGlgE,KAAK,aAA4B,CACvC,IAAIkiE,EAAgBhC,EAAG39D,eACG,IAAtBs7D,IAA6BqE,EAAgBhC,EAAGl6C,GAAG,GAAGzjB,eAC1D29D,EAAGlgE,KAAK,YAAakiE,GAEtB,IAAIhmE,EAAWmhE,EAASx9D,IAAI,OAoB5B,GAnB4B,QAAxBw9D,EAASx9D,IAAI,SAAmBw9D,EAASx9D,KAAK+C,KAAM,IAC7B,QAAvBy6D,EAASx9D,IAAI,SAChBw9D,EAASx9D,KAAK8C,IAAKm/D,IACnB5lE,EAAW4lE,GAEZzE,EAASl8D,OAGL8gE,EAAWjhE,SAEV8c,EAAO3W,QAAQrD,QAAUw9D,EAAex9D,QAC3Cs5D,EAAUh2D,SAAS,WAGpBg2D,EAAUp9D,KAAK,aAAciiE,EAAWjiE,KAAK,eAC7Co9D,EAAUh2D,SAAS66D,EAAWjiE,KAAK,gBAIhCnG,EAAG2R,GAAG,aAET,OADA4xD,EAAUh2D,SAAS,aACZ,EAIRg6D,EAAUxC,MAAM,WAWf,GARIjlE,EAAE,oBAAoBwL,OAAO,WAAWnE,QAC3Cu9D,EAAIhB,eAAe34D,KAAKjL,EAAE,oBAAoBwL,OAAO,YAGtDtL,EAAGwrB,SAICm5C,EAAJ,CAGA,IAAI2D,EAAMxoE,EAAE8G,QACRkgE,EAAWT,EAAGlgE,KAAK,aACnBoiE,EAAYhF,EAAU36D,SAASE,IAC/B0/D,EAAeF,EAAI3/D,SAAWs/D,GAAgBM,EAAYD,EAAIr/D,aAC9DvC,EAAU1G,EAAGmG,KAAK,wBACN0O,IAAZnO,GAAqC,KAAZA,IAAgBA,EAAUg+D,EAAIL,sBAC3D,IAAIoE,EAAuB,EAAX3B,EACZt6B,EAAYs6B,EAAWpgE,EACvBA,EAAU,GAAKA,EAAU,IAAG+hE,EAAYj8B,GAC5B,IAAZ9lC,IAAe8lC,EAAY,QAE/B,IAAIk8B,EAAW,WACdlF,EAAS76D,OAAO,QAAQ3C,KAAKs+B,OAAQ,OAAQx7B,IAAKzG,IAClD,IAAIsmE,EAAkB,WACrB/B,EAAG5gE,IAAI,aAAcoD,KAAK42B,OAAOwoC,EAAe,GAAKN,GAAgBpB,GAAYA,IAElF6B,IACA/B,EAAG5gE,IAAI,aAAcwmC,GACF,QAAf27B,GACHvB,EAAG5gE,IAAI,aAAcmiE,GAElBK,EAAgBhF,EAAS96D,cAAgB,IAC5CigE,MAmB6B,IAA3BrE,GAA8D,IAA3BA,EAElCkE,EAAgBC,EAAYP,EAAe,IAC9CQ,IACAnF,EAAUl9D,YAAY,UAAUkH,SAAS,cAnB9B,WACZi2D,EAAS76D,OAAO,QAAQ3C,KAAK8C,IAAK,OAAQw7B,OAAQjiC,IAClD,IAAIumE,EAAe,WAClBhC,EAAG5gE,IAAI,aAAcoD,KAAK42B,OAAOuoC,EAAYD,EAAIr/D,YAAc,GAAKi/D,GAAgBpB,GAAYA,IAEjG8B,IACAhC,EAAG5gE,IAAI,aAAcwmC,GACF,QAAf27B,GACHvB,EAAG5gE,IAAI,aAAcmiE,GAEjBI,EAAYD,EAAIr/D,YAAc,GAAOu6D,EAAS96D,cAAgB,IAClEkgE,IAWAC,GACAtF,EAAUl9D,YAAY,YAAYkH,SAAS,YAEP,IAA3B+2D,GAA+D,IAA3BA,EAE1CkE,EAAgBC,EAAYP,EAAe,KAC9CQ,IACAnF,EAAUl9D,YAAY,UAAUkH,SAAS,cAI1Ci2D,EAAS76D,OAAO,QAAQ3C,KAAKs+B,OAAQ,OAAQx7B,IAAKzG,IAClDukE,EAAG5gE,IAAI,aAAcwmC,GACF,QAAf27B,GACHvB,EAAG5gE,IAAI,aAAcmiE,IAMnB5E,EAAU36D,SAASG,KAAOy6D,EAAS95D,aAAe4+D,EAAIhlE,SACzDkgE,EAASx9D,KAAK+C,KAAM,OAAQq7B,MAAO,IAIpCtkC,EAAE,gBAAgBkG,KAAK/B,OAASqjE,EAAe,IAAKjhE,YAAY,UAChEk9D,EAAUv9D,KAAK/B,OAAQqjE,IACnB9D,EAAS7xD,GAAG,YACf7R,EAAE,sCAAsCwH,OACxCk8D,EAASh6D,OACT+5D,EAAUh2D,SAAS,kBAEnBm3D,EAAIH,eAAex5D,KAAKw4D,KAExBC,EAASl8D,OACTi8D,EAAUl9D,YAAY,0BAElBvG,EAAE,oBAAoBwL,OAAO,WAAWnE,QAC3Cu9D,EAAIhB,eAAe34D,KAAKw4D,IAKtB95C,EAAOtiB,SACVsiB,EAAOviB,IAAI,IAAIy8D,QACf+D,EAASpgE,OACTmiB,EAAOk6C,MAAM,WACZ,IAAI/4D,EAAQ9K,EAAEK,MAAM+G,MACpBm/D,EAAGl5D,KAAK,WACFrN,EAAEK,MAAM2F,OAAOumB,MAAM,IAAIxoB,OAAO,MAAQ+G,EAAQ,MAAO,MAG3D9K,EAAEK,MAAMqJ,OAFR1J,EAAEK,MAAMmH,SAMoB,KAA1B2c,EAAO3W,QAAQrD,QAA4C,KAA3BjK,EAAGmG,KAAK,gBAC3CkgE,EAAG/4D,QAAQhG,OAER++D,EAAG/6D,OAAO,YAAYnE,OAAS,EAClCugE,EAASl+D,OAETk+D,EAASpgE,UAMR++D,EAAG/6D,OAAO,aAAanE,SACT,KAAbnH,EAAGkH,MACN0/D,EAAG39D,UAAU,IAIP29D,EAAGjiD,cAAgBmiD,EAAY,GAAM,IAAIA,GAAsB,GACrEF,EAAG39D,UAAU29D,EAAG39D,YAAco9D,EAAG/6D,OAAO,aAAajJ,WAAWyG,IAAM89D,EAAGjiD,cAAgB,EAAImiD,KAI/Ff,EAAiBa,MAKlBP,EAAGyC,MAAM,WACRhpE,EAAEK,MAAMqkC,WAAWn+B,YAAY,cAEhC,IAAI0iE,EAAe1C,EAAG/6D,OAAO,aAAarB,OAG1Co8D,EAAG/6D,OAAO,kCAAkCy5D,MAAM,WACjD/kE,EAAGwrB,QACH,IAAIsO,EAAIh6B,EAAEK,MACN6oE,EAASlvC,EAAE7vB,OACf,IAAK6vB,EAAEnoB,GAAG,aAAc,CACvB,IAAI1E,EAAQ6sB,EAAE7sB,QACdA,GAAS6sB,EAAEmtC,QAAQ,aAAa9/D,OAChC2yB,EAAEvsB,SAAS,gBAAgBi3B,WAAWn+B,YAAY,gBAClD4d,EAAOghB,KAAK,YAAY,GAAO9Y,GAAGlf,GAAOg4B,KAAK,YAAY,GAC1D8jC,EAAeC,EACfxB,EAAQv9D,KAAK++D,GAGTzF,EAAUp9D,KAAK,eAAeo9D,EAAUl9D,YAAYk9D,EAAUp9D,KAAK,eACvEo9D,EAAUp9D,KAAK,aAAc2zB,EAAE3zB,KAAK,eACpCo9D,EAAUh2D,SAASusB,EAAE3zB,KAAK,eAE1BnG,EAAGwiE,SAEJgB,EAASl8D,OACTi8D,EAAUl9D,YAAY,0BAEtBq+D,EAAIhB,eAAe34D,KAAKw4D,KAGzBC,EAASyF,SAAS,WACjBnpE,EAAE,SAAU0jE,GAAUj2D,SAAS,cAIhCvN,EAAGiG,GAAG,gBAAiB,WACtBuhE,EAAQv9D,KAAKga,EAAO3Y,OAAO,aAAarB,QAAQ5D,YAAY,eAC5DggE,EAAGhgE,YAAY,gBAAgBm1D,IAAI,aAAarvC,GAAGnsB,EAAG,GAAGO,eAAegN,SAAS,gBAE7E0W,EAAO3W,QAAQrD,QAAUo8D,EAAG/6D,OAAO,aAAarB,OACnDs5D,EAAUh2D,SAAS,WAEnBg2D,EAAUl9D,YAAY,aAGvBJ,GAAG,eAAgB,WACnBs9D,EAAUh2D,SAAS,WACnBzN,EAAE,gBAAgB07D,IAAI,YAAYn1D,YAAY,0BAA0B8H,KAAK,8BAA8B7G,SAE3GrB,GAAG,cAAe,WAClBs9D,EAAUl9D,YAAY,aAGtBJ,GAAG,8BAA+B,SAASY,GAC3C,IAAIigE,EAAWT,EAAGlgE,KAAK,aACN,KAAbnG,EAAGkH,MACNsgE,EAAQv9D,KAAK+5D,GAAmBz2D,SAAS,eAEzCi6D,EAAQv9D,KAAKga,EAAO3Y,OAAO,aAAarB,QAEzCo8D,EAAGhgE,YAAY,gBAAgBm1D,IAAI,aAAarvC,GAAGnsB,EAAG,GAAGO,eAAegN,SAAS,gBAElE,IAAX1G,EAAEqD,OAA0B,IAAXrD,EAAEqD,OAA0B,IAAXrD,EAAEqD,OAA0B,IAAXrD,EAAEqD,QACvC,KAAblK,EAAGkH,MACN0/D,EAAG39D,UAAU,GAEb29D,EAAG39D,UAAU29D,EAAG39D,YAAco9D,EAAG/6D,OAAO,aAAajJ,WAAWyG,MAInD,IAAXjC,EAAEqD,OAA0B,IAAXrD,EAAEqD,OAA0B,IAAXrD,EAAEqD,OAA0B,IAAXrD,EAAEqD,OACxD08D,EAAG39D,UAAU29D,EAAG39D,YAAco9D,EAAG/6D,OAAO,aAAajJ,WAAWyG,IAAM89D,EAAGjiD,cAAgBmiD,GAG3E,IAAXjgE,EAAEqD,QACLrD,EAAE2D,iBACFg5D,EAASl8D,OACTi8D,EAAUl9D,YAAY,0BAEtBq+D,EAAIhB,eAAe34D,KAAKw4D,MAEvBt9D,GAAG,iBAAkB,SAASY,GAEjB,IAAXA,EAAEqD,QACLrD,EAAE2D,iBACF+8D,EAAUxC,WAKPzB,EAAgB4F,aACpBppE,EAAEmC,UAAUgE,GAAG,QAASq9D,GACxBA,EAAgB4F,YAAa,GA2J9BC,IAKFrD,IAGA9lE,EAAGiG,GAAG,UAAW,WAChBjG,EAAG4O,IAAI,WAAWrG,SAASwkB,OAAO/sB,GAAI8O,SACtCg3D,WAMS9lE,EAAG2R,GAAG,WAChB3R,EAAGiG,GAAG,QAAS,WACdoB,WAAW,WACVrH,EAAGwjB,QAAQ,QAAQrV,KAAK,iBAAiB8U,QAAQ,YAC/C,MAONmiB,QAAS,WAER,IAAIplC,EAAKF,EAAEK,KAAKC,SAEZJ,EAAG2R,GAAG,cAAgB3R,EAAG2R,GAAG,WAC/B3R,EAAG6O,WAAW,IAAM40D,GAAY70D,IAAI,mBAAmBuvB,WAAW,SAAS51B,SAASwkB,OAAO/sB,GAAI8O,SAC/F9O,EAAGwjB,QAAQ,SAASG,IAAI,cAAgB3jB,EAAG+nB,KAAK,MAAQ,MAAMnZ,IAAI,YACxD5O,EAAG2R,GAAG,wBAChB3R,EAAG6O,WAAW,IAAM40D,GAAY70D,IAAI,mBAAmB4U,QAAQ,cAAcuJ,OAAO/sB,GAAI8O,UAC9E9O,EAAG2R,GAAG,UAAY3R,EAAG2R,GAAG,YAClC3R,EAAG6O,WAAW,IAAM40D,GAAY70D,IAAI,mBAAmBuvB,WAAW,SAAS51B,SAASwkB,OAAO/sB,GAAI8O,WAOlGhP,EAAEiP,GAAG00D,GAAc,SAASxjE,GAC3B,IAAIgP,EAAOC,UACX,QAAgB2F,IAAZ5U,GAA4C,iBAAZA,EAYnC,OAXAE,KAAKgN,KAAK,WACJrN,EAAEqG,KAAKhG,KAAM,IAAMsjE,IACvB3jE,EAAEqG,KAAKhG,KAAM,IAAMsjE,EAAY,IAAIN,EAAOhjE,KAAMF,MAIjDoqB,UACAje,KAAK,WACL,IAAIs4D,EAAM5kE,EAAEK,KAAK,IAAIgG,KAAK,IAAMs9D,GAC5BiB,GAAKA,EAAIzkE,QAAQukE,aAAaz5D,SAE5B5K,KACD,GAAuB,iBAAZF,GAAuC,MAAfA,EAAQ,IAA0B,SAAZA,EAAoB,CACnF,IAAImpE,EAOJ,OANAjpE,KAAKgN,KAAK,WACT,IAAIiC,EAAWtP,EAAEqG,KAAKhG,KAAM,IAAMsjE,GAC9Br0D,aAAoB+zD,GAAuC,mBAAtB/zD,EAASnP,KACjDmpE,EAAUh6D,EAASnP,GAASkjB,MAAM/T,EAAU1H,MAAMhC,UAAUiG,MAAMZ,KAAKkE,EAAM,YAG5D4F,IAAZu0D,EAAwBA,EAAUjpE,OAwB3CmjE,EAAgB4F,YAAa;CC37B7B,SAAS1pE,GACc,mBAAXC,QAAyBA,OAAOC,KAAOD,OAAOC,IAAIG,OAE3DJ,QAAQ,UAAWD,GAGnBA,EAF2B,oBAAX+P,QAA0BA,OAAO5P,QAEzCC,QAAQ,UAGRC,QATZ,CAWE,SAASC,GACT,aAyPA,SAASo7B,EAAKj7B,GAoBZ,OAlBIA,QAAwC4U,IAA5B5U,EAAQopE,sBAAoDx0D,IAAlB5U,EAAQqpE,YAA+Cz0D,IAAxB5U,EAAQspE,cAC/FtpE,EAAQopE,gBAAkB17C,QAKN9Y,IAAlB5U,EAAQ8kE,YAAuClwD,IAAhB5U,EAAQupE,MACzCvpE,EAAQupE,IAAMvpE,EAAQ8kE,OAGnB9kE,IACHA,MAIFA,EAAUH,EAAEmB,UAAWnB,EAAEiP,GAAGu6D,MAAMpoE,SAAUjB,GAGrCE,KAAKgN,KAAK,WACf,IAAIs8D,EAAQ3pE,EAAEK,MAGVupE,EAASD,EAAMtjE,KAAKwjE,GAEnBD,IACHA,EAAS,IAAIE,EAAWzpE,KAAMF,GAC9BwpE,EAAMtjE,KAAKwjE,EAAWD,MAgB5B,SAASE,EAAWxpE,EAASH,GAwJ3B,SAAS4pE,EAAWC,GAGlB,KAAIC,MAKAjqE,EAAEgqE,EAAQvmD,QAAQC,QAAQvjB,EAAQ+pE,iBAAkBtsB,IAAUv2C,OAAS,GAA3E,CAMA,IAAI0rB,EAAQi3C,EAAQttC,cAAgBstC,EAAQttC,cAAgBstC,EAI5D,IAAGj3C,EAAMi1B,aAAkC,SAAnBj1B,EAAMi1B,aAAuD,GAA/B7nD,EAAQgqE,sBAA9D,CAIA,IAAI1oC,EACFgH,EAAU1V,EAAM0V,QAChB2hC,EAAM3hC,EAAUA,EAAQ,GAAK1V,EAmD/B,OAjDAs3C,GAAQC,EAGJ7hC,EAEF8hC,GAAc9hC,EAAQphC,QAGkB,IAAjClH,EAAQqqE,sBACfR,EAAQt/D,iBAIVq+B,GAAW,EACXmhB,GAAY,KACZugB,GAAiB,KACjBC,GAAiB,KACjB97C,GAAW,EACX+7C,GAAuB,EACvBC,GAAqB,EACrBC,GAAY,EACZC,GAAgB,EAChBC,GAAcC,KACdC,KAGAC,GAAiB,EAAGd,IAGf3hC,GAAY8hC,KAAgBpqE,EAAQgrE,SAAWhrE,EAAQgrE,UAAYC,GAAgBC,KAEtF1gC,GAAY2gC,KAEO,GAAff,KAGFW,GAAiB,EAAGziC,EAAQ,IAC5BkiC,GAAuBC,GAAqBW,GAAyBC,GAAW,GAAGj2D,MAAOi2D,GAAW,GAAGj2D,SAGtGpV,EAAQspE,aAAetpE,EAAQsrE,eACjChqC,EAAM44B,EAAetnC,EAAOs3C,MAI9B5oC,GAAM,GAII,IAARA,GACF4oC,GAAQqB,EACRrR,EAAetnC,EAAOs3C,IACf5oC,IAEHthC,EAAQwrE,OACVC,GAAcrkE,WAAWvH,EAAEgS,MAAM,WAE/B4rC,GAASz6B,QAAQ,QAAS4P,EAAMtP,SAE5BtjB,EAAQwrE,OACVlqC,EAAMthC,EAAQwrE,KAAK1gE,KAAK2yC,GAAU7qB,EAAOA,EAAMtP,UAEhDpjB,MAAOF,EAAQ0rE,mBAGpBC,IAAmB,GAGd,QAWT,SAASC,EAAU/B,GAIjB,IAAIj3C,EAAQi3C,EAAQttC,cAAgBstC,EAAQttC,cAAgBstC,EAG5D,GAAIK,KAAU2B,GAAa3B,KAAUqB,IAAgBO,KAArD,CAGA,IAAIxqC,EACFgH,EAAU1V,EAAM0V,QAKdyjC,EAAgBC,GAJZ1jC,EAAUA,EAAQ,GAAK1V,GAuC/B,GAlCAq5C,GAAUd,KAEN7iC,IACF8hC,GAAc9hC,EAAQphC,QAGpBlH,EAAQwrE,MACVllE,aAAamlE,IAGfvB,GAAQgC,EAGW,GAAf9B,KAI0B,GAAxBI,IAEFO,GAAiB,EAAGziC,EAAQ,IAE5BkiC,GAAuBC,GAAqBW,GAAyBC,GAAW,GAAGj2D,MAAOi2D,GAAW,GAAGj2D,SAGxG42D,GAAiB1jC,EAAQ,IAEzBmiC,GAAqBW,GAAyBC,GAAW,GAAG5rC,IAAK4rC,GAAW,GAAG5rC,KAC/E8qC,GAAiB4B,GAAwBd,GAAW,GAAG5rC,IAAK4rC,GAAW,GAAG5rC,MAG5EirC,GAAY0B,GAAmB5B,GAAsBC,IACrDE,GAAgBxhE,KAAKq3B,IAAIgqC,GAAuBC,KAG7CL,KAAgBpqE,EAAQgrE,SAAWhrE,EAAQgrE,UAAYC,IAAiB3iC,GAAW4iC,KAuBtF,GApBAnhB,GAAYsiB,GAAmBN,EAAc32D,MAAO22D,EAActsC,KAGlE6qC,GAAmB+B,GAAmBN,EAAcO,KAAMP,EAActsC,KAGxE8sC,EAAqB1C,EAASS,IAG9B1hC,GAAW4jC,GAAkBT,EAAc32D,MAAO22D,EAActsC,KAChEhR,GAAWg+C,KAGXC,GAAe3iB,GAAWnhB,IAG1BtH,EAAM44B,EAAetnC,EAAOs3C,KAIvBlqE,EAAQ2sE,mBAAqB3sE,EAAQ4sE,oBAAqB,CAE7D,IAAIC,GAAW,EAGf,GAAI7sE,EAAQ4sE,oBAAqB,CAC/B,IAAI95D,EAASg6D,GAAU5sE,MACvB2sE,EAAWE,GAAWhB,EAActsC,IAAK3sB,IAItC9S,EAAQ2sE,mBAAqBE,EAChC3C,GAAQ8C,EAAad,GAGdlsE,EAAQ4sE,sBAAwBC,IACvC3C,GAAQ8C,EAAanB,IAGnB3B,IAASqB,GAAgBrB,IAAS2B,GACpC3R,EAAetnC,EAAOs3C,UAK1BhQ,EAAetnC,EADfs3C,GAAQqB,IAIE,IAARjqC,GAEF44B,EAAetnC,EADfs3C,GAAQqB,IAcZ,SAAS0B,EAASpD,GAGhB,IAAIj3C,EAAQi3C,EAAQttC,cAAgBstC,EAAQttC,cAAgBstC,EAC1DvhC,EAAU1V,EAAM0V,QAIlB,GAAIA,EAAS,CACX,GAAIA,EAAQphC,SAAW4kE,KAErB,OADAoB,GAAwBt6C,IACjB,EACF,GAAI0V,EAAQphC,QAAU4kE,KAC3B,OAAO,EA0CX,OApCIA,OACF1B,GAAc+C,IAIhBlB,GAAUd,KAGV18C,GAAWg+C,KAGPW,MAA2BC,IAE7BnT,EAAetnC,EADfs3C,GAAQqB,GAECvrE,EAAQ2sE,oBAAoD,IAA9B3sE,EAAQ2sE,mBAA+BzC,KAAUgC,IAEnD,IAAjClsE,EAAQqqE,uBAAyD,IAAvBR,EAAQyD,YACpDzD,EAAQt/D,iBAGV2vD,EAAetnC,EADfs3C,GAAQ2B,KAMA7rE,EAAQ2sE,mBAAqBY,IAGrCC,EAAyB56C,EADzBs3C,GAAQ2B,EAC+B4B,GAC9BvD,KAAUgC,GAEnBhS,EAAetnC,EADfs3C,GAAQqB,GAIVI,IAAmB,GAEZ,KAUT,SAAS+B,IAEPtD,GAAc,EACd6B,GAAU,EACVzhC,GAAY,EACZggC,GAAuB,EACvBC,GAAqB,EACrBC,GAAY,EAGZI,KAEAa,IAAmB,GAUrB,SAASgC,EAAW9D,GAElB,IAAIj3C,EAAQi3C,EAAQttC,cAAgBstC,EAAQttC,cAAgBstC,EAGxD7pE,EAAQ4sE,qBAEV1S,EAAetnC,EADfs3C,GAAQ8C,EAAanB,IASzB,SAAS+B,IACPnwB,GAASowB,OAAOC,GAAUlE,GAC1BnsB,GAASowB,OAAOE,GAAWL,GAC3BjwB,GAASowB,OAAOG,GAASpC,GACzBnuB,GAASowB,OAAOI,GAAQhB,GAGpBiB,IACFzwB,GAASowB,OAAOK,GAAUP,GAG5BhC,IAAmB,GAOrB,SAASqB,EAAamB,GAEpB,IAAIC,EAAYD,EAGZE,EAAYC,IACZC,EAAgBlB,IAChBmB,EAAYpB,IAehB,OAZKiB,GAAaG,EAChBJ,EAAY7C,GAGLgD,GAAiBJ,GAAgBjC,GAAgBlsE,EAAQ2sE,oBAAqB3sE,EAAQ4sE,qBAIrF2B,GAAiBJ,GAAgBtC,GAAa7rE,EAAQ4sE,sBAC9DwB,EAAY7C,GAJZ6C,EAAYvC,EAOPuC,EAWT,SAASlU,EAAetnC,EAAOs3C,GAI7B,IAAI5oC,EACFgH,EAAU1V,EAAM0V,QAqDlB,OAlDImmC,KAAcC,OACdptC,EAAMksC,EAAyB56C,EAAOs3C,EAAOyE,KAI5CC,KAAc1D,OAAyB,IAAR5pC,IAChCA,EAAMksC,EAAyB56C,EAAOs3C,EAAO2E,IAI7CC,OAA0B,IAARxtC,EAEpBA,EAAMksC,EAAyB56C,EAAOs3C,EAAO6E,GAItCC,OAAwB,IAAR1tC,EAEvBA,EAAMksC,EAAyB56C,EAAOs3C,EAAO+E,GAItCC,OAAoB,IAAR5tC,IAEnBA,EAAMksC,EAAyB56C,EAAOs3C,EAAOuD,IAM3CvD,IAAUqB,GAEZmC,EAAY96C,GAOVs3C,IAAU2B,IAERvjC,EACGA,EAAQphC,QACXwmE,EAAY96C,GAGd86C,EAAY96C,IAIT0O,EAcT,SAASksC,EAAyB56C,EAAOs3C,EAAOiF,GAE9C,IAAI7tC,EAGJ,GAAI6tC,GAAWR,EAAO,CAIpB,GAFAlxB,GAASz6B,QAAQ,eAAgBknD,EAAOngB,IAAa,KAAMnhB,IAAY,EAAGna,IAAY,EAAG27C,GAAaiB,GAAYf,KAE9GtqE,EAAQspE,cAGE,KAFZhoC,EAAMthC,EAAQspE,YAAYx+D,KAAK2yC,GAAU7qB,EAAOs3C,EAAOngB,IAAa,KAAMnhB,IAAY,EAAGna,IAAY,EAAG27C,GAAaiB,GAAYf,KAE9G,OAAO,EAG5B,GAAIJ,GAAS2B,GAAauD,IAAiB,CAQzC,GALA9oE,aAAa+oE,IACb/oE,aAAamlE,IAEbhuB,GAASz6B,QAAQ,SAAU+mC,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAE/EtqE,EAAQqpE,QAGE,KAFZ/nC,EAAMthC,EAAQqpE,MAAMv+D,KAAK2yC,GAAU7qB,EAAOm3B,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAE/E,OAAO,EAI5B,OAAQvgB,IACN,KAAKrnD,EACH+6C,GAASz6B,QAAQ,aAAc+mC,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAEnFtqE,EAAQsvE,YACVhuC,EAAMthC,EAAQsvE,UAAUxkE,KAAK2yC,GAAU7qB,EAAOm3B,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAExG,MAEF,KAAK1nE,EACH66C,GAASz6B,QAAQ,cAAe+mC,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAEpFtqE,EAAQuvE,aACVjuC,EAAMthC,EAAQuvE,WAAWzkE,KAAK2yC,GAAU7qB,EAAOm3B,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAEzG,MAEF,KAAK3nE,EACH86C,GAASz6B,QAAQ,WAAY+mC,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAEjFtqE,EAAQwvE,UACVluC,EAAMthC,EAAQwvE,QAAQ1kE,KAAK2yC,GAAU7qB,EAAOm3B,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAEtG,MAEF,KAAKznE,EACH46C,GAASz6B,QAAQ,aAAc+mC,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,KAEnFtqE,EAAQyvE,YACVnuC,EAAMthC,EAAQyvE,UAAU3kE,KAAK2yC,GAAU7qB,EAAOm3B,GAAWnhB,GAAUna,GAAU27C,GAAaiB,GAAYf,OAShH,GAAI6E,GAAWN,EAAO,CAGpB,GAFApxB,GAASz6B,QAAQ,eAAgBknD,EAAOK,IAAkB,KAAMI,IAAiB,EAAGl8C,IAAY,EAAG27C,GAAaM,GAAWW,KAEvHrrE,EAAQsrE,cAGE,KAFZhqC,EAAMthC,EAAQsrE,YAAYxgE,KAAK2yC,GAAU7qB,EAAOs3C,EAAOK,IAAkB,KAAMI,IAAiB,EAAGl8C,IAAY,EAAG27C,GAAaM,GAAWW,KAEvH,OAAO,EAG5B,GAAInB,GAAS2B,GAAa6D,IAExB,OAAQnF,IACN,KAAKoF,EACHlyB,GAASz6B,QAAQ,WAAYunD,IAAkB,KAAMI,IAAiB,EAAGl8C,IAAY,EAAG27C,GAAaM,GAAWW,KAE5GrrE,EAAQ4vE,UACVtuC,EAAMthC,EAAQ4vE,QAAQ9kE,KAAK2yC,GAAU7qB,EAAO23C,IAAkB,KAAMI,IAAiB,EAAGl8C,IAAY,EAAG27C,GAAaM,GAAWW,KAEjI,MAEF,KAAKwE,EACHpyB,GAASz6B,QAAQ,YAAaunD,IAAkB,KAAMI,IAAiB,EAAGl8C,IAAY,EAAG27C,GAAaM,GAAWW,KAE7GrrE,EAAQ8vE,WACVxuC,EAAMthC,EAAQ8vE,SAAShlE,KAAK2yC,GAAU7qB,EAAO23C,IAAkB,KAAMI,IAAiB,EAAGl8C,IAAY,EAAG27C,GAAaM,GAAWW,MA2D1I,OApDI8D,GAAW1B,EACTvD,IAAUqB,GAAgBrB,IAAU2B,IAEtCvlE,aAAa+oE,IACb/oE,aAAamlE,IAGTsE,MAAmBC,MACrBC,GAAqB9E,KAIrBkE,GAAmBjoE,WAAWvH,EAAEgS,MAAM,WACpCo+D,GAAqB,KACrBxyB,GAASz6B,QAAQ,OAAQ4P,EAAMtP,SAE3BtjB,EAAQupE,MACVjoC,EAAMthC,EAAQupE,IAAIz+D,KAAK2yC,GAAU7qB,EAAOA,EAAMtP,UAE/CpjB,MAAOF,EAAQkwE,sBAGlBD,GAAqB,KACrBxyB,GAASz6B,QAAQ,OAAQ4P,EAAMtP,SAC3BtjB,EAAQupE,MACVjoC,EAAMthC,EAAQupE,IAAIz+D,KAAK2yC,GAAU7qB,EAAOA,EAAMtP,WAI3C6rD,GAAWJ,EAChB7E,IAAUqB,GAAgBrB,IAAU2B,IACtCvlE,aAAa+oE,IACb/oE,aAAamlE,IACbwE,GAAqB,KACrBxyB,GAASz6B,QAAQ,aAAc4P,EAAMtP,SAEjCtjB,EAAQmwE,YACV7uC,EAAMthC,EAAQmwE,UAAUrlE,KAAK2yC,GAAU7qB,EAAOA,EAAMtP,UAG/C6rD,GAAWF,IAChB/E,IAAUqB,GAAgBrB,IAAU2B,IACtCvlE,aAAa+oE,IACbY,GAAqB,KAErBxyB,GAASz6B,QAAQ,WAAY4P,EAAMtP,SAC/BtjB,EAAQowE,UACV9uC,EAAMthC,EAAQowE,QAAQtlE,KAAK2yC,GAAU7qB,EAAOA,EAAMtP,WAKjDge,EAcT,SAAS+rC,IACP,IAAInX,GAAQ,EAMZ,OAJ0B,OAAtBl2D,EAAQ03C,YACVwe,EAAQttB,IAAY5oC,EAAQ03C,WAGvBwe,EAST,SAASkX,IACP,IAAIiD,GAAY,EAKhB,OAJgC,OAA5BrwE,EAAQswE,iBAA0C,OAAdvmB,KACtCsmB,EAAaE,GAAexmB,IAAanhB,IAAa5oC,EAAQswE,iBAGzDD,EAST,SAASG,IACP,OAA+B,OAA3BxwE,EAAQywE,gBACH9F,IAAiB3qE,EAAQywE,eAUpC,SAASnC,IAaP,OAVItuE,EAAQ0wE,oBACNjiD,IAAYzuB,EAAQ0wE,kBAqB5B,SAASnE,EAAqB1C,EAAS9f,GAGrC,IAAqC,IAAjC/pD,EAAQqqE,qBAIZ,GAAIrqE,EAAQopE,kBAAoB17C,EAC9Bm8C,EAAQt/D,qBACH,CACL,IAAIomE,EAAO3wE,EAAQopE,kBAAoBwH,EAEvC,OAAQ7mB,GACN,KAAKrnD,GACE1C,EAAQsvE,WAAaqB,IAAWA,GAAQ3wE,EAAQopE,iBAAmByH,IACtEhH,EAAQt/D,iBAEV,MAEF,KAAK3H,GACE5C,EAAQuvE,YAAcoB,IAAWA,GAAQ3wE,EAAQopE,iBAAmByH,IACvEhH,EAAQt/D,iBAEV,MAEF,KAAK5H,GACE3C,EAAQwvE,SAAWmB,IAAWA,GAAQ3wE,EAAQopE,iBAAmB0H,IACpEjH,EAAQt/D,iBAEV,MAEF,KAAK1H,GACE7C,EAAQyvE,WAAakB,IAAWA,GAAQ3wE,EAAQopE,iBAAmB0H,IACtEjH,EAAQt/D,mBAkBlB,SAASmlE,IACP,IAAIqB,EAAwBC,IACxBC,EAAcC,IACdC,EAAqBX,IACzB,OAAOO,GAAyBE,GAAeE,EASjD,SAASjG,IAEP,SAAUlrE,EAAQsrE,aAAetrE,EAAQ4vE,SAAW5vE,EAAQ8vE,UAQ9D,SAASlB,IAEP,SAAUc,MAAmBxE,KAY/B,SAASkE,IAEP,IAAIgC,EAAe9C,IACf+C,EAAmBhE,IACnB0D,EAAwBC,IACxBC,EAAcC,IAOlB,OANgB9D,KAIU6D,GAAeF,GAAyBM,GAAoBD,EAUxF,SAAS1C,IAEP,SAAU1uE,EAAQqpE,OAASrpE,EAAQspE,aAAetpE,EAAQsvE,WAAatvE,EAAQuvE,YAAcvvE,EAAQwvE,SAAWxvE,EAAQyvE,WAS1H,SAAShB,IAEP,SAAUW,MAAmBV,KAQ/B,SAASsC,IAEP,OAAS5G,KAAgBpqE,EAAQgrE,SAAWhrE,EAAQgrE,UAAYC,IAAiBqG,EAQnF,SAASJ,IAEP,OAA+B,IAAxB7F,GAAW,GAAG5rC,IAAIjB,EAS3B,SAAS+uC,IAEP,QAAUvtE,EAAW,IAQvB,SAAS+vE,IAEP,QAAU/vE,EAAiB,UAQ7B,SAASuxE,IAEP,QAAUvxE,EAAe,QAQ3B,SAASwxE,IACP,GAA0B,MAAtBvB,GACF,OAAO,EAET,IAAIwB,EAAMtG,KACV,OAAQ4E,KAAoB0B,EAAMxB,IAAuBjwE,EAAQkwE,mBAQnE,SAASF,KACP,OAAOwB,IAST,SAASE,KACP,OAAyB,IAAhBtH,KAAsBkH,KAAoB9lD,MAAMod,KAAaA,GAAW5oC,EAAQ03C,WAQ3F,SAASi6B,KAEP,OAASljD,GAAWzuB,EAAQ0rE,kBAAsB9iC,GAAWgpC,EAQ/D,SAAS1C,KAEP,SAAUwC,OAAiBnE,KAS7B,SAASuB,KAEP,SAAU0C,MAAuBzB,KAQnC,SAASf,KAEP,SAAU2C,OAAqBJ,KAWjC,SAASrE,GAAwBt6C,GAC/Bi/C,GAAuB1G,KACvBgC,GAAuBv6C,EAAM0V,QAAQphC,OAAS,EAOhD,SAAS4jE,KACP+G,GAAuB,EACvB1E,GAAuB,EAQzB,SAASrB,KAEP,IAAIgG,GAAkB,EAStB,OAPID,IACS1G,KAAiB0G,IAChB7xE,EAAQ+xE,yBAClBD,GAAkB,GAIfA,EAST,SAAShI,KAEP,SAAoD,IAA1CrsB,GAASv3C,KAAKwjE,EAAY,aAQtC,SAASiC,GAAmB1kE,GAGtBw2C,MAGQ,IAARx2C,GACFw2C,GAAS6J,KAAK0mB,GAASpC,GACvBnuB,GAAS6J,KAAK2mB,GAAQhB,GAGlBiB,IACFzwB,GAAS6J,KAAK4mB,GAAUP,KAI1BlwB,GAASowB,OAAOG,GAASpC,GAAW,GACpCnuB,GAASowB,OAAOI,GAAQhB,GAAU,GAG9BiB,IACFzwB,GAASowB,OAAOK,GAAUP,GAAY,IAM1ClwB,GAASv3C,KAAKwjE,EAAY,YAAoB,IAARziE,IAWxC,SAAS8jE,GAAiBrwD,EAAIuvD,GAC5B,IAAI+H,GACF58D,OACEopB,EAAG,EACHC,EAAG,GAEL6tC,MACE9tC,EAAG,EACHC,EAAG,GAELgB,KACEjB,EAAG,EACHC,EAAG,IAMP,OAHAuzC,EAAE58D,MAAMopB,EAAIwzC,EAAE1F,KAAK9tC,EAAIwzC,EAAEvyC,IAAIjB,EAAIyrC,EAAIzhC,OAASyhC,EAAIvhC,QAClDspC,EAAE58D,MAAMqpB,EAAIuzC,EAAE1F,KAAK7tC,EAAIuzC,EAAEvyC,IAAIhB,EAAIwrC,EAAIxhC,OAASwhC,EAAIthC,QAClD0iC,GAAW3wD,GAAMs3D,EACVA,EAST,SAAShG,GAAiB/B,GACxB,IAAIvvD,OAAwB9F,IAAnBq1D,EAAInmB,WAA2BmmB,EAAInmB,WAAa,EACrDkuB,EAAIC,GAAcv3D,GAYtB,OAVU,OAANs3D,IACFA,EAAIjH,GAAiBrwD,EAAIuvD,IAG3B+H,EAAE1F,KAAK9tC,EAAIwzC,EAAEvyC,IAAIjB,EACjBwzC,EAAE1F,KAAK7tC,EAAIuzC,EAAEvyC,IAAIhB,EAEjBuzC,EAAEvyC,IAAIjB,EAAIyrC,EAAIzhC,OAASyhC,EAAIvhC,QAC3BspC,EAAEvyC,IAAIhB,EAAIwrC,EAAIxhC,OAASwhC,EAAIthC,QAEpBqpC,EAWT,SAASC,GAAcv3D,GACrB,OAAO2wD,GAAW3wD,IAAO,KAW3B,SAASgyD,GAAe3iB,EAAWnhB,GAC9BmhB,GAAWr8B,IACdkb,EAAWz/B,KAAKC,IAAIw/B,EAAU2nC,GAAexmB,IAC7C6gB,GAAY7gB,GAAWnhB,SAAWA,GASpC,SAAS2nC,GAAexmB,GACtB,GAAI6gB,GAAY7gB,GAAY,OAAO6gB,GAAY7gB,GAAWnhB,SAS5D,SAASiiC,KACP,IAAIqH,KAMJ,OALAA,EAAQxvE,GAAQyvE,GAAgBzvE,GAChCwvE,EAAQtvE,GAASuvE,GAAgBvvE,GACjCsvE,EAAQvvE,GAAMwvE,GAAgBxvE,GAC9BuvE,EAAQrvE,GAAQsvE,GAAgBtvE,GAEzBqvE,EAST,SAASC,GAAgBC,GACvB,OACEroB,UAAWqoB,EACXxpC,SAAU,GAcd,SAAS6jC,KACP,OAAOR,GAAUzhC,GAUnB,SAAS4gC,GAAyBiH,EAAYC,GAC5C,IAAIC,EAAQppE,KAAKq3B,IAAI6xC,EAAW7zC,EAAI8zC,EAAS9zC,GACzCg0C,EAAQrpE,KAAKq3B,IAAI6xC,EAAW5zC,EAAI6zC,EAAS7zC,GAE7C,OAAOt1B,KAAKynB,MAAMznB,KAAK6/B,KAAKupC,EAAQA,EAAQC,EAAQA,IAUtD,SAASpG,GAAmBqG,EAAeC,GAEzC,OADeA,EAAcD,EAAiB,GAC/BE,QAAQ,GAUzB,SAASxG,KACP,OAAIzB,GAAY,EACPmF,EAEAF,EAYX,SAASnD,GAAkB6F,EAAYC,GACrC,OAAOnpE,KAAKynB,MAAMznB,KAAK6/B,KAAK7/B,KAAK8/B,IAAIqpC,EAAS9zC,EAAI6zC,EAAW7zC,EAAG,GAAKr1B,KAAK8/B,IAAIqpC,EAAS7zC,EAAI4zC,EAAW5zC,EAAG,KAU3G,SAASm0C,GAAeP,EAAYC,GAClC,IAAI9zC,EAAI6zC,EAAW7zC,EAAI8zC,EAAS9zC,EAC5BC,EAAI6zC,EAAS7zC,EAAI4zC,EAAW5zC,EAC5Bo0C,EAAI1pE,KAAK2iC,MAAMrN,EAAGD,GAClBoN,EAAQziC,KAAKynB,MAAU,IAAJiiD,EAAU1pE,KAAK4iC,IAOtC,OAJIH,EAAQ,IACVA,EAAQ,IAAMziC,KAAKq3B,IAAIoL,IAGlBA,EAYT,SAASygC,GAAmBgG,EAAYC,GAEtC,GAAIQ,GAAcT,EAAYC,GAC5B,OAAO5kD,EAGT,IAAIke,EAAQgnC,GAAeP,EAAYC,GAEvC,OAAK1mC,GAAS,IAAQA,GAAS,EACtBlpC,EACGkpC,GAAS,KAASA,GAAS,IAC9BlpC,EACGkpC,GAAS,KAASA,GAAS,IAC9BhpC,EACGgpC,EAAQ,IAAQA,EAAQ,IAC3B/oC,EAEAF,EAUX,SAASwoE,KAEP,OADU,IAAI9oC,MACHC,UASb,SAASwqC,GAAU/sE,GAEjB,IAAI4I,GADJ5I,EAAKF,EAAEE,IACS4I,SAShB,OANEG,KAAMH,EAAOG,KACbq7B,MAAOx7B,EAAOG,KAAO/I,EAAG0J,aACxBZ,IAAKF,EAAOE,IACZw7B,OAAQ17B,EAAOE,IAAM9I,EAAG0I,eAkB5B,SAASskE,GAAWgG,EAAOjgE,GACzB,OAAQigE,EAAMv0C,EAAI1rB,EAAOhK,MAAQiqE,EAAMv0C,EAAI1rB,EAAOqxB,OAAS4uC,EAAMt0C,EAAI3rB,EAAOjK,KAAOkqE,EAAMt0C,EAAI3rB,EAAOuxB,OAStG,SAASyuC,GAAcE,EAAQC,GAC7B,OAAQD,EAAOx0C,GAAKy0C,EAAOz0C,GAAKw0C,EAAOv0C,GAAKw0C,EAAOx0C,EA76CrD,IAAIz+B,EAAUH,EAAEmB,UAAWhB,GAEvBkzE,GAAkB5B,GAAkB6B,IAAqBnzE,EAAQgqE,sBACnE8D,GAAWoF,GAAkBC,EAAoBC,EAAwB,gBAAkB,cAAiB,aAAgB,YAC5HpF,GAAUkF,GAAkBC,EAAoBC,EAAwB,gBAAkB,cAAiB,YAAe,YAC1HnF,GAASiF,GAAkBC,EAAoBC,EAAwB,cAAgB,YAAe,WAAc,UACpHlF,GAAWgF,GAAkBC,EAAmB,aAAe,KAAQ,aACvEpF,GAAaoF,EAAoBC,EAAwB,kBAAoB,gBAAmB,cAK9FxqC,GAAW,EACbmhB,GAAY,KACZugB,GAAmB,KACnB77C,GAAW,EACX+7C,GAAuB,EACvBC,GAAqB,EACrBC,GAAY,EACZC,GAAgB,EAChBJ,GAAiB,EACjBK,GAAc,KAKZntB,GAAW59C,EAAEM,GAGb+pE,GAAQ,QAGRE,GAAc,EAGdiB,MAGA7gC,GAAY,EACdyhC,GAAU,EACV4F,GAAuB,EACvB1E,GAAuB,EACvB8C,GAAqB,EAGnBZ,GAAmB,KACrB5D,GAAc,KAGhB,IACEhuB,GAAS6J,KAAKwmB,GAAUlE,GACxBnsB,GAAS6J,KAAKymB,GAAWL,GACzB,MAAO9mE,GACP/G,EAAE40B,MAAM,wBAA0Bq5C,GAAW,IAAMC,GAAY,oBAcjE7tE,KAAKiI,OAAS,WAKZ,OAHAjI,KAAK+H,UACLw1C,GAAS6J,KAAKwmB,GAAUlE,GACxBnsB,GAAS6J,KAAKymB,GAAWL,GAClBjwB,IAUTv9C,KAAK+H,QAAU,WAEb,OADA2lE,IACOnwB,IASTv9C,KAAKilC,QAAU,WACbyoC,IACAnwB,GAASv3C,KAAKwjE,EAAW,MACzBjsB,GAAW,MAmBbv9C,KAAK8jB,OAAS,SAASqvD,EAAU7yE,GAE/B,GAAwB,iBAAb6yE,EACTrzE,EAAUH,EAAEmB,OAAOhB,EAASqzE,QACvB,QAA0Bz+D,IAAtB5U,EAAQqzE,GAAyB,CAC1C,QAAcz+D,IAAVpU,EACF,OAAOR,EAAQqzE,GAEfrzE,EAAQqzE,GAAY7yE,MAEjB,CAAA,IAAK6yE,EACV,OAAOrzE,EAEPH,EAAE40B,MAAM,UAAY4+C,EAAW,2CAGjC,OAAO,MAxaX,IACE3wE,EAAO,OACPE,EAAQ,QACRD,EAAK,KACLE,EAAO,OACP8sE,EAAK,KACLE,EAAM,MAENniD,EAAO,OACPkjD,EAAO,OAEPjC,EAAQ,QACRE,EAAQ,QACRpB,EAAM,MACNsB,EAAa,YACbE,EAAW,UAGX4B,EAAa,aACbC,EAAW,WAEX7F,EAAc,MAEd2G,EAAuB,GAEvBzH,EAAc,QACd+B,EAAa,OACbL,EAAY,MACZN,EAAe,SAEf+F,EAAiB,iBAAkB3qE,OAEnCysE,EAAwBzsE,OAAO0+B,UAAUiuC,mBAAqB3sE,OAAO0+B,UAAUkuC,iBAAmBjC,EAElG6B,GAAoBxsE,OAAO0+B,UAAUkuC,gBAAkB5sE,OAAO0+B,UAAUiuC,oBAAsBhC,EAE9F5H,EAAY,aAwFd7pE,EAAEiP,GAAGu6D,MAAQ,SAAS7nD,GACpB,IAAIgoD,EAAQ3pE,EAAEK,MACZupE,EAASD,EAAMtjE,KAAKwjE,GAGtB,GAAID,GAA4B,iBAAXjoD,EAAqB,CACxC,GAAIioD,EAAOjoD,GACT,OAAOioD,EAAOjoD,GAAQ0B,MAAMumD,EAAQhiE,MAAMhC,UAAUiG,MAAMZ,KAAKmE,UAAW,IAE1EpP,EAAE40B,MAAM,UAAYjT,EAAS,wCAK5B,GAAIioD,GAA4B,iBAAXjoD,EACxBioD,EAAe,OAAEvmD,MAAMumD,EAAQx6D,gBAI5B,KAAKw6D,GAA6B,iBAAXjoD,GAAwBA,GAClD,OAAOyZ,EAAK/X,MAAMhjB,KAAM+O,WAG1B,OAAOu6D,GAOT3pE,EAAEiP,GAAGu6D,MAAMjjD,QA1JG,SA+JdvmB,EAAEiP,GAAGu6D,MAAMpoE,UAhFT+pE,QAAS,EACTtzB,UAAW,GACX44B,gBAAiB,KACjBG,eAAgB,GAChBC,iBAAkB,KAClBqB,uBAAwB,IACxBrG,iBAAkB,IAClBwE,mBAAoB,IACpB7G,MAAO,KACPiG,UAAW,KACXC,WAAY,KACZC,QAAS,KACTC,UAAW,KACXnG,YAAa,KACbsG,QAAS,KACTE,SAAU,KACVxE,YAAa,KACbxG,MAAO,KACPyE,IAAK,KACL4G,UAAW,KACXC,QAAS,KACT5E,KAAM,KACNmB,mBAAmB,EACnBC,qBAAqB,EACrBxD,gBAAiB,OACjBY,uBAAuB,EACvBD,iBAAkB,WAClBM,sBAAsB,GAiExBxqE,EAAEiP,GAAGu6D,MAAMmK,QACTrJ,YAAaA,EACb+B,WAAYA,EACZL,UAAWA,EACXN,aAAcA,GAehB1rE,EAAEiP,GAAGu6D,MAAMoK,YACT/wE,KAAMA,EACNE,MAAOA,EACPD,GAAIA,EACJE,KAAMA,EACN8sE,GAAIA,EACJE,IAAKA,GAcPhwE,EAAEiP,GAAGu6D,MAAMqK,YACThmD,KAAMA,EACNmjD,WAAYA,EACZC,SAAUA,EACVF,KAAMA,GAiBR/wE,EAAEiP,GAAGu6D,MAAM2B,SACT2I,IAAK,EACLC,IAAK,EACLC,MAAO,EACPC,KAAM,EACNC,KAAM,EACNC,IAAK/I","file":"plugins.js","sourcesContent":["/**\r\n*  Ajax Autocomplete for jQuery, version 1.4.4\r\n*  (c) 2017 Tomas Kirda\r\n*\r\n*  Ajax Autocomplete for jQuery is freely distributable under the terms of an MIT-style license.\r\n*  For details, see the web site: https://github.com/devbridge/jQuery-Autocomplete\r\n*/\r\n\r\n/*jslint  browser: true, white: true, single: true, this: true, multivar: true */\r\n/*global define, window, document, jQuery, exports, require */\r\n\r\n// Expose plugin as an AMD module if AMD loader is present:\r\n(function (factory) {\r\n    \"use strict\";\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define(['jquery'], factory);\r\n    } else if (typeof exports === 'object' && typeof require === 'function') {\r\n        // Browserify\r\n        factory(require('jquery'));\r\n    } else {\r\n        // Browser globals\r\n        factory(jQuery);\r\n    }\r\n}(function ($) {\r\n    'use strict';\r\n\r\n    var\r\n        utils = (function () {\r\n            return {\r\n                escapeRegExChars: function (value) {\r\n                    return value.replace(/[|\\\\{}()[\\]^$+*?.]/g, \"\\\\$&\");\r\n                },\r\n                createNode: function (containerClass) {\r\n                    var div = document.createElement('div');\r\n                    div.className = containerClass;\r\n                    div.style.position = 'absolute';\r\n                    div.style.display = 'none';\r\n                    return div;\r\n                }\r\n            };\r\n        }()),\r\n\r\n        keys = {\r\n            ESC: 27,\r\n            TAB: 9,\r\n            RETURN: 13,\r\n            LEFT: 37,\r\n            UP: 38,\r\n            RIGHT: 39,\r\n            DOWN: 40\r\n        },\r\n\r\n        noop = $.noop;\r\n\r\n    function Autocomplete(el, options) {\r\n        var that = this;\r\n\r\n        // Shared variables:\r\n        that.element = el;\r\n        that.el = $(el);\r\n        that.suggestions = [];\r\n        that.badQueries = [];\r\n        that.selectedIndex = -1;\r\n        that.currentValue = that.element.value;\r\n        that.timeoutId = null;\r\n        that.cachedResponse = {};\r\n        that.onChangeTimeout = null;\r\n        that.onChange = null;\r\n        that.isLocal = false;\r\n        that.suggestionsContainer = null;\r\n        that.noSuggestionsContainer = null;\r\n        that.options = $.extend({}, Autocomplete.defaults, options);\r\n        that.classes = {\r\n            selected: 'autocomplete-selected',\r\n            suggestion: 'autocomplete-suggestion'\r\n        };\r\n        that.hint = null;\r\n        that.hintValue = '';\r\n        that.selection = null;\r\n\r\n        // Initialize and set options:\r\n        that.initialize();\r\n        that.setOptions(options);\r\n    }\r\n\r\n    Autocomplete.utils = utils;\r\n\r\n    $.Autocomplete = Autocomplete;\r\n\r\n    Autocomplete.defaults = {\r\n            ajaxSettings: {},\r\n            autoSelectFirst: false,\r\n            appendTo: 'body',\r\n            serviceUrl: null,\r\n            lookup: null,\r\n            onSelect: null,\r\n            width: 'auto',\r\n            minChars: 1,\r\n            maxHeight: 300,\r\n            deferRequestBy: 0,\r\n            params: {},\r\n            formatResult: _formatResult,\r\n            formatGroup: _formatGroup,\r\n            delimiter: null,\r\n            zIndex: 9999,\r\n            type: 'GET',\r\n            noCache: false,\r\n            onSearchStart: noop,\r\n            onSearchComplete: noop,\r\n            onSearchError: noop,\r\n            preserveInput: false,\r\n            containerClass: 'autocomplete-suggestions',\r\n            tabDisabled: false,\r\n            dataType: 'text',\r\n            currentRequest: null,\r\n            triggerSelectOnValidInput: true,\r\n            preventBadQueries: true,\r\n            lookupFilter: _lookupFilter,\r\n            paramName: 'query',\r\n            transformResult: _transformResult,\r\n            showNoSuggestionNotice: false,\r\n            noSuggestionNotice: 'No results',\r\n            orientation: 'bottom',\r\n            forceFixPosition: false\r\n    };\r\n\r\n    function _lookupFilter(suggestion, originalQuery, queryLowerCase) {\r\n        return suggestion.value.toLowerCase().indexOf(queryLowerCase) !== -1;\r\n    };\r\n\r\n    function _transformResult(response) {\r\n        return typeof response === 'string' ? $.parseJSON(response) : response;\r\n    };\r\n\r\n    function _formatResult(suggestion, currentValue) {\r\n        // Do not replace anything if the current value is empty\r\n        if (!currentValue) {\r\n            return suggestion.value;\r\n        }\r\n\r\n        var pattern = '(' + utils.escapeRegExChars(currentValue) + ')';\r\n\r\n        return suggestion.value\r\n            .replace(new RegExp(pattern, 'gi'), '<strong>$1<\\/strong>')\r\n            .replace(/&/g, '&amp;')\r\n            .replace(/</g, '&lt;')\r\n            .replace(/>/g, '&gt;')\r\n            .replace(/\"/g, '&quot;')\r\n            .replace(/&lt;(\\/?strong)&gt;/g, '<$1>');\r\n    };\r\n\r\n    function _formatGroup(suggestion, category) {\r\n        return '<div class=\"autocomplete-group\">' + category + '</div>';\r\n    };\r\n\r\n    Autocomplete.prototype = {\r\n\r\n        initialize: function () {\r\n            var that = this,\r\n                suggestionSelector = '.' + that.classes.suggestion,\r\n                selected = that.classes.selected,\r\n                options = that.options,\r\n                container;\r\n\r\n            // Remove autocomplete attribute to prevent native suggestions:\r\n            that.element.setAttribute('autocomplete', 'off');\r\n\r\n            // html() deals with many types: htmlString or Element or Array or jQuery\r\n            that.noSuggestionsContainer = $('<div class=\"autocomplete-no-suggestion\"></div>')\r\n                                          .html(this.options.noSuggestionNotice).get(0);\r\n\r\n            that.suggestionsContainer = Autocomplete.utils.createNode(options.containerClass);\r\n\r\n            container = $(that.suggestionsContainer);\r\n\r\n            container.appendTo(options.appendTo || 'body');\r\n\r\n            // Only set width if it was provided:\r\n            if (options.width !== 'auto') {\r\n                container.css('width', options.width);\r\n            }\r\n\r\n            // Listen for mouse over event on suggestions list:\r\n            container.on('mouseover.autocomplete', suggestionSelector, function () {\r\n                that.activate($(this).data('index'));\r\n            });\r\n\r\n            // Deselect active element when mouse leaves suggestions container:\r\n            container.on('mouseout.autocomplete', function () {\r\n                that.selectedIndex = -1;\r\n                container.children('.' + selected).removeClass(selected);\r\n            });\r\n\r\n            // Listen for click event on suggestions list:\r\n            container.on('click.autocomplete', suggestionSelector, function () {\r\n                that.select($(this).data('index'));\r\n            });\r\n\r\n            container.on('click.autocomplete', function () {\r\n                clearTimeout(that.blurTimeoutId);\r\n            })\r\n\r\n            that.fixPositionCapture = function () {\r\n                if (that.visible) {\r\n                    that.fixPosition();\r\n                }\r\n            };\r\n\r\n            $(window).on('resize.autocomplete', that.fixPositionCapture);\r\n\r\n            that.el.on('keydown.autocomplete', function (e) { that.onKeyPress(e); });\r\n            that.el.on('keyup.autocomplete', function (e) { that.onKeyUp(e); });\r\n            that.el.on('blur.autocomplete', function () { that.onBlur(); });\r\n            that.el.on('focus.autocomplete', function () { that.onFocus(); });\r\n            that.el.on('change.autocomplete', function (e) { that.onKeyUp(e); });\r\n            that.el.on('input.autocomplete', function (e) { that.onKeyUp(e); });\r\n        },\r\n\r\n        onFocus: function () {\r\n            var that = this;\r\n\r\n            that.fixPosition();\r\n\r\n            if (that.el.val().length >= that.options.minChars) {\r\n                that.onValueChange();\r\n            }\r\n        },\r\n\r\n        onBlur: function () {\r\n            var that = this;\r\n\r\n            // If user clicked on a suggestion, hide() will\r\n            // be canceled, otherwise close suggestions\r\n            that.blurTimeoutId = setTimeout(function () {\r\n                that.hide();\r\n            }, 200);\r\n        },\r\n\r\n        abortAjax: function () {\r\n            var that = this;\r\n            if (that.currentRequest) {\r\n                that.currentRequest.abort();\r\n                that.currentRequest = null;\r\n            }\r\n        },\r\n\r\n        setOptions: function (suppliedOptions) {\r\n            var that = this,\r\n                options = $.extend({}, that.options, suppliedOptions);\r\n\r\n            that.isLocal = Array.isArray(options.lookup);\r\n\r\n            if (that.isLocal) {\r\n                options.lookup = that.verifySuggestionsFormat(options.lookup);\r\n            }\r\n\r\n            options.orientation = that.validateOrientation(options.orientation, 'bottom');\r\n\r\n            // Adjust height, width and z-index:\r\n            $(that.suggestionsContainer).css({\r\n                'max-height': options.maxHeight + 'px',\r\n                'width': options.width + 'px',\r\n                'z-index': options.zIndex\r\n            });\r\n\r\n            this.options = options;            \r\n        },\r\n\r\n\r\n        clearCache: function () {\r\n            this.cachedResponse = {};\r\n            this.badQueries = [];\r\n        },\r\n\r\n        clear: function () {\r\n            this.clearCache();\r\n            this.currentValue = '';\r\n            this.suggestions = [];\r\n        },\r\n\r\n        disable: function () {\r\n            var that = this;\r\n            that.disabled = true;\r\n            clearTimeout(that.onChangeTimeout);\r\n            that.abortAjax();\r\n        },\r\n\r\n        enable: function () {\r\n            this.disabled = false;\r\n        },\r\n\r\n        fixPosition: function () {\r\n            // Use only when container has already its content\r\n\r\n            var that = this,\r\n                $container = $(that.suggestionsContainer),\r\n                containerParent = $container.parent().get(0);\r\n            // Fix position automatically when appended to body.\r\n            // In other cases force parameter must be given.\r\n            if (containerParent !== document.body && !that.options.forceFixPosition) {\r\n                return;\r\n            }\r\n\r\n            // Choose orientation\r\n            var orientation = that.options.orientation,\r\n                containerHeight = $container.outerHeight(),\r\n                height = that.el.outerHeight(),\r\n                offset = that.el.offset(),\r\n                styles = { 'top': offset.top, 'left': offset.left };\r\n\r\n            if (orientation === 'auto') {\r\n                var viewPortHeight = $(window).height(),\r\n                    scrollTop = $(window).scrollTop(),\r\n                    topOverflow = -scrollTop + offset.top - containerHeight,\r\n                    bottomOverflow = scrollTop + viewPortHeight - (offset.top + height + containerHeight);\r\n\r\n                orientation = (Math.max(topOverflow, bottomOverflow) === topOverflow) ? 'top' : 'bottom';\r\n            }\r\n\r\n            if (orientation === 'top') {\r\n                styles.top += -containerHeight;\r\n            } else {\r\n                styles.top += height;\r\n            }\r\n\r\n            // If container is not positioned to body,\r\n            // correct its position using offset parent offset\r\n            if(containerParent !== document.body) {\r\n                var opacity = $container.css('opacity'),\r\n                    parentOffsetDiff;\r\n\r\n                    if (!that.visible){\r\n                        $container.css('opacity', 0).show();\r\n                    }\r\n\r\n                parentOffsetDiff = $container.offsetParent().offset();\r\n                styles.top -= parentOffsetDiff.top;\r\n                styles.left -= parentOffsetDiff.left;\r\n\r\n                if (!that.visible){\r\n                    $container.css('opacity', opacity).hide();\r\n                }\r\n            }\r\n\r\n            if (that.options.width === 'auto') {\r\n                styles.width = that.el.outerWidth() + 'px';\r\n            }\r\n\r\n            $container.css(styles);\r\n        },\r\n\r\n        isCursorAtEnd: function () {\r\n            var that = this,\r\n                valLength = that.el.val().length,\r\n                selectionStart = that.element.selectionStart,\r\n                range;\r\n\r\n            if (typeof selectionStart === 'number') {\r\n                return selectionStart === valLength;\r\n            }\r\n            if (document.selection) {\r\n                range = document.selection.createRange();\r\n                range.moveStart('character', -valLength);\r\n                return valLength === range.text.length;\r\n            }\r\n            return true;\r\n        },\r\n\r\n        onKeyPress: function (e) {\r\n            var that = this;\r\n\r\n            // If suggestions are hidden and user presses arrow down, display suggestions:\r\n            if (!that.disabled && !that.visible && e.which === keys.DOWN && that.currentValue) {\r\n                that.suggest();\r\n                return;\r\n            }\r\n\r\n            if (that.disabled || !that.visible) {\r\n                return;\r\n            }\r\n\r\n            switch (e.which) {\r\n                case keys.ESC:\r\n                    that.el.val(that.currentValue);\r\n                    that.hide();\r\n                    break;\r\n                case keys.RIGHT:\r\n                    if (that.hint && that.options.onHint && that.isCursorAtEnd()) {\r\n                        that.selectHint();\r\n                        break;\r\n                    }\r\n                    return;\r\n                case keys.TAB:\r\n                    if (that.hint && that.options.onHint) {\r\n                        that.selectHint();\r\n                        return;\r\n                    }\r\n                    if (that.selectedIndex === -1) {\r\n                        that.hide();\r\n                        return;\r\n                    }\r\n                    that.select(that.selectedIndex);\r\n                    if (that.options.tabDisabled === false) {\r\n                        return;\r\n                    }\r\n                    break;\r\n                case keys.RETURN:\r\n                    if (that.selectedIndex === -1) {\r\n                        that.hide();\r\n                        return;\r\n                    }\r\n                    that.select(that.selectedIndex);\r\n                    break;\r\n                case keys.UP:\r\n                    that.moveUp();\r\n                    break;\r\n                case keys.DOWN:\r\n                    that.moveDown();\r\n                    break;\r\n                default:\r\n                    return;\r\n            }\r\n\r\n            // Cancel event if function did not return:\r\n            e.stopImmediatePropagation();\r\n            e.preventDefault();\r\n        },\r\n\r\n        onKeyUp: function (e) {\r\n            var that = this;\r\n\r\n            if (that.disabled) {\r\n                return;\r\n            }\r\n\r\n            switch (e.which) {\r\n                case keys.UP:\r\n                case keys.DOWN:\r\n                    return;\r\n            }\r\n\r\n            clearTimeout(that.onChangeTimeout);\r\n\r\n            if (that.currentValue !== that.el.val()) {\r\n                that.findBestHint();\r\n                if (that.options.deferRequestBy > 0) {\r\n                    // Defer lookup in case when value changes very quickly:\r\n                    that.onChangeTimeout = setTimeout(function () {\r\n                        that.onValueChange();\r\n                    }, that.options.deferRequestBy);\r\n                } else {\r\n                    that.onValueChange();\r\n                }\r\n            }\r\n        },\r\n\r\n        onValueChange: function () {\r\n            if (this.ignoreValueChange) {\r\n                this.ignoreValueChange = false;\r\n                return;\r\n            }\r\n\r\n            var that = this,\r\n                options = that.options,\r\n                value = that.el.val(),\r\n                query = that.getQuery(value);\r\n\r\n            if (that.selection && that.currentValue !== query) {\r\n                that.selection = null;\r\n                (options.onInvalidateSelection || $.noop).call(that.element);\r\n            }\r\n\r\n            clearTimeout(that.onChangeTimeout);\r\n            that.currentValue = value;\r\n            that.selectedIndex = -1;\r\n\r\n            // Check existing suggestion for the match before proceeding:\r\n            if (options.triggerSelectOnValidInput && that.isExactMatch(query)) {\r\n                that.select(0);\r\n                return;\r\n            }\r\n\r\n            if (query.length < options.minChars) {\r\n                that.hide();\r\n            } else {\r\n                that.getSuggestions(query);\r\n            }\r\n        },\r\n\r\n        isExactMatch: function (query) {\r\n            var suggestions = this.suggestions;\r\n\r\n            return (suggestions.length === 1 && suggestions[0].value.toLowerCase() === query.toLowerCase());\r\n        },\r\n\r\n        getQuery: function (value) {\r\n            var delimiter = this.options.delimiter,\r\n                parts;\r\n\r\n            if (!delimiter) {\r\n                return value;\r\n            }\r\n            parts = value.split(delimiter);\r\n            return $.trim(parts[parts.length - 1]);\r\n        },\r\n\r\n        getSuggestionsLocal: function (query) {\r\n            var that = this,\r\n                options = that.options,\r\n                queryLowerCase = query.toLowerCase(),\r\n                filter = options.lookupFilter,\r\n                limit = parseInt(options.lookupLimit, 10),\r\n                data;\r\n\r\n            data = {\r\n                suggestions: $.grep(options.lookup, function (suggestion) {\r\n                    return filter(suggestion, query, queryLowerCase);\r\n                })\r\n            };\r\n\r\n            if (limit && data.suggestions.length > limit) {\r\n                data.suggestions = data.suggestions.slice(0, limit);\r\n            }\r\n\r\n            return data;\r\n        },\r\n\r\n        getSuggestions: function (q) {\r\n            var response,\r\n                that = this,\r\n                options = that.options,\r\n                serviceUrl = options.serviceUrl,\r\n                params,\r\n                cacheKey,\r\n                ajaxSettings;\r\n\r\n            options.params[options.paramName] = q;\r\n\r\n            if (options.onSearchStart.call(that.element, options.params) === false) {\r\n                return;\r\n            }\r\n\r\n            params = options.ignoreParams ? null : options.params;\r\n\r\n            if ($.isFunction(options.lookup)){\r\n                options.lookup(q, function (data) {\r\n                    that.suggestions = data.suggestions;\r\n                    that.suggest();\r\n                    options.onSearchComplete.call(that.element, q, data.suggestions);\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (that.isLocal) {\r\n                response = that.getSuggestionsLocal(q);\r\n            } else {\r\n                if ($.isFunction(serviceUrl)) {\r\n                    serviceUrl = serviceUrl.call(that.element, q);\r\n                }\r\n                cacheKey = serviceUrl + '?' + $.param(params || {});\r\n                response = that.cachedResponse[cacheKey];\r\n            }\r\n\r\n            if (response && Array.isArray(response.suggestions)) {\r\n                that.suggestions = response.suggestions;\r\n                that.suggest();\r\n                options.onSearchComplete.call(that.element, q, response.suggestions);\r\n            } else if (!that.isBadQuery(q)) {\r\n                that.abortAjax();\r\n\r\n                ajaxSettings = {\r\n                    url: serviceUrl,\r\n                    data: params,\r\n                    type: options.type,\r\n                    dataType: options.dataType\r\n                };\r\n\r\n                $.extend(ajaxSettings, options.ajaxSettings);\r\n\r\n                that.currentRequest = $.ajax(ajaxSettings).done(function (data) {\r\n                    var result;\r\n                    that.currentRequest = null;\r\n                    result = options.transformResult(data, q);\r\n                    that.processResponse(result, q, cacheKey);\r\n                    options.onSearchComplete.call(that.element, q, result.suggestions);\r\n                }).fail(function (jqXHR, textStatus, errorThrown) {\r\n                    options.onSearchError.call(that.element, q, jqXHR, textStatus, errorThrown);\r\n                });\r\n            } else {\r\n                options.onSearchComplete.call(that.element, q, []);\r\n            }\r\n        },\r\n\r\n        isBadQuery: function (q) {\r\n            if (!this.options.preventBadQueries){\r\n                return false;\r\n            }\r\n\r\n            var badQueries = this.badQueries,\r\n                i = badQueries.length;\r\n\r\n            while (i--) {\r\n                if (q.indexOf(badQueries[i]) === 0) {\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            return false;\r\n        },\r\n\r\n        hide: function () {\r\n            var that = this,\r\n                container = $(that.suggestionsContainer);\r\n\r\n            if ($.isFunction(that.options.onHide) && that.visible) {\r\n                that.options.onHide.call(that.element, container);\r\n            }\r\n\r\n            that.visible = false;\r\n            that.selectedIndex = -1;\r\n            clearTimeout(that.onChangeTimeout);\r\n            $(that.suggestionsContainer).hide();\r\n            that.signalHint(null);\r\n        },\r\n\r\n        suggest: function () {\r\n            if (!this.suggestions.length) {\r\n                if (this.options.showNoSuggestionNotice) {\r\n                    this.noSuggestions();\r\n                } else {\r\n                    this.hide();\r\n                }\r\n                return;\r\n            }\r\n\r\n            var that = this,\r\n                options = that.options,\r\n                groupBy = options.groupBy,\r\n                formatResult = options.formatResult,\r\n                value = that.getQuery(that.currentValue),\r\n                className = that.classes.suggestion,\r\n                classSelected = that.classes.selected,\r\n                container = $(that.suggestionsContainer),\r\n                noSuggestionsContainer = $(that.noSuggestionsContainer),\r\n                beforeRender = options.beforeRender,\r\n                html = '',\r\n                category,\r\n                formatGroup = function (suggestion, index) {\r\n                        var currentCategory = suggestion.data[groupBy];\r\n\r\n                        if (category === currentCategory){\r\n                            return '';\r\n                        }\r\n\r\n                        category = currentCategory;\r\n\r\n                        return options.formatGroup(suggestion, category);\r\n                    };\r\n\r\n            if (options.triggerSelectOnValidInput && that.isExactMatch(value)) {\r\n                that.select(0);\r\n                return;\r\n            }\r\n\r\n            // Build suggestions inner HTML:\r\n            $.each(that.suggestions, function (i, suggestion) {\r\n                if (groupBy){\r\n                    html += formatGroup(suggestion, value, i);\r\n                }\r\n\r\n                html += '<div class=\"' + className + '\" data-index=\"' + i + '\">' + formatResult(suggestion, value, i) + '</div>';\r\n            });\r\n\r\n            this.adjustContainerWidth();\r\n\r\n            noSuggestionsContainer.detach();\r\n            container.html(html);\r\n\r\n            if ($.isFunction(beforeRender)) {\r\n                beforeRender.call(that.element, container, that.suggestions);\r\n            }\r\n\r\n            that.fixPosition();\r\n            container.show();\r\n\r\n            // Select first value by default:\r\n            if (options.autoSelectFirst) {\r\n                that.selectedIndex = 0;\r\n                container.scrollTop(0);\r\n                container.children('.' + className).first().addClass(classSelected);\r\n            }\r\n\r\n            that.visible = true;\r\n            that.findBestHint();\r\n        },\r\n\r\n        noSuggestions: function() {\r\n             var that = this,\r\n                 beforeRender = that.options.beforeRender,\r\n                 container = $(that.suggestionsContainer),\r\n                 noSuggestionsContainer = $(that.noSuggestionsContainer);\r\n\r\n            this.adjustContainerWidth();\r\n\r\n            // Some explicit steps. Be careful here as it easy to get\r\n            // noSuggestionsContainer removed from DOM if not detached properly.\r\n            noSuggestionsContainer.detach();\r\n\r\n            // clean suggestions if any\r\n            container.empty();\r\n            container.append(noSuggestionsContainer);\r\n\r\n            if ($.isFunction(beforeRender)) {\r\n                beforeRender.call(that.element, container, that.suggestions);\r\n            }\r\n\r\n            that.fixPosition();\r\n\r\n            container.show();\r\n            that.visible = true;\r\n        },\r\n\r\n        adjustContainerWidth: function() {\r\n            var that = this,\r\n                options = that.options,\r\n                width,\r\n                container = $(that.suggestionsContainer);\r\n\r\n            // If width is auto, adjust width before displaying suggestions,\r\n            // because if instance was created before input had width, it will be zero.\r\n            // Also it adjusts if input width has changed.\r\n            if (options.width === 'auto') {\r\n                width = that.el.outerWidth();\r\n                container.css('width', width > 0 ? width : 300);\r\n            } else if(options.width === 'flex') {\r\n                // Trust the source! Unset the width property so it will be the max length\r\n                // the containing elements.\r\n                container.css('width', '');\r\n            }\r\n        },\r\n\r\n        findBestHint: function () {\r\n            var that = this,\r\n                value = that.el.val().toLowerCase(),\r\n                bestMatch = null;\r\n\r\n            if (!value) {\r\n                return;\r\n            }\r\n\r\n            $.each(that.suggestions, function (i, suggestion) {\r\n                var foundMatch = suggestion.value.toLowerCase().indexOf(value) === 0;\r\n                if (foundMatch) {\r\n                    bestMatch = suggestion;\r\n                }\r\n                return !foundMatch;\r\n            });\r\n\r\n            that.signalHint(bestMatch);\r\n        },\r\n\r\n        signalHint: function (suggestion) {\r\n            var hintValue = '',\r\n                that = this;\r\n            if (suggestion) {\r\n                hintValue = that.currentValue + suggestion.value.substr(that.currentValue.length);\r\n            }\r\n            if (that.hintValue !== hintValue) {\r\n                that.hintValue = hintValue;\r\n                that.hint = suggestion;\r\n                (this.options.onHint || $.noop)(hintValue);\r\n            }\r\n        },\r\n\r\n        verifySuggestionsFormat: function (suggestions) {\r\n            // If suggestions is string array, convert them to supported format:\r\n            if (suggestions.length && typeof suggestions[0] === 'string') {\r\n                return $.map(suggestions, function (value) {\r\n                    return { value: value, data: null };\r\n                });\r\n            }\r\n\r\n            return suggestions;\r\n        },\r\n\r\n        validateOrientation: function(orientation, fallback) {\r\n            orientation = $.trim(orientation || '').toLowerCase();\r\n\r\n            if($.inArray(orientation, ['auto', 'bottom', 'top']) === -1){\r\n                orientation = fallback;\r\n            }\r\n\r\n            return orientation;\r\n        },\r\n\r\n        processResponse: function (result, originalQuery, cacheKey) {\r\n            var that = this,\r\n                options = that.options;\r\n\r\n            result.suggestions = that.verifySuggestionsFormat(result.suggestions);\r\n\r\n            // Cache results if cache is not disabled:\r\n            if (!options.noCache) {\r\n                that.cachedResponse[cacheKey] = result;\r\n                if (options.preventBadQueries && !result.suggestions.length) {\r\n                    that.badQueries.push(originalQuery);\r\n                }\r\n            }\r\n\r\n            // Return if originalQuery is not matching current query:\r\n            if (originalQuery !== that.getQuery(that.currentValue)) {\r\n                return;\r\n            }\r\n\r\n            that.suggestions = result.suggestions;\r\n            that.suggest();\r\n        },\r\n\r\n        activate: function (index) {\r\n            var that = this,\r\n                activeItem,\r\n                selected = that.classes.selected,\r\n                container = $(that.suggestionsContainer),\r\n                children = container.find('.' + that.classes.suggestion);\r\n\r\n            container.find('.' + selected).removeClass(selected);\r\n\r\n            that.selectedIndex = index;\r\n\r\n            if (that.selectedIndex !== -1 && children.length > that.selectedIndex) {\r\n                activeItem = children.get(that.selectedIndex);\r\n                $(activeItem).addClass(selected);\r\n                return activeItem;\r\n            }\r\n\r\n            return null;\r\n        },\r\n\r\n        selectHint: function () {\r\n            var that = this,\r\n                i = $.inArray(that.hint, that.suggestions);\r\n\r\n            that.select(i);\r\n        },\r\n\r\n        select: function (i) {\r\n            var that = this;\r\n            that.hide();\r\n            that.onSelect(i);\r\n        },\r\n\r\n        moveUp: function () {\r\n            var that = this;\r\n\r\n            if (that.selectedIndex === -1) {\r\n                return;\r\n            }\r\n\r\n            if (that.selectedIndex === 0) {\r\n                $(that.suggestionsContainer).children().first().removeClass(that.classes.selected);\r\n                that.selectedIndex = -1;\r\n                that.ignoreValueChange = false;\r\n                that.el.val(that.currentValue);\r\n                that.findBestHint();\r\n                return;\r\n            }\r\n\r\n            that.adjustScroll(that.selectedIndex - 1);\r\n        },\r\n\r\n        moveDown: function () {\r\n            var that = this;\r\n\r\n            if (that.selectedIndex === (that.suggestions.length - 1)) {\r\n                return;\r\n            }\r\n\r\n            that.adjustScroll(that.selectedIndex + 1);\r\n        },\r\n\r\n        adjustScroll: function (index) {\r\n            var that = this,\r\n                activeItem = that.activate(index);\r\n\r\n            if (!activeItem) {\r\n                return;\r\n            }\r\n\r\n            var offsetTop,\r\n                upperBound,\r\n                lowerBound,\r\n                heightDelta = $(activeItem).outerHeight();\r\n\r\n            offsetTop = activeItem.offsetTop;\r\n            upperBound = $(that.suggestionsContainer).scrollTop();\r\n            lowerBound = upperBound + that.options.maxHeight - heightDelta;\r\n\r\n            if (offsetTop < upperBound) {\r\n                $(that.suggestionsContainer).scrollTop(offsetTop);\r\n            } else if (offsetTop > lowerBound) {\r\n                $(that.suggestionsContainer).scrollTop(offsetTop - that.options.maxHeight + heightDelta);\r\n            }\r\n\r\n            if (!that.options.preserveInput) {\r\n                // During onBlur event, browser will trigger \"change\" event,\r\n                // because value has changed, to avoid side effect ignore,\r\n                // that event, so that correct suggestion can be selected\r\n                // when clicking on suggestion with a mouse\r\n                that.ignoreValueChange = true;\r\n                that.el.val(that.getValue(that.suggestions[index].value));\r\n            }\r\n\r\n            that.signalHint(null);\r\n        },\r\n\r\n        onSelect: function (index) {\r\n            var that = this,\r\n                onSelectCallback = that.options.onSelect,\r\n                suggestion = that.suggestions[index];\r\n\r\n            that.currentValue = that.getValue(suggestion.value);\r\n\r\n            if (that.currentValue !== that.el.val() && !that.options.preserveInput) {\r\n                that.el.val(that.currentValue);\r\n            }\r\n\r\n            that.signalHint(null);\r\n            that.suggestions = [];\r\n            that.selection = suggestion;\r\n\r\n            if ($.isFunction(onSelectCallback)) {\r\n                onSelectCallback.call(that.element, suggestion);\r\n            }\r\n        },\r\n\r\n        getValue: function (value) {\r\n            var that = this,\r\n                delimiter = that.options.delimiter,\r\n                currentValue,\r\n                parts;\r\n\r\n            if (!delimiter) {\r\n                return value;\r\n            }\r\n\r\n            currentValue = that.currentValue;\r\n            parts = currentValue.split(delimiter);\r\n\r\n            if (parts.length === 1) {\r\n                return value;\r\n            }\r\n\r\n            return currentValue.substr(0, currentValue.length - parts[parts.length - 1].length) + value;\r\n        },\r\n\r\n        dispose: function () {\r\n            var that = this;\r\n            that.el.off('.autocomplete').removeData('autocomplete');\r\n            $(window).off('resize.autocomplete', that.fixPositionCapture);\r\n            $(that.suggestionsContainer).remove();\r\n        }\r\n    };\r\n\r\n    // Create chainable jQuery plugin:\r\n    $.fn.devbridgeAutocomplete = function (options, args) {\r\n        var dataKey = 'autocomplete';\r\n        // If function invoked without argument return\r\n        // instance of the first matched element:\r\n        if (!arguments.length) {\r\n            return this.first().data(dataKey);\r\n        }\r\n\r\n        return this.each(function () {\r\n            var inputElement = $(this),\r\n                instance = inputElement.data(dataKey);\r\n\r\n            if (typeof options === 'string') {\r\n                if (instance && typeof instance[options] === 'function') {\r\n                    instance[options](args);\r\n                }\r\n            } else {\r\n                // If instance already exists, destroy it:\r\n                if (instance && instance.dispose) {\r\n                    instance.dispose();\r\n                }\r\n                instance = new Autocomplete(this, options);\r\n                inputElement.data(dataKey, instance);\r\n            }\r\n        });\r\n    };\r\n\r\n    // Don't overwrite if it already exists\r\n    if (!$.fn.autocomplete) {\r\n        $.fn.autocomplete = $.fn.devbridgeAutocomplete;\r\n    }\r\n}));","/**\r\n * DaData.ru Suggestions jQuery plugin, version 99.9.9\r\n *\r\n * DaData.ru Suggestions jQuery plugin is freely distributable under the terms of MIT-style license\r\n * Built on DevBridge Autocomplete for jQuery (https://github.com/devbridge/jQuery-Autocomplete)\r\n * For details, see https://github.com/hflabs/suggestions-jquery\r\n */\r\n(function (global, factory) {\r\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(require('jquery')) :\r\n\ttypeof define === 'function' && define.amd ? define(['jquery'], factory) :\r\n\t(factory(global.jQuery));\r\n}(this, (function ($) { 'use strict';\r\n\r\n$ = 'default' in $ ? $['default'] : $;\r\n\r\nvar KEYS = {\r\n        ENTER: 13,\r\n        ESC:   27,\r\n        TAB:   9,\r\n        SPACE: 32,\r\n        UP:    38,\r\n        DOWN:  40\r\n    };\r\nvar EVENT_NS = '.suggestions';\r\nvar DATA_ATTR_KEY = 'suggestions';\r\nvar WORD_DELIMITERS = '\\\\s\"\\'~\\\\*\\\\.,:\\\\|\\\\[\\\\]\\\\(\\\\)\\\\{\\\\}<>№';\r\nvar WORD_SPLITTER = new RegExp('[' + WORD_DELIMITERS + ']+', 'g');\r\nvar WORD_PARTS_DELIMITERS = '\\\\-\\\\+\\\\/\\\\\\\\\\\\?!@#$%^&';\r\nvar WORD_PARTS_SPLITTER = new RegExp('[' + WORD_PARTS_DELIMITERS + ']+', 'g');\r\n\r\nvar utils = (function () {\r\n    var uniqueId = 0;\r\n    return {\r\n        escapeRegExChars: function (value) {\r\n            return value.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\r\n        },\r\n        escapeHtml: function (str) {\r\n            var map = {\r\n                '&': '&amp;',\r\n                '<': '&lt;',\r\n                '>': '&gt;',\r\n                '\"': '&quot;',\r\n                \"'\": '&#x27;',\r\n                '/': '&#x2F;'\r\n            };\r\n\r\n            if (str) {\r\n                $.each(map, function(ch, html){\r\n                    str = str.replace(new RegExp(ch, 'g'), html);\r\n                });\r\n            }\r\n            return str;\r\n        },\r\n        getDefaultType: function () {\r\n            return ($.support.cors ? 'POST' : 'GET');\r\n        },\r\n        getDefaultContentType: function () {\r\n            return ($.support.cors ? 'application/json' : 'application/x-www-form-urlencoded');\r\n        },\r\n        fixURLProtocol: function(url){\r\n            return $.support.cors ? url : url.replace(/^https?:/, location.protocol);\r\n        },\r\n        addUrlParams: function (url, params) {\r\n            return url + (/\\?/.test(url) ? '&' : '?') + $.param(params);\r\n        },\r\n        serialize: function (data) {\r\n            if ($.support.cors) {\r\n                return JSON.stringify(data, function (key, value) {\r\n                    return value === null ? undefined : value;\r\n                });\r\n            } else {\r\n                data = this.compactObject(data);\r\n                return $.param(data, true);\r\n            }\r\n        },\r\n        compact: function (array) {\r\n            return $.grep(array, function (el) {\r\n                return !!el;\r\n            });\r\n        },\r\n        delay: function (handler, delay) {\r\n            return setTimeout(handler, delay || 0);\r\n        },\r\n        uniqueId: function (prefix) {\r\n            return (prefix || '') + ++uniqueId;\r\n        },\r\n        slice: function(obj, start) {\r\n            return Array.prototype.slice.call(obj, start);\r\n        },\r\n        indexBy: function (data, field, indexField) {\r\n            var result = {};\r\n\r\n            $.each(data, function (i, obj) {\r\n                var key = obj[field],\r\n                    val = {};\r\n\r\n                if (indexField) {\r\n                    val[indexField] = i;\r\n                }\r\n\r\n                result[key] = $.extend(true, val, obj);\r\n            });\r\n\r\n            return result;\r\n        },\r\n\r\n        /**\r\n         * Compares two objects, but only fields that are set in both\r\n         * @param a\r\n         * @param b\r\n         * @returns {boolean}\r\n         */\r\n        areSame: function self(a, b) {\r\n            var same = true;\r\n\r\n            if (typeof a != typeof b) {\r\n                return false;\r\n            }\r\n\r\n            if (typeof a == 'object' && a != null && b != null) {\r\n                $.each(a, function (i, value) {\r\n                    return same = self(value, b[i]);\r\n                });\r\n                return same;\r\n            }\r\n\r\n            return a === b;\r\n        },\r\n\r\n        /**\r\n         * Returns array1 minus array2\r\n         */\r\n        arrayMinus: function(array1, array2) {\r\n            return array2 ? $.grep(array1, function(el, i){\r\n                return $.inArray(el, array2) === -1;\r\n            }) : array1;\r\n        },\r\n        /**\r\n         * Returns array1 minus array2\r\n         * if value in array1 in enclosed by value in array2, it is considered a match\r\n         */\r\n        arrayMinusWithPartialMatching: function(array1, array2) {\r\n            return array2 ? $.grep(array1, function(el, i){\r\n                return !array2.some(function(el2) {\r\n                    return el2.indexOf(el) === 0;\r\n                })\r\n            }) : array1;\r\n        },\r\n        /**\r\n         * Пересечение массивов: ([1,2,3,4], [2,4,5,6]) => [2,4]\r\n         * Исходные массивы не меняются\r\n         * @param {Array} array1\r\n         * @param {Array} array2\r\n         * @returns {Array}\r\n         */\r\n        arraysIntersection: function(array1, array2) {\r\n            var result = [];\r\n            if (!$.isArray(array1) || !$.isArray(array2)) {\r\n                return result;\r\n            }\r\n            $.each(array1, function(index, item) {\r\n                if ($.inArray(item, array2) >= 0) {\r\n                    result.push(item);\r\n                }\r\n            });\r\n            return result;\r\n        },\r\n        getWords: function(str, stopwords) {\r\n            // Split numbers and letters written together\r\n            str = str.replace(/(\\d+)([а-яА-ЯёЁ]{2,})/g, '$1 $2')\r\n                .replace(/([а-яА-ЯёЁ]+)(\\d+)/g, '$1 $2');\r\n\r\n            var words = this.compact(str.split(WORD_SPLITTER)),\r\n                lastWord = words.pop(),\r\n                goodWords = this.arrayMinus(words, stopwords);\r\n\r\n            goodWords.push(lastWord);\r\n            return goodWords;\r\n        },\r\n        /**\r\n         * Returns normalized string without stopwords\r\n         */\r\n        normalize: function(str, stopwords) {\r\n            var that = this;\r\n            return that.getWords(str, stopwords).join(' ');\r\n        },\r\n        /**\r\n         * Returns true if str1 includes str2 plus something else, false otherwise.\r\n         */\r\n        stringEncloses: function(str1, str2) {\r\n            return str1.length > str2.length && str1.indexOf(str2) !== -1;\r\n        },\r\n        fieldsNotEmpty: function(obj, fields){\r\n            if (!$.isPlainObject(obj)) {\r\n                return false;\r\n            }\r\n            var result = true;\r\n            $.each(fields, function (i, field) {\r\n                return result = !!(obj[field]);\r\n            });\r\n            return result;\r\n        },\r\n        getDeepValue: function self(obj, name) {\r\n            var path = name.split('.'),\r\n                step = path.shift();\r\n\r\n            return obj && (path.length ? self(obj[step], path.join('.')) : obj[step]);\r\n        },\r\n        reWordExtractor: function () {\r\n            return new RegExp('([^' + WORD_DELIMITERS + ']*)([' + WORD_DELIMITERS + ']*)', 'g');\r\n        },\r\n        /**\r\n         * Возвращает список слов используемых в запросе\r\n         */\r\n        getTokens: function(value, unformattableTokens) {\r\n            var tokens,\r\n                preferredTokens;\r\n\r\n            tokens = this.compact(this.formatToken(value).split(WORD_SPLITTER));\r\n            // Move unformattableTokens to the end.\r\n            // This will help to apply them only if no other tokens match\r\n            preferredTokens = this.arrayMinus(tokens, unformattableTokens);\r\n            tokens = this.withSubTokens(preferredTokens.concat(this.arrayMinus(tokens, preferredTokens)));\r\n\r\n            return tokens;\r\n        },\r\n        formatToken: function (token) {\r\n            return token && token.toLowerCase().replace(/[ёЁ]/g, 'е');\r\n        },\r\n        withSubTokens: function (tokens) {\r\n            var result = [];\r\n\r\n            $.each(tokens, function (i, token) {\r\n                var subtokens = token.split(WORD_PARTS_SPLITTER);\r\n\r\n                result.push(token);\r\n\r\n                if (subtokens.length > 1) {\r\n                    result = result.concat(utils.compact(subtokens));\r\n                }\r\n            });\r\n\r\n            return result;\r\n        },\r\n\r\n        /**\r\n         * Возвращает массив с ключами переданного объекта\r\n         * Используется нативный Object.keys если он есть\r\n         * @param {Object} obj\r\n         * @returns {Array}\r\n         */\r\n        objectKeys: function(obj) {\r\n            if (Object.keys) {\r\n                return Object.keys(obj);\r\n            }\r\n            var keys = [];\r\n            $.each(obj, function(name) {\r\n                keys.push(name);\r\n            });\r\n            return keys;\r\n        },\r\n\r\n        /**\r\n         * Возвращает копию объекта без пустых элементов\r\n         * @param obj\r\n         */\r\n        compactObject: function(obj) {\r\n            var copy = $.extend(true, {}, obj);\r\n\r\n            $.each(copy, function (key, val) {\r\n                if (val === null || val === undefined || val === '') {\r\n                    delete copy[key];\r\n                }\r\n            });\r\n\r\n            return copy;\r\n        }\r\n\r\n    };\r\n}());\r\n\r\n/**\r\n * Matchers return index of suitable suggestion\r\n * Context inside is optionally set in types.js\r\n */\r\nvar matchers = function() {\r\n\r\n    /**\r\n     * Factory to create same parent checker function\r\n     * @param preprocessFn called on each value before comparison\r\n     * @returns {Function} same parent checker function\r\n     */\r\n    function sameParentChecker (preprocessFn) {\r\n        return function (suggestions) {\r\n            if (suggestions.length === 0) {\r\n                return false;\r\n            }\r\n            if (suggestions.length === 1) {\r\n                return true;\r\n            }\r\n\r\n            var parentValue = preprocessFn(suggestions[0].value),\r\n                aliens = $.grep(suggestions, function (suggestion) {\r\n                    return preprocessFn(suggestion.value).indexOf(parentValue) === 0;\r\n                }, true);\r\n\r\n            return aliens.length === 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Default same parent checker. Compares raw values.\r\n     * @type {Function}\r\n     */\r\n    var haveSameParent = sameParentChecker(function(val) { return val; });\r\n\r\n    /**\r\n     * Same parent checker for addresses. Strips house and extension before comparison.\r\n     * @type {Function}\r\n     */\r\n    var haveSameParentAddress = sameParentChecker(function(val) {\r\n        return val.replace(/, (?:д|вл|двлд|к) .+$/, '');\r\n    });\r\n\r\n    return {\r\n\r\n        /**\r\n         * Matches query against suggestions, removing all the stopwords.\r\n         */\r\n        matchByNormalizedQuery: function (query, suggestions) {\r\n            var queryLowerCase = query.toLowerCase(),\r\n                stopwords = this && this.stopwords,\r\n                normalizedQuery = utils.normalize(queryLowerCase, stopwords),\r\n                matches = [];\r\n\r\n            $.each(suggestions, function(i, suggestion) {\r\n                var suggestedValue = suggestion.value.toLowerCase();\r\n                // if query encloses suggestion, than it has already been selected\r\n                // so we should not select it anymore\r\n                if (utils.stringEncloses(queryLowerCase, suggestedValue)) {\r\n                    return false;\r\n                }\r\n                // if there is suggestion that contains query as its part\r\n                // than we should ignore all other matches, even full ones\r\n                if (suggestedValue.indexOf(normalizedQuery) > 0) {\r\n                    return false;\r\n                }\r\n                if (normalizedQuery === utils.normalize(suggestedValue, stopwords)) {\r\n                    matches.push(i);\r\n                }\r\n            });\r\n\r\n            return matches.length === 1 ? matches[0] : -1;\r\n        },\r\n\r\n        /**\r\n         * Matches query against suggestions word-by-word (with respect to stopwords).\r\n         * Matches if query words are a subset of suggested words.\r\n         */\r\n        matchByWords: function (query, suggestions) {\r\n            var stopwords = this && this.stopwords,\r\n                queryLowerCase = query.toLowerCase(),\r\n                queryTokens,\r\n                matches = [];\r\n\r\n            if (haveSameParent(suggestions)) {\r\n                queryTokens = utils.withSubTokens(utils.getWords(queryLowerCase, stopwords));\r\n\r\n                $.each(suggestions, function(i, suggestion) {\r\n                    var suggestedValue = suggestion.value.toLowerCase();\r\n\r\n                    if (utils.stringEncloses(queryLowerCase, suggestedValue)) {\r\n                        return false;\r\n                    }\r\n\r\n                    // check if query words are a subset of suggested words\r\n                    var suggestionWords = utils.withSubTokens(utils.getWords(suggestedValue, stopwords));\r\n\r\n                    if (utils.arrayMinus(queryTokens, suggestionWords).length === 0) {\r\n                        matches.push(i);\r\n                    }\r\n                });\r\n            }\r\n\r\n            return matches.length === 1 ? matches[0] : -1;\r\n        },\r\n\r\n        matchByWordsAddress: function (query, suggestions) {\r\n            var stopwords = this && this.stopwords,\r\n                queryLowerCase = query.toLowerCase(),\r\n                queryTokens,\r\n                index = -1;\r\n\r\n            if (haveSameParentAddress(suggestions)) {\r\n                queryTokens = utils.withSubTokens(utils.getWords(queryLowerCase, stopwords));\r\n\r\n                $.each(suggestions, function(i, suggestion) {\r\n                    var suggestedValue = suggestion.value.toLowerCase();\r\n\r\n                    if (utils.stringEncloses(queryLowerCase, suggestedValue)) {\r\n                        return false;\r\n                    }\r\n\r\n                    // check if query words are a subset of suggested words\r\n                    var suggestionWords = utils.withSubTokens(utils.getWords(suggestedValue, stopwords));\r\n\r\n                    if (utils.arrayMinus(queryTokens, suggestionWords).length === 0) {\r\n                        index = i;\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n\r\n            return index;\r\n        },\r\n\r\n        /**\r\n         * Matches query against values contained in suggestion fields\r\n         * for cases, when there is only one suggestion\r\n         * only considers fields specified in fieldsStopwords map\r\n         * uses partial matching:\r\n         *   \"0445\" vs { value: \"ALFA-BANK\", data: { \"bic\": \"044525593\" }} is a match\r\n         */\r\n        matchByFields: function (query, suggestions) {\r\n            var stopwords = this && this.stopwords,\r\n                fieldsStopwords = this && this.fieldsStopwords,\r\n                tokens = utils.withSubTokens(utils.getWords(query.toLowerCase(), stopwords)),\r\n                suggestionWords = [];\r\n\r\n            if (suggestions.length === 1) {\r\n                if (fieldsStopwords) {\r\n                    $.each(fieldsStopwords, function (field, stopwords) {\r\n                        var fieldValue = utils.getDeepValue(suggestions[0], field),\r\n                            fieldWords = fieldValue && utils.withSubTokens(utils.getWords(fieldValue.toLowerCase(), stopwords));\r\n\r\n                        if (fieldWords && fieldWords.length) {\r\n                            suggestionWords = suggestionWords.concat(fieldWords);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (utils.arrayMinusWithPartialMatching(tokens, suggestionWords).length === 0) {\r\n                    return 0;\r\n                }\r\n            }\r\n\r\n            return -1;\r\n        }\r\n\r\n    };\r\n\r\n}();\r\n\r\nvar DEFAULT_OPTIONS = {\r\n    autoSelectFirst: false,\r\n    // основной url, может быть переопределен\r\n    serviceUrl: 'https://suggestions.dadata.ru/suggestions/api/4_1/rs',\r\n    // url, который заменяет serviceUrl + method + type\r\n    // то есть, если он задан, то для всех запросов будет использоваться именно он\r\n    // если не поддерживается cors то к url будут добавлены параметры ?token=...&version=...\r\n    // и заменен протокол на протокол текущей страницы\r\n    url: null,\r\n    onSearchStart: $.noop,\r\n    onSearchComplete: $.noop,\r\n    onSearchError: $.noop,\r\n    onSuggestionsFetch: null,\r\n    onSelect: null,\r\n    onSelectNothing: null,\r\n    onInvalidateSelection: null,\r\n    minChars: 1,\r\n    deferRequestBy: 100,\r\n    params: {},\r\n    paramName: 'query',\r\n    timeout: 3000,\r\n    formatResult: null,\r\n    formatSelected: null,\r\n    noCache: false,\r\n    containerClass: 'suggestions-suggestions',\r\n    tabDisabled: false,\r\n    triggerSelectOnSpace: false,\r\n    triggerSelectOnEnter: true,\r\n    triggerSelectOnBlur: true,\r\n    preventBadQueries: false,\r\n    hint: 'Выберите вариант или продолжите ввод',\r\n    noSuggestionsHint: {\r\n        NAME:       'Неизвестное ФИО',\r\n        ADDRESS:    'Неизвестный адрес',\r\n        EMAIL:      'Неизвестная эл. почта',\r\n        PARTY:      'Неизвестная организация',\r\n        BANK:       'Неизвестный банк'\r\n    },\r\n    type: null,\r\n    requestMode: 'suggest',\r\n    count: 5,\r\n    $helpers: null,\r\n    headers: null,\r\n    scrollOnFocus: true,\r\n    mobileWidth: 980,\r\n    initializeInterval: 100\r\n};\r\n\r\n/**\r\n * Type is a bundle of properties:\r\n * - urlSuffix Mandatory. String\r\n * - matchers Mandatory. Array of functions (with optional data bound as a context) that find appropriate suggestion to select\r\n * - `fieldNames` Map fields of suggestion.data to their displayable names\r\n * - `unformattableTokens` Array of strings which should not be highlighted\r\n * - `dataComponents` Array of 'bound's can be set as `bounds` option. Order is important.\r\n *\r\n * flags:\r\n * - `alwaysContinueSelecting` Forbids to hide dropdown after selecting\r\n * - `geoEnabled` Makes to detect client's location for passing it to all requests\r\n * - `enrichmentEnabled` Makes to send additional request when a suggestion is selected\r\n *\r\n * and methods:\r\n * - `isDataComplete` Checks if suggestion.data can be operated as full data of it's type\r\n * - `composeValue` returns string value based on suggestion.data\r\n * - `formatResult` returns html of a suggestion. Overrides default method\r\n * - `formatResultInn` returns html of suggestion.data.inn\r\n * - `isQueryRequestable` checks if query is appropriated for requesting server\r\n * - `formatSelected` returns string to be inserted in textbox\r\n */\r\n\r\nvar ADDRESS_STOPWORDS = ['ао', 'аобл', 'дом', 'респ', 'а/я', 'аал', 'автодорога', 'аллея', 'арбан', 'аул', 'б-р', 'берег', 'бугор', 'вал', 'вл', 'волость', 'въезд', 'высел', 'г', 'городок', 'гск', 'д', 'двлд', 'днп', 'дор', 'дп', 'ж/д_будка', 'ж/д_казарм', 'ж/д_оп', 'ж/д_платф', 'ж/д_пост', 'ж/д_рзд', 'ж/д_ст', 'жилзона', 'жилрайон', 'жт', 'заезд', 'заимка', 'зона', 'к', 'казарма', 'канал', 'кв', 'кв-л', 'км', 'кольцо', 'комн', 'кордон', 'коса', 'кп', 'край', 'линия', 'лпх', 'м', 'массив', 'местность', 'мкр', 'мост', 'н/п', 'наб', 'нп', 'обл', 'округ', 'остров', 'оф', 'п', 'п/о', 'п/р', 'п/ст', 'парк', 'пгт', 'пер', 'переезд', 'пл', 'пл-ка', 'платф', 'погост', 'полустанок', 'починок', 'пр-кт', 'проезд', 'промзона', 'просек', 'просека', 'проселок', 'проток', 'протока', 'проулок', 'р-н', 'рзд', 'россия', 'рп', 'ряды', 'с', 'с/а', 'с/мо', 'с/о', 'с/п', 'с/с', 'сад', 'сквер', 'сл', 'снт', 'спуск', 'ст', 'ст-ца', 'стр', 'тер', 'тракт', 'туп', 'у', 'ул', 'уч-к', 'ф/х', 'ферма', 'х', 'ш', 'бульвар', 'владение', 'выселки', 'гаражно-строительный', 'город', 'деревня', 'домовладение', 'дорога', 'квартал', 'километр', 'комната', 'корпус', 'литер', 'леспромхоз', 'местечко', 'микрорайон', 'набережная', 'область', 'переулок', 'платформа', 'площадка', 'площадь', 'поселение', 'поселок', 'проспект', 'разъезд', 'район', 'республика', 'село', 'сельсовет', 'слобода', 'сооружение', 'станица', 'станция', 'строение', 'территория', 'тупик', 'улица', 'улус', 'участок', 'хутор', 'шоссе'];\r\n\r\n/**\r\n * Компоненты адреса\r\n * @type {*[]}\r\n * id {String} Наименование типа\r\n * fields {Array of Strings}\r\n * forBounds {Boolean} может использоваться в ограничениях\r\n * forLocations {Boolean}\r\n * kladrFormat {Object}\r\n * fiasType {String} Наименование соответствующего ФИАС типа\r\n */\r\nvar ADDRESS_COMPONENTS = [\r\n    {\r\n        id: 'kladr_id',\r\n        fields: ['kladr_id'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'postal_code',\r\n        fields: ['postal_code'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'country',\r\n        fields: ['country'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'region_fias_id',\r\n        fields: ['region_fias_id'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'region_type_full',\r\n        fields: ['region_type_full'],\r\n        forBounds: false,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 2, zeros: 11 },\r\n        fiasType: 'region_fias_id'\r\n    },\r\n    {\r\n        id: 'region',\r\n        fields: ['region', 'region_type', 'region_type_full', 'region_with_type'],\r\n        forBounds: true,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 2, zeros: 11 },\r\n        fiasType: 'region_fias_id'\r\n    },\r\n    {\r\n        id: 'area_fias_id',\r\n        fields: ['area_fias_id'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'area_type_full',\r\n        fields: ['area_type_full'],\r\n        forBounds: false,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 5, zeros: 8 },\r\n        fiasType: 'area_fias_id'\r\n    },\r\n    {\r\n        id: 'area',\r\n        fields: ['area', 'area_type', 'area_type_full', 'area_with_type'],\r\n        forBounds: true,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 5, zeros: 8 },\r\n        fiasType: 'area_fias_id'\r\n    },\r\n    {\r\n        id: 'city_fias_id',\r\n        fields: ['city_fias_id'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'city_type_full',\r\n        fields: ['city_type_full'],\r\n        forBounds: false,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 8, zeros: 5 },\r\n        fiasType: 'city_fias_id'\r\n    },\r\n    {\r\n        id: 'city',\r\n        fields: ['city', 'city_type', 'city_type_full', 'city_with_type'],\r\n        forBounds: true,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 8, zeros: 5 },\r\n        fiasType: 'city_fias_id'\r\n    },\r\n    {\r\n        id: 'city_district_fias_id',\r\n        fields: ['city_district_fias_id'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'city_district_type_full',\r\n        fields: ['city_district_type_full'],\r\n        forBounds: false,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 11, zeros: 2 },\r\n        fiasType: 'city_district_fias_id'\r\n    },\r\n    {\r\n        id: 'city_district',\r\n        fields: ['city_district', 'city_district_type', 'city_district_type_full', 'city_district_with_type'],\r\n        forBounds: true,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 11, zeros: 2 },\r\n        fiasType: 'city_district_fias_id'\r\n    },\r\n    {\r\n        id: 'settlement_fias_id',\r\n        fields: ['settlement_fias_id'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'settlement_type_full',\r\n        fields: ['settlement_type_full'],\r\n        forBounds: false,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 11, zeros: 2 },\r\n        fiasType: 'settlement_fias_id'\r\n    },\r\n    {\r\n        id: 'settlement',\r\n        fields: ['settlement', 'settlement_type', 'settlement_type_full', 'settlement_with_type'],\r\n        forBounds: true,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 11, zeros: 2 },\r\n        fiasType: 'settlement_fias_id'\r\n    },\r\n    {\r\n        id: 'street_fias_id',\r\n        fields: ['street_fias_id'],\r\n        forBounds: false,\r\n        forLocations: true\r\n    },\r\n    {\r\n        id: 'street_type_full',\r\n        fields: ['street_type_full'],\r\n        forBounds: false,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 15, zeros: 2 },\r\n        fiasType: 'street_fias_id'\r\n    },\r\n    {\r\n        id: 'street',\r\n        fields: ['street', 'street_type', 'street_type_full', 'street_with_type'],\r\n        forBounds: true,\r\n        forLocations: true,\r\n        kladrFormat: { digits: 15, zeros: 2 },\r\n        fiasType: 'street_fias_id'\r\n    },\r\n    {\r\n        id: 'house',\r\n        fields: ['house', 'house_type', 'house_type_full',\r\n            'block', 'block_type'],\r\n        forBounds: true,\r\n        forLocations: false,\r\n        kladrFormat: { digits: 19 }\r\n    }\r\n\r\n];\r\n\r\nvar rHasMatch = /<strong>/;\r\n\r\nvar innPartsLengths = {\r\n    'LEGAL': [2, 2, 5, 1],\r\n    'INDIVIDUAL': [2, 2, 6, 2]\r\n};\r\n\r\nfunction valueStartsWith (suggestion, field) {\r\n    var fieldValue = suggestion.data && suggestion.data[field];\r\n\r\n    return fieldValue &&\r\n        new RegExp('^' + utils.escapeRegExChars(fieldValue) + '([' + WORD_DELIMITERS + ']|$)','i')\r\n            .test(suggestion.value);\r\n}\r\n\r\nfunction chooseFormattedField (formattedMain, formattedAlt) {\r\n    return rHasMatch.test(formattedAlt) && !rHasMatch.test(formattedMain)\r\n        ? formattedAlt\r\n        : formattedMain;\r\n}\r\n\r\nfunction formattedField (main, alt, currentValue, suggestion, options) {\r\n    var that = this,\r\n        formattedMain = that.highlightMatches(main, currentValue, suggestion, options),\r\n        formattedAlt = that.highlightMatches(alt, currentValue, suggestion, options);\r\n\r\n    return chooseFormattedField(formattedMain, formattedAlt);\r\n}\r\n\r\nvar types = {};\r\n\r\ntypes['NAME'] = {\r\n    urlSuffix: 'fio',\r\n    matchers: [matchers.matchByNormalizedQuery, matchers.matchByWords],\r\n    // names for labels, describing which fields are displayed\r\n    fieldNames: {\r\n        surname: 'фамилия',\r\n        name: 'имя',\r\n        patronymic: 'отчество'\r\n    },\r\n    // try to suggest even if a suggestion has been selected manually\r\n    alwaysContinueSelecting: true,\r\n    isDataComplete: function (suggestion) {\r\n        var that = this,\r\n            params = that.options.params,\r\n            data = suggestion.data,\r\n            fields;\r\n\r\n        if ($.isFunction(params)) {\r\n            params = params.call(that.element, suggestion.value);\r\n        }\r\n        if (params && params.parts) {\r\n            fields = $.map(params.parts, function (part) {\r\n                return part.toLowerCase();\r\n            });\r\n        } else {\r\n            // when NAME is first, patronymic is mot mandatory\r\n            fields = ['surname', 'name'];\r\n            // when SURNAME is first, it is\r\n            if (valueStartsWith(suggestion, 'surname')) {\r\n                fields.push('patronymic');\r\n            }\r\n        }\r\n        return utils.fieldsNotEmpty(data, fields);\r\n    },\r\n    composeValue: function (data) {\r\n        return utils.compact([data.surname, data.name, data.patronymic]).join(' ');\r\n    }\r\n};\r\n\r\ntypes['ADDRESS'] = {\r\n    urlSuffix: 'address',\r\n    matchers: [\r\n        $.proxy(matchers.matchByNormalizedQuery, { stopwords: ADDRESS_STOPWORDS }),\r\n        $.proxy(matchers.matchByWordsAddress, { stopwords: ADDRESS_STOPWORDS })\r\n    ],\r\n    dataComponents: ADDRESS_COMPONENTS,\r\n    dataComponentsById: utils.indexBy(ADDRESS_COMPONENTS, 'id', 'index'),\r\n    unformattableTokens: ADDRESS_STOPWORDS,\r\n    enrichmentEnabled: true,\r\n    geoEnabled: true,\r\n    isDataComplete: function (suggestion) {\r\n        var fields = [this.bounds.to || 'flat'],\r\n            data = suggestion.data;\r\n\r\n        return !$.isPlainObject(data) || utils.fieldsNotEmpty(data, fields);\r\n    },\r\n    composeValue: function (data, options) {\r\n        var region = data.region_with_type || utils.compact([data.region, data.region_type]).join(' ') || data.region_type_full,\r\n            area = data.area_with_type || utils.compact([data.area_type, data.area]).join(' ') || data.area_type_full,\r\n            city = data.city_with_type || utils.compact([data.city_type, data.city]).join(' ') || data.city_type_full,\r\n            settelement = data.settlement_with_type || utils.compact([data.settlement_type, data.settlement]).join(' ') || data.settlement_type_full,\r\n            cityDistrict = data.city_district_with_type || utils.compact([data.city_district_type, data.city_district]).join(' ') || data.city_district_type_full,\r\n            street = data.street_with_type || utils.compact([data.street_type, data.street]).join(' ') || data.street_type_full,\r\n            house = utils.compact([data.house_type, data.house, data.block_type, data.block]).join(' '),\r\n            flat = utils.compact([data.flat_type, data.flat]).join(' '),\r\n            postal_box = data.postal_box && ('а/я ' + data.postal_box),\r\n            result;\r\n\r\n        // если регион совпадает с городом\r\n        // например г Москва, г Москва\r\n        // то не показываем регион\r\n        if (region === city) {\r\n            region = '';\r\n        }\r\n\r\n        // иногда не показываем район\r\n        if (!(options && options.saveCityDistrict)) {\r\n            if (options && options.excludeCityDistrict) {\r\n                // если район явно запрещен\r\n                cityDistrict = '';\r\n            } else if (cityDistrict && !data.city_district_fias_id) {\r\n                // если район взят из ОКАТО (у него пустой city_district_fias_id)\r\n                cityDistrict = '';\r\n            }\r\n        }\r\n\r\n        result = utils.compact([\r\n            region,\r\n            area,\r\n            city,\r\n            cityDistrict,\r\n            settelement,\r\n            street,\r\n            house,\r\n            flat,\r\n            postal_box\r\n        ]).join(', ');\r\n\r\n        return result;\r\n    },\r\n    formatResult: function() {\r\n        var componentsUnderCityDistrict = [],\r\n            _underCityDistrict = false;\r\n\r\n        $.each(ADDRESS_COMPONENTS, function () {\r\n            if (_underCityDistrict) componentsUnderCityDistrict.push(this.id);\r\n            if (this.id === 'city_district') _underCityDistrict = true;\r\n        });\r\n\r\n        return function (value, currentValue, suggestion, options) {\r\n            var that = this,\r\n                district = suggestion.data && suggestion.data.city_district_with_type,\r\n                unformattableTokens = options && options.unformattableTokens,\r\n                historyValues = suggestion.data && suggestion.data.history_values,\r\n                tokens,\r\n                unusedTokens,\r\n                formattedHistoryValues;\r\n\r\n            // добавляем исторические значения\r\n            if (historyValues && historyValues.length > 0) {\r\n                tokens = utils.getTokens(currentValue, unformattableTokens);\r\n                unusedTokens = this.type.findUnusedTokens(tokens, value);\r\n                formattedHistoryValues = this.type.getFormattedHistoryValues(unusedTokens, historyValues);\r\n                if (formattedHistoryValues) {\r\n                    value += formattedHistoryValues;\r\n                }\r\n            }\r\n\r\n            value = that.highlightMatches(value, currentValue, suggestion, options);\r\n            value = that.wrapFormattedValue(value, suggestion);\r\n\r\n            if (district && (!that.bounds.own.length || that.bounds.own.indexOf('street') >= 0)\r\n                && !$.isEmptyObject(that.copyDataComponents(suggestion.data, componentsUnderCityDistrict))) {\r\n                value +=\r\n                    '<div class=\"' + that.classes.subtext + '\">' +\r\n                    that.highlightMatches(district, currentValue, suggestion) +\r\n                    '</div>';\r\n            }\r\n\r\n            return value;\r\n        };\r\n    }(),\r\n\r\n    /**\r\n     * Возвращает список слов в запросе для которых не найдено соответствующего слова в ответе\r\n     */\r\n    findUnusedTokens: function(tokens, value) {\r\n        var tokenIndex,\r\n            token,\r\n            unused = [];\r\n\r\n        for(tokenIndex in tokens) {\r\n            token = tokens[tokenIndex];\r\n            if (value.indexOf(token) === -1) {\r\n                unused.push(token);\r\n            }\r\n        }\r\n\r\n        return unused;\r\n    },\r\n\r\n    /**\r\n     * Возвращает исторические названия для слов запроса, для которых не найдено совпадения в основном значении\r\n     */\r\n    getFormattedHistoryValues: function(unusedTokens, historyValues) {\r\n        var tokenIndex,\r\n            token,\r\n            historyValueIndex,\r\n            historyValue,\r\n            values = [],\r\n            formatted = '';\r\n\r\n        for(historyValueIndex in historyValues) {\r\n            historyValue = historyValues[historyValueIndex];\r\n            for(tokenIndex in unusedTokens) {\r\n                token = unusedTokens[tokenIndex];\r\n                if (historyValue.toLowerCase().indexOf(token) >= 0) {\r\n                    values.push(historyValue);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (values.length > 0) {\r\n            formatted = ' (бывш. ' + values.join(', ') + ')';\r\n        }\r\n\r\n        return formatted;\r\n    },\r\n\r\n    /**\r\n     * @param instance\r\n     * @param options\r\n     * @param options.suggestion\r\n     * @param options.hasSameValues\r\n     * @param options.hasBeenEnreached\r\n     */\r\n    getSuggestionValue: function(instance, options) {\r\n        var formattedValue = null;\r\n\r\n        if (options.hasSameValues) {\r\n            if (instance.options.restrict_value) {\r\n                // Can not use unrestricted address,\r\n                // because some components (from constraints) must be omitted\r\n                formattedValue = this.getValueWithinConstraints(instance, options.suggestion);\r\n            } else if (instance.bounds.own.length) {\r\n                // Can not use unrestricted address,\r\n                // because only components from bounds must be included\r\n                formattedValue = this.getValueWithinBounds(instance, options.suggestion);\r\n            } else {\r\n                // Can use full unrestricted address\r\n                formattedValue = options.suggestion.unrestricted_value;\r\n            }\r\n        } else if (options.hasBeenEnriched) {\r\n            if (instance.options.restrict_value) {\r\n                formattedValue = this.getValueWithinConstraints(instance, options.suggestion, { excludeCityDistrict: true });\r\n            }\r\n        }\r\n\r\n        return formattedValue;\r\n    },\r\n    /*\r\n     * Compose suggestion value with respect to constraints\r\n     */\r\n    getValueWithinConstraints: function (instance, suggestion, options) {\r\n        return this.composeValue(instance.getUnrestrictedData(suggestion.data), options);\r\n    },\r\n    /*\r\n     * Compose suggestion value with respect to bounds\r\n     */\r\n    getValueWithinBounds: function (instance, suggestion, options) {\r\n        // для корректного составления адреса нужен city_district_fias_id\r\n        var data = instance.copyDataComponents(suggestion.data, instance.bounds.own.concat(['city_district_fias_id']));\r\n\r\n        return this.composeValue(data, options);\r\n    }\r\n\r\n};\r\n\r\ntypes['PARTY'] = {\r\n    urlSuffix: 'party',\r\n    matchers: [\r\n        $.proxy(matchers.matchByFields, {\r\n            // These fields of suggestion's `data` used by by-words matcher\r\n            fieldsStopwords: {\r\n                'value': null,\r\n                'data.address.value': ADDRESS_STOPWORDS,\r\n                'data.inn': null,\r\n                'data.ogrn': null\r\n            }\r\n        })\r\n    ],\r\n    dataComponents: ADDRESS_COMPONENTS,\r\n    geoEnabled: true,\r\n    formatResult: function (value, currentValue, suggestion, options) {\r\n        var that = this,\r\n            formattedInn = that.type.formatResultInn.call(that, suggestion, currentValue),\r\n            formatterOGRN = that.highlightMatches(utils.getDeepValue(suggestion.data, 'ogrn'), currentValue, suggestion),\r\n            formattedInnOGRN = chooseFormattedField(formattedInn, formatterOGRN),\r\n            formattedFIO = that.highlightMatches(utils.getDeepValue(suggestion.data, 'management.name'), currentValue, suggestion),\r\n            address = utils.getDeepValue(suggestion.data, 'address.value') || '';\r\n\r\n        if (that.isMobile) {\r\n            (options || (options = {})).maxLength = 50;\r\n        }\r\n\r\n        value = formattedField.call(that, value, utils.getDeepValue(suggestion.data, 'name.latin'), currentValue, suggestion, options);\r\n        value = that.wrapFormattedValue(value, suggestion);\r\n\r\n        if (address) {\r\n            address = address.replace(/^(\\d{6}?\\s+|Россия,\\s+)/i, '');\r\n            if (that.isMobile) {\r\n                // keep only two first words\r\n                address = address.replace(new RegExp('^([^' + WORD_DELIMITERS + ']+[' + WORD_DELIMITERS + ']+[^' + WORD_DELIMITERS + ']+).*'), '$1');\r\n            } else {\r\n                address = that.highlightMatches(address, currentValue, suggestion, {\r\n                    unformattableTokens: ADDRESS_STOPWORDS\r\n                });\r\n            }\r\n        }\r\n\r\n        if (formattedInnOGRN || address || formattedFIO) {\r\n            value +=\r\n                '<div class=\"' + that.classes.subtext + '\">' +\r\n                '<span class=\"' + that.classes.subtext_inline + '\">' + (formattedInnOGRN || '') + '</span>' +\r\n                (chooseFormattedField(address, formattedFIO) || '') +\r\n                '</div>';\r\n        }\r\n        return value;\r\n    },\r\n    formatResultInn: function(suggestion, currentValue) {\r\n        var that = this,\r\n            inn = suggestion.data && suggestion.data.inn,\r\n            innPartsLength = innPartsLengths[suggestion.data && suggestion.data.type],\r\n            innParts,\r\n            formattedInn,\r\n            rDigit = /\\d/;\r\n\r\n        if (inn) {\r\n            formattedInn = that.highlightMatches(inn, currentValue, suggestion);\r\n            if (innPartsLength) {\r\n                formattedInn = formattedInn.split('');\r\n                innParts = $.map(innPartsLength, function (partLength) {\r\n                    var formattedPart = '',\r\n                        ch;\r\n\r\n                    while (partLength && (ch = formattedInn.shift())) {\r\n                        formattedPart += ch;\r\n                        if (rDigit.test(ch)) partLength--;\r\n                    }\r\n\r\n                    return formattedPart;\r\n                });\r\n                formattedInn = innParts.join('<span class=\"' + that.classes.subtext_delimiter + '\"></span>') +\r\n                    formattedInn.join('');\r\n            }\r\n\r\n            return formattedInn;\r\n        }\r\n    }\r\n};\r\n\r\ntypes['EMAIL'] = {\r\n    urlSuffix: 'email',\r\n    matchers: [matchers.matchByNormalizedQuery],\r\n    isQueryRequestable: function (query) {\r\n        return this.options.suggest_local || query.indexOf('@') >= 0;\r\n    }\r\n};\r\n\r\ntypes['BANK'] = {\r\n    urlSuffix: 'bank',\r\n    matchers: [$.proxy(matchers.matchByFields, {\r\n        // These fields of suggestion's `data` used by by-words matcher\r\n        fieldsStopwords: {\r\n            'value': null,\r\n            'data.bic': null,\r\n            'data.swift': null\r\n        }\r\n    })],\r\n    dataComponents: ADDRESS_COMPONENTS,\r\n    geoEnabled: true,\r\n    formatResult: function (value, currentValue, suggestion, options) {\r\n        var that = this,\r\n            formattedBIC = that.highlightMatches(utils.getDeepValue(suggestion.data, 'bic'), currentValue, suggestion),\r\n            address = utils.getDeepValue(suggestion.data, 'address.value') || '';\r\n\r\n        value = that.highlightMatches(value, currentValue, suggestion, options);\r\n        value = that.wrapFormattedValue(value, suggestion);\r\n\r\n        if (address) {\r\n            address = address.replace(/^\\d{6}( РОССИЯ)?, /i, '');\r\n            if (that.isMobile) {\r\n                // keep only two first words\r\n                address = address.replace(new RegExp('^([^' + WORD_DELIMITERS + ']+[' + WORD_DELIMITERS + ']+[^' + WORD_DELIMITERS + ']+).*'), '$1');\r\n            } else {\r\n                address = that.highlightMatches(address, currentValue, suggestion, {\r\n                    unformattableTokens: ADDRESS_STOPWORDS\r\n                });\r\n            }\r\n        }\r\n\r\n        if (formattedBIC || address) {\r\n            value +=\r\n                '<div class=\"' + that.classes.subtext + '\">' +\r\n                '<span class=\"' + that.classes.subtext_inline + '\">' + formattedBIC + '</span>' +\r\n                address +\r\n                '</div>';\r\n        }\r\n        return value;\r\n    },\r\n    formatSelected: function (suggestion) {\r\n        return utils.getDeepValue(suggestion, 'data.name.payment') || null;\r\n    }\r\n};\r\n\r\n$.extend(DEFAULT_OPTIONS, {\r\n    suggest_local: true\r\n});\r\n\r\nvar notificator = {\r\n\r\n    chains: {},\r\n\r\n    'on': function (name, method) {\r\n        this.get(name).push(method);\r\n        return this;\r\n    },\r\n\r\n    'get': function (name) {\r\n        var chains = this.chains;\r\n        return chains[name] || (chains[name] = []);\r\n    }\r\n};\r\n\r\nvar serviceMethods = {\r\n    'suggest': {\r\n        defaultParams: {\r\n            type: utils.getDefaultType(),\r\n            dataType: 'json',\r\n            contentType: utils.getDefaultContentType()\r\n        },\r\n        addTypeInUrl: true\r\n    },\r\n    'detectAddressByIp': {\r\n        defaultParams: {\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        },\r\n        addTypeInUrl: false\r\n    },\r\n    'status': {\r\n        defaultParams: {\r\n            type: 'GET',\r\n            dataType: 'json'\r\n        },\r\n        addTypeInUrl: true\r\n    },\r\n    'findById': {\r\n        defaultParams: {\r\n            type: utils.getDefaultType(),\r\n            dataType: 'json',\r\n            contentType: utils.getDefaultContentType()\r\n        },\r\n        addTypeInUrl: true\r\n    }\r\n};\r\n\r\nvar requestModes = {\r\n    'suggest': {\r\n        method: 'suggest',\r\n        userSelect: true,\r\n        updateValue: true,\r\n        enrichmentEnabled: true\r\n    },\r\n    'findById': {\r\n        method: 'findById',\r\n        userSelect: false,\r\n        updateValue: false,\r\n        enrichmentEnabled: false\r\n    }\r\n};\r\n\r\nfunction Suggestions(el, options) {\r\n    var that = this;\r\n\r\n    // Shared variables:\r\n    that.element = el;\r\n    that.el = $(el);\r\n    that.suggestions = [];\r\n    that.badQueries = [];\r\n    that.selectedIndex = -1;\r\n    that.currentValue = that.element.value;\r\n    that.intervalId = 0;\r\n    that.cachedResponse = {};\r\n    that.enrichmentCache = {};\r\n    that.currentRequest = null;\r\n    that.inputPhase = $.Deferred();\r\n    that.fetchPhase = $.Deferred();\r\n    that.enrichPhase = $.Deferred();\r\n    that.onChangeTimeout = null;\r\n    that.triggering = {};\r\n    that.$wrapper = null;\r\n    that.options = $.extend({}, DEFAULT_OPTIONS, options);\r\n    that.classes = {\r\n        hint: 'suggestions-hint',\r\n        mobile: 'suggestions-mobile',\r\n        nowrap: 'suggestions-nowrap',\r\n        selected: 'suggestions-selected',\r\n        suggestion: 'suggestions-suggestion',\r\n        subtext: 'suggestions-subtext',\r\n        subtext_inline: 'suggestions-subtext suggestions-subtext_inline',\r\n        subtext_delimiter: 'suggestions-subtext-delimiter',\r\n        subtext_label: 'suggestions-subtext suggestions-subtext_label',\r\n        removeConstraint: 'suggestions-remove',\r\n        value: 'suggestions-value'\r\n    };\r\n    that.disabled = false;\r\n    that.selection = null;\r\n    that.$viewport = $(window);\r\n    that.$body = $(document.body);\r\n    that.type = null;\r\n    that.status = {};\r\n\r\n    that.setupElement();\r\n\r\n    that.initializer = $.Deferred();\r\n\r\n    if (that.el.is(':visible')) {\r\n        that.initializer.resolve();\r\n    } else {\r\n        that.deferInitialization();\r\n    }\r\n\r\n    that.initializer.done($.proxy(that.initialize, that));\r\n}\r\n\r\nSuggestions.prototype = {\r\n\r\n    // Creation and destruction\r\n\r\n    initialize: function () {\r\n        var that = this;\r\n\r\n        that.uniqueId = utils.uniqueId('i');\r\n\r\n        that.createWrapper();\r\n        that.notify('initialize');\r\n\r\n        that.bindWindowEvents();\r\n\r\n        that.setOptions();\r\n        that.fixPosition();\r\n    },\r\n\r\n    /**\r\n     * Initialize when element is firstly interacted\r\n     */\r\n    deferInitialization: function () {\r\n        var that = this,\r\n            events = 'mouseover focus keydown',\r\n            timer,\r\n            callback = function () {\r\n                that.initializer.resolve();\r\n                that.enable();\r\n            };\r\n\r\n        that.initializer.always(function(){\r\n            that.el.off(events, callback);\r\n            clearInterval(timer);\r\n        });\r\n\r\n        that.disabled = true;\r\n        that.el.on(events, callback);\r\n        timer = setInterval(function(){\r\n            if (that.el.is(':visible')) {\r\n                callback();\r\n            }\r\n        }, that.options.initializeInterval);\r\n    },\r\n\r\n    isInitialized: function () {\r\n        return this.initializer.state() === 'resolved';\r\n    },\r\n\r\n    dispose: function () {\r\n        var that = this;\r\n\r\n        that.initializer.reject();\r\n        that.notify('dispose');\r\n        that.el.removeData(DATA_ATTR_KEY)\r\n            .removeClass('suggestions-input');\r\n        that.unbindWindowEvents();\r\n        that.removeWrapper();\r\n        that.el.trigger('suggestions-dispose');\r\n    },\r\n\r\n    notify: function (chainName) {\r\n        var that = this,\r\n            args = utils.slice(arguments, 1);\r\n\r\n        return $.map(notificator.get(chainName), function (method) {\r\n            return method.apply(that, args);\r\n        });\r\n    },\r\n\r\n    createWrapper: function () {\r\n        var that = this;\r\n\r\n        that.$wrapper = $('<div class=\"suggestions-wrapper\"/>');\r\n        that.el.after(that.$wrapper);\r\n\r\n        that.$wrapper.on('mousedown' + EVENT_NS, $.proxy(that.onMousedown, that));\r\n    },\r\n\r\n    removeWrapper: function () {\r\n        var that = this;\r\n\r\n        if (that.$wrapper) {\r\n            that.$wrapper.remove();\r\n        }\r\n        $(that.options.$helpers).off(EVENT_NS);\r\n    },\r\n\r\n    /** This whole handler is needed to prevent blur event on textbox\r\n     * when suggestion is clicked (blur leads to suggestions hide, so we need to prevent it).\r\n     * See https://github.com/jquery/jquery-ui/blob/master/ui/autocomplete.js for details\r\n     */\r\n    onMousedown: function (e) {\r\n        var that = this;\r\n\r\n        // prevent moving focus out of the text field\r\n        e.preventDefault();\r\n\r\n        // IE doesn't prevent moving focus even with e.preventDefault()\r\n        // so we set a flag to know when we should ignore the blur event\r\n        that.cancelBlur = true;\r\n        utils.delay(function () {\r\n            delete that.cancelBlur;\r\n        });\r\n\r\n        // clicking on the scrollbar causes focus to shift to the body\r\n        // but we can't detect a mouseup or a click immediately afterward\r\n        // so we have to track the next mousedown and close the menu if\r\n        // the user clicks somewhere outside of the autocomplete\r\n        if ($(e.target).closest(\".ui-menu-item\").length == 0) {\r\n            utils.delay(function () {\r\n                $(document).one(\"mousedown\", function (e) {\r\n                    var $elements = that.el\r\n                        .add(that.$wrapper)\r\n                        .add(that.options.$helpers);\r\n\r\n                    if (that.options.floating) {\r\n                        $elements = $elements.add(that.$container);\r\n                    }\r\n\r\n                    $elements = $elements.filter(function () {\r\n                        return this === e.target || $.contains(this, e.target);\r\n                    });\r\n\r\n                    if (!$elements.length) {\r\n                        that.hide();\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    bindWindowEvents: function () {\r\n        var that = this,\r\n            handler = $.proxy(that.fixPosition, that);\r\n\r\n        that.$viewport\r\n            .on('resize' + EVENT_NS + that.uniqueId, handler)\r\n            .on('scroll' + EVENT_NS + that.uniqueId, handler);\r\n    },\r\n\r\n    unbindWindowEvents: function () {\r\n        this.$viewport\r\n            .off('resize' + EVENT_NS + this.uniqueId)\r\n            .off('scroll' + EVENT_NS + this.uniqueId);\r\n    },\r\n\r\n    scrollToTop: function () {\r\n        var that = this,\r\n            scrollTarget = that.options.scrollOnFocus;\r\n\r\n        if (scrollTarget === true) {\r\n            scrollTarget = that.el;\r\n        }\r\n        if (scrollTarget instanceof $ && scrollTarget.length > 0) {\r\n            $('body,html').animate({\r\n                scrollTop: scrollTarget.offset().top\r\n            }, 'fast');\r\n        }\r\n    },\r\n\r\n    // Configuration methods\r\n\r\n    setOptions: function (suppliedOptions) {\r\n        var that = this;\r\n\r\n        $.extend(that.options, suppliedOptions);\r\n\r\n        // Check mandatory options\r\n        $.each({\r\n            'type': types,\r\n            'requestMode': requestModes\r\n        }, function (option, available) {\r\n            that[option] = available[that.options[option]];\r\n            if (!that[option]) {\r\n                that.disable();\r\n                throw '`' + option + '` option is incorrect! Must be one of: ' + $.map(available, function (value, name) {\r\n                    return '\"' + name + '\"';\r\n                }).join(', ');\r\n            }\r\n        });\r\n\r\n        $(that.options.$helpers)\r\n            .off(EVENT_NS)\r\n            .on('mousedown' + EVENT_NS, $.proxy(that.onMousedown, that));\r\n\r\n        if (that.isInitialized()) {\r\n            that.notify('setOptions');\r\n        }\r\n    },\r\n\r\n    // Common public methods\r\n\r\n    fixPosition: function (e) {\r\n        var that = this,\r\n            elLayout = {},\r\n            wrapperOffset,\r\n            origin;\r\n\r\n        that.isMobile = that.$viewport.width() <= that.options.mobileWidth;\r\n\r\n        if (!that.isInitialized() || (e && e.type == 'scroll' && !(that.options.floating || that.isMobile))) return;\r\n        that.$container.appendTo(that.options.floating ? that.$body : that.$wrapper);\r\n\r\n        that.notify('resetPosition');\r\n        // reset input's padding to default, determined by css\r\n        that.el.css('paddingLeft', '');\r\n        that.el.css('paddingRight', '');\r\n        elLayout.paddingLeft = parseFloat(that.el.css('paddingLeft'));\r\n        elLayout.paddingRight = parseFloat(that.el.css('paddingRight'));\r\n\r\n        $.extend(elLayout, that.el.offset());\r\n        elLayout.borderTop = that.el.css('border-top-style') == 'none' ? 0 : parseFloat(that.el.css('border-top-width'));\r\n        elLayout.borderLeft = that.el.css('border-left-style') == 'none' ? 0 : parseFloat(that.el.css('border-left-width'));\r\n        elLayout.innerHeight = that.el.innerHeight();\r\n        elLayout.innerWidth = that.el.innerWidth();\r\n        elLayout.outerHeight = that.el.outerHeight();\r\n        elLayout.componentsLeft = 0;\r\n        elLayout.componentsRight = 0;\r\n        wrapperOffset = that.$wrapper.offset();\r\n\r\n        origin = {\r\n            top: elLayout.top - wrapperOffset.top,\r\n            left: elLayout.left - wrapperOffset.left\r\n        };\r\n\r\n        that.notify('fixPosition', origin, elLayout);\r\n\r\n        if (elLayout.componentsLeft > elLayout.paddingLeft) {\r\n            that.el.css('paddingLeft', elLayout.componentsLeft + 'px');\r\n        }\r\n        if (elLayout.componentsRight > elLayout.paddingRight) {\r\n            that.el.css('paddingRight', elLayout.componentsRight + 'px');\r\n        }\r\n    },\r\n\r\n    clearCache: function () {\r\n        this.cachedResponse = {};\r\n        this.enrichmentCache = {};\r\n        this.badQueries = [];\r\n    },\r\n\r\n    clear: function () {\r\n        var that = this,\r\n            currentSelection = that.selection;\r\n\r\n        if (that.isInitialized()) {\r\n            that.clearCache();\r\n            that.currentValue = '';\r\n            that.selection = null;\r\n            that.hide();\r\n            that.suggestions = [];\r\n            that.el.val('');\r\n            that.el.trigger('suggestions-clear');\r\n            that.notify('clear');\r\n            that.trigger('InvalidateSelection', currentSelection);\r\n        }\r\n    },\r\n\r\n    disable: function () {\r\n        var that = this;\r\n\r\n        that.disabled = true;\r\n        that.abortRequest();\r\n        if (that.visible) {\r\n            that.hide();\r\n        }\r\n    },\r\n\r\n    enable: function () {\r\n        this.disabled = false;\r\n    },\r\n\r\n    isUnavailable: function () {\r\n        return this.disabled;\r\n    },\r\n\r\n    update: function () {\r\n        var that = this,\r\n            query = that.el.val();\r\n\r\n        if (that.isInitialized()) {\r\n            that.currentValue = query;\r\n            if (that.isQueryRequestable(query)) {\r\n                that.updateSuggestions(query);\r\n            } else {\r\n                that.hide();\r\n            }\r\n        }\r\n    },\r\n\r\n    setSuggestion: function (suggestion) {\r\n        var that = this,\r\n            data,\r\n            value;\r\n\r\n        if ($.isPlainObject(suggestion) && $.isPlainObject(suggestion.data)) {\r\n            suggestion = $.extend(true, {}, suggestion);\r\n\r\n            if (that.isUnavailable() && that.initializer && that.initializer.state() === 'pending') {\r\n                that.initializer.resolve();\r\n                that.enable();\r\n            }\r\n\r\n            if (that.bounds.own.length) {\r\n                that.checkValueBounds(suggestion);\r\n                data = that.copyDataComponents(suggestion.data, that.bounds.all);\r\n                if (suggestion.data.kladr_id) {\r\n                    data.kladr_id = that.getBoundedKladrId(suggestion.data.kladr_id, that.bounds.all);\r\n                }\r\n                suggestion.data = data;\r\n            }\r\n\r\n            that.selection = suggestion;\r\n\r\n            // `that.suggestions` required by `that.getSuggestionValue` and must be set before\r\n            that.suggestions = [suggestion];\r\n            value = that.getSuggestionValue(suggestion) || '';\r\n            that.currentValue = value;\r\n            that.el.val(value);\r\n            that.abortRequest();\r\n            that.el.trigger('suggestions-set');\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fetch full object for current INPUT's value\r\n     * if no suitable object found, clean input element\r\n     */\r\n    fixData: function () {\r\n        var that = this,\r\n            fullQuery = that.extendedCurrentValue(),\r\n            currentValue = that.el.val(),\r\n            resolver = $.Deferred();\r\n\r\n        resolver\r\n            .done(function (suggestion) {\r\n                that.selectSuggestion(suggestion, 0, currentValue, { hasBeenEnriched: true });\r\n                that.el.trigger('suggestions-fixdata', suggestion);\r\n            })\r\n            .fail(function () {\r\n                that.selection = null;\r\n                that.el.trigger('suggestions-fixdata');\r\n            });\r\n\r\n        if (that.isQueryRequestable(fullQuery)) {\r\n            that.currentValue = fullQuery;\r\n            that.getSuggestions(fullQuery, { count: 1, from_bound: null, to_bound: null })\r\n                .done(function (suggestions) {\r\n                    // data fetched\r\n                    var suggestion = suggestions[0];\r\n                    if (suggestion) {\r\n                        resolver.resolve(suggestion);\r\n                    } else {\r\n                        resolver.reject();\r\n                    }\r\n                })\r\n                .fail(function () {\r\n                    // no data fetched\r\n                    resolver.reject();\r\n                });\r\n        } else {\r\n            resolver.reject();\r\n        }\r\n    },\r\n\r\n    // Querying related methods\r\n\r\n    /**\r\n     * Looks up parent instances\r\n     * @returns {String} current value prepended by parents' values\r\n     */\r\n    extendedCurrentValue: function () {\r\n        var that = this,\r\n            parentInstance = that.getParentInstance(),\r\n            parentValue = parentInstance && parentInstance.extendedCurrentValue(),\r\n            currentValue = $.trim(that.el.val());\r\n\r\n        return utils.compact([parentValue, currentValue]).join(' ');\r\n    },\r\n\r\n    getAjaxParams: function (method, custom) {\r\n        var that = this,\r\n            token = $.trim(that.options.token),\r\n            partner = $.trim(that.options.partner),\r\n            serviceUrl = that.options.serviceUrl,\r\n            url = that.options.url,\r\n            serviceMethod = serviceMethods[method],\r\n            params = $.extend({\r\n                timeout: that.options.timeout\r\n            }, serviceMethod.defaultParams),\r\n            headers = {};\r\n\r\n        if (url) {\r\n            serviceUrl = url;\r\n        } else {\r\n            if (!/\\/$/.test(serviceUrl)) {\r\n                serviceUrl += '/';\r\n            }\r\n            serviceUrl += method;\r\n            if (serviceMethod.addTypeInUrl) {\r\n                serviceUrl += '/' + that.type.urlSuffix;\r\n            }\r\n        }\r\n\r\n        serviceUrl = utils.fixURLProtocol(serviceUrl);\r\n\r\n        if ($.support.cors) {\r\n            // for XMLHttpRequest put token in header\r\n            if (token) {\r\n                headers['Authorization'] = 'Token ' + token;\r\n            }\r\n            if (partner) {\r\n                headers['X-Partner'] = partner;\r\n            }\r\n            headers['X-Version'] = Suggestions.version;\r\n            if (!params.headers) {\r\n                params.headers = {};\r\n            }\r\n            if (!params.xhrFields) {\r\n                params.xhrFields = {};\r\n            }\r\n            $.extend(params.headers, that.options.headers, headers);\r\n            // server sets Access-Control-Allow-Origin: *\r\n            // which requires no credentials\r\n            params.xhrFields.withCredentials = false;\r\n\r\n        } else {\r\n            // for XDomainRequest put token into URL\r\n            if (token) {\r\n                headers['token'] = token;\r\n            }\r\n            if (partner) {\r\n                headers['partner'] = partner;\r\n            }\r\n            headers['version'] = Suggestions.version;\r\n            serviceUrl = utils.addUrlParams(serviceUrl, headers);\r\n        }\r\n\r\n        params.url = serviceUrl;\r\n\r\n        return $.extend(params, custom);\r\n    },\r\n\r\n    isQueryRequestable: function (query) {\r\n        var that = this,\r\n            result;\r\n\r\n        result = query.length >= that.options.minChars;\r\n\r\n        if (result && that.type.isQueryRequestable) {\r\n            result = that.type.isQueryRequestable.call(that, query);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    constructRequestParams: function (query, customParams) {\r\n        var that = this,\r\n            options = that.options,\r\n            params = $.isFunction(options.params)\r\n                ? options.params.call(that.element, query)\r\n                : $.extend({}, options.params);\r\n\r\n        if (that.type.constructRequestParams) {\r\n            $.extend(params, that.type.constructRequestParams.call(that));\r\n        }\r\n        $.each(that.notify('requestParams'), function (i, hookParams) {\r\n            $.extend(params, hookParams);\r\n        });\r\n        params[options.paramName] = query;\r\n        if ($.isNumeric(options.count) && options.count > 0) {\r\n            params.count = options.count;\r\n        }\r\n\r\n        return $.extend(params, customParams);\r\n    },\r\n\r\n    updateSuggestions: function (query) {\r\n        var that = this;\r\n\r\n        that.fetchPhase = that.getSuggestions(query)\r\n            .done(function (suggestions) {\r\n                that.assignSuggestions(suggestions, query);\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Get suggestions from cache or from server\r\n     * @param {String} query\r\n     * @param {Object} customParams parameters specified here will be passed to request body\r\n     * @param {Object} requestOptions\r\n     * @param {Boolean} [requestOptions.noCallbacks]  flag, request competence callbacks will not be invoked\r\n     * @param {Boolean} [requestOptions.useEnrichmentCache]\r\n     * @return {$.Deferred} waiter which is to be resolved with suggestions as argument\r\n     */\r\n    getSuggestions: function (query, customParams, requestOptions) {\r\n        var response,\r\n            that = this,\r\n            options = that.options,\r\n            noCallbacks = requestOptions && requestOptions.noCallbacks,\r\n            useEnrichmentCache = requestOptions && requestOptions.useEnrichmentCache,\r\n            params = that.constructRequestParams(query, customParams),\r\n            cacheKey = $.param(params || {}),\r\n            resolver = $.Deferred();\r\n\r\n        response = that.cachedResponse[cacheKey];\r\n        if (response && $.isArray(response.suggestions)) {\r\n            resolver.resolve(response.suggestions);\r\n        } else {\r\n            if (that.isBadQuery(query)) {\r\n                resolver.reject();\r\n            } else {\r\n                if (!noCallbacks && options.onSearchStart.call(that.element, params) === false) {\r\n                    resolver.reject();\r\n                } else {\r\n                    that.doGetSuggestions(params)\r\n                        .done(function (response) {\r\n                            // if response is correct and current value has not been changed\r\n                            if (that.processResponse(response) && query == that.currentValue) {\r\n\r\n                                // Cache results if cache is not disabled:\r\n                                if (!options.noCache) {\r\n                                    if (useEnrichmentCache) {\r\n                                        that.enrichmentCache[query] = response.suggestions[0];\r\n                                    } else {\r\n                                        that.enrichResponse(response, query);\r\n                                        that.cachedResponse[cacheKey] = response;\r\n                                        if (options.preventBadQueries && response.suggestions.length === 0) {\r\n                                            that.badQueries.push(query);\r\n                                        }\r\n                                    }\r\n                                }\r\n\r\n                                resolver.resolve(response.suggestions);\r\n                            } else {\r\n                                resolver.reject();\r\n                            }\r\n                            if (!noCallbacks) {\r\n                                options.onSearchComplete.call(that.element, query, response.suggestions);\r\n                            }\r\n                        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n                        resolver.reject();\r\n                        if (!noCallbacks && textStatus !== 'abort') {\r\n                            options.onSearchError.call(that.element, query, jqXHR, textStatus, errorThrown);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        return resolver;\r\n    },\r\n\r\n    /**\r\n     * Sends an AJAX request to server suggest method.\r\n     * @param {Object} params request params\r\n     * @returns {$.Deferred} response promise\r\n     */\r\n    doGetSuggestions: function (params) {\r\n        var that = this,\r\n            request = $.ajax(\r\n                that.getAjaxParams(that.requestMode.method, { data: utils.serialize(params) })\r\n            );\r\n\r\n        that.abortRequest();\r\n        that.currentRequest = request;\r\n        that.notify('request');\r\n\r\n        request.always(function () {\r\n            that.currentRequest = null;\r\n            that.notify('request');\r\n        });\r\n\r\n        return request;\r\n    },\r\n\r\n    isBadQuery: function (q) {\r\n        if (!this.options.preventBadQueries) {\r\n            return false;\r\n        }\r\n\r\n        var result = false;\r\n        $.each(this.badQueries, function (i, query) {\r\n            return !(result = q.indexOf(query) === 0);\r\n        });\r\n        return result;\r\n    },\r\n\r\n    abortRequest: function () {\r\n        var that = this;\r\n\r\n        if (that.currentRequest) {\r\n            that.currentRequest.abort();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Checks response format and data\r\n     * @return {Boolean} response contains acceptable data\r\n     */\r\n    processResponse: function (response) {\r\n        var that = this,\r\n            suggestions;\r\n\r\n        if (!response || !$.isArray(response.suggestions)) {\r\n            return false;\r\n        }\r\n\r\n        that.verifySuggestionsFormat(response.suggestions);\r\n        that.setUnrestrictedValues(response.suggestions);\r\n\r\n        if ($.isFunction(that.options.onSuggestionsFetch)) {\r\n            suggestions = that.options.onSuggestionsFetch.call(that.element, response.suggestions);\r\n            if ($.isArray(suggestions)) {\r\n                response.suggestions = suggestions;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    verifySuggestionsFormat: function (suggestions) {\r\n        if (typeof suggestions[0] === 'string') {\r\n            $.each(suggestions, function (i, value) {\r\n                suggestions[i] = { value: value, data: null };\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Gets string to set as input value\r\n     *\r\n     * @param suggestion\r\n     * @param {Object} [selectionOptions]\r\n     * @param {boolean} selectionOptions.hasBeenEnriched\r\n     * @param {boolean} selectionOptions.hasSameValues\r\n     * @return {string}\r\n     */\r\n    getSuggestionValue: function (suggestion, selectionOptions) {\r\n        var that = this,\r\n            formatSelected = that.options.formatSelected || that.type.formatSelected,\r\n            hasSameValues = selectionOptions && selectionOptions.hasSameValues,\r\n            hasBeenEnriched = selectionOptions && selectionOptions.hasBeenEnriched,\r\n            formattedValue,\r\n            typeFormattedValue = null;\r\n\r\n\r\n        if ($.isFunction(formatSelected)) {\r\n            formattedValue = formatSelected.call(that, suggestion);\r\n        }\r\n\r\n        if (typeof formattedValue !== 'string') {\r\n            formattedValue = suggestion.value;\r\n\r\n            if (that.type.getSuggestionValue) {\r\n                typeFormattedValue = that.type.getSuggestionValue(that, {\r\n                    suggestion: suggestion,\r\n                    hasSameValues: hasSameValues,\r\n                    hasBeenEnriched: hasBeenEnriched,\r\n                });\r\n\r\n                if (typeFormattedValue !== null) {\r\n                    formattedValue = typeFormattedValue;\r\n                }\r\n            }\r\n        }\r\n\r\n        return formattedValue;\r\n    },\r\n\r\n    hasSameValues: function(suggestion){\r\n        var hasSame = false;\r\n\r\n        $.each(this.suggestions, function(i, anotherSuggestion){\r\n            if (anotherSuggestion.value === suggestion.value && anotherSuggestion !== suggestion) {\r\n                hasSame = true;\r\n                return false;\r\n            }\r\n        });\r\n\r\n        return hasSame;\r\n    },\r\n\r\n    assignSuggestions: function (suggestions, query) {\r\n        var that = this;\r\n        that.suggestions = suggestions;\r\n        that.notify('assignSuggestions', query);\r\n    },\r\n\r\n    shouldRestrictValues: function () {\r\n        var that = this;\r\n        // treat suggestions value as restricted only if there is one constraint\r\n        // and restrict_value is true\r\n        return that.options.restrict_value\r\n            && that.constraints\r\n            && Object.keys(that.constraints).length == 1;\r\n    },\r\n\r\n    /**\r\n     * Fills suggestion.unrestricted_value property\r\n     */\r\n    setUnrestrictedValues: function (suggestions) {\r\n        var that = this,\r\n            shouldRestrict = that.shouldRestrictValues(),\r\n            label = that.getFirstConstraintLabel();\r\n\r\n        $.each(suggestions, function (i, suggestion) {\r\n            if (!suggestion.unrestricted_value) {\r\n                suggestion.unrestricted_value = shouldRestrict ? label + ', ' + suggestion.value : suggestion.value;\r\n            }\r\n        });\r\n    },\r\n\r\n    areSuggestionsSame: function (a, b) {\r\n        return a && b &&\r\n            a.value === b.value &&\r\n            utils.areSame(a.data, b.data);\r\n    }\r\n\r\n};\r\n\r\n/**\r\n * Methods related to INPUT's behavior\r\n */\r\n\r\nvar methods = {\r\n\r\n    setupElement: function () {\r\n        // Remove autocomplete attribute to prevent native suggestions:\r\n        this.el\r\n            .attr('autocomplete', 'off')\r\n            .addClass('suggestions-input')\r\n            .css('box-sizing', 'border-box');\r\n    },\r\n\r\n    bindElementEvents: function () {\r\n        var that = this;\r\n\r\n        that.el.on('keydown' + EVENT_NS, $.proxy(that.onElementKeyDown, that));\r\n        // IE is buggy, it doesn't trigger `input` on text deletion, so use following events\r\n        that.el.on(['keyup' + EVENT_NS, 'cut' + EVENT_NS, 'paste' + EVENT_NS, 'input' + EVENT_NS].join(' '), $.proxy(that.onElementKeyUp, that));\r\n        that.el.on('blur' + EVENT_NS, $.proxy(that.onElementBlur, that));\r\n        that.el.on('focus' + EVENT_NS, $.proxy(that.onElementFocus, that));\r\n    },\r\n\r\n    unbindElementEvents: function () {\r\n        this.el.off(EVENT_NS);\r\n    },\r\n\r\n    onElementBlur: function () {\r\n        var that = this;\r\n\r\n        // suggestion was clicked, blur should be ignored\r\n        // see container mousedown handler\r\n        if (that.cancelBlur) {\r\n            that.cancelBlur = false;\r\n            return;\r\n        }\r\n\r\n        if (that.options.triggerSelectOnBlur) {\r\n            if (!that.isUnavailable()) {\r\n                that.selectCurrentValue({ noSpace: true })\r\n                    .always(function () {\r\n                        // For NAMEs selecting keeps suggestions list visible, so hide it\r\n                        that.hide();\r\n                    });\r\n            }\r\n        } else {\r\n            that.hide();\r\n        }\r\n\r\n        if (that.fetchPhase.abort) {\r\n            that.fetchPhase.abort();\r\n        }\r\n    },\r\n\r\n    onElementFocus: function () {\r\n        var that = this;\r\n\r\n        if (!that.cancelFocus) {\r\n            // defer methods to allow browser update input's style before\r\n            utils.delay($.proxy(that.completeOnFocus, that));\r\n        }\r\n        that.cancelFocus = false;\r\n    },\r\n\r\n    onElementKeyDown: function (e) {\r\n        var that = this;\r\n\r\n        if (that.isUnavailable()) {\r\n            return;\r\n        }\r\n\r\n        if (!that.visible) {\r\n            switch (e.which) {\r\n                // If suggestions are hidden and user presses arrow down, display suggestions\r\n                case KEYS.DOWN:\r\n                    that.suggest();\r\n                    break;\r\n                // if no suggestions available and user pressed Enter\r\n                case KEYS.ENTER:\r\n                    if (that.options.triggerSelectOnEnter) {\r\n                        that.triggerOnSelectNothing();\r\n                    }\r\n                    break;\r\n            }\r\n            return;\r\n        }\r\n\r\n        switch (e.which) {\r\n            case KEYS.ESC:\r\n                that.el.val(that.currentValue);\r\n                that.hide();\r\n                that.abortRequest();\r\n                break;\r\n\r\n            case KEYS.TAB:\r\n                if (that.options.tabDisabled === false) {\r\n                    return;\r\n                }\r\n                break;\r\n\r\n            case KEYS.ENTER:\r\n                if (that.options.triggerSelectOnEnter) {\r\n                    that.selectCurrentValue();\r\n                }\r\n                break;\r\n\r\n            case KEYS.SPACE:\r\n                if (that.options.triggerSelectOnSpace && that.isCursorAtEnd()) {\r\n                    e.preventDefault();\r\n                    that.selectCurrentValue({ continueSelecting: true, dontEnrich: true })\r\n                        .fail(function () {\r\n                            // If all data fetched but nothing selected\r\n                            that.currentValue += ' ';\r\n                            that.el.val(that.currentValue);\r\n                            that.proceedChangedValue();\r\n                        });\r\n                }\r\n                return;\r\n            case KEYS.UP:\r\n                that.moveUp();\r\n                break;\r\n            case KEYS.DOWN:\r\n                that.moveDown();\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n\r\n        // Cancel event if function did not return:\r\n        e.stopImmediatePropagation();\r\n        e.preventDefault();\r\n    },\r\n\r\n    onElementKeyUp: function (e) {\r\n        var that = this;\r\n\r\n        if (that.isUnavailable()) {\r\n            return;\r\n        }\r\n\r\n        switch (e.which) {\r\n            case KEYS.UP:\r\n            case KEYS.DOWN:\r\n            case KEYS.ENTER:\r\n                return;\r\n        }\r\n\r\n        // Cancel pending change\r\n        clearTimeout(that.onChangeTimeout);\r\n        that.inputPhase.reject();\r\n\r\n        if (that.currentValue !== that.el.val()) {\r\n            that.proceedChangedValue();\r\n        }\r\n    },\r\n\r\n    proceedChangedValue: function () {\r\n        var that = this;\r\n\r\n        // Cancel fetching, because it became obsolete\r\n        that.abortRequest();\r\n\r\n        that.inputPhase = $.Deferred()\r\n            .done($.proxy(that.onValueChange, that));\r\n\r\n        if (that.options.deferRequestBy > 0) {\r\n            // Defer lookup in case when value changes very quickly:\r\n            that.onChangeTimeout = utils.delay(function () {\r\n                that.inputPhase.resolve();\r\n            }, that.options.deferRequestBy);\r\n        } else {\r\n            that.inputPhase.resolve();\r\n        }\r\n    },\r\n\r\n    onValueChange: function () {\r\n        var that = this,\r\n            currentSelection;\r\n\r\n        if (that.selection) {\r\n            currentSelection = that.selection;\r\n            that.selection = null;\r\n            that.trigger('InvalidateSelection', currentSelection);\r\n        }\r\n\r\n        that.selectedIndex = -1;\r\n\r\n        that.update();\r\n        that.notify('valueChange');\r\n    },\r\n\r\n    completeOnFocus: function () {\r\n        var that = this;\r\n\r\n        if (that.isUnavailable()) {\r\n            return;\r\n        }\r\n\r\n        if (that.isElementFocused()) {\r\n            that.fixPosition();\r\n            that.update();\r\n            if (that.isMobile) {\r\n                that.setCursorAtEnd();\r\n                that.scrollToTop();\r\n            }\r\n        }\r\n    },\r\n\r\n    isElementFocused: function () {\r\n        return document.activeElement === this.element;\r\n    },\r\n\r\n    isCursorAtEnd: function () {\r\n        var that = this,\r\n            valLength = that.el.val().length,\r\n            selectionStart,\r\n            range;\r\n\r\n        // `selectionStart` and `selectionEnd` are not supported by some input types\r\n        try {\r\n            selectionStart = that.element.selectionStart;\r\n            if (typeof selectionStart === 'number') {\r\n                return selectionStart === valLength;\r\n            }\r\n        } catch (ex) {\r\n        }\r\n\r\n        if (document.selection) {\r\n            range = document.selection.createRange();\r\n            range.moveStart('character', -valLength);\r\n            return valLength === range.text.length;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    setCursorAtEnd: function () {\r\n        var element = this.element;\r\n\r\n        // `selectionStart` and `selectionEnd` are not supported by some input types\r\n        try {\r\n            element.selectionEnd = element.selectionStart = element.value.length;\r\n            element.scrollLeft = element.scrollWidth;\r\n        } catch (ex) {\r\n            element.value = element.value;\r\n        }\r\n    }\r\n\r\n};\r\n\r\n$.extend(Suggestions.prototype, methods);\r\n\r\nnotificator\r\n    .on('initialize', methods.bindElementEvents)\r\n    .on('dispose', methods.unbindElementEvents);\r\n\r\n/**\r\n * Methods related to plugin's authorization on server\r\n */\r\n\r\n// keys are \"[type][token]\"\r\nvar statusRequests = {};\r\n\r\nfunction resetTokens () {\r\n    $.each(statusRequests, function(){\r\n        this.abort();\r\n    });\r\n    statusRequests = {};\r\n}\r\n\r\nresetTokens();\r\n\r\nvar methods$1 = {\r\n\r\n    checkStatus: function () {\r\n        var that = this,\r\n            token = $.trim(that.options.token),\r\n            requestKey = that.options.type + token,\r\n            request = statusRequests[requestKey];\r\n\r\n        if (!request) {\r\n            request = statusRequests[requestKey] = $.ajax(that.getAjaxParams('status'));\r\n        }\r\n\r\n        request\r\n            .done(function(status){\r\n                if (status.search) {\r\n                    $.extend(that.status, status);\r\n                } else {\r\n                    triggerError('Service Unavailable');\r\n                }\r\n            })\r\n            .fail(function(){\r\n                triggerError(request.statusText);\r\n            });\r\n\r\n        function triggerError(errorThrown){\r\n            // If unauthorized\r\n            if ($.isFunction(that.options.onSearchError)) {\r\n                that.options.onSearchError.call(that.element, null, request, 'error', errorThrown);\r\n            }\r\n        }\r\n    }\r\n\r\n};\r\n\r\nSuggestions.resetTokens = resetTokens;\r\n\r\n$.extend(Suggestions.prototype, methods$1);\r\n\r\nnotificator\r\n    .on('setOptions', methods$1.checkStatus);\r\n\r\n//export { methods, resetTokens };\r\n\r\nvar locationRequest;\r\nvar defaultGeoLocation = true;\r\n\r\nfunction resetLocation () {\r\n    locationRequest = null;\r\n    DEFAULT_OPTIONS.geoLocation = defaultGeoLocation;\r\n}\r\n\r\nvar methods$2 = {\r\n\r\n    checkLocation: function () {\r\n        var that = this,\r\n            providedLocation = that.options.geoLocation;\r\n\r\n        if (!that.type.geoEnabled || !providedLocation) {\r\n            return;\r\n        }\r\n\r\n        that.geoLocation = $.Deferred();\r\n        if ($.isPlainObject(providedLocation) || $.isArray(providedLocation)) {\r\n            that.geoLocation.resolve(providedLocation);\r\n        } else {\r\n            if (!locationRequest) {\r\n                locationRequest = $.ajax(that.getAjaxParams('detectAddressByIp'));\r\n            }\r\n\r\n            locationRequest\r\n                .done(function (resp) {\r\n                    var locationData = resp && resp.location && resp.location.data;\r\n                    if (locationData && locationData.kladr_id) {\r\n                        that.geoLocation.resolve(locationData);\r\n                    } else {\r\n                        that.geoLocation.reject();\r\n                    }\r\n                })\r\n                .fail(function(){\r\n                    that.geoLocation.reject();\r\n                });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Public method to get `geoLocation` promise\r\n     * @returns {$.Deferred}\r\n     */\r\n    getGeoLocation: function () {\r\n        return this.geoLocation;\r\n    },\r\n\r\n    constructParams: function () {\r\n        var that = this,\r\n            params = {};\r\n\r\n        if (that.geoLocation && $.isFunction(that.geoLocation.promise) && that.geoLocation.state() == 'resolved') {\r\n            that.geoLocation.done(function (locationData) {\r\n                params['locations_boost'] = $.makeArray(locationData);\r\n            });\r\n        }\r\n\r\n        return params;\r\n    }\r\n\r\n};\r\n\r\n\r\n// Disable this feature when GET method used. See SUG-202\r\nif (utils.getDefaultType() != 'GET') {\r\n    $.extend(DEFAULT_OPTIONS, {\r\n        geoLocation: defaultGeoLocation\r\n    });\r\n\r\n    $.extend(Suggestions, {\r\n        resetLocation: resetLocation\r\n    });\r\n\r\n    $.extend(Suggestions.prototype, {\r\n        getGeoLocation: methods$2.getGeoLocation\r\n    });\r\n\r\n    notificator\r\n        .on('setOptions', methods$2.checkLocation)\r\n        .on('requestParams', methods$2.constructParams);\r\n}\r\n\r\nvar methods$3 = {\r\n\r\n    enrichSuggestion: function (suggestion, selectionOptions) {\r\n        var that = this,\r\n            resolver = $.Deferred();\r\n\r\n        if (!that.status.enrich || !that.type.enrichmentEnabled || !that.requestMode.enrichmentEnabled ||\r\n            selectionOptions && selectionOptions.dontEnrich) {\r\n            return resolver.resolve(suggestion);\r\n        }\r\n\r\n        // if current suggestion is already enriched, use it\r\n        if (suggestion.data && suggestion.data.qc != null) {\r\n            return resolver.resolve(suggestion);\r\n        }\r\n\r\n        that.disableDropdown();\r\n\r\n        // Set `currentValue` to make `processResponse` to consider enrichment response valid\r\n        that.currentValue = suggestion.unrestricted_value ;\r\n\r\n        // prevent request abortion during onBlur\r\n        that.enrichPhase = that.getSuggestions(\r\n            suggestion.unrestricted_value,\r\n            {\r\n                count: 1,\r\n                locations: null,\r\n                locations_boost: null,\r\n                from_bound: null,\r\n                to_bound: null\r\n            },\r\n            {\r\n                noCallbacks: true,\r\n                useEnrichmentCache: true\r\n            }\r\n        )\r\n            .always(function () {\r\n                that.enableDropdown();\r\n            })\r\n            .done(function (suggestions) {\r\n                var enrichedSuggestion = suggestions && suggestions[0];\r\n\r\n                resolver.resolve(enrichedSuggestion || suggestion, !!enrichedSuggestion);\r\n            })\r\n            .fail(function () {\r\n                resolver.resolve(suggestion);\r\n            });\r\n\r\n        return resolver;\r\n    },\r\n\r\n    /**\r\n     * Injects enriched suggestion into response\r\n     * @param response\r\n     * @param query\r\n     */\r\n    enrichResponse: function (response, query) {\r\n        var that = this,\r\n            enrichedSuggestion = that.enrichmentCache[query];\r\n\r\n        if (enrichedSuggestion) {\r\n            $.each(response.suggestions, function(i, suggestion){\r\n                if (suggestion.value === query) {\r\n                    response.suggestions[i] = enrichedSuggestion;\r\n                    return false;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n};\r\n\r\n$.extend(Suggestions.prototype, methods$3);\r\n\r\n/**\r\n * Methods related to suggestions dropdown list\r\n */\r\n\r\nfunction highlightMatches(chunks) {\r\n    return $.map(chunks, function (chunk) {\r\n        var text = utils.escapeHtml(chunk.text);\r\n\r\n        if (text && chunk.matched) {\r\n            text = '<strong>' + text + '</strong>';\r\n        }\r\n        return text;\r\n    }).join('');\r\n}\r\n\r\nfunction nowrapLinkedParts(formattedStr, nowrapClass) {\r\n    var delimitedParts = formattedStr.split(', ');\r\n    // string has no delimiters, should not wrap\r\n    if (delimitedParts.length === 1) {\r\n        return formattedStr;\r\n    }\r\n    // disable word-wrap inside delimited parts\r\n    return $.map(delimitedParts, function (part) {\r\n        return '<span class=\"' + nowrapClass + '\">' + part + '</span>'\r\n    }).join(', ');\r\n}\r\n\r\nfunction hasAnotherSuggestion (suggestions, suggestion) {\r\n    var result = false;\r\n\r\n    $.each(suggestions, function (i, s) {\r\n        result = s.value == suggestion.value && s != suggestion;\r\n        if (result) {\r\n            return false;\r\n        }\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\nvar optionsUsed = {\r\n    width: 'auto',\r\n    floating: false\r\n};\r\n\r\nvar methods$4 = {\r\n\r\n    createContainer: function () {\r\n        var that = this,\r\n            suggestionSelector = '.' + that.classes.suggestion,\r\n            options = that.options,\r\n            $container = $('<div/>')\r\n                .addClass(options.containerClass)\r\n                .css({\r\n                    position: 'absolute',\r\n                    display: 'none'\r\n                });\r\n\r\n        that.$container = $container;\r\n\r\n        $container.on('click' + EVENT_NS, suggestionSelector, $.proxy(that.onSuggestionClick, that));\r\n    },\r\n\r\n    removeContainer: function () {\r\n        var that = this;\r\n\r\n        if (that.options.floating) {\r\n            that.$container.remove();\r\n        }\r\n    },\r\n\r\n    setContainerOptions: function () {\r\n        var that = this,\r\n            mousedownEvent = 'mousedown' + EVENT_NS;\r\n\r\n        that.$container.off(mousedownEvent);\r\n        if (that.options.floating) {\r\n            that.$container.on(mousedownEvent, $.proxy(that.onMousedown, that));\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Listen for click event on suggestions list:\r\n     */\r\n    onSuggestionClick: function (e) {\r\n        var that = this,\r\n            $el = $(e.target),\r\n            index;\r\n\r\n        if (!that.dropdownDisabled) {\r\n            that.cancelFocus = true;\r\n            that.el.focus();\r\n\r\n            while ($el.length && !(index = $el.attr('data-index'))) {\r\n                $el = $el.closest('.' + that.classes.suggestion);\r\n            }\r\n\r\n            if (index && !isNaN(index)) {\r\n                that.select(+index);\r\n            }\r\n        }\r\n    },\r\n\r\n    // Dropdown UI methods\r\n\r\n    setDropdownPosition: function (origin, elLayout) {\r\n        var that = this,\r\n            scrollLeft = that.$viewport.scrollLeft(),\r\n            style;\r\n\r\n        if (that.isMobile) {\r\n            style = that.options.floating ? {\r\n                left: scrollLeft + 'px',\r\n                top: elLayout.top + elLayout.outerHeight + 'px'\r\n            } : {\r\n                left: origin.left - elLayout.left + scrollLeft + 'px',\r\n                top: origin.top + elLayout.outerHeight + 'px'\r\n            };\r\n            style.width = that.$viewport.width() + 'px';\r\n        } else {\r\n            style = that.options.floating ? {\r\n                left: elLayout.left + 'px',\r\n                top: elLayout.top + elLayout.borderTop + elLayout.innerHeight + 'px'\r\n            } : {\r\n                left: origin.left + 'px',\r\n                top: origin.top + elLayout.borderTop + elLayout.innerHeight + 'px'\r\n            };\r\n\r\n            // Defer to let body show scrollbars\r\n            utils.delay(function () {\r\n                var width = that.options.width;\r\n\r\n                if (width === 'auto') {\r\n                    width = that.el.outerWidth();\r\n                }\r\n                that.$container.outerWidth(width);\r\n            });\r\n        }\r\n\r\n        that.$container\r\n            .toggleClass(that.classes.mobile, that.isMobile)\r\n            .css(style);\r\n\r\n        that.containerItemsPadding = elLayout.left + elLayout.borderLeft + elLayout.paddingLeft - scrollLeft;\r\n    },\r\n\r\n    setItemsPositions: function () {\r\n        var that = this,\r\n            $items = that.getSuggestionsItems();\r\n\r\n        $items.css('paddingLeft', that.isMobile ? that.containerItemsPadding + 'px' : '');\r\n    },\r\n\r\n    getSuggestionsItems: function () {\r\n        return this.$container.children('.' + this.classes.suggestion);\r\n    },\r\n\r\n    toggleDropdownEnabling: function (enable) {\r\n        this.dropdownDisabled = !enable;\r\n        this.$container.attr('disabled', !enable);\r\n    },\r\n\r\n    disableDropdown: function () {\r\n        this.toggleDropdownEnabling(false);\r\n    },\r\n\r\n    enableDropdown: function () {\r\n        this.toggleDropdownEnabling(true);\r\n    },\r\n\r\n    /**\r\n     * Shows if there are any suggestions besides currently selected\r\n     * @returns {boolean}\r\n     */\r\n    hasSuggestionsToChoose: function () {\r\n        var that = this;\r\n\r\n        return that.suggestions.length > 1 ||\r\n            (that.suggestions.length === 1 &&\r\n                (!that.selection || $.trim(that.suggestions[0].value) !== $.trim(that.selection.value))\r\n            );\r\n    },\r\n\r\n    suggest: function () {\r\n        var that = this,\r\n            options = that.options,\r\n            formatResult,\r\n            html = [];\r\n\r\n        if (!that.requestMode.userSelect) {\r\n            return ;\r\n        }\r\n\r\n        // если нечего показывать, то сообщаем об этом\r\n        if (!that.hasSuggestionsToChoose()) {\r\n\r\n            if (that.suggestions.length) {\r\n                that.hide();\r\n                return\r\n            } else {\r\n                html.push('<div class=\"' + that.classes.hint + '\">' + options.noSuggestionsHint[options.type] + '</div>');\r\n            }\r\n\r\n        } else {\r\n\r\n            formatResult = options.formatResult || that.type.formatResult || that.formatResult;\r\n\r\n            // Build hint html\r\n            if (!that.isMobile && options.hint && that.suggestions.length) {\r\n                html.push('<div class=\"' + that.classes.hint + '\">' + options.hint + '</div>');\r\n            }\r\n            that.selectedIndex = -1;\r\n            // Build suggestions inner HTML:\r\n            $.each(that.suggestions, function (i, suggestion) {\r\n                var labels = that.makeSuggestionLabel(that.suggestions, suggestion);\r\n\r\n                if (suggestion == that.selection) {\r\n                    that.selectedIndex = i;\r\n                }\r\n\r\n                html.push('<div class=\"' + that.classes.suggestion + '\" data-index=\"' + i + '\">');\r\n                html.push(formatResult.call(that, suggestion.value, that.currentValue, suggestion, {\r\n                    unformattableTokens: that.type.unformattableTokens\r\n                }));\r\n                if (labels) {\r\n                    html.push('<span class=\"' + that.classes.subtext_label + '\">' + utils.escapeHtml(labels) + '</span>');\r\n                }\r\n                html.push('</div>');\r\n            });\r\n\r\n        }\r\n\r\n        that.$container.html(html.join(''));\r\n\r\n        // Select first value by default:\r\n        if (options.autoSelectFirst && that.selectedIndex === -1) {\r\n            that.selectedIndex = 0;\r\n        }\r\n        if (that.selectedIndex !== -1) {\r\n            that.getSuggestionsItems().eq(that.selectedIndex).addClass(that.classes.selected);\r\n        }\r\n\r\n        if ($.isFunction(options.beforeRender)) {\r\n            options.beforeRender.call(that.element, that.$container);\r\n        }\r\n\r\n        that.$container.show();\r\n        that.visible = true;\r\n        that.fixPosition();\r\n        that.setItemsPositions();\r\n    },\r\n\r\n    wrapFormattedValue: function (value, suggestion) {\r\n        var that = this,\r\n            status = utils.getDeepValue(suggestion.data, 'state.status');\r\n\r\n        return '<span class=\"' + that.classes.value + '\"' + (status ? ' data-suggestion-status=\"' + status + '\"' : '') + '>' +\r\n            value +\r\n            '</span>';\r\n    },\r\n\r\n    formatResult: function (value, currentValue, suggestion, options) {\r\n        var that = this;\r\n\r\n        value = that.highlightMatches(value, currentValue, suggestion, options);\r\n\r\n        return that.wrapFormattedValue(value, suggestion);\r\n    },\r\n\r\n    /**\r\n     * Makes HTML contents for suggestion item\r\n     * @param {String} value string to be displayed as a value\r\n     * @param {String} currentValue contents of the textbox\r\n     * @param suggestion whole suggestion object with displaying value and other fields\r\n     * @param {Object} [options] set of flags:\r\n     *          `unformattableTokens` - array of search tokens, that are not to be highlighted\r\n     *          `maxLength` - if set, `value` is limited by this length\r\n     * @returns {String} HTML to be inserted in the list\r\n     */\r\n    highlightMatches: function (value, currentValue, suggestion, options) {\r\n\r\n        var that = this,\r\n            chunks = [],\r\n            unformattableTokens = options && options.unformattableTokens,\r\n            maxLength = options && options.maxLength,\r\n            tokens, tokenMatchers, preferredTokens,\r\n            rWords = utils.reWordExtractor(),\r\n            match, word, i, chunk, formattedStr;\r\n\r\n        if (!value) return '';\r\n\r\n        tokens = utils.getTokens(currentValue, unformattableTokens);\r\n\r\n        tokenMatchers = $.map(tokens, function (token) {\r\n            return new RegExp('^((.*)([' + WORD_PARTS_DELIMITERS + ']+))?' +\r\n                '(' + utils.escapeRegExChars(token) + ')' +\r\n                '([^' + WORD_PARTS_DELIMITERS + ']*[' + WORD_PARTS_DELIMITERS + ']*)', 'i');\r\n        });\r\n\r\n        // parse string by words\r\n        while ((match = rWords.exec(value)) && match[0]) {\r\n            word = match[1];\r\n            chunks.push({\r\n                text: word,\r\n\r\n                // upper case means a word is a name and can be highlighted even if presents in unformattableTokens\r\n                hasUpperCase: word.toLowerCase() !== word,\r\n                formatted: utils.formatToken(word),\r\n                matchable: true\r\n            });\r\n            if (match[2]) {\r\n                chunks.push({\r\n                    text: match[2]\r\n                });\r\n            }\r\n        }\r\n\r\n        // use simple loop because length can change\r\n        for (i = 0; i < chunks.length; i++) {\r\n            chunk = chunks[i];\r\n            if (chunk.matchable && !chunk.matched && ($.inArray(chunk.formatted, unformattableTokens) === -1 || chunk.hasUpperCase)) {\r\n                $.each(tokenMatchers, function (j, matcher) {\r\n                    var tokenMatch = matcher.exec(chunk.formatted),\r\n                        length, nextIndex = i + 1;\r\n\r\n                    if (tokenMatch) {\r\n                        tokenMatch = {\r\n                            before: tokenMatch[1] || '',\r\n                            beforeText: tokenMatch[2] || '',\r\n                            beforeDelimiter: tokenMatch[3] || '',\r\n                            text: tokenMatch[4] || '',\r\n                            after: tokenMatch[5] || ''\r\n                        };\r\n\r\n                        if (tokenMatch.before) {\r\n                            // insert chunk before current\r\n                            chunks.splice(i, 0, {\r\n                                text: chunk.text.substr(0, tokenMatch.beforeText.length),\r\n                                formatted: tokenMatch.beforeText,\r\n                                matchable: true\r\n                            }, {\r\n                                text: tokenMatch.beforeDelimiter\r\n                            });\r\n                            nextIndex += 2;\r\n\r\n                            length = tokenMatch.before.length;\r\n                            chunk.text = chunk.text.substr(length);\r\n                            chunk.formatted = chunk.formatted.substr(length);\r\n                            i--;\r\n                        }\r\n\r\n                        length = tokenMatch.text.length + tokenMatch.after.length;\r\n                        if (chunk.formatted.length > length) {\r\n                            chunks.splice(nextIndex, 0, {\r\n                                text: chunk.text.substr(length),\r\n                                formatted: chunk.formatted.substr(length),\r\n                                matchable: true\r\n                            });\r\n                            chunk.text = chunk.text.substr(0, length);\r\n                            chunk.formatted = chunk.formatted.substr(0, length);\r\n                        }\r\n\r\n                        if (tokenMatch.after) {\r\n                            length = tokenMatch.text.length;\r\n                            chunks.splice(nextIndex, 0, {\r\n                                text: chunk.text.substr(length),\r\n                                formatted: chunk.formatted.substr(length)\r\n                            });\r\n                            chunk.text = chunk.text.substr(0, length);\r\n                            chunk.formatted = chunk.formatted.substr(0, length);\r\n                        }\r\n                        chunk.matched = true;\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if (maxLength) {\r\n            for (i = 0; i < chunks.length && maxLength >= 0; i++) {\r\n                chunk = chunks[i];\r\n                maxLength -= chunk.text.length;\r\n                if (maxLength < 0) {\r\n                    chunk.text = chunk.text.substr(0, chunk.text.length + maxLength) + '...';\r\n                }\r\n            }\r\n            chunks.length = i;\r\n        }\r\n\r\n        formattedStr = highlightMatches(chunks);\r\n        return nowrapLinkedParts(formattedStr, that.classes.nowrap);\r\n    },\r\n\r\n    makeSuggestionLabel: function (suggestions, suggestion) {\r\n        var that = this,\r\n            fieldNames = that.type.fieldNames,\r\n            nameData = {},\r\n            rWords = utils.reWordExtractor(),\r\n            match, word,\r\n            labels = [];\r\n\r\n        if (fieldNames && hasAnotherSuggestion(suggestions, suggestion) && suggestion.data) {\r\n\r\n            $.each(fieldNames, function (field) {\r\n                var value = suggestion.data[field];\r\n                if (value) {\r\n                    nameData[field] = utils.formatToken(value);\r\n                }\r\n            });\r\n\r\n            if (!$.isEmptyObject(nameData)) {\r\n                while ((match = rWords.exec(utils.formatToken(suggestion.value))) && (word = match[1])) {\r\n                    $.each(nameData, function (i, value) {\r\n                        if (value == word) {\r\n                            labels.push(fieldNames[i]);\r\n                            delete nameData[i];\r\n                            return false;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (labels.length) {\r\n                    return labels.join(', ');\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    hide: function () {\r\n        var that = this;\r\n        that.visible = false;\r\n        that.selectedIndex = -1;\r\n        that.$container\r\n            .hide()\r\n            .empty();\r\n    },\r\n\r\n    activate: function (index) {\r\n        var that = this,\r\n            $activeItem,\r\n            selected = that.classes.selected,\r\n            $children;\r\n\r\n        if (!that.dropdownDisabled) {\r\n            $children = that.getSuggestionsItems();\r\n\r\n            $children.removeClass(selected);\r\n\r\n            that.selectedIndex = index;\r\n\r\n            if (that.selectedIndex !== -1 && $children.length > that.selectedIndex) {\r\n                $activeItem = $children.eq(that.selectedIndex);\r\n                $activeItem.addClass(selected);\r\n                return $activeItem;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    deactivate: function (restoreValue) {\r\n        var that = this;\r\n\r\n        if (!that.dropdownDisabled) {\r\n            that.selectedIndex = -1;\r\n            that.getSuggestionsItems().removeClass(that.classes.selected);\r\n            if (restoreValue) {\r\n                that.el.val(that.currentValue);\r\n            }\r\n        }\r\n    },\r\n\r\n    moveUp: function () {\r\n        var that = this;\r\n\r\n        if (that.dropdownDisabled) {\r\n            return;\r\n        }\r\n        if (that.selectedIndex === -1) {\r\n            if (that.suggestions.length) {\r\n                that.adjustScroll(that.suggestions.length - 1);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (that.selectedIndex === 0) {\r\n            that.deactivate(true);\r\n            return;\r\n        }\r\n\r\n        that.adjustScroll(that.selectedIndex - 1);\r\n    },\r\n\r\n    moveDown: function () {\r\n        var that = this;\r\n\r\n        if (that.dropdownDisabled) {\r\n            return;\r\n        }\r\n        if (that.selectedIndex === (that.suggestions.length - 1)) {\r\n            that.deactivate(true);\r\n            return;\r\n        }\r\n\r\n        that.adjustScroll(that.selectedIndex + 1);\r\n    },\r\n\r\n    adjustScroll: function (index) {\r\n        var that = this,\r\n            $activeItem = that.activate(index),\r\n            itemTop,\r\n            itemBottom,\r\n            scrollTop = that.$container.scrollTop(),\r\n            containerHeight;\r\n\r\n        if (!$activeItem || !$activeItem.length) {\r\n            return;\r\n        }\r\n\r\n        itemTop = $activeItem.position().top;\r\n        if (itemTop < 0 ) {\r\n            that.$container.scrollTop(scrollTop + itemTop);\r\n        } else {\r\n            itemBottom = itemTop + $activeItem.outerHeight();\r\n            containerHeight = that.$container.innerHeight();\r\n            if (itemBottom > containerHeight) {\r\n                that.$container.scrollTop(scrollTop - containerHeight + itemBottom);\r\n            }\r\n        }\r\n\r\n        that.el.val(that.suggestions[index].value);\r\n    }\r\n\r\n};\r\n\r\n$.extend(DEFAULT_OPTIONS, optionsUsed);\r\n\r\n$.extend(Suggestions.prototype, methods$4);\r\n\r\nnotificator\r\n    .on('initialize', methods$4.createContainer)\r\n    .on('dispose', methods$4.removeContainer)\r\n    .on('setOptions', methods$4.setContainerOptions)\r\n    .on('fixPosition', methods$4.setDropdownPosition)\r\n    .on('fixPosition', methods$4.setItemsPositions)\r\n    .on('assignSuggestions', methods$4.suggest);\r\n\r\n/**\r\n * Methods related to right-sided component\r\n */\r\n\r\nvar QUEUE_NAME = 'addon';\r\nvar BEFORE_SHOW_ADDON = 50;\r\nvar BEFORE_RESTORE_PADDING = 1000;\r\n\r\nvar optionsUsed$1 = {\r\n    addon: null\r\n};\r\n\r\nvar ADDON_TYPES = {\r\n    'NONE': 'none',\r\n    'SPINNER': 'spinner',\r\n    'CLEAR': 'clear'\r\n};\r\n\r\nvar Addon = function (owner) {\r\n    var that = this,\r\n        $el = $('<span class=\"suggestions-addon\"/>');\r\n\r\n    that.owner = owner;\r\n    that.$el = $el;\r\n    that.type = ADDON_TYPES.NONE;\r\n    that.visible = false;\r\n    that.initialPadding = null;\r\n\r\n    $el.on('click', $.proxy(that, 'onClick'));\r\n};\r\n\r\nAddon.prototype = {\r\n\r\n    checkType: function () {\r\n        var that = this,\r\n            type = that.owner.options.addon,\r\n            isTypeCorrect = false;\r\n\r\n        $.each(ADDON_TYPES, function (key, value) {\r\n            isTypeCorrect = value == type;\r\n            if (isTypeCorrect) {\r\n                return false;\r\n            }\r\n        });\r\n\r\n        if (!isTypeCorrect) {\r\n            type = that.owner.isMobile ? ADDON_TYPES.CLEAR : ADDON_TYPES.SPINNER;\r\n        }\r\n\r\n        if (type != that.type) {\r\n            that.type = type;\r\n            that.$el.attr('data-addon-type', type);\r\n            that.toggle(true);\r\n        }\r\n    },\r\n\r\n    toggle: function (immediate) {\r\n        var that = this,\r\n            visible;\r\n\r\n        switch (that.type) {\r\n            case ADDON_TYPES.CLEAR:\r\n                visible = !!that.owner.currentValue;\r\n                break;\r\n            case ADDON_TYPES.SPINNER:\r\n                visible = !!that.owner.currentRequest;\r\n                break;\r\n            default:\r\n                visible = false;\r\n        }\r\n\r\n        if (visible != that.visible) {\r\n            that.visible = visible;\r\n            if (visible) {\r\n                that.show(immediate);\r\n            } else {\r\n                that.hide(immediate);\r\n            }\r\n        }\r\n    },\r\n\r\n    show: function (immediate) {\r\n        var that = this,\r\n            style = {'opacity': 1};\r\n\r\n        if (immediate) {\r\n            that.$el\r\n                .show()\r\n                .css(style);\r\n            that.showBackground(true);\r\n        } else {\r\n            that.$el\r\n                .stop(true, true)\r\n                .delay(BEFORE_SHOW_ADDON)\r\n                .queue(function () {\r\n                    that.$el.show();\r\n                    that.showBackground();\r\n                    that.$el.dequeue();\r\n                })\r\n                .animate(style, 'fast');\r\n        }\r\n    },\r\n\r\n    hide: function (immediate) {\r\n        var that = this,\r\n            style = {'opacity': 0};\r\n\r\n        if (immediate) {\r\n            that.$el\r\n                .hide()\r\n                .css(style);\r\n        }\r\n        that.$el\r\n            .stop(true)\r\n            .animate(style, {\r\n                duration: 'fast',\r\n                complete: function () {\r\n                    that.$el.hide();\r\n                    that.hideBackground();\r\n                }\r\n            });\r\n    },\r\n\r\n    fixPosition: function(origin, elLayout){\r\n        var that = this,\r\n            addonSize = elLayout.innerHeight;\r\n\r\n        that.checkType();\r\n        that.$el.css({\r\n            left: origin.left + elLayout.borderLeft + elLayout.innerWidth - addonSize + 'px',\r\n            top: origin.top + elLayout.borderTop + 'px',\r\n            height: addonSize,\r\n            width: addonSize\r\n        });\r\n\r\n        that.initialPadding = elLayout.paddingRight;\r\n        that.width = addonSize;\r\n        if (that.visible) {\r\n            elLayout.componentsRight += addonSize;\r\n        }\r\n    },\r\n\r\n    showBackground: function (immediate) {\r\n        var that = this,\r\n            $el = that.owner.el,\r\n            style = {'paddingRight': that.width};\r\n\r\n        if (that.width > that.initialPadding) {\r\n            that.stopBackground();\r\n            if (immediate) {\r\n                $el.css(style);\r\n            } else {\r\n                $el\r\n                    .animate(style, { duration: 'fast', queue: QUEUE_NAME })\r\n                    .dequeue(QUEUE_NAME);\r\n            }\r\n        }\r\n    },\r\n\r\n    hideBackground: function (immediate) {\r\n        var that = this,\r\n            $el = that.owner.el,\r\n            style = {'paddingRight': that.initialPadding};\r\n\r\n        if (that.width > that.initialPadding) {\r\n            that.stopBackground(true);\r\n            if (immediate) {\r\n                $el.css(style);\r\n            } else {\r\n                $el\r\n                    .delay(BEFORE_RESTORE_PADDING, QUEUE_NAME)\r\n                    .animate(style, { duration: 'fast', queue: QUEUE_NAME })\r\n                    .dequeue(QUEUE_NAME);\r\n            }\r\n        }\r\n    },\r\n\r\n    stopBackground: function (gotoEnd) {\r\n        this.owner.el.stop(QUEUE_NAME, true, gotoEnd);\r\n    },\r\n\r\n    onClick: function (e) {\r\n        var that = this;\r\n\r\n        if (that.type == ADDON_TYPES.CLEAR) {\r\n            that.owner.clear();\r\n        }\r\n    }\r\n\r\n};\r\n\r\nvar methods$5 = {\r\n\r\n    createAddon: function () {\r\n        var that = this,\r\n            addon = new Addon(that);\r\n\r\n        that.$wrapper.append(addon.$el);\r\n        that.addon = addon;\r\n    },\r\n\r\n    fixAddonPosition: function (origin, elLayout) {\r\n        this.addon.fixPosition(origin, elLayout);\r\n    },\r\n\r\n    checkAddonType: function () {\r\n        this.addon.checkType();\r\n    },\r\n\r\n    checkAddonVisibility: function () {\r\n        this.addon.toggle();\r\n    },\r\n\r\n    stopBackground: function () {\r\n        this.addon.stopBackground();\r\n    }\r\n\r\n};\r\n\r\n$.extend(DEFAULT_OPTIONS, optionsUsed$1);\r\n\r\nnotificator\r\n    .on('initialize', methods$5.createAddon)\r\n    .on('setOptions', methods$5.checkAddonType)\r\n    .on('fixPosition', methods$5.fixAddonPosition)\r\n    .on('clear', methods$5.checkAddonVisibility)\r\n    .on('valueChange', methods$5.checkAddonVisibility)\r\n    .on('request', methods$5.checkAddonVisibility)\r\n    .on('resetPosition', methods$5.stopBackground);\r\n\r\n/**\r\n * Methods related to CONSTRAINTS component\r\n */\r\nvar optionsUsed$2 = {\r\n    constraints: null,\r\n    restrict_value: false\r\n};\r\n\r\nvar fiasParamNames = [\r\n  'region_fias_id',\r\n  'area_fias_id',\r\n  'city_fias_id',\r\n  'city_district_fias_id',\r\n  'settlement_fias_id',\r\n  'street_fias_id'\r\n];\r\n\r\n/**\r\n * Compares two suggestion objects\r\n * @param suggestion\r\n * @param instance other Suggestions instance\r\n */\r\nfunction belongsToArea(suggestion, instance){\r\n    var parentSuggestion = instance.selection,\r\n        result = parentSuggestion && parentSuggestion.data && instance.bounds;\r\n\r\n    if (result) {\r\n        $.each(instance.bounds.all, function (i, bound) {\r\n            return (result = parentSuggestion.data[bound] === suggestion.data[bound]);\r\n        });\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * @param {Object} data  fields\r\n * @param {Suggestions} instance\r\n * @constructor\r\n */\r\nvar ConstraintLocation = function(data, instance){\r\n    var that = this,\r\n        fieldNames,\r\n        fiasFieldNames,\r\n        fiasFields = {};\r\n\r\n    that.instance = instance;\r\n    that.fields = {};\r\n    that.specificity = -1;\r\n\r\n    if ($.isPlainObject(data) && instance.type.dataComponents) {\r\n        $.each(instance.type.dataComponents, function (i, component) {\r\n            var fieldName = component.id;\r\n\r\n            if (component.forLocations && data[fieldName]) {\r\n                that.fields[fieldName] = data[fieldName];\r\n                that.specificity = i;\r\n            }\r\n        });\r\n    }\r\n\r\n    fieldNames = utils.objectKeys(that.fields);\r\n    fiasFieldNames = utils.arraysIntersection(fieldNames, fiasParamNames);\r\n    if (fiasFieldNames.length) {\r\n        $.each(fiasFieldNames, function(index, fieldName) {\r\n            fiasFields[fieldName] = that.fields[fieldName];\r\n        });\r\n        that.fields = fiasFields;\r\n        that.specificity = that.getFiasSpecificity(fiasFieldNames);\r\n    } else if (that.fields.kladr_id) {\r\n        that.fields = { kladr_id: that.fields.kladr_id };\r\n        that.specificity = that.getKladrSpecificity(that.fields.kladr_id);\r\n    }\r\n};\r\n\r\n$.extend(ConstraintLocation.prototype, {\r\n    getLabel: function(){\r\n        return this.instance.type.composeValue(this.fields, { saveCityDistrict: true });\r\n    },\r\n\r\n    getFields: function () {\r\n        return this.fields;\r\n    },\r\n\r\n    isValid: function(){\r\n        return !$.isEmptyObject(this.fields);\r\n    },\r\n\r\n    /**\r\n     * Возвращает specificity для КЛАДР\r\n     * Описание ниже, в getFiasSpecificity\r\n     * @param kladr_id\r\n     * @returns {number}\r\n     */\r\n    getKladrSpecificity: function (kladr_id) {\r\n        var specificity = -1,\r\n            significantLength;\r\n\r\n        this.significantKladr = kladr_id.replace(/^(\\d{2})(\\d*?)(0+)$/g, '$1$2');\r\n        significantLength = this.significantKladr.length;\r\n\r\n        $.each(this.instance.type.dataComponents, function (i, component) {\r\n            if (component.kladrFormat && significantLength === component.kladrFormat.digits) {\r\n                specificity = i;\r\n            }\r\n        });\r\n\r\n        return specificity;\r\n    },\r\n\r\n    /**\r\n     * Возвращает особую величину specificity для ФИАС\r\n     * Specificity это индекс для массива this.instance.type.dataComponents\r\n     * до которого (включительно) обрежется этот массив при формировании строки адреса.\r\n     * Этот параметр нужен для случаев, когда в настройках плагина restrict_value = true\r\n     * Например, установлено ограничение (locations) по region_fias_id (Краснодарский край)\r\n     * В выпадашке нажимаем на \"г. Сочи\"\r\n     * Если restrict_value отключен, то выведется значение \"Краснодарский край, г Сочи\"\r\n     * Если включен, то просто \"г Сочи\"\r\n     *\r\n     * @param fiasFieldNames\r\n     * @returns {number}\r\n     */\r\n    getFiasSpecificity: function (fiasFieldNames) {\r\n        var specificity = -1;\r\n\r\n        $.each(this.instance.type.dataComponents, function (i, component) {\r\n            if (component.fiasType && ($.inArray(component.fiasType, fiasFieldNames) > -1) && specificity < i) {\r\n                specificity = i;\r\n            }\r\n        });\r\n\r\n        return specificity;\r\n    },\r\n\r\n    containsData: function (data){\r\n        var result = true;\r\n\r\n        if (this.fields.kladr_id) {\r\n            return !!data.kladr_id && data.kladr_id.indexOf(this.significantKladr) === 0;\r\n        } else {\r\n            $.each(this.fields, function(fieldName, value){\r\n                return result = !!data[fieldName] && data[fieldName].toLowerCase() === value.toLowerCase();\r\n            });\r\n\r\n            return result;\r\n        }\r\n    }\r\n});\r\n\r\nSuggestions.ConstraintLocation = ConstraintLocation;\r\n\r\n/**\r\n * @param {Object} data\r\n * @param {Object|Array} data.locations\r\n * @param {string} [data.label]\r\n * @param {boolean} [data.deletable]\r\n * @param {Suggestions} [instance]\r\n * @constructor\r\n */\r\nvar Constraint = function(data, instance) {\r\n    this.id = utils.uniqueId('c');\r\n    this.deletable = !!data.deletable;\r\n    this.instance = instance;\r\n\r\n    this.locations = $.map($.makeArray(data && (data.locations || data.restrictions)), function (data) {\r\n        return new ConstraintLocation(data, instance);\r\n    });\r\n\r\n    this.locations = $.grep(this.locations, function(location) {\r\n        return location.isValid();\r\n    });\r\n\r\n    this.label = data.label;\r\n    if (this.label == null && instance.type.composeValue) {\r\n        this.label = $.map(this.locations, function (location) {\r\n            return location.getLabel();\r\n        }).join(', ');\r\n    }\r\n\r\n    if (this.label && this.isValid()) {\r\n        this.$el = $(document.createElement('li'))\r\n            .append($(document.createElement('span')).text(this.label))\r\n            .attr('data-constraint-id', this.id);\r\n\r\n        if (this.deletable) {\r\n            this.$el.append(\r\n                $(document.createElement('span'))\r\n                    .addClass(instance.classes.removeConstraint)\r\n            );\r\n        }\r\n    }\r\n};\r\n\r\n$.extend(Constraint.prototype, {\r\n    isValid: function () {\r\n        return this.locations.length > 0;\r\n    },\r\n    getFields: function(){\r\n        return $.map(this.locations, function(location){\r\n            return location.getFields();\r\n        });\r\n    }\r\n});\r\n\r\nvar methods$6 = {\r\n\r\n    createConstraints: function () {\r\n        var that = this;\r\n\r\n        that.constraints = {};\r\n\r\n        that.$constraints = $('<ul class=\"suggestions-constraints\"/>');\r\n        that.$wrapper.append(that.$constraints);\r\n        that.$constraints.on('click', '.' + that.classes.removeConstraint, $.proxy(that.onConstraintRemoveClick, that));\r\n    },\r\n\r\n    setConstraintsPosition: function(origin, elLayout){\r\n        var that = this;\r\n\r\n        that.$constraints.css({\r\n            left: origin.left + elLayout.borderLeft + elLayout.paddingLeft + 'px',\r\n            top: origin.top + elLayout.borderTop + Math.round((elLayout.innerHeight - that.$constraints.height()) / 2) + 'px'\r\n        });\r\n\r\n        elLayout.componentsLeft += that.$constraints.outerWidth(true) + elLayout.paddingLeft;\r\n    },\r\n\r\n    onConstraintRemoveClick: function (e) {\r\n        var that = this,\r\n            $item = $(e.target).closest('li'),\r\n            id = $item.attr('data-constraint-id');\r\n\r\n        // Delete constraint data before animation to let correct requests to be sent while fading\r\n        delete that.constraints[id];\r\n        // Request for new suggestions\r\n        that.update();\r\n\r\n        $item.fadeOut('fast', function () {\r\n            that.removeConstraint(id);\r\n        });\r\n    },\r\n\r\n    setupConstraints: function () {\r\n        var that = this,\r\n            constraints = that.options.constraints,\r\n            $parent;\r\n\r\n        if (!constraints) {\r\n            that.unbindFromParent();\r\n            return;\r\n        }\r\n\r\n        if (constraints instanceof $ || typeof constraints === 'string' || typeof constraints.nodeType === 'number') {\r\n            $parent = $(constraints);\r\n            if (!$parent.is(that.constraints)) {\r\n                that.unbindFromParent();\r\n                if (!$parent.is(that.el)) {\r\n                    that.constraints = $parent;\r\n                    that.bindToParent();\r\n                }\r\n            }\r\n        } else {\r\n            that._constraintsUpdating = true;\r\n            $.each(that.constraints, $.proxy(that.removeConstraint, that));\r\n            $.each($.makeArray(constraints), function (i, constraint) {\r\n                that.addConstraint(constraint);\r\n            });\r\n            that._constraintsUpdating = false;\r\n            that.fixPosition();\r\n        }\r\n    },\r\n\r\n    filteredLocation: function (data) {\r\n        var locationComponents = [],\r\n            location = {};\r\n\r\n        $.each(this.type.dataComponents, function () {\r\n            if (this.forLocations) locationComponents.push(this.id);\r\n        });\r\n\r\n        if ($.isPlainObject(data)) {\r\n            // Copy to location only allowed fields\r\n            $.each(data, function (key, value) {\r\n                if (value && locationComponents.indexOf(key) >= 0) {\r\n                    location[key] = value;\r\n                }\r\n            });\r\n        }\r\n\r\n        if (!$.isEmptyObject(location)) {\r\n            return location.kladr_id ? { kladr_id: location.kladr_id } : location;\r\n        }\r\n    },\r\n\r\n    addConstraint: function (constraint) {\r\n        var that = this;\r\n\r\n        constraint = new Constraint(constraint, that);\r\n\r\n        if (constraint.isValid()) {\r\n            that.constraints[constraint.id] = constraint;\r\n\r\n            if (constraint.$el) {\r\n                that.$constraints.append(constraint.$el);\r\n                if (!that._constraintsUpdating) {\r\n                    that.fixPosition();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    removeConstraint: function (id) {\r\n        var that = this;\r\n        delete that.constraints[id];\r\n        that.$constraints.children('[data-constraint-id=\"' + id + '\"]').remove();\r\n        if (!that._constraintsUpdating) {\r\n            that.fixPosition();\r\n        }\r\n    },\r\n\r\n    constructConstraintsParams: function () {\r\n        var that = this,\r\n            locations = [],\r\n            constraints = that.constraints,\r\n            parentInstance,\r\n            parentData,\r\n            params = {};\r\n\r\n        while (constraints instanceof $ && (parentInstance = constraints.suggestions()) &&\r\n            !(parentData = utils.getDeepValue(parentInstance, 'selection.data'))\r\n        ) {\r\n            constraints = parentInstance.constraints;\r\n        }\r\n\r\n        if (constraints instanceof $) {\r\n            parentData = (new ConstraintLocation(parentData, parentInstance))\r\n                .getFields();\r\n\r\n            if (parentData) {\r\n                params.locations = [ parentData ];\r\n                params.restrict_value = true;\r\n            }\r\n        } else {\r\n            if (constraints) {\r\n                $.each(constraints, function (id, constraint) {\r\n                    locations = locations.concat(constraint.getFields());\r\n                });\r\n\r\n                if (locations.length) {\r\n                    params.locations = locations;\r\n                    params.restrict_value = that.options.restrict_value;\r\n                }\r\n            }\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * Returns label of the first constraint (if any), empty string otherwise\r\n     * @returns {String}\r\n     */\r\n    getFirstConstraintLabel: function() {\r\n        var that = this,\r\n            constraints_id = $.isPlainObject(that.constraints) && Object.keys(that.constraints)[0];\r\n\r\n        return constraints_id ? that.constraints[constraints_id].label : '';\r\n    },\r\n\r\n    bindToParent: function () {\r\n        var that = this;\r\n\r\n        that.constraints\r\n            .on([\r\n                    'suggestions-select.' + that.uniqueId,\r\n                    'suggestions-invalidateselection.' + that.uniqueId,\r\n                    'suggestions-clear.' + that.uniqueId\r\n                ].join(' '),\r\n                $.proxy(that.onParentSelectionChanged, that)\r\n            )\r\n            .on('suggestions-dispose.' + that.uniqueId, $.proxy(that.onParentDispose, that));\r\n    },\r\n\r\n    unbindFromParent: function  () {\r\n        var that = this,\r\n            $parent = that.constraints;\r\n\r\n        if ($parent instanceof $) {\r\n            $parent.off('.' + that.uniqueId);\r\n        }\r\n    },\r\n\r\n    onParentSelectionChanged: function (e, suggestion, valueChanged) {\r\n        // Don't clear if parent has been just enriched\r\n        if (e.type !== 'suggestions-select' || valueChanged) {\r\n            this.clear();\r\n        }\r\n    },\r\n\r\n    onParentDispose: function (e) {\r\n        this.unbindFromParent();\r\n    },\r\n\r\n    getParentInstance: function () {\r\n        return this.constraints instanceof $ && this.constraints.suggestions();\r\n    },\r\n\r\n    shareWithParent: function (suggestion) {\r\n        // that is the parent control's instance\r\n        var that = this.getParentInstance();\r\n\r\n        if (!that || that.type !== this.type || belongsToArea(suggestion, that)) {\r\n            return;\r\n        }\r\n\r\n        that.shareWithParent(suggestion);\r\n        that.setSuggestion(suggestion);\r\n    },\r\n\r\n    /**\r\n     * Pick only fields that absent in restriction\r\n     */\r\n    getUnrestrictedData: function (data) {\r\n        var that = this,\r\n            restrictedKeys = [],\r\n            unrestrictedData = {},\r\n            maxSpecificity = -1;\r\n\r\n        // Find most specific location that could restrict current data\r\n        $.each(that.constraints, function (id, constraint) {\r\n            $.each(constraint.locations, function (i, location) {\r\n                if (location.containsData(data) && location.specificity > maxSpecificity) {\r\n                    maxSpecificity = location.specificity;\r\n                }\r\n            });\r\n        });\r\n\r\n        if (maxSpecificity >= 0) {\r\n\r\n            // Для городов-регионов нужно также отсечь и город\r\n            if (data.region_kladr_id && data.region_kladr_id === data.city_kladr_id) {\r\n                restrictedKeys.push.apply(restrictedKeys, that.type.dataComponentsById['city'].fields);\r\n            }\r\n\r\n            // Collect all fieldnames from all restricted components\r\n            $.each(that.type.dataComponents.slice(0, maxSpecificity + 1), function (i, component) {\r\n                restrictedKeys.push.apply(restrictedKeys, component.fields);\r\n            });\r\n\r\n            // Copy skipping restricted fields\r\n            $.each(data, function (key, value) {\r\n                if (restrictedKeys.indexOf(key) === -1) {\r\n                    unrestrictedData[key] = value;\r\n                }\r\n            });\r\n        } else {\r\n            unrestrictedData = data;\r\n        }\r\n\r\n        return unrestrictedData;\r\n    }\r\n\r\n};\r\n\r\n$.extend(DEFAULT_OPTIONS, optionsUsed$2);\r\n\r\n$.extend(Suggestions.prototype, methods$6);\r\n\r\n// Disable this feature when GET method used. See SUG-202\r\nif (utils.getDefaultType() != 'GET') {\r\n    notificator\r\n        .on('initialize', methods$6.createConstraints)\r\n        .on('setOptions', methods$6.setupConstraints)\r\n        .on('fixPosition', methods$6.setConstraintsPosition)\r\n        .on('requestParams', methods$6.constructConstraintsParams)\r\n        .on('dispose', methods$6.unbindFromParent);\r\n}\r\n\r\n/**\r\n * Methods for selecting a suggestion\r\n */\r\n\r\nvar methods$7 = {\r\n\r\n    proceedQuery: function (query) {\r\n        var that = this;\r\n\r\n        if (query.length >= that.options.minChars) {\r\n            that.updateSuggestions(query);\r\n        } else {\r\n            that.hide();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Selects current or first matched suggestion, but firstly waits for data ready\r\n     * @param selectionOptions\r\n     * @returns {$.Deferred} promise, resolved with index of selected suggestion or rejected if nothing matched\r\n     */\r\n    selectCurrentValue: function (selectionOptions) {\r\n        var that = this,\r\n            result = $.Deferred();\r\n\r\n        // force onValueChange to be executed if it has been deferred\r\n        that.inputPhase.resolve();\r\n\r\n        that.fetchPhase\r\n            .done(function () {\r\n                var index;\r\n\r\n                // When suggestion has already been selected and not modified\r\n                if (that.selection && !that.visible) {\r\n                    result.reject();\r\n                } else {\r\n                    index = that.findSuggestionIndex();\r\n\r\n                    that.select(index, selectionOptions);\r\n\r\n                    if (index === -1) {\r\n                        result.reject();\r\n                    } else {\r\n                        result.resolve(index);\r\n                    }\r\n                }\r\n            })\r\n            .fail(function () {\r\n                result.reject();\r\n            });\r\n\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * Selects first when user interaction is not supposed\r\n     */\r\n    selectFoundSuggestion: function () {\r\n        var that = this;\r\n\r\n        if (!that.requestMode.userSelect) {\r\n            that.select(0);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Selects current or first matched suggestion\r\n     * @returns {number} index of found suggestion\r\n     */\r\n    findSuggestionIndex: function() {\r\n        var that = this,\r\n            index = that.selectedIndex,\r\n            value;\r\n\r\n        if (index === -1) {\r\n            // matchers always operate with trimmed strings\r\n            value = $.trim(that.el.val());\r\n            if (value) {\r\n                $.each(that.type.matchers, function (i, matcher) {\r\n                    index = matcher(value, that.suggestions);\r\n                    return index === -1;\r\n                });\r\n            }\r\n        }\r\n\r\n        return index;\r\n    },\r\n\r\n    /**\r\n     * Selects a suggestion at specified index\r\n     * @param index index of suggestion to select. Can be -1\r\n     * @param {Object} selectionOptions\r\n     * @param {boolean} [selectionOptions.continueSelecting]  prevents hiding after selection\r\n     * @param {boolean} [selectionOptions.noSpace]  prevents adding space at the end of current value\r\n     */\r\n    select: function (index, selectionOptions) {\r\n        var that = this,\r\n            suggestion = that.suggestions[index],\r\n            continueSelecting = selectionOptions && selectionOptions.continueSelecting,\r\n            currentValue = that.currentValue,\r\n            hasSameValues;\r\n\r\n        // Prevent recursive execution\r\n        if (that.triggering['Select'])\r\n            return;\r\n\r\n        // if no suggestion to select\r\n        if (!suggestion) {\r\n            if (!continueSelecting && !that.selection) {\r\n                that.triggerOnSelectNothing();\r\n            }\r\n            that.onSelectComplete(continueSelecting);\r\n            return;\r\n        }\r\n\r\n        hasSameValues = that.hasSameValues(suggestion);\r\n\r\n        that.enrichSuggestion(suggestion, selectionOptions)\r\n            .done(function (enrichedSuggestion, hasBeenEnriched) {\r\n                that.selectSuggestion(enrichedSuggestion, index, currentValue, $.extend({\r\n                    hasBeenEnriched: hasBeenEnriched,\r\n                    hasSameValues: hasSameValues\r\n                }, selectionOptions));\r\n            });\r\n\r\n    },\r\n\r\n    /**\r\n     * Formats and selects final (enriched) suggestion\r\n     * @param suggestion\r\n     * @param index\r\n     * @param lastValue\r\n     * @param {Object} selectionOptions\r\n     * @param {boolean} [selectionOptions.continueSelecting]  prevents hiding after selection\r\n     * @param {boolean} [selectionOptions.noSpace]  prevents adding space at the end of current value\r\n     * @param {boolean} selectionOptions.hasBeenEnriched\r\n     * @param {boolean} selectionOptions.hasSameValues\r\n     */\r\n    selectSuggestion: function (suggestion, index, lastValue, selectionOptions) {\r\n        var that = this,\r\n            continueSelecting = selectionOptions.continueSelecting,\r\n            assumeDataComplete = !that.type.isDataComplete || that.type.isDataComplete.call(that, suggestion),\r\n            currentSelection = that.selection;\r\n\r\n        // Prevent recursive execution\r\n        if (that.triggering['Select'])\r\n            return;\r\n\r\n        if (that.type.alwaysContinueSelecting) {\r\n            continueSelecting = true;\r\n        }\r\n\r\n        if (assumeDataComplete) {\r\n            continueSelecting = false;\r\n        }\r\n\r\n        // `suggestions` cat be empty, e.g. during `fixData`\r\n        if (selectionOptions.hasBeenEnriched && that.suggestions[index]) {\r\n            that.suggestions[index].data = suggestion.data;\r\n        }\r\n\r\n        if (that.requestMode.updateValue) {\r\n            that.checkValueBounds(suggestion);\r\n            that.currentValue = that.getSuggestionValue(suggestion, selectionOptions);\r\n\r\n            if (that.currentValue && !selectionOptions.noSpace && !assumeDataComplete) {\r\n                that.currentValue += ' ';\r\n            }\r\n            that.el.val(that.currentValue);\r\n        }\r\n\r\n        if (that.currentValue) {\r\n            that.selection = suggestion;\r\n            if (!that.areSuggestionsSame(suggestion, currentSelection)) {\r\n                that.trigger('Select', suggestion, that.currentValue != lastValue);\r\n            }\r\n            if (that.requestMode.userSelect) {\r\n                that.onSelectComplete(continueSelecting);\r\n            }\r\n        } else {\r\n            that.selection = null;\r\n            that.triggerOnSelectNothing();\r\n        }\r\n\r\n        that.shareWithParent(suggestion);\r\n    },\r\n\r\n    onSelectComplete: function (continueSelecting) {\r\n        var that = this;\r\n\r\n        if (continueSelecting) {\r\n            that.selectedIndex = -1;\r\n            that.updateSuggestions(that.currentValue);\r\n        } else {\r\n            that.hide();\r\n        }\r\n    },\r\n\r\n    triggerOnSelectNothing: function () {\r\n        var that = this;\r\n\r\n        if (!that.triggering['SelectNothing']) {\r\n            that.trigger('SelectNothing', that.currentValue);\r\n        }\r\n    },\r\n\r\n    trigger: function (event) {\r\n        var that = this,\r\n            args = utils.slice(arguments, 1),\r\n            callback = that.options['on' + event];\r\n\r\n        that.triggering[event] = true;\r\n        if ($.isFunction(callback)) {\r\n            callback.apply(that.element, args);\r\n        }\r\n        that.el.trigger.call(that.el, 'suggestions-' + event.toLowerCase(), args);\r\n        that.triggering[event] = false;\r\n    }\r\n\r\n};\r\n\r\n$.extend(Suggestions.prototype, methods$7);\r\n\r\nnotificator\r\n    .on('assignSuggestions', methods$7.selectFoundSuggestion);\r\n\r\n/**\r\n * features for connected instances\r\n */\r\n\r\nvar optionsUsed$3 = {\r\n    bounds: null\r\n};\r\n\r\nvar methods$8 = {\r\n\r\n    setupBounds: function () {\r\n        this.bounds = {\r\n            from: null,\r\n            to: null\r\n        };\r\n    },\r\n\r\n    setBoundsOptions: function () {\r\n        var that = this,\r\n            boundsAvailable = [],\r\n            newBounds = $.trim(that.options.bounds).split('-'),\r\n            boundFrom = newBounds[0],\r\n            boundTo = newBounds[newBounds.length - 1],\r\n            boundsOwn = [],\r\n            boundIsOwn,\r\n            boundsAll = [],\r\n            indexTo;\r\n\r\n        if (that.type.dataComponents) {\r\n            $.each(that.type.dataComponents, function () {\r\n                if (this.forBounds) {\r\n                    boundsAvailable.push(this.id);\r\n                }\r\n            });\r\n        }\r\n\r\n        if ($.inArray(boundFrom, boundsAvailable) === -1) {\r\n            boundFrom = null;\r\n        }\r\n\r\n        indexTo = $.inArray(boundTo, boundsAvailable);\r\n        if (indexTo === -1 || indexTo === boundsAvailable.length - 1) {\r\n            boundTo = null;\r\n        }\r\n\r\n        if (boundFrom || boundTo) {\r\n            boundIsOwn = !boundFrom;\r\n            $.each(boundsAvailable, function (i, bound) {\r\n                if (bound == boundFrom) {\r\n                    boundIsOwn = true;\r\n                }\r\n                boundsAll.push(bound);\r\n                if (boundIsOwn) {\r\n                    boundsOwn.push(bound);\r\n                }\r\n                if (bound == boundTo) {\r\n                    return false;\r\n                }\r\n            });\r\n        }\r\n\r\n        that.bounds.from = boundFrom;\r\n        that.bounds.to = boundTo;\r\n        that.bounds.all = boundsAll;\r\n        that.bounds.own = boundsOwn;\r\n    },\r\n\r\n    constructBoundsParams: function () {\r\n        var that = this,\r\n            params = {};\r\n\r\n        if (that.bounds.from) {\r\n            params['from_bound'] = { value: that.bounds.from };\r\n        }\r\n        if (that.bounds.to) {\r\n            params['to_bound'] = { value: that.bounds.to };\r\n        }\r\n\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * Подстраивает suggestion.value под that.bounds.own\r\n     * Ничего не возвращает, меняет в самом suggestion\r\n     * @param suggestion\r\n     */\r\n    checkValueBounds: function (suggestion) {\r\n        var that = this,\r\n            valueData;\r\n\r\n        // If any bounds set up\r\n        if (that.bounds.own.length && that.type.composeValue) {\r\n            // делаем копию\r\n            var bounds = that.bounds.own.slice(0);\r\n            // если роль текущего инстанса плагина показывать только район города\r\n            // то для корректного формировния нужен city_district_fias_id\r\n            if (bounds.length === 1 && bounds[0] === 'city_district') {\r\n                bounds.push('city_district_fias_id');\r\n            }\r\n            valueData = that.copyDataComponents(suggestion.data, bounds);\r\n            suggestion.value = that.type.composeValue(valueData);\r\n        }\r\n    },\r\n\r\n    copyDataComponents: function (data, components) {\r\n        var result = {},\r\n            dataComponentsById = this.type.dataComponentsById;\r\n\r\n        if (dataComponentsById) {\r\n            $.each(components, function (i, component) {\r\n                $.each(dataComponentsById[component].fields, function (i, field) {\r\n                    if (data[field] != null) {\r\n                        result[field] = data[field];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    getBoundedKladrId: function (kladr_id, boundsRange) {\r\n        var boundTo = boundsRange[boundsRange.length - 1],\r\n            kladrFormat;\r\n\r\n        $.each(this.type.dataComponents, function(i, component){\r\n            if (component.id === boundTo) {\r\n                kladrFormat = component.kladrFormat;\r\n                return false;\r\n            }\r\n        });\r\n\r\n        return kladr_id.substr(0, kladrFormat.digits) + (new Array((kladrFormat.zeros || 0) + 1).join('0'));\r\n    }\r\n\r\n};\r\n\r\n$.extend(DEFAULT_OPTIONS, optionsUsed$3);\r\n\r\n$.extend(Suggestions.prototype, methods$8);\r\n\r\nnotificator\r\n    .on('initialize', methods$8.setupBounds)\r\n    .on('setOptions', methods$8.setBoundsOptions)\r\n    .on('requestParams', methods$8.constructBoundsParams);\r\n\r\nSuggestions.defaultOptions = DEFAULT_OPTIONS;\r\n\r\nSuggestions.version = '99.9.9';\r\n\r\n$.Suggestions = Suggestions;\r\n\r\n// Create chainable jQuery plugin:\r\n$.fn.suggestions = function (options, args) {\r\n    // If function invoked without argument return\r\n    // instance of the first matched element:\r\n    if (arguments.length === 0) {\r\n        return this.first().data(DATA_ATTR_KEY);\r\n    }\r\n\r\n    return this.each(function () {\r\n        var inputElement = $(this),\r\n            instance = inputElement.data(DATA_ATTR_KEY);\r\n\r\n        if (typeof options === 'string') {\r\n            if (instance && typeof instance[options] === 'function') {\r\n                instance[options](args);\r\n            }\r\n        } else {\r\n            // If instance already exists, destroy it:\r\n            if (instance && instance.dispose) {\r\n                instance.dispose();\r\n            }\r\n            instance = new Suggestions(this, options);\r\n            inputElement.data(DATA_ATTR_KEY, instance);\r\n        }\r\n    });\r\n};\r\n\r\n})));\r\n","// ==================================================\r\n// fancyBox v3.1.28\r\n//\r\n// Licensed GPLv3 for open source use\r\n// or fancyBox Commercial License for commercial use\r\n//\r\n// http://fancyapps.com/fancybox/\r\n// Copyright 2017 fancyApps\r\n//\r\n// ==================================================\r\n;(function (window, document, $, undefined) {\r\n    'use strict';\r\n\r\n    // If there's no jQuery, fancyBox can't work\r\n    // =========================================\r\n\r\n    if ( !$ ) {\r\n        return;\r\n    }\r\n\r\n    // Check if fancyBox is already initialized\r\n    // ========================================\r\n\r\n    if ( $.fn.fancybox ) {\r\n\r\n        $.error('fancyBox already initialized');\r\n\r\n        return;\r\n    }\r\n\r\n    // Private default settings\r\n    // ========================\r\n\r\n    var defaults = {\r\n\r\n        // Enable infinite gallery navigation\r\n        loop : false,\r\n\r\n        // Space around image, ignored if zoomed-in or viewport width is smaller than 800px\r\n        margin : [44, 0],\r\n\r\n        // Horizontal space between slides\r\n        gutter : 50,\r\n\r\n        // Enable keyboard navigation\r\n        keyboard : true,\r\n\r\n        // Should display navigation arrows at the screen edges\r\n        arrows : true,\r\n\r\n        // Should display infobar (counter and arrows at the top)\r\n        infobar : false,\r\n\r\n        // Should display toolbar (buttons at the top)\r\n        toolbar : true,\r\n\r\n        // What buttons should appear in the top right corner.\r\n        // Buttons will be created using templates from `btnTpl` option\r\n        // and they will be placed into toolbar (class=\"fancybox-toolbar\"` element)\r\n        buttons : [\r\n            'slideShow',\r\n            'fullScreen',\r\n            'thumbs',\r\n            'close'\r\n        ],\r\n\r\n        // Detect \"idle\" time in seconds\r\n        idleTime : 4,\r\n\r\n        // Should display buttons at top right corner of the content\r\n        // If 'auto' - they will be created for content having type 'html', 'inline' or 'ajax'\r\n        // Use template from `btnTpl.smallBtn` for customization\r\n        smallBtn : 'auto',\r\n\r\n        // Disable right-click and use simple image protection for images\r\n        protect : false,\r\n\r\n        // Shortcut to make content \"modal\" - disable keyboard navigtion, hide buttons, etc\r\n        modal : false,\r\n\r\n        image : {\r\n\r\n            // Wait for images to load before displaying\r\n            // Requires predefined image dimensions\r\n            // If 'auto' - will zoom in thumbnail if 'width' and 'height' attributes are found\r\n            preload : \"auto\",\r\n\r\n        },\r\n\r\n        ajax : {\r\n\r\n            // Object containing settings for ajax request\r\n            settings : {\r\n\r\n                // This helps to indicate that request comes from the modal\r\n                // Feel free to change naming\r\n                data : {\r\n                    fancybox : true\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        iframe : {\r\n\r\n            // Iframe template\r\n            tpl : '<iframe id=\"fancybox-frame{rnd}\" name=\"fancybox-frame{rnd}\" class=\"fancybox-iframe\" frameborder=\"0\" vspace=\"0\" hspace=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen allowtransparency=\"true\" src=\"\"></iframe>',\r\n\r\n            // Preload iframe before displaying it\r\n            // This allows to calculate iframe content width and height\r\n            // (note: Due to \"Same Origin Policy\", you can't get cross domain data).\r\n            preload : true,\r\n\r\n            // Custom CSS styling for iframe wrapping element\r\n            // You can use this to set custom iframe dimensions\r\n            css : {},\r\n\r\n            // Iframe tag attributes\r\n            attr : {\r\n                scrolling : 'auto'\r\n            }\r\n\r\n        },\r\n\r\n        // Open/close animation type\r\n        // Possible values:\r\n        //   false            - disable\r\n        //   \"zoom\"           - zoom images from/to thumbnail\r\n        //   \"fade\"\r\n        //   \"zoom-in-out\"\r\n        //\r\n        animationEffect : \"zoom\",\r\n\r\n        // Duration in ms for open/close animation\r\n        animationDuration : 366,\r\n\r\n        // Should image change opacity while zooming\r\n        // If opacity is 'auto', then opacity will be changed if image and thumbnail have different aspect ratios\r\n        zoomOpacity : 'auto',\r\n\r\n        // Transition effect between slides\r\n        //\r\n        // Possible values:\r\n        //   false            - disable\r\n        //   \"fade'\r\n        //   \"slide'\r\n        //   \"circular'\r\n        //   \"tube'\r\n        //   \"zoom-in-out'\r\n        //   \"rotate'\r\n        //\r\n        transitionEffect : \"fade\",\r\n\r\n        // Duration in ms for transition animation\r\n        transitionDuration : 366,\r\n\r\n        // Custom CSS class for slide element\r\n        slideClass : '',\r\n\r\n        // Custom CSS class for layout\r\n        baseClass : '',\r\n\r\n        // Base template for layout\r\n        baseTpl\t:\r\n            '<div class=\"fancybox-container\" role=\"dialog\" tabindex=\"-1\">' +\r\n                '<div class=\"fancybox-bg\"></div>' +\r\n                '<div class=\"fancybox-inner\">' +\r\n                    '<div class=\"fancybox-infobar\">' +\r\n                        '<button data-fancybox-prev title=\"{{PREV}}\" class=\"fancybox-button fancybox-button--left\"></button>' +\r\n                        '<div class=\"fancybox-infobar__body\">' +\r\n                            '<span data-fancybox-index></span>&nbsp;/&nbsp;<span data-fancybox-count></span>' +\r\n                        '</div>' +\r\n                        '<button data-fancybox-next title=\"{{NEXT}}\" class=\"fancybox-button fancybox-button--right\"></button>' +\r\n                    '</div>' +\r\n                    '<div class=\"fancybox-toolbar\">' +\r\n                        '{{BUTTONS}}' +\r\n                    '</div>' +\r\n                    '<div class=\"fancybox-navigation\">' +\r\n                        '<button data-fancybox-prev title=\"{{PREV}}\" class=\"fancybox-arrow fancybox-arrow--left\" />' +\r\n                        '<button data-fancybox-next title=\"{{NEXT}}\" class=\"fancybox-arrow fancybox-arrow--right\" />' +\r\n                    '</div>' +\r\n                    '<div class=\"fancybox-stage\"></div>' +\r\n                    '<div class=\"fancybox-caption-wrap\">' +\r\n                        '<div class=\"fancybox-caption\"></div>' +\r\n                    '</div>' +\r\n                '</div>' +\r\n            '</div>',\r\n\r\n        // Loading indicator template\r\n        spinnerTpl : '<div class=\"fancybox-loading\"></div>',\r\n\r\n        // Error message template\r\n        errorTpl : '<div class=\"fancybox-error\"><p>{{ERROR}}<p></div>',\r\n\r\n        btnTpl : {\r\n            slideShow  : '<button data-fancybox-play class=\"fancybox-button fancybox-button--play\" title=\"{{PLAY_START}}\"></button>',\r\n            fullScreen : '<button data-fancybox-fullscreen class=\"fancybox-button fancybox-button--fullscreen\" title=\"{{FULL_SCREEN}}\"></button>',\r\n            thumbs     : '<button data-fancybox-thumbs class=\"fancybox-button fancybox-button--thumbs\" title=\"{{THUMBS}}\"></button>',\r\n            close      : '<button data-fancybox-close class=\"fancybox-button fancybox-button--close\" title=\"{{CLOSE}}\"></button>',\r\n\r\n            // This small close button will be appended to your html/inline/ajax content by default,\r\n            // if \"smallBtn\" option is not set to false\r\n            smallBtn   : '<button data-fancybox-close class=\"fancybox-close-small\" title=\"{{CLOSE}}\"></button>'\r\n        },\r\n\r\n        // Container is injected into this element\r\n        parentEl : 'body',\r\n\r\n\r\n        // Focus handling\r\n        // ==============\r\n\r\n        // Try to focus on the first focusable element after opening\r\n        autoFocus : true,\r\n\r\n        // Put focus back to active element after closing\r\n        backFocus : true,\r\n\r\n        // Do not let user to focus on element outside modal content\r\n        trapFocus : true,\r\n\r\n\r\n        // Module specific options\r\n        // =======================\r\n\r\n        fullScreen : {\r\n            autoStart : false,\r\n        },\r\n\r\n        // Set `touch: false` to disable dragging/swiping\r\n        touch : {\r\n            vertical : true,  // Allow to drag content vertically\r\n            momentum : true   // Continue movement after releasing mouse/touch when panning\r\n        },\r\n\r\n        // Hash value when initializing manually,\r\n        // set `false` to disable hash change\r\n        hash : null,\r\n\r\n        // Customize or add new media types\r\n        // Example:\r\n        /*\r\n        media : {\r\n            youtube : {\r\n                params : {\r\n                    autoplay : 0\r\n                }\r\n            }\r\n        }\r\n        */\r\n        media : {},\r\n\r\n        slideShow : {\r\n            autoStart : false,\r\n            speed     : 4000\r\n        },\r\n\r\n        thumbs : {\r\n            autoStart   : false,   // Display thumbnails on opening\r\n            hideOnClose : true     // Hide thumbnail grid when closing animation starts\r\n        },\r\n\r\n        // Callbacks\r\n        //==========\r\n\r\n        // See Documentation/API/Events for more information\r\n        // Example:\r\n        /*\r\n            afterShow: function( instance, current ) {\r\n                 console.info( 'Clicked element:' );\r\n                 console.info( current.opts.$orig );\r\n            }\r\n        */\r\n\r\n        onInit       : $.noop,  // When instance has been initialized\r\n\r\n        beforeLoad   : $.noop,  // Before the content of a slide is being loaded\r\n        afterLoad    : $.noop,  // When the content of a slide is done loading\r\n\r\n        beforeShow   : $.noop,  // Before open animation starts\r\n        afterShow    : $.noop,  // When content is done loading and animating\r\n\r\n        beforeClose  : $.noop,  // Before the instance attempts to close. Return false to cancel the close.\r\n        afterClose   : $.noop,  // After instance has been closed\r\n\r\n        onActivate   : $.noop,  // When instance is brought to front\r\n        onDeactivate : $.noop,  // When other instance has been activated\r\n\r\n\r\n        // Interaction\r\n        // ===========\r\n\r\n        // Use options below to customize taken action when user clicks or double clicks on the fancyBox area,\r\n        // each option can be string or method that returns value.\r\n        //\r\n        // Possible values:\r\n        //   \"close\"           - close instance\r\n        //   \"next\"            - move to next gallery item\r\n        //   \"nextOrClose\"     - move to next gallery item or close if gallery has only one item\r\n        //   \"toggleControls\"  - show/hide controls\r\n        //   \"zoom\"            - zoom image (if loaded)\r\n        //   false             - do nothing\r\n\r\n        // Clicked on the content\r\n        clickContent : function( current, event ) {\r\n            return current.type === 'image' ? 'zoom' : false;\r\n        },\r\n\r\n        // Clicked on the slide\r\n        clickSlide : 'close',\r\n\r\n        // Clicked on the background (backdrop) element\r\n        clickOutside : 'close',\r\n\r\n        // Same as previous two, but for double click\r\n        dblclickContent : false,\r\n        dblclickSlide   : false,\r\n        dblclickOutside : false,\r\n\r\n\r\n        // Custom options when mobile device is detected\r\n        // =============================================\r\n\r\n        mobile : {\r\n            clickContent : function( current, event ) {\r\n                return current.type === 'image' ? 'toggleControls' : false;\r\n            },\r\n            clickSlide : function( current, event ) {\r\n                return current.type === 'image' ? 'toggleControls' : 'close';\r\n            },\r\n            dblclickContent : function( current, event ) {\r\n                return current.type === 'image' ? 'zoom' : false;\r\n            },\r\n            dblclickSlide : function( current, event ) {\r\n                return current.type === 'image' ? 'zoom' : false;\r\n            }\r\n        },\r\n\r\n\r\n        // Internationalization\r\n        // ============\r\n\r\n        lang : 'en',\r\n        i18n : {\r\n            'en' : {\r\n                CLOSE       : 'Close',\r\n                NEXT        : 'Next',\r\n                PREV        : 'Previous',\r\n                ERROR       : 'The requested content cannot be loaded. <br/> Please try again later.',\r\n                PLAY_START  : 'Start slideshow',\r\n                PLAY_STOP   : 'Pause slideshow',\r\n                FULL_SCREEN : 'Full screen',\r\n                THUMBS      : 'Thumbnails'\r\n            },\r\n            'de' : {\r\n                CLOSE       : 'Schliessen',\r\n                NEXT        : 'Weiter',\r\n                PREV        : 'Zurück',\r\n                ERROR       : 'Die angeforderten Daten konnten nicht geladen werden. <br/> Bitte versuchen Sie es später nochmal.',\r\n                PLAY_START  : 'Diaschau starten',\r\n                PLAY_STOP   : 'Diaschau beenden',\r\n                FULL_SCREEN : 'Vollbild',\r\n                THUMBS      : 'Vorschaubilder'\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    // Few useful variables and methods\r\n    // ================================\r\n\r\n    var $W = $(window);\r\n    var $D = $(document);\r\n\r\n    var called = 0;\r\n\r\n\r\n    // Check if an object is a jQuery object and not a native JavaScript object\r\n    // ========================================================================\r\n\r\n    var isQuery = function ( obj ) {\r\n        return obj && obj.hasOwnProperty && obj instanceof $;\r\n    };\r\n\r\n\r\n    // Handle multiple browsers for \"requestAnimationFrame\" and \"cancelAnimationFrame\"\r\n    // ===============================================================================\r\n\r\n    var requestAFrame = (function () {\r\n        return window.requestAnimationFrame ||\r\n                window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                window.oRequestAnimationFrame ||\r\n                // if all else fails, use setTimeout\r\n                function (callback) {\r\n                    return window.setTimeout(callback, 1000 / 60);\r\n                };\r\n    })();\r\n\r\n\r\n    // Detect the supported transition-end event property name\r\n    // =======================================================\r\n\r\n    var transitionEnd = (function () {\r\n        var t, el = document.createElement(\"fakeelement\");\r\n\r\n        var transitions = {\r\n            \"transition\"      : \"transitionend\",\r\n            \"OTransition\"     : \"oTransitionEnd\",\r\n            \"MozTransition\"   : \"transitionend\",\r\n            \"WebkitTransition\": \"webkitTransitionEnd\"\r\n        };\r\n\r\n        for (t in transitions) {\r\n            if (el.style[t] !== undefined){\r\n                return transitions[t];\r\n            }\r\n        }\r\n    })();\r\n\r\n\r\n    // Force redraw on an element.\r\n    // This helps in cases where the browser doesn't redraw an updated element properly.\r\n    // =================================================================================\r\n\r\n    var forceRedraw = function( $el ) {\r\n        return ( $el && $el.length && $el[0].offsetHeight );\r\n    };\r\n\r\n\r\n    // Class definition\r\n    // ================\r\n\r\n    var FancyBox = function( content, opts, index ) {\r\n        var self = this;\r\n\r\n        self.opts  = $.extend( true, { index : index }, defaults, opts || {} );\r\n\r\n        // Exclude buttons option from deep merging\r\n        if ( opts && $.isArray( opts.buttons ) ) {\r\n            self.opts.buttons = opts.buttons;\r\n        }\r\n\r\n        self.id    = self.opts.id || ++called;\r\n        self.group = [];\r\n\r\n        self.currIndex = parseInt( self.opts.index, 10 ) || 0;\r\n        self.prevIndex = null;\r\n\r\n        self.prevPos = null;\r\n        self.currPos = 0;\r\n\r\n        self.firstRun = null;\r\n\r\n        // Create group elements from original item collection\r\n        self.createGroup( content );\r\n\r\n        if ( !self.group.length ) {\r\n            return;\r\n        }\r\n\r\n        // Save last active element and current scroll position\r\n        self.$lastFocus = $(document.activeElement).blur();\r\n\r\n        // Collection of gallery objects\r\n        self.slides = {};\r\n\r\n        self.init( content );\r\n\r\n    };\r\n\r\n    $.extend(FancyBox.prototype, {\r\n\r\n        // Create DOM structure\r\n        // ====================\r\n\r\n        init : function() {\r\n            var self = this;\r\n\r\n            var testWidth, $container, buttonStr;\r\n\r\n            var firstItemOpts = self.group[ self.currIndex ].opts;\r\n\r\n            self.scrollTop  = $D.scrollTop();\r\n            self.scrollLeft = $D.scrollLeft();\r\n\r\n\r\n            // Hide scrollbars\r\n            // ===============\r\n\r\n            if ( !$.fancybox.getInstance() && !$.fancybox.isMobile && $( 'body' ).css('overflow') !== 'hidden' ) {\r\n                testWidth = $( 'body' ).width();\r\n\r\n                $( 'html' ).addClass( 'fancybox-enabled' );\r\n\r\n                // Compare body width after applying \"overflow: hidden\"\r\n                testWidth = $( 'body' ).width() - testWidth;\r\n\r\n                // If width has changed - compensate missing scrollbars by adding right margin\r\n                if ( testWidth > 1 ) {\r\n                    $( 'head' ).append( '<style id=\"fancybox-style-noscroll\" type=\"text/css\">.compensate-for-scrollbar, .fancybox-enabled body { margin-right: ' + testWidth + 'px; }</style>' );\r\n                }\r\n            }\r\n\r\n\r\n            // Build html markup and set references\r\n            // ====================================\r\n\r\n            // Build html code for buttons and insert into main template\r\n            buttonStr = '';\r\n\r\n            $.each( firstItemOpts.buttons, function( index, value ) {\r\n                buttonStr += ( firstItemOpts.btnTpl[ value ] || '' );\r\n            });\r\n\r\n            // Create markup from base template, it will be initially hidden to\r\n            // avoid unnecessary work like painting while initializing is not complete\r\n            $container = $( self.translate( self, firstItemOpts.baseTpl.replace( '\\{\\{BUTTONS\\}\\}', buttonStr ) ) )\r\n                .addClass( 'fancybox-is-hidden' )\r\n                .attr('id', 'fancybox-container-' + self.id)\r\n                .addClass( firstItemOpts.baseClass )\r\n                .data( 'FancyBox', self )\r\n                .prependTo( firstItemOpts.parentEl );\r\n\r\n            // Create object holding references to jQuery wrapped nodes\r\n            self.$refs = {\r\n                container : $container\r\n            };\r\n\r\n            [ 'bg', 'inner', 'infobar', 'toolbar', 'stage', 'caption' ].forEach(function(item) {\r\n                self.$refs[ item ] = $container.find( '.fancybox-' + item );\r\n            });\r\n\r\n            // Check for redundant elements\r\n            if ( !firstItemOpts.arrows || self.group.length < 2 ) {\r\n                $container.find('.fancybox-navigation').remove();\r\n            }\r\n\r\n            if ( !firstItemOpts.infobar ) {\r\n                self.$refs.infobar.remove();\r\n            }\r\n\r\n            if ( !firstItemOpts.toolbar ) {\r\n                self.$refs.toolbar.remove();\r\n            }\r\n\r\n            self.trigger( 'onInit' );\r\n\r\n            // Bring to front and enable events\r\n            self.activate();\r\n\r\n            // Build slides, load and reveal content\r\n            self.jumpTo( self.currIndex );\r\n        },\r\n\r\n\r\n        // Simple i18n support - replaces object keys found in template\r\n        // with corresponding values\r\n        // ============================================================\r\n\r\n        translate : function( obj, str ) {\r\n            var arr = obj.opts.i18n[ obj.opts.lang ];\r\n\r\n            return str.replace(/\\{\\{(\\w+)\\}\\}/g, function(match, n) {\r\n                var value = arr[n];\r\n\r\n                if ( value === undefined ) {\r\n                    return match;\r\n                }\r\n\r\n                return value;\r\n            });\r\n        },\r\n\r\n        // Create array of gally item objects\r\n        // Check if each object has valid type and content\r\n        // ===============================================\r\n\r\n        createGroup : function ( content ) {\r\n            var self  = this;\r\n            var items = $.makeArray( content );\r\n\r\n            $.each(items, function( i, item ) {\r\n                var obj  = {},\r\n                    opts = {},\r\n                    data = [],\r\n                    $item,\r\n                    type,\r\n                    src,\r\n                    srcParts;\r\n\r\n                // Step 1 - Make sure we have an object\r\n                // ====================================\r\n\r\n                if ( $.isPlainObject( item ) ) {\r\n\r\n                    // We probably have manual usage here, something like\r\n                    // $.fancybox.open( [ { src : \"image.jpg\", type : \"image\" } ] )\r\n\r\n                    obj  = item;\r\n                    opts = item.opts || item;\r\n\r\n                } else if ( $.type( item ) === 'object' && $( item ).length ) {\r\n\r\n                    // Here we propbably have jQuery collection returned by some selector\r\n\r\n                    $item = $( item );\r\n                    data  = $item.data();\r\n\r\n                    opts = 'options' in data ? data.options : {};\r\n                    opts = $.type( opts ) === 'object' ? opts : {};\r\n\r\n                    obj.src  = 'src' in data ? data.src : ( opts.src || $item.attr( 'href' ) );\r\n\r\n                    [ 'width', 'height', 'thumb', 'type', 'filter' ].forEach(function(item) {\r\n                        if ( item in data ) {\r\n                            opts[ item ] = data[ item ];\r\n                        }\r\n                    });\r\n\r\n                    if ( 'srcset' in data ) {\r\n                        opts.image = { srcset : data.srcset };\r\n                    }\r\n\r\n                    opts.$orig = $item;\r\n\r\n                    if ( !obj.type && !obj.src ) {\r\n                        obj.type = 'inline';\r\n                        obj.src  = item;\r\n                    }\r\n\r\n                } else {\r\n\r\n                    // Assume we have a simple html code, for example:\r\n                    // $.fancybox.open( '<div><h1>Hi!</h1></div>' );\r\n\r\n                    obj = {\r\n                        type : 'html',\r\n                        src  : item + ''\r\n                    };\r\n\r\n                }\r\n\r\n                // Each gallery object has full collection of options\r\n                obj.opts = $.extend( true, {}, self.opts, opts );\r\n\r\n                if ( $.fancybox.isMobile ) {\r\n                    obj.opts = $.extend( true, {}, obj.opts, obj.opts.mobile );\r\n                }\r\n\r\n\r\n                // Step 2 - Make sure we have content type, if not - try to guess\r\n                // ==============================================================\r\n\r\n                type = obj.type || obj.opts.type;\r\n                src  = obj.src || '';\r\n\r\n                if ( !type && src ) {\r\n                    if ( src.match(/(^data:image\\/[a-z0-9+\\/=]*,)|(\\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\\?|#).*)?$)/i) ) {\r\n                        type = 'image';\r\n\r\n                    } else if ( src.match(/\\.(pdf)((\\?|#).*)?$/i) ) {\r\n                        type = 'pdf';\r\n\r\n                    } else if ( src.charAt(0) === '#' ) {\r\n                        type = 'inline';\r\n                    }\r\n                }\r\n\r\n                obj.type = type;\r\n\r\n\r\n                // Step 3 - Some adjustments\r\n                // =========================\r\n\r\n                obj.index = self.group.length;\r\n\r\n                // Check if $orig and $thumb objects exist\r\n                if ( obj.opts.$orig && !obj.opts.$orig.length ) {\r\n                    delete obj.opts.$orig;\r\n                }\r\n\r\n                if ( !obj.opts.$thumb && obj.opts.$orig ) {\r\n                    obj.opts.$thumb = obj.opts.$orig.find( 'img:first' );\r\n                }\r\n\r\n                if ( obj.opts.$thumb && !obj.opts.$thumb.length ) {\r\n                    delete obj.opts.$thumb;\r\n                }\r\n\r\n                // Caption is a \"special\" option, it can be passed as a method\r\n                if ( $.type( obj.opts.caption ) === 'function' ) {\r\n                    obj.opts.caption = obj.opts.caption.apply( item, [ self, obj ] );\r\n\r\n                } else if ( 'caption' in data ) {\r\n                    obj.opts.caption = data.caption;\r\n                }\r\n\r\n                // Make sure we have caption as a string\r\n                obj.opts.caption = obj.opts.caption === undefined ? '' : obj.opts.caption + '';\r\n\r\n                // Check if url contains \"filter\" used to filter the content\r\n                // Example: \"ajax.html #something\"\r\n                if ( type === 'ajax' ) {\r\n                    srcParts = src.split(/\\s+/, 2);\r\n\r\n                    if ( srcParts.length > 1 ) {\r\n                        obj.src = srcParts.shift();\r\n\r\n                        obj.opts.filter = srcParts.shift();\r\n                    }\r\n                }\r\n\r\n                if ( obj.opts.smallBtn == 'auto' ) {\r\n\r\n                    if ( $.inArray( type, ['html', 'inline', 'ajax'] ) > -1 ) {\r\n                        obj.opts.toolbar  = false;\r\n                        obj.opts.smallBtn = true;\r\n\r\n                    } else {\r\n                        obj.opts.smallBtn = false;\r\n                    }\r\n\r\n                }\r\n\r\n                // If the type is \"pdf\", then simply load file into iframe\r\n                if ( type === 'pdf' ) {\r\n                    obj.type = 'iframe';\r\n\r\n                    obj.opts.iframe.preload = false;\r\n                }\r\n\r\n                // Hide all buttons and disable interactivity for modal items\r\n                if ( obj.opts.modal ) {\r\n\r\n                    obj.opts = $.extend(true, obj.opts, {\r\n                        // Remove buttons\r\n                        infobar : 0,\r\n                        toolbar : 0,\r\n\r\n                        smallBtn : 0,\r\n\r\n                        // Disable keyboard navigation\r\n                        keyboard : 0,\r\n\r\n                        // Disable some modules\r\n                        slideShow  : 0,\r\n                        fullScreen : 0,\r\n                        thumbs     : 0,\r\n                        touch      : 0,\r\n\r\n                        // Disable click event handlers\r\n                        clickContent    : false,\r\n                        clickSlide      : false,\r\n                        clickOutside    : false,\r\n                        dblclickContent : false,\r\n                        dblclickSlide   : false,\r\n                        dblclickOutside : false\r\n                    });\r\n\r\n                }\r\n\r\n                // Step 4 - Add processed object to group\r\n                // ======================================\r\n\r\n                self.group.push( obj );\r\n\r\n            });\r\n\r\n        },\r\n\r\n\r\n        // Attach an event handler functions for:\r\n        //   - navigation buttons\r\n        //   - browser scrolling, resizing;\r\n        //   - focusing\r\n        //   - keyboard\r\n        //   - detect idle\r\n        // ======================================\r\n\r\n        addEvents : function() {\r\n            var self = this;\r\n\r\n            self.removeEvents();\r\n\r\n            // Make navigation elements clickable\r\n            self.$refs.container.on('click.fb-close', '[data-fancybox-close]', function(e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n\r\n                self.close( e );\r\n\r\n            }).on( 'click.fb-prev touchend.fb-prev', '[data-fancybox-prev]', function(e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n\r\n                self.previous();\r\n\r\n            }).on( 'click.fb-next touchend.fb-next', '[data-fancybox-next]', function(e) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n\r\n                self.next();\r\n\r\n            });\r\n\r\n\r\n            // Handle page scrolling and browser resizing\r\n            $W.on('orientationchange.fb resize.fb', function(e) {\r\n\r\n                if ( e && e.originalEvent && e.originalEvent.type === \"resize\" ) {\r\n\r\n                    requestAFrame(function() {\r\n                        self.update();\r\n                    });\r\n\r\n                } else {\r\n\r\n                    self.$refs.stage.hide();\r\n\r\n                    setTimeout(function() {\r\n                        self.$refs.stage.show();\r\n\r\n                        self.update();\r\n                    }, 500);\r\n\r\n                }\r\n\r\n            });\r\n\r\n            // Trap keyboard focus inside of the modal, so the user does not accidentally tab outside of the modal\r\n            // (a.k.a. \"escaping the modal\")\r\n            $D.on('focusin.fb', function(e) {\r\n                var instance = $.fancybox ? $.fancybox.getInstance() : null;\r\n\r\n                if ( instance.isClosing || !instance.current || !instance.current.opts.trapFocus || $( e.target ).hasClass( 'fancybox-container' ) || $( e.target ).is( document ) ) {\r\n                    return;\r\n                }\r\n\r\n                if ( instance && $( e.target ).css( 'position' ) !== 'fixed' && !instance.$refs.container.has( e.target ).length ) {\r\n                    e.stopPropagation();\r\n\r\n                    instance.focus();\r\n\r\n                    // Sometimes page gets scrolled, set it back\r\n                    $W.scrollTop( self.scrollTop ).scrollLeft( self.scrollLeft );\r\n                }\r\n            });\r\n\r\n\r\n            // Enable keyboard navigation\r\n            $D.on('keydown.fb', function (e) {\r\n                var current = self.current,\r\n                    keycode = e.keyCode || e.which;\r\n\r\n                if ( !current || !current.opts.keyboard ) {\r\n                    return;\r\n                }\r\n\r\n                if ( $(e.target).is('input') || $(e.target).is('textarea') ) {\r\n                    return;\r\n                }\r\n\r\n                // Backspace and Esc keys\r\n                if ( keycode === 8 || keycode === 27 ) {\r\n                    e.preventDefault();\r\n\r\n                    self.close( e );\r\n\r\n                    return;\r\n                }\r\n\r\n                // Left arrow and Up arrow\r\n                if ( keycode === 37 || keycode === 38 ) {\r\n                    e.preventDefault();\r\n\r\n                    self.previous();\r\n\r\n                    return;\r\n                }\r\n\r\n                // Righ arrow and Down arrow\r\n                if ( keycode === 39 || keycode === 40 ) {\r\n                    e.preventDefault();\r\n\r\n                    self.next();\r\n\r\n                    return;\r\n                }\r\n\r\n                self.trigger('afterKeydown', e, keycode);\r\n            });\r\n\r\n\r\n            // Hide controls after some inactivity period\r\n            if ( self.group[ self.currIndex ].opts.idleTime ) {\r\n                self.idleSecondsCounter = 0;\r\n\r\n                $D.on('mousemove.fb-idle mouseenter.fb-idle mouseleave.fb-idle mousedown.fb-idle touchstart.fb-idle touchmove.fb-idle scroll.fb-idle keydown.fb-idle', function() {\r\n                    self.idleSecondsCounter = 0;\r\n\r\n                    if ( self.isIdle ) {\r\n                        self.showControls();\r\n                    }\r\n\r\n                    self.isIdle = false;\r\n                });\r\n\r\n                self.idleInterval = window.setInterval(function() {\r\n\r\n                    self.idleSecondsCounter++;\r\n\r\n                    if ( self.idleSecondsCounter >= self.group[ self.currIndex ].opts.idleTime ) {\r\n                        self.isIdle = true;\r\n                        self.idleSecondsCounter = 0;\r\n\r\n                        self.hideControls();\r\n                    }\r\n\r\n                }, 1000);\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Remove events added by the core\r\n        // ===============================\r\n\r\n        removeEvents : function () {\r\n            var self = this;\r\n\r\n            $W.off( 'orientationchange.fb resize.fb' );\r\n            $D.off( 'focusin.fb keydown.fb .fb-idle' );\r\n\r\n            this.$refs.container.off( '.fb-close .fb-prev .fb-next' );\r\n\r\n            if ( self.idleInterval ) {\r\n                window.clearInterval( self.idleInterval );\r\n\r\n                self.idleInterval = null;\r\n            }\r\n        },\r\n\r\n\r\n        // Change to previous gallery item\r\n        // ===============================\r\n\r\n        previous : function( duration ) {\r\n            return this.jumpTo( this.currPos - 1, duration );\r\n        },\r\n\r\n\r\n        // Change to next gallery item\r\n        // ===========================\r\n\r\n        next : function( duration ) {\r\n            return this.jumpTo( this.currPos + 1, duration );\r\n        },\r\n\r\n\r\n        // Switch to selected gallery item\r\n        // ===============================\r\n\r\n        jumpTo : function ( pos, duration, slide ) {\r\n            var self = this,\r\n                firstRun,\r\n                loop,\r\n                current,\r\n                previous,\r\n                canvasWidth,\r\n                currentPos,\r\n                transitionProps;\r\n\r\n            var groupLen = self.group.length;\r\n\r\n            if ( self.isSliding || self.isClosing || ( self.isAnimating && self.firstRun ) ) {\r\n                return;\r\n            }\r\n\r\n            pos  = parseInt( pos, 10 );\r\n            loop = self.current ? self.current.opts.loop : self.opts.loop;\r\n\r\n            if ( !loop && ( pos < 0 || pos >= groupLen ) ) {\r\n                return false;\r\n            }\r\n\r\n            firstRun = self.firstRun = ( self.firstRun === null );\r\n\r\n            if ( groupLen < 2 && !firstRun && !!self.isSliding ) {\r\n                return;\r\n            }\r\n\r\n            previous = self.current;\r\n\r\n            self.prevIndex = self.currIndex;\r\n            self.prevPos   = self.currPos;\r\n\r\n            // Create slides\r\n            current = self.createSlide( pos );\r\n\r\n            if ( groupLen > 1 ) {\r\n                if ( loop || current.index > 0 ) {\r\n                    self.createSlide( pos - 1 );\r\n                }\r\n\r\n                if ( loop || current.index < groupLen - 1 ) {\r\n                    self.createSlide( pos + 1 );\r\n                }\r\n            }\r\n\r\n            self.current   = current;\r\n            self.currIndex = current.index;\r\n            self.currPos   = current.pos;\r\n\r\n            self.trigger( 'beforeShow', firstRun );\r\n\r\n            self.updateControls();\r\n\r\n            currentPos = $.fancybox.getTranslate( current.$slide );\r\n\r\n            current.isMoved        = ( currentPos.left !== 0 || currentPos.top !== 0 ) && !current.$slide.hasClass( 'fancybox-animated' );\r\n            current.forcedDuration = undefined;\r\n\r\n            if ( $.isNumeric( duration ) ) {\r\n                current.forcedDuration = duration;\r\n            } else {\r\n                duration = current.opts[ firstRun ? 'animationDuration' : 'transitionDuration' ];\r\n            }\r\n\r\n            duration = parseInt( duration, 10 );\r\n\r\n            // Fresh start - reveal container, current slide and start loading content\r\n            if ( firstRun ) {\r\n\r\n                if ( current.opts.animationEffect && duration ) {\r\n                    self.$refs.container.css( 'transition-duration', duration + 'ms' );\r\n                }\r\n\r\n                self.$refs.container.removeClass( 'fancybox-is-hidden' );\r\n\r\n                forceRedraw( self.$refs.container );\r\n\r\n                self.$refs.container.addClass( 'fancybox-is-open' );\r\n\r\n                // Make first slide visible (to display loading icon, if needed)\r\n                current.$slide.addClass( 'fancybox-slide--current' );\r\n\r\n                self.loadSlide( current );\r\n\r\n                self.preload();\r\n\r\n                return;\r\n            }\r\n\r\n            // Clean up\r\n            $.each(self.slides, function( index, slide ) {\r\n                $.fancybox.stop( slide.$slide );\r\n            });\r\n\r\n            // Make current that slide is visible even if content is still loading\r\n            current.$slide.removeClass( 'fancybox-slide--next fancybox-slide--previous' ).addClass( 'fancybox-slide--current' );\r\n\r\n            // If slides have been dragged, animate them to correct position\r\n            if ( current.isMoved ) {\r\n                canvasWidth = Math.round( current.$slide.width() );\r\n\r\n                $.each(self.slides, function( index, slide ) {\r\n                    var pos = slide.pos - current.pos;\r\n\r\n                    $.fancybox.animate( slide.$slide, {\r\n                        top  : 0,\r\n                        left : ( pos * canvasWidth ) + ( pos * slide.opts.gutter )\r\n                    }, duration, function() {\r\n\r\n                        slide.$slide.removeAttr('style').removeClass( 'fancybox-slide--next fancybox-slide--previous' );\r\n\r\n                        if ( slide.pos === self.currPos ) {\r\n                            current.isMoved = false;\r\n\r\n                            self.complete();\r\n                        }\r\n                    });\r\n                });\r\n\r\n            } else {\r\n                self.$refs.stage.children().removeAttr( 'style' );\r\n            }\r\n\r\n            // Start transition that reveals current content\r\n            // or wait when it will be loaded\r\n\r\n            if ( current.isLoaded ) {\r\n                self.revealContent( current );\r\n\r\n            } else {\r\n                self.loadSlide( current );\r\n            }\r\n\r\n            self.preload();\r\n\r\n            if ( previous.pos === current.pos ) {\r\n                return;\r\n            }\r\n\r\n            // Handle previous slide\r\n            // =====================\r\n\r\n            transitionProps = 'fancybox-slide--' + ( previous.pos > current.pos ? 'next' : 'previous' );\r\n\r\n            previous.$slide.removeClass( 'fancybox-slide--complete fancybox-slide--current fancybox-slide--next fancybox-slide--previous' );\r\n\r\n            previous.isComplete = false;\r\n\r\n            if ( !duration || ( !current.isMoved && !current.opts.transitionEffect ) ) {\r\n                return;\r\n            }\r\n\r\n            if ( current.isMoved ) {\r\n                previous.$slide.addClass( transitionProps );\r\n\r\n            } else {\r\n\r\n                transitionProps = 'fancybox-animated ' + transitionProps + ' fancybox-fx-' + current.opts.transitionEffect;\r\n\r\n                $.fancybox.animate( previous.$slide, transitionProps, duration, function() {\r\n                    previous.$slide.removeClass( transitionProps ).removeAttr( 'style' );\r\n                });\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Create new \"slide\" element\r\n        // These are gallery items  that are actually added to DOM\r\n        // =======================================================\r\n\r\n        createSlide : function( pos ) {\r\n\r\n            var self = this;\r\n            var $slide;\r\n            var index;\r\n\r\n            index = pos % self.group.length;\r\n            index = index < 0 ? self.group.length + index : index;\r\n\r\n            if ( !self.slides[ pos ] && self.group[ index ] ) {\r\n                $slide = $('<div class=\"fancybox-slide\"></div>').appendTo( self.$refs.stage );\r\n\r\n                self.slides[ pos ] = $.extend( true, {}, self.group[ index ], {\r\n                    pos      : pos,\r\n                    $slide   : $slide,\r\n                    isLoaded : false,\r\n                });\r\n\r\n                self.updateSlide( self.slides[ pos ] );\r\n            }\r\n\r\n            return self.slides[ pos ];\r\n        },\r\n\r\n\r\n        // Scale image to the actual size of the image\r\n        // ===========================================\r\n\r\n        scaleToActual : function( x, y, duration ) {\r\n\r\n            var self = this;\r\n\r\n            var current = self.current;\r\n            var $what   = current.$content;\r\n\r\n            var imgPos, posX, posY, scaleX, scaleY;\r\n\r\n            var canvasWidth  = parseInt( current.$slide.width(), 10 );\r\n            var canvasHeight = parseInt( current.$slide.height(), 10 );\r\n\r\n            var newImgWidth  = current.width;\r\n            var newImgHeight = current.height;\r\n\r\n            if ( !( current.type == 'image' && !current.hasError) || !$what || self.isAnimating) {\r\n                return;\r\n            }\r\n\r\n            $.fancybox.stop( $what );\r\n\r\n            self.isAnimating = true;\r\n\r\n            x = x === undefined ? canvasWidth  * 0.5  : x;\r\n            y = y === undefined ? canvasHeight * 0.5  : y;\r\n\r\n            imgPos = $.fancybox.getTranslate( $what );\r\n\r\n            scaleX  = newImgWidth  / imgPos.width;\r\n            scaleY  = newImgHeight / imgPos.height;\r\n\r\n            // Get center position for original image\r\n            posX = ( canvasWidth * 0.5  - newImgWidth * 0.5 );\r\n            posY = ( canvasHeight * 0.5 - newImgHeight * 0.5 );\r\n\r\n            // Make sure image does not move away from edges\r\n            if ( newImgWidth > canvasWidth ) {\r\n                posX = imgPos.left * scaleX - ( ( x * scaleX ) - x );\r\n\r\n                if ( posX > 0 ) {\r\n                    posX = 0;\r\n                }\r\n\r\n                if ( posX <  canvasWidth - newImgWidth ) {\r\n                    posX = canvasWidth - newImgWidth;\r\n                }\r\n            }\r\n\r\n            if ( newImgHeight > canvasHeight) {\r\n                posY = imgPos.top  * scaleY - ( ( y * scaleY ) - y );\r\n\r\n                if ( posY > 0 ) {\r\n                    posY = 0;\r\n                }\r\n\r\n                if ( posY <  canvasHeight - newImgHeight ) {\r\n                    posY = canvasHeight - newImgHeight;\r\n                }\r\n            }\r\n\r\n            self.updateCursor( newImgWidth, newImgHeight );\r\n\r\n            $.fancybox.animate( $what, {\r\n                top    : posY,\r\n                left   : posX,\r\n                scaleX : scaleX,\r\n                scaleY : scaleY\r\n            }, duration || 330, function() {\r\n                self.isAnimating = false;\r\n            });\r\n\r\n            // Stop slideshow\r\n            if ( self.SlideShow && self.SlideShow.isActive ) {\r\n                self.SlideShow.stop();\r\n            }\r\n        },\r\n\r\n\r\n        // Scale image to fit inside parent element\r\n        // ========================================\r\n\r\n        scaleToFit : function( duration ) {\r\n\r\n            var self = this;\r\n\r\n            var current = self.current;\r\n            var $what   = current.$content;\r\n            var end;\r\n\r\n            if ( !( current.type == 'image' && !current.hasError) || !$what || self.isAnimating ) {\r\n                return;\r\n            }\r\n\r\n            $.fancybox.stop( $what );\r\n\r\n            self.isAnimating = true;\r\n\r\n            end = self.getFitPos( current );\r\n\r\n            self.updateCursor( end.width, end.height );\r\n\r\n            $.fancybox.animate( $what, {\r\n                top    : end.top,\r\n                left   : end.left,\r\n                scaleX : end.width  / $what.width(),\r\n                scaleY : end.height / $what.height()\r\n            }, duration || 330, function() {\r\n                self.isAnimating = false;\r\n            });\r\n\r\n        },\r\n\r\n        // Calculate image size to fit inside viewport\r\n        // ===========================================\r\n\r\n        getFitPos : function( slide ) {\r\n            var self  = this;\r\n            var $what = slide.$content;\r\n\r\n            var imgWidth  = slide.width;\r\n            var imgHeight = slide.height;\r\n\r\n            var margin = slide.opts.margin;\r\n\r\n            var canvasWidth, canvasHeight, minRatio, width, height;\r\n\r\n            if ( !$what || !$what.length || ( !imgWidth && !imgHeight) ) {\r\n                return false;\r\n            }\r\n\r\n            // Convert \"margin to CSS style: [ top, right, bottom, left ]\r\n            if ( $.type( margin ) === \"number\" ) {\r\n                margin = [ margin, margin ];\r\n            }\r\n\r\n            if ( margin.length == 2 ) {\r\n                margin = [ margin[0], margin[1], margin[0], margin[1] ];\r\n            }\r\n\r\n            if ( $W.width() < 800 ) {\r\n                margin = [ 0, 0, 0, 0 ];\r\n            }\r\n\r\n            // We can not use $slide width here, because it can have different diemensions while in transiton\r\n            canvasWidth  = parseInt( self.$refs.stage.width(), 10 )  - ( margin[ 1 ] + margin[ 3 ] );\r\n            canvasHeight = parseInt( self.$refs.stage.height(), 10 ) - ( margin[ 0 ] + margin[ 2 ] );\r\n\r\n            minRatio = Math.min(1, canvasWidth / imgWidth, canvasHeight / imgHeight );\r\n\r\n            width  = Math.floor( minRatio * imgWidth );\r\n            height = Math.floor( minRatio * imgHeight );\r\n\r\n            // Use floor rounding to make sure it really fits\r\n            return {\r\n                top    : Math.floor( ( canvasHeight - height ) * 0.5 ) + margin[ 0 ],\r\n                left   : Math.floor( ( canvasWidth  - width )  * 0.5 ) + margin[ 3 ],\r\n                width  : width,\r\n                height : height\r\n            };\r\n\r\n        },\r\n\r\n\r\n        // Update position and content of all slides\r\n        // =========================================\r\n\r\n        update : function() {\r\n\r\n            var self = this;\r\n\r\n            $.each( self.slides, function( key, slide ) {\r\n                self.updateSlide( slide );\r\n            });\r\n\r\n        },\r\n\r\n\r\n        // Update slide position and scale content to fit\r\n        // ==============================================\r\n\r\n        updateSlide : function( slide ) {\r\n\r\n            var self  = this;\r\n            var $what = slide.$content;\r\n\r\n            if ( $what && ( slide.width || slide.height ) ) {\r\n                $.fancybox.stop( $what );\r\n\r\n                $.fancybox.setTranslate( $what, self.getFitPos( slide ) );\r\n\r\n                if ( slide.pos === self.currPos ) {\r\n                    self.updateCursor();\r\n                }\r\n            }\r\n\r\n            slide.$slide.trigger( 'refresh' );\r\n\r\n            self.trigger( 'onUpdate', slide );\r\n\r\n        },\r\n\r\n        // Update cursor style depending if content can be zoomed\r\n        // ======================================================\r\n\r\n        updateCursor : function( nextWidth, nextHeight ) {\r\n\r\n            var self = this;\r\n            var isScaledDown;\r\n\r\n            var $container = self.$refs.container.removeClass('fancybox-is-zoomable fancybox-can-zoomIn fancybox-can-drag fancybox-can-zoomOut');\r\n\r\n            if ( !self.current || self.isClosing ) {\r\n                return;\r\n            }\r\n\r\n            if ( self.isZoomable() ) {\r\n\r\n                $container.addClass( 'fancybox-is-zoomable' );\r\n\r\n                if ( nextWidth !== undefined && nextHeight !== undefined ) {\r\n                    isScaledDown = nextWidth < self.current.width && nextHeight < self.current.height;\r\n\r\n                } else {\r\n                    isScaledDown = self.isScaledDown();\r\n                }\r\n\r\n                if ( isScaledDown ) {\r\n\r\n                    // If image is scaled down, then, obviously, it can be zoomed to full size\r\n                    $container.addClass('fancybox-can-zoomIn');\r\n\r\n                } else {\r\n\r\n                    if ( self.current.opts.touch ) {\r\n\r\n                        // If image size ir largen than available available and touch module is not disable,\r\n                        // then user can do panning\r\n                        $container.addClass('fancybox-can-drag');\r\n\r\n                    } else {\r\n                        $container.addClass('fancybox-can-zoomOut');\r\n                    }\r\n\r\n                }\r\n\r\n            } else if ( self.current.opts.touch ) {\r\n                $container.addClass('fancybox-can-drag');\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Check if current slide is zoomable\r\n        // ==================================\r\n\r\n        isZoomable : function() {\r\n\r\n            var self = this;\r\n\r\n            var current = self.current;\r\n            var fitPos;\r\n\r\n            if ( !current || self.isClosing ) {\r\n                return;\r\n            }\r\n\r\n            // Assume that slide is zoomable if\r\n            //   - image is loaded successfuly\r\n            //   - click action is \"zoom\"\r\n            //   - actual size of the image is smaller than available area\r\n            if ( current.type === 'image' && current.isLoaded && !current.hasError &&\r\n                ( current.opts.clickContent === 'zoom' || ( $.isFunction( current.opts.clickContent ) && current.opts.clickContent( current ) ===  \"zoom\" ) )\r\n            ) {\r\n\r\n                fitPos = self.getFitPos( current );\r\n\r\n                if ( current.width > fitPos.width || current.height > fitPos.height ) {\r\n                    return true;\r\n                }\r\n\r\n            }\r\n\r\n            return false;\r\n\r\n        },\r\n\r\n\r\n        // Check if current image dimensions are smaller than actual\r\n        // =========================================================\r\n\r\n        isScaledDown : function() {\r\n\r\n            var self = this;\r\n\r\n            var current = self.current;\r\n            var $what   = current.$content;\r\n\r\n            var rez = false;\r\n\r\n            if ( $what ) {\r\n                rez = $.fancybox.getTranslate( $what );\r\n                rez = rez.width < current.width || rez.height < current.height;\r\n            }\r\n\r\n            return rez;\r\n\r\n        },\r\n\r\n\r\n        // Check if image dimensions exceed parent element\r\n        // ===============================================\r\n\r\n        canPan : function() {\r\n\r\n            var self = this;\r\n\r\n            var current = self.current;\r\n            var $what   = current.$content;\r\n\r\n            var rez = false;\r\n\r\n            if ( $what ) {\r\n                rez = self.getFitPos( current );\r\n                rez = Math.abs( $what.width() - rez.width ) > 1  || Math.abs( $what.height() - rez.height ) > 1;\r\n\r\n            }\r\n\r\n            return rez;\r\n\r\n        },\r\n\r\n\r\n        // Load content into the slide\r\n        // ===========================\r\n\r\n        loadSlide : function( slide ) {\r\n\r\n            var self = this, type, $slide;\r\n            var ajaxLoad;\r\n\r\n            if ( slide.isLoading ) {\r\n                return;\r\n            }\r\n\r\n            if ( slide.isLoaded ) {\r\n                return;\r\n            }\r\n\r\n            slide.isLoading = true;\r\n\r\n            self.trigger( 'beforeLoad', slide );\r\n\r\n            type   = slide.type;\r\n            $slide = slide.$slide;\r\n\r\n            $slide\r\n                .off( 'refresh' )\r\n                .trigger( 'onReset' )\r\n                .addClass( 'fancybox-slide--' + ( type || 'unknown' ) )\r\n                .addClass( slide.opts.slideClass );\r\n\r\n            // Create content depending on the type\r\n\r\n            switch ( type ) {\r\n\r\n                case 'image':\r\n\r\n                    self.setImage( slide );\r\n\r\n                break;\r\n\r\n                case 'iframe':\r\n\r\n                    self.setIframe( slide );\r\n\r\n                break;\r\n\r\n                case 'html':\r\n\r\n                    self.setContent( slide, slide.src || slide.content );\r\n\r\n                break;\r\n\r\n                case 'inline':\r\n\r\n                    if ( $( slide.src ).length ) {\r\n                        self.setContent( slide, $( slide.src ) );\r\n\r\n                    } else {\r\n                        self.setError( slide );\r\n                    }\r\n\r\n                break;\r\n\r\n                case 'ajax':\r\n\r\n                    self.showLoading( slide );\r\n\r\n                    ajaxLoad = $.ajax( $.extend( {}, slide.opts.ajax.settings, {\r\n                        url : slide.src,\r\n                        success : function ( data, textStatus ) {\r\n\r\n                            if ( textStatus === 'success' ) {\r\n                                self.setContent( slide, data );\r\n                            }\r\n\r\n                        },\r\n                        error : function ( jqXHR, textStatus ) {\r\n\r\n                            if ( jqXHR && textStatus !== 'abort' ) {\r\n                                self.setError( slide );\r\n                            }\r\n\r\n                        }\r\n                    }));\r\n\r\n                    $slide.one( 'onReset', function () {\r\n                        ajaxLoad.abort();\r\n                    });\r\n\r\n                break;\r\n\r\n                default:\r\n\r\n                    self.setError( slide );\r\n\r\n                break;\r\n\r\n            }\r\n\r\n            return true;\r\n\r\n        },\r\n\r\n\r\n        // Use thumbnail image, if possible\r\n        // ================================\r\n\r\n        setImage : function( slide ) {\r\n\r\n            var self   = this;\r\n            var srcset = slide.opts.image.srcset;\r\n\r\n            var found, temp, pxRatio, windowWidth;\r\n\r\n            // If we have \"srcset\", then we need to find matching \"src\" value.\r\n            // This is necessary, because when you set an src attribute, the browser will preload the image\r\n            // before any javascript or even CSS is applied.\r\n            if ( srcset ) {\r\n                pxRatio     = window.devicePixelRatio || 1;\r\n                windowWidth = window.innerWidth  * pxRatio;\r\n\r\n                temp = srcset.split(',').map(function ( el ) {\r\n            \t\tvar ret = {};\r\n\r\n            \t\tel.trim().split(/\\s+/).forEach(function ( el, i ) {\r\n                        var value = parseInt( el.substring(0, el.length - 1), 10 );\r\n\r\n            \t\t\tif ( i === 0 ) {\r\n            \t\t\t\treturn ( ret.url = el );\r\n            \t\t\t}\r\n\r\n                        if ( value ) {\r\n                            ret.value   = value;\r\n                            ret.postfix = el[ el.length - 1 ];\r\n                        }\r\n\r\n            \t\t});\r\n\r\n            \t\treturn ret;\r\n            \t});\r\n\r\n                // Sort by value\r\n                temp.sort(function (a, b) {\r\n                  return a.value - b.value;\r\n                });\r\n\r\n                // Ok, now we have an array of all srcset values\r\n                for ( var j = 0; j < temp.length; j++ ) {\r\n                    var el = temp[ j ];\r\n\r\n                    if ( ( el.postfix === 'w' && el.value >= windowWidth ) || ( el.postfix === 'x' && el.value >= pxRatio ) ) {\r\n                        found = el;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                // If not found, take the last one\r\n                if ( !found && temp.length ) {\r\n                    found = temp[ temp.length - 1 ];\r\n                }\r\n\r\n                if ( found ) {\r\n                    slide.src = found.url;\r\n\r\n                    // If we have default width/height values, we can calculate height for matching source\r\n                    if ( slide.width && slide.height && found.postfix == 'w' ) {\r\n                        slide.height = ( slide.width / slide.height ) * found.value;\r\n                        slide.width  = found.value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // This will be wrapper containing both ghost and actual image\r\n            slide.$content = $('<div class=\"fancybox-image-wrap\"></div>')\r\n                .addClass( 'fancybox-is-hidden' )\r\n                .appendTo( slide.$slide );\r\n\r\n\r\n            // If we have a thumbnail, we can display it while actual image is loading\r\n            // Users will not stare at black screen and actual image will appear gradually\r\n            if ( slide.opts.preload !== false && slide.opts.width && slide.opts.height && ( slide.opts.thumb || slide.opts.$thumb ) ) {\r\n\r\n                slide.width  = slide.opts.width;\r\n                slide.height = slide.opts.height;\r\n\r\n                slide.$ghost = $('<img />')\r\n                    .one('error', function() {\r\n\r\n                        $(this).remove();\r\n\r\n                        slide.$ghost = null;\r\n\r\n                        self.setBigImage( slide );\r\n\r\n                    })\r\n                    .one('load', function() {\r\n\r\n                        self.afterLoad( slide );\r\n\r\n                        self.setBigImage( slide );\r\n\r\n                    })\r\n                    .addClass( 'fancybox-image' )\r\n                    .appendTo( slide.$content )\r\n                    .attr( 'src', slide.opts.thumb || slide.opts.$thumb.attr( 'src' ) );\r\n\r\n            } else {\r\n\r\n                self.setBigImage( slide );\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Create full-size image\r\n        // ======================\r\n\r\n        setBigImage : function ( slide ) {\r\n            var self = this;\r\n            var $img = $('<img />');\r\n\r\n            slide.$image = $img\r\n                .one('error', function() {\r\n\r\n                    self.setError( slide );\r\n\r\n                })\r\n                .one('load', function() {\r\n\r\n                    // Clear timeout that checks if loading icon needs to be displayed\r\n                    clearTimeout( slide.timouts );\r\n\r\n                    slide.timouts = null;\r\n\r\n                    if ( self.isClosing ) {\r\n                        return;\r\n                    }\r\n\r\n                    slide.width  = this.naturalWidth;\r\n                    slide.height = this.naturalHeight;\r\n\r\n                    if ( slide.opts.image.srcset ) {\r\n                        $img.attr( 'sizes', '100vw' ).attr( 'srcset', slide.opts.image.srcset );\r\n                    }\r\n\r\n                    self.hideLoading( slide );\r\n\r\n                    if ( slide.$ghost ) {\r\n\r\n                        slide.timouts = setTimeout(function() {\r\n                            slide.timouts = null;\r\n\r\n                            slide.$ghost.hide();\r\n\r\n                        }, Math.min( 300, Math.max( 1000, slide.height / 1600 ) ) );\r\n\r\n                    } else {\r\n                        self.afterLoad( slide );\r\n                    }\r\n\r\n                })\r\n                .addClass( 'fancybox-image' )\r\n                .attr('src', slide.src)\r\n                .appendTo( slide.$content );\r\n\r\n            if ( ( $img[0].complete || $img[0].readyState == \"complete\" ) && $img[0].naturalWidth && $img[0].naturalHeight ) {\r\n                  $img.trigger( 'load' );\r\n\r\n            } else if( $img[0].error ) {\r\n                 $img.trigger( 'error' );\r\n\r\n            } else {\r\n\r\n                slide.timouts = setTimeout(function() {\r\n                    if ( !$img[0].complete && !slide.hasError ) {\r\n                        self.showLoading( slide );\r\n                    }\r\n\r\n                }, 100);\r\n\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Create iframe wrapper, iframe and bindings\r\n        // ==========================================\r\n\r\n        setIframe : function( slide ) {\r\n            var self\t= this,\r\n                opts    = slide.opts.iframe,\r\n                $slide\t= slide.$slide,\r\n                $iframe;\r\n\r\n            slide.$content = $('<div class=\"fancybox-content' + ( opts.preload ? ' fancybox-is-hidden' : '' ) + '\"></div>')\r\n                .css( opts.css )\r\n                .appendTo( $slide );\r\n\r\n            $iframe = $( opts.tpl.replace(/\\{rnd\\}/g, new Date().getTime()) )\r\n                .attr( opts.attr )\r\n                .appendTo( slide.$content );\r\n\r\n            if ( opts.preload ) {\r\n\r\n                self.showLoading( slide );\r\n\r\n                // Unfortunately, it is not always possible to determine if iframe is successfully loaded\r\n                // (due to browser security policy)\r\n\r\n                $iframe.on('load.fb error.fb', function(e) {\r\n                    this.isReady = 1;\r\n\r\n                    slide.$slide.trigger( 'refresh' );\r\n\r\n                    self.afterLoad( slide );\r\n                });\r\n\r\n                // Recalculate iframe content size\r\n                // ===============================\r\n\r\n                $slide.on('refresh.fb', function() {\r\n                    var $wrap = slide.$content,\r\n                        frameWidth  = opts.css.width,\r\n                        frameHeight = opts.css.height,\r\n                        scrollWidth,\r\n                        $contents,\r\n                        $body;\r\n\r\n                    if ( $iframe[0].isReady !== 1 ) {\r\n                        return;\r\n                    }\r\n\r\n                    // Check if content is accessible,\r\n                    // it will fail if frame is not with the same origin\r\n\r\n                    try {\r\n                        $contents = $iframe.contents();\r\n                        $body     = $contents.find('body');\r\n\r\n                    } catch (ignore) {}\r\n\r\n                    // Calculate dimensions for the wrapper\r\n                    if ( $body && $body.length ) {\r\n\r\n                        if ( frameWidth === undefined ) {\r\n                            scrollWidth = $iframe[0].contentWindow.document.documentElement.scrollWidth;\r\n\r\n                            frameWidth = Math.ceil( $body.outerWidth(true) + ( $wrap.width() - scrollWidth ) );\r\n                            frameWidth += $wrap.outerWidth() - $wrap.innerWidth();\r\n                        }\r\n\r\n                        if ( frameHeight === undefined ) {\r\n                            frameHeight = Math.ceil( $body.outerHeight(true) );\r\n                            frameHeight += $wrap.outerHeight() - $wrap.innerHeight();\r\n                        }\r\n\r\n                        // Resize wrapper to fit iframe content\r\n                        if ( frameWidth ) {\r\n                            $wrap.width( frameWidth );\r\n                        }\r\n\r\n                        if ( frameHeight ) {\r\n                            $wrap.height( frameHeight );\r\n                        }\r\n                    }\r\n\r\n                    $wrap.removeClass( 'fancybox-is-hidden' );\r\n\r\n                });\r\n\r\n            } else {\r\n\r\n                this.afterLoad( slide );\r\n\r\n            }\r\n\r\n            $iframe.attr( 'src', slide.src );\r\n\r\n            if ( slide.opts.smallBtn === true ) {\r\n                slide.$content.prepend( self.translate( slide, slide.opts.btnTpl.smallBtn ) );\r\n            }\r\n\r\n            // Remove iframe if closing or changing gallery item\r\n            $slide.one( 'onReset', function () {\r\n\r\n                // This helps IE not to throw errors when closing\r\n                try {\r\n\r\n                    $( this ).find( 'iframe' ).hide().attr( 'src', '//about:blank' );\r\n\r\n                } catch ( ignore ) {}\r\n\r\n                $( this ).empty();\r\n\r\n                slide.isLoaded = false;\r\n\r\n            });\r\n\r\n        },\r\n\r\n\r\n        // Wrap and append content to the slide\r\n        // ======================================\r\n\r\n        setContent : function ( slide, content ) {\r\n\r\n            var self = this;\r\n\r\n            if ( self.isClosing ) {\r\n                return;\r\n            }\r\n\r\n            self.hideLoading( slide );\r\n\r\n            slide.$slide.empty();\r\n\r\n            if ( isQuery( content ) && content.parent().length ) {\r\n\r\n                // If content is a jQuery object, then it will be moved to the slide.\r\n                // The placeholder is created so we will know where to put it back.\r\n                // If user is navigating gallery fast, then the content might be already inside fancyBox\r\n                // =====================================================================================\r\n\r\n                // Make sure content is not already moved to fancyBox\r\n                content.parent( '.fancybox-slide--inline' ).trigger( 'onReset' );\r\n\r\n                // Create temporary element marking original place of the content\r\n                slide.$placeholder = $( '<div></div>' ).hide().insertAfter( content );\r\n\r\n                // Make sure content is visible\r\n                content.css('display', 'inline-block');\r\n\r\n            } else if ( !slide.hasError ) {\r\n\r\n                // If content is just a plain text, try to convert it to html\r\n                if ( $.type( content ) === 'string' ) {\r\n                    content = $('<div>').append( $.trim( content ) ).contents();\r\n\r\n                    // If we have text node, then add wrapping element to make vertical alignment work\r\n                    if ( content[0].nodeType === 3 ) {\r\n                        content = $('<div>').html( content );\r\n                    }\r\n                }\r\n\r\n                // If \"filter\" option is provided, then filter content\r\n                if ( slide.opts.filter ) {\r\n                    content = $('<div>').html( content ).find( slide.opts.filter );\r\n                }\r\n\r\n            }\r\n\r\n            slide.$slide.one('onReset', function () {\r\n\r\n                // Put content back\r\n                if ( slide.$placeholder ) {\r\n                    slide.$placeholder.after( content.hide() ).remove();\r\n\r\n                    slide.$placeholder = null;\r\n                }\r\n\r\n                // Remove custom close button\r\n                if ( slide.$smallBtn ) {\r\n                    slide.$smallBtn.remove();\r\n\r\n                    slide.$smallBtn = null;\r\n                }\r\n\r\n                // Remove content and mark slide as not loaded\r\n                if ( !slide.hasError ) {\r\n                    $(this).empty();\r\n\r\n                    slide.isLoaded = false;\r\n                }\r\n\r\n            });\r\n\r\n            slide.$content = $( content ).appendTo( slide.$slide );\r\n\r\n            if ( slide.opts.smallBtn && !slide.$smallBtn ) {\r\n                slide.$smallBtn = $( self.translate( slide, slide.opts.btnTpl.smallBtn ) ).appendTo( slide.$content.filter('div').first() );\r\n            }\r\n\r\n            this.afterLoad( slide );\r\n        },\r\n\r\n        // Display error message\r\n        // =====================\r\n\r\n        setError : function ( slide ) {\r\n\r\n            slide.hasError = true;\r\n\r\n            slide.$slide.removeClass( 'fancybox-slide--' + slide.type );\r\n\r\n            this.setContent( slide, this.translate( slide, slide.opts.errorTpl ) );\r\n\r\n        },\r\n\r\n\r\n        // Show loading icon inside the slide\r\n        // ==================================\r\n\r\n        showLoading : function( slide ) {\r\n\r\n            var self = this;\r\n\r\n            slide = slide || self.current;\r\n\r\n            if ( slide && !slide.$spinner ) {\r\n                slide.$spinner = $( self.opts.spinnerTpl ).appendTo( slide.$slide );\r\n            }\r\n\r\n        },\r\n\r\n        // Remove loading icon from the slide\r\n        // ==================================\r\n\r\n        hideLoading : function( slide ) {\r\n\r\n            var self = this;\r\n\r\n            slide = slide || self.current;\r\n\r\n            if ( slide && slide.$spinner ) {\r\n                slide.$spinner.remove();\r\n\r\n                delete slide.$spinner;\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Adjustments after slide content has been loaded\r\n        // ===============================================\r\n\r\n        afterLoad : function( slide ) {\r\n\r\n            var self = this;\r\n\r\n            if ( self.isClosing ) {\r\n                return;\r\n            }\r\n\r\n            slide.isLoading = false;\r\n            slide.isLoaded  = true;\r\n\r\n            self.trigger( 'afterLoad', slide );\r\n\r\n            self.hideLoading( slide );\r\n\r\n            if ( slide.opts.protect && slide.$content && !slide.hasError ) {\r\n\r\n                // Disable right click\r\n                slide.$content.on( 'contextmenu.fb', function( e ) {\r\n                     if ( e.button == 2 ) {\r\n                         e.preventDefault();\r\n                     }\r\n\r\n                    return true;\r\n                });\r\n\r\n                // Add fake element on top of the image\r\n                // This makes a bit harder for user to select image\r\n                if ( slide.type === 'image' ) {\r\n                    $( '<div class=\"fancybox-spaceball\"></div>' ).appendTo( slide.$content );\r\n                }\r\n\r\n            }\r\n\r\n            self.revealContent( slide );\r\n\r\n        },\r\n\r\n\r\n        // Make content visible\r\n        // This method is called right after content has been loaded or\r\n        // user navigates gallery and transition should start\r\n        // ============================================================\r\n\r\n        revealContent : function( slide ) {\r\n\r\n            var self   = this;\r\n            var $slide = slide.$slide;\r\n\r\n            var effect, effectClassName, duration, opacity, end, start = false;\r\n\r\n            effect   = slide.opts[ self.firstRun ? 'animationEffect'   : 'transitionEffect' ];\r\n            duration = slide.opts[ self.firstRun ? 'animationDuration' : 'transitionDuration' ];\r\n\r\n            duration = parseInt( slide.forcedDuration === undefined ? duration : slide.forcedDuration, 10 );\r\n\r\n            if ( slide.isMoved || slide.pos !== self.currPos || !duration ) {\r\n                effect = false;\r\n            }\r\n\r\n            // Check if can zoom\r\n            if ( effect === 'zoom' && !( slide.pos === self.currPos && duration && slide.type === 'image' && !slide.hasError && ( start = self.getThumbPos( slide ) ) ) ) {\r\n                effect = 'fade';\r\n            }\r\n\r\n            // Zoom animation\r\n            // ==============\r\n\r\n            if ( effect === 'zoom' ) {\r\n                end = self.getFitPos( slide );\r\n\r\n                end.scaleX = end.width  / start.width;\r\n                end.scaleY = end.height / start.height;\r\n\r\n                delete end.width;\r\n                delete end.height;\r\n\r\n                // Check if we need to animate opacity\r\n                opacity = slide.opts.zoomOpacity;\r\n\r\n                if ( opacity == 'auto' ) {\r\n                    opacity = Math.abs( slide.width / slide.height - start.width / start.height ) > 0.1;\r\n                }\r\n\r\n                if ( opacity ) {\r\n                    start.opacity = 0.1;\r\n                    end.opacity   = 1;\r\n                }\r\n\r\n                // Draw image at start position\r\n                $.fancybox.setTranslate( slide.$content.removeClass( 'fancybox-is-hidden' ), start );\r\n\r\n                forceRedraw( slide.$content );\r\n\r\n                // Start animation\r\n                $.fancybox.animate( slide.$content, end, duration, function() {\r\n                    self.complete();\r\n                });\r\n\r\n                return;\r\n            }\r\n\r\n\r\n            self.updateSlide( slide );\r\n\r\n\r\n            // Simply show content\r\n            // ===================\r\n\r\n            if ( !effect ) {\r\n                forceRedraw( $slide );\r\n\r\n                slide.$content.removeClass( 'fancybox-is-hidden' );\r\n\r\n                if ( slide.pos === self.currPos ) {\r\n                    self.complete();\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            $.fancybox.stop( $slide );\r\n\r\n            effectClassName = 'fancybox-animated fancybox-slide--' + ( slide.pos > self.prevPos ? 'next' : 'previous' ) + ' fancybox-fx-' + effect;\r\n\r\n            $slide.removeAttr( 'style' ).removeClass( 'fancybox-slide--current fancybox-slide--next fancybox-slide--previous' ).addClass( effectClassName );\r\n\r\n            slide.$content.removeClass( 'fancybox-is-hidden' );\r\n\r\n            //Force reflow for CSS3 transitions\r\n            forceRedraw( $slide );\r\n\r\n            $.fancybox.animate( $slide, 'fancybox-slide--current', duration, function(e) {\r\n                $slide.removeClass( effectClassName ).removeAttr( 'style' );\r\n\r\n                if ( slide.pos === self.currPos ) {\r\n                    self.complete();\r\n                }\r\n\r\n            }, true);\r\n\r\n        },\r\n\r\n\r\n        // Check if we can and have to zoom from thumbnail\r\n        //================================================\r\n\r\n        getThumbPos : function( slide ) {\r\n\r\n            var self = this;\r\n            var rez  = false;\r\n\r\n            // Check if element is inside the viewport by at least 1 pixel\r\n            var isElementVisible = function( $el ) {\r\n                var element = $el[0];\r\n\r\n                var elementRect = element.getBoundingClientRect();\r\n                var parentRects = [];\r\n\r\n                var visibleInAllParents;\r\n\r\n                while ( element.parentElement !== null ) {\r\n                    if ( $(element.parentElement).css('overflow') === 'hidden'  || $(element.parentElement).css('overflow') === 'auto' ) {\r\n                        parentRects.push(element.parentElement.getBoundingClientRect());\r\n                    }\r\n\r\n                    element = element.parentElement;\r\n                }\r\n\r\n                visibleInAllParents = parentRects.every(function(parentRect){\r\n                    var visiblePixelX = Math.min(elementRect.right, parentRect.right) - Math.max(elementRect.left, parentRect.left);\r\n                    var visiblePixelY = Math.min(elementRect.bottom, parentRect.bottom) - Math.max(elementRect.top, parentRect.top);\r\n\r\n                    return visiblePixelX > 0 && visiblePixelY > 0;\r\n                });\r\n\r\n                return visibleInAllParents &&\r\n                    elementRect.bottom > 0 && elementRect.right > 0 &&\r\n                    elementRect.left < $(window).width() && elementRect.top < $(window).height();\r\n            };\r\n\r\n            var $thumb   = slide.opts.$thumb;\r\n            var thumbPos = $thumb ? $thumb.offset() : 0;\r\n            var slidePos;\r\n\r\n            if ( thumbPos && $thumb[0].ownerDocument === document && isElementVisible( $thumb ) ) {\r\n                slidePos = self.$refs.stage.offset();\r\n\r\n                rez = {\r\n                    top    : thumbPos.top  - slidePos.top  + parseFloat( $thumb.css( \"border-top-width\" ) || 0 ),\r\n                    left   : thumbPos.left - slidePos.left + parseFloat( $thumb.css( \"border-left-width\" ) || 0 ),\r\n                    width  : $thumb.width(),\r\n                    height : $thumb.height(),\r\n                    scaleX : 1,\r\n                    scaleY : 1\r\n                };\r\n            }\r\n\r\n            return rez;\r\n        },\r\n\r\n\r\n        // Final adjustments after current gallery item is moved to position\r\n        // and it`s content is loaded\r\n        // ==================================================================\r\n\r\n        complete : function() {\r\n\r\n            var self = this;\r\n\r\n            var current = self.current;\r\n            var slides  = {};\r\n\r\n            if ( current.isMoved || !current.isLoaded || current.isComplete ) {\r\n                return;\r\n            }\r\n\r\n            current.isComplete = true;\r\n\r\n            current.$slide.siblings().trigger( 'onReset' );\r\n\r\n            // Trigger any CSS3 transiton inside the slide\r\n            forceRedraw( current.$slide );\r\n\r\n            current.$slide.addClass( 'fancybox-slide--complete' );\r\n\r\n            // Remove unnecessary slides\r\n            $.each( self.slides, function( key, slide ) {\r\n                if ( slide.pos >= self.currPos - 1 && slide.pos <= self.currPos + 1 ) {\r\n                    slides[ slide.pos ] = slide;\r\n\r\n                } else if ( slide ) {\r\n\r\n                    $.fancybox.stop( slide.$slide );\r\n\r\n                    slide.$slide.off().remove();\r\n                }\r\n            });\r\n\r\n            self.slides = slides;\r\n\r\n            self.updateCursor();\r\n\r\n            self.trigger( 'afterShow' );\r\n\r\n            // Try to focus on the first focusable element\r\n            if ( $( document.activeElement ).is( '[disabled]' ) || ( current.opts.autoFocus && !( current.type == 'image' || current.type === 'iframe' ) ) ) {\r\n                self.focus();\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Preload next and previous slides\r\n        // ================================\r\n\r\n        preload : function() {\r\n            var self = this;\r\n            var next, prev;\r\n\r\n            if ( self.group.length < 2 ) {\r\n                return;\r\n            }\r\n\r\n            next  = self.slides[ self.currPos + 1 ];\r\n            prev  = self.slides[ self.currPos - 1 ];\r\n\r\n            if ( next && next.type === 'image' ) {\r\n                self.loadSlide( next );\r\n            }\r\n\r\n            if ( prev && prev.type === 'image' ) {\r\n                self.loadSlide( prev );\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Try to find and focus on the first focusable element\r\n        // ====================================================\r\n\r\n        focus : function() {\r\n            var current = this.current;\r\n            var $el;\r\n\r\n            if ( this.isClosing ) {\r\n                return;\r\n            }\r\n\r\n            if ( current && current.isComplete ) {\r\n\r\n                // Look for first input with autofocus attribute\r\n                $el = current.$slide.find('input[autofocus]:enabled:visible:first');\r\n\r\n                if ( !$el.length ) {\r\n                    $el = current.$slide.find('button,:input,[tabindex],a').filter(':enabled:visible:first');\r\n                }\r\n            }\r\n\r\n            $el = $el && $el.length ? $el : this.$refs.container;\r\n\r\n            $el.focus();\r\n        },\r\n\r\n\r\n        // Activates current instance - brings container to the front and enables keyboard,\r\n        // notifies other instances about deactivating\r\n        // =================================================================================\r\n\r\n        activate : function () {\r\n            var self = this;\r\n\r\n            // Deactivate all instances\r\n            $( '.fancybox-container' ).each(function () {\r\n                var instance = $(this).data( 'FancyBox' );\r\n\r\n                // Skip self and closing instances\r\n                if (instance && instance.uid !== self.uid && !instance.isClosing) {\r\n                    instance.trigger( 'onDeactivate' );\r\n                }\r\n\r\n            });\r\n\r\n            if ( self.current ) {\r\n                if ( self.$refs.container.index() > 0 ) {\r\n                    self.$refs.container.prependTo( document.body );\r\n                }\r\n\r\n                self.updateControls();\r\n            }\r\n\r\n            self.trigger( 'onActivate' );\r\n\r\n            self.addEvents();\r\n\r\n        },\r\n\r\n\r\n        // Start closing procedure\r\n        // This will start \"zoom-out\" animation if needed and clean everything up afterwards\r\n        // =================================================================================\r\n\r\n        close : function( e, d ) {\r\n\r\n            var self    = this;\r\n            var current = self.current;\r\n\r\n            var effect, duration;\r\n            var $what, opacity, start, end;\r\n\r\n            var done = function() {\r\n                self.cleanUp( e );\r\n            };\r\n\r\n            if ( self.isClosing ) {\r\n                return false;\r\n            }\r\n\r\n            self.isClosing = true;\r\n\r\n            // If beforeClose callback prevents closing, make sure content is centered\r\n            if ( self.trigger( 'beforeClose', e ) === false ) {\r\n                self.isClosing = false;\r\n\r\n                requestAFrame(function() {\r\n                    self.update();\r\n                });\r\n\r\n                return false;\r\n            }\r\n\r\n            // Remove all events\r\n            // If there are multiple instances, they will be set again by \"activate\" method\r\n            self.removeEvents();\r\n\r\n            if ( current.timouts ) {\r\n                clearTimeout( current.timouts );\r\n            }\r\n\r\n            $what    = current.$content;\r\n            effect   = current.opts.animationEffect;\r\n            duration = $.isNumeric( d ) ? d : ( effect ? current.opts.animationDuration : 0 );\r\n\r\n            // Remove other slides\r\n            current.$slide.off( transitionEnd ).removeClass( 'fancybox-slide--complete fancybox-slide--next fancybox-slide--previous fancybox-animated' );\r\n\r\n            current.$slide.siblings().trigger( 'onReset' ).remove();\r\n\r\n            // Trigger animations\r\n            if ( duration ) {\r\n                self.$refs.container.removeClass( 'fancybox-is-open' ).addClass( 'fancybox-is-closing' );\r\n            }\r\n\r\n            // Clean up\r\n            self.hideLoading( current );\r\n\r\n            self.hideControls();\r\n\r\n            self.updateCursor();\r\n\r\n            // Check if possible to zoom-out\r\n            if ( effect === 'zoom' && !( e !== true && $what && duration && current.type === 'image' && !current.hasError && ( end = self.getThumbPos( current ) ) ) ) {\r\n                effect = 'fade';\r\n            }\r\n\r\n            if ( effect === 'zoom' ) {\r\n                $.fancybox.stop( $what );\r\n\r\n                start = $.fancybox.getTranslate( $what );\r\n\r\n                start.width  = start.width  * start.scaleX;\r\n                start.height = start.height * start.scaleY;\r\n\r\n                // Check if we need to animate opacity\r\n                opacity = current.opts.zoomOpacity;\r\n\r\n                if ( opacity == 'auto' ) {\r\n                    opacity = Math.abs( current.width / current.height - end.width / end.height ) > 0.1;\r\n                }\r\n\r\n                if ( opacity ) {\r\n                    end.opacity = 0;\r\n                }\r\n\r\n                start.scaleX = start.width  / end.width;\r\n                start.scaleY = start.height / end.height;\r\n\r\n                start.width  = end.width;\r\n                start.height = end.height;\r\n\r\n                $.fancybox.setTranslate( current.$content, start );\r\n\r\n                $.fancybox.animate( current.$content, end, duration, done );\r\n\r\n                return true;\r\n            }\r\n\r\n            if ( effect && duration ) {\r\n\r\n                // If skip animation\r\n                if ( e === true ) {\r\n                    setTimeout( done, duration );\r\n\r\n                } else {\r\n                    $.fancybox.animate( current.$slide.removeClass( 'fancybox-slide--current' ), 'fancybox-animated fancybox-slide--previous fancybox-fx-' + effect, duration, done );\r\n                }\r\n\r\n            } else {\r\n                done();\r\n            }\r\n\r\n            return true;\r\n        },\r\n\r\n\r\n        // Final adjustments after removing the instance\r\n        // =============================================\r\n\r\n        cleanUp : function( e ) {\r\n            var self = this,\r\n                instance;\r\n\r\n            self.current.$slide.trigger( 'onReset' );\r\n\r\n            self.$refs.container.empty().remove();\r\n\r\n            self.trigger( 'afterClose', e );\r\n\r\n            // Place back focus\r\n            if ( self.$lastFocus && !!self.current.opts.backFocus ) {\r\n                self.$lastFocus.focus();\r\n            }\r\n\r\n            self.current = null;\r\n\r\n            // Check if there are other instances\r\n            instance = $.fancybox.getInstance();\r\n\r\n            if ( instance ) {\r\n                instance.activate();\r\n\r\n            } else {\r\n                $W.scrollTop( self.scrollTop ).scrollLeft( self.scrollLeft );\r\n\r\n                $( 'html' ).removeClass( 'fancybox-enabled' );\r\n\r\n                $( '#fancybox-style-noscroll' ).remove();\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Call callback and trigger an event\r\n        // ==================================\r\n\r\n        trigger : function( name, slide ) {\r\n            var args  = Array.prototype.slice.call(arguments, 1),\r\n                self  = this,\r\n                obj   = slide && slide.opts ? slide : self.current,\r\n                rez;\r\n\r\n            if ( obj ) {\r\n                args.unshift( obj );\r\n\r\n            } else {\r\n                obj = self;\r\n            }\r\n\r\n            args.unshift( self );\r\n\r\n            if ( $.isFunction( obj.opts[ name ] ) ) {\r\n                rez = obj.opts[ name ].apply( obj, args );\r\n            }\r\n\r\n            if ( rez === false ) {\r\n                return rez;\r\n            }\r\n\r\n            if ( name === 'afterClose' ) {\r\n                $D.trigger( name + '.fb', args );\r\n\r\n            } else {\r\n                self.$refs.container.trigger( name + '.fb', args );\r\n            }\r\n\r\n        },\r\n\r\n\r\n        // Update infobar values, navigation button states and reveal caption\r\n        // ==================================================================\r\n\r\n        updateControls : function ( force ) {\r\n\r\n            var self = this;\r\n\r\n            var current  = self.current;\r\n            var index    = current.index;\r\n            var opts     = current.opts;\r\n            var caption  = opts.caption;\r\n            var $caption = self.$refs.caption;\r\n\r\n            // Recalculate content dimensions\r\n            current.$slide.trigger( 'refresh' );\r\n\r\n            self.$caption = caption && caption.length ? $caption.html( caption ) : null;\r\n\r\n            if ( !self.isHiddenControls ) {\r\n                self.showControls();\r\n            }\r\n\r\n            // Update info and navigation elements\r\n            $('[data-fancybox-count]').html( self.group.length );\r\n            $('[data-fancybox-index]').html( index + 1 );\r\n\r\n            $('[data-fancybox-prev]').prop('disabled', ( !opts.loop && index <= 0 ) );\r\n            $('[data-fancybox-next]').prop('disabled', ( !opts.loop && index >= self.group.length - 1 ) );\r\n\r\n        },\r\n\r\n        // Hide toolbar and caption\r\n        // ========================\r\n\r\n        hideControls : function () {\r\n\r\n            this.isHiddenControls = true;\r\n\r\n            this.$refs.container.removeClass('fancybox-show-infobar fancybox-show-toolbar fancybox-show-caption fancybox-show-nav');\r\n\r\n        },\r\n\r\n        showControls : function() {\r\n\r\n            var self = this;\r\n            var opts = self.current ? self.current.opts : self.opts;\r\n            var $container = self.$refs.container;\r\n\r\n            self.isHiddenControls   = false;\r\n            self.idleSecondsCounter = 0;\r\n\r\n            $container\r\n                .toggleClass('fancybox-show-toolbar', !!( opts.toolbar && opts.buttons ) )\r\n                .toggleClass('fancybox-show-infobar', !!( opts.infobar && self.group.length > 1 ) )\r\n                .toggleClass('fancybox-show-nav',     !!( opts.arrows && self.group.length > 1 ) )\r\n                .toggleClass('fancybox-is-modal',     !!opts.modal );\r\n\r\n            if ( self.$caption ) {\r\n                $container.addClass( 'fancybox-show-caption ');\r\n\r\n            } else {\r\n               $container.removeClass( 'fancybox-show-caption' );\r\n           }\r\n\r\n       },\r\n\r\n\r\n       // Toggle toolbar and caption\r\n       // ==========================\r\n\r\n       toggleControls : function() {\r\n\r\n           if ( this.isHiddenControls ) {\r\n               this.showControls();\r\n\r\n           } else {\r\n               this.hideControls();\r\n           }\r\n\r\n       },\r\n\r\n\r\n    });\r\n\r\n\r\n    $.fancybox = {\r\n\r\n        version  : \"3.1.28\",\r\n        defaults : defaults,\r\n\r\n\r\n        // Get current instance and execute a command.\r\n        //\r\n        // Examples of usage:\r\n        //\r\n        //   $instance = $.fancybox.getInstance();\r\n        //   $.fancybox.getInstance().jumpTo( 1 );\r\n        //   $.fancybox.getInstance( 'jumpTo', 1 );\r\n        //   $.fancybox.getInstance( function() {\r\n        //       console.info( this.currIndex );\r\n        //   });\r\n        // ======================================================\r\n\r\n        getInstance : function ( command ) {\r\n            var instance = $('.fancybox-container:not(\".fancybox-is-closing\"):first').data( 'FancyBox' );\r\n            var args     = Array.prototype.slice.call(arguments, 1);\r\n\r\n            if ( instance instanceof FancyBox ) {\r\n\r\n                if ( $.type( command ) === 'string' ) {\r\n                    instance[ command ].apply( instance, args );\r\n\r\n                } else if ( $.type( command ) === 'function' ) {\r\n                    command.apply( instance, args );\r\n\r\n                }\r\n\r\n                return instance;\r\n            }\r\n\r\n            return false;\r\n\r\n        },\r\n\r\n\r\n        // Create new instance\r\n        // ===================\r\n\r\n        open : function ( items, opts, index ) {\r\n            return new FancyBox( items, opts, index );\r\n        },\r\n\r\n\r\n        // Close current or all instances\r\n        // ==============================\r\n\r\n        close : function ( all ) {\r\n            var instance = this.getInstance();\r\n\r\n            if ( instance ) {\r\n                instance.close();\r\n\r\n                // Try to find and close next instance\r\n\r\n                if ( all === true ) {\r\n                    this.close();\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        // Close instances and unbind all events\r\n        // ==============================\r\n\r\n        destroy : function() {\r\n\r\n            this.close( true );\r\n\r\n            $D.off( 'click.fb-start' );\r\n\r\n        },\r\n\r\n\r\n        // Try to detect mobile devices\r\n        // ============================\r\n\r\n        isMobile : document.createTouch !== undefined && /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),\r\n\r\n\r\n        // Detect if 'translate3d' support is available\r\n        // ============================================\r\n\r\n        use3d : (function() {\r\n            var div = document.createElement('div');\r\n\r\n            return window.getComputedStyle && window.getComputedStyle( div ).getPropertyValue('transform') && !(document.documentMode && document.documentMode < 11);\r\n        }()),\r\n\r\n\r\n        // Helper function to get current visual state of an element\r\n        // returns array[ top, left, horizontal-scale, vertical-scale, opacity ]\r\n        // =====================================================================\r\n\r\n        getTranslate : function( $el ) {\r\n            var matrix;\r\n\r\n            if ( !$el || !$el.length ) {\r\n                return false;\r\n            }\r\n\r\n            matrix  = $el.eq( 0 ).css('transform');\r\n\r\n            if ( matrix && matrix.indexOf( 'matrix' ) !== -1 ) {\r\n                matrix = matrix.split('(')[1];\r\n                matrix = matrix.split(')')[0];\r\n                matrix = matrix.split(',');\r\n            } else {\r\n                matrix = [];\r\n            }\r\n\r\n            if ( matrix.length ) {\r\n\r\n                // If IE\r\n                if ( matrix.length > 10 ) {\r\n                    matrix = [ matrix[13], matrix[12], matrix[0], matrix[5] ];\r\n\r\n                } else {\r\n                    matrix = [ matrix[5], matrix[4], matrix[0], matrix[3]];\r\n                }\r\n\r\n                matrix = matrix.map(parseFloat);\r\n\r\n            } else {\r\n                matrix = [ 0, 0, 1, 1 ];\r\n\r\n                var transRegex = /\\.*translate\\((.*)px,(.*)px\\)/i;\r\n                var transRez = transRegex.exec( $el.eq( 0 ).attr('style') );\r\n\r\n                if ( transRez ) {\r\n                    matrix[ 0 ] = parseFloat( transRez[2] );\r\n                    matrix[ 1 ] = parseFloat( transRez[1] );\r\n                }\r\n            }\r\n\r\n            return {\r\n                top     : matrix[ 0 ],\r\n                left    : matrix[ 1 ],\r\n                scaleX  : matrix[ 2 ],\r\n                scaleY  : matrix[ 3 ],\r\n                opacity : parseFloat( $el.css('opacity') ),\r\n                width   : $el.width(),\r\n                height  : $el.height()\r\n            };\r\n\r\n        },\r\n\r\n\r\n        // Shortcut for setting \"translate3d\" properties for element\r\n        // Can set be used to set opacity, too\r\n        // ========================================================\r\n\r\n        setTranslate : function( $el, props ) {\r\n            var str  = '';\r\n            var css  = {};\r\n\r\n            if ( !$el || !props ) {\r\n                return;\r\n            }\r\n\r\n            if ( props.left !== undefined || props.top !== undefined ) {\r\n                str = ( props.left === undefined ? $el.position().left : props.left )  + 'px, ' + ( props.top === undefined ? $el.position().top : props.top ) + 'px';\r\n\r\n                if ( this.use3d ) {\r\n                    str = 'translate3d(' + str + ', 0px)';\r\n\r\n                } else {\r\n                    str = 'translate(' + str + ')';\r\n                }\r\n            }\r\n\r\n            if ( props.scaleX !== undefined && props.scaleY !== undefined ) {\r\n                str = (str.length ? str + ' ' : '') + 'scale(' + props.scaleX + ', ' + props.scaleY + ')';\r\n            }\r\n\r\n            if ( str.length ) {\r\n                css.transform = str;\r\n            }\r\n\r\n            if ( props.opacity !== undefined ) {\r\n                css.opacity = props.opacity;\r\n            }\r\n\r\n            if ( props.width !== undefined ) {\r\n                css.width = props.width;\r\n            }\r\n\r\n            if ( props.height !== undefined ) {\r\n                css.height = props.height;\r\n            }\r\n\r\n            return $el.css( css );\r\n        },\r\n\r\n\r\n        // Simple CSS transition handler\r\n        // =============================\r\n\r\n        animate : function ( $el, to, duration, callback, leaveAnimationName ) {\r\n            var event = transitionEnd || 'transitionend';\r\n\r\n            if ( $.isFunction( duration ) ) {\r\n                callback = duration;\r\n                duration = null;\r\n            }\r\n\r\n            if ( !$.isPlainObject( to ) ) {\r\n                $el.removeAttr('style');\r\n            }\r\n\r\n            $el.on( event, function(e) {\r\n\r\n                // Skip events from child elements and z-index change\r\n                if ( e && e.originalEvent && ( !$el.is( e.originalEvent.target ) || e.originalEvent.propertyName == 'z-index' ) ) {\r\n                    return;\r\n                }\r\n\r\n                $el.off( event );\r\n\r\n                if ( $.isPlainObject( to ) ) {\r\n\r\n                    if ( to.scaleX !== undefined && to.scaleY !== undefined ) {\r\n                        $el.css( 'transition-duration', '0ms' );\r\n\r\n                        to.width  = Math.round( $el.width()  * to.scaleX );\r\n                        to.height = Math.round( $el.height() * to.scaleY );\r\n\r\n                        to.scaleX = 1;\r\n                        to.scaleY = 1;\r\n\r\n                        $.fancybox.setTranslate( $el, to );\r\n                    }\r\n\r\n                } else if ( leaveAnimationName !== true ) {\r\n                    $el.removeClass( to );\r\n                }\r\n\r\n                if ( $.isFunction( callback ) ) {\r\n                    callback( e );\r\n                }\r\n\r\n            });\r\n\r\n            if ( $.isNumeric( duration ) ) {\r\n                $el.css( 'transition-duration', duration + 'ms' );\r\n            }\r\n\r\n            if ( $.isPlainObject( to ) ) {\r\n                $.fancybox.setTranslate( $el, to );\r\n\r\n            } else {\r\n                $el.addClass( to );\r\n            }\r\n\r\n            $el.data(\"timer\", setTimeout(function() {\r\n                $el.trigger( 'transitionend' );\r\n            }, duration + 16));\r\n\r\n        },\r\n\r\n        stop : function( $el ) {\r\n            clearTimeout( $el.data(\"timer\") );\r\n\r\n            $el.off( transitionEnd );\r\n        }\r\n\r\n    };\r\n\r\n\r\n    // Default click handler for \"fancyboxed\" links\r\n    // ============================================\r\n\r\n    function _run( e ) {\r\n        var target\t= e.currentTarget,\r\n            opts\t= e.data ? e.data.options : {},\r\n            items\t= opts.selector ? $( opts.selector ) : ( e.data ? e.data.items : [] ),\r\n            value\t= $( target ).attr( 'data-fancybox' ) || '',\r\n            index\t= 0,\r\n            active  = $.fancybox.getInstance();\r\n\r\n        e.preventDefault();\r\n\r\n        // Avoid opening multiple times\r\n        if ( active && active.current.opts.$orig.is( target ) ) {\r\n            return;\r\n        }\r\n\r\n        // Get all related items and find index for clicked one\r\n        if ( value ) {\r\n            items = items.length ? items.filter( '[data-fancybox=\"' + value + '\"]' ) : $( '[data-fancybox=\"' + value + '\"]' );\r\n            index = items.index( target );\r\n\r\n            // Sometimes current item can not be found\r\n            // (for example, when slider clones items)\r\n            if ( index < 0 ) {\r\n                index = 0;\r\n            }\r\n\r\n        } else {\r\n            items = [ target ];\r\n        }\r\n\r\n        $.fancybox.open( items, opts, index );\r\n    }\r\n\r\n\r\n    // Create a jQuery plugin\r\n    // ======================\r\n\r\n    $.fn.fancybox = function (options) {\r\n        var selector;\r\n\r\n        options  = options || {};\r\n        selector = options.selector || false;\r\n\r\n        if ( selector ) {\r\n\r\n            $( 'body' ).off( 'click.fb-start', selector ).on( 'click.fb-start', selector, {\r\n                options : options\r\n            }, _run );\r\n\r\n        } else {\r\n\r\n            this.off( 'click.fb-start' ).on( 'click.fb-start', {\r\n                items   : this,\r\n                options : options\r\n            }, _run);\r\n\r\n        }\r\n\r\n        return this;\r\n    };\r\n\r\n\r\n    // Self initializing plugin\r\n    // ========================\r\n\r\n    $D.on( 'click.fb-start', '[data-fancybox]', _run );\r\n\r\n}( window, document, window.jQuery || jQuery ));\r\n\r\n// ==========================================================================\r\n//\r\n// Media\r\n// Adds additional media type support\r\n//\r\n// ==========================================================================\r\n;(function ($) {\r\n\r\n\t'use strict';\r\n\r\n\t// Formats matching url to final form\r\n\r\n\tvar format = function (url, rez, params) {\r\n\t\tif ( !url ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tparams = params || '';\r\n\r\n\t\tif ( $.type(params) === \"object\" ) {\r\n\t\t\tparams = $.param(params, true);\r\n\t\t}\r\n\r\n\t\t$.each(rez, function (key, value) {\r\n\t\t\turl = url.replace('$' + key, value || '');\r\n\t\t});\r\n\r\n\t\tif (params.length) {\r\n\t\t\turl += (url.indexOf('?') > 0 ? '&' : '?') + params;\r\n\t\t}\r\n\r\n\t\treturn url;\r\n\t};\r\n\r\n\t// Object containing properties for each media type\r\n\r\n\tvar defaults = {\r\n\t\tyoutube : {\r\n\t\t\tmatcher : /(youtube\\.com|youtu\\.be|youtube\\-nocookie\\.com)\\/(watch\\?(.*&)?v=|v\\/|u\\/|embed\\/?)?(videoseries\\?list=(.*)|[\\w-]{11}|\\?listType=(.*)&list=(.*))(.*)/i,\r\n\t\t\tparams  : {\r\n\t\t\t\tautoplay : 1,\r\n\t\t\t\tautohide : 1,\r\n\t\t\t\tfs  : 1,\r\n\t\t\t\trel : 0,\r\n\t\t\t\thd  : 1,\r\n\t\t\t\twmode : 'transparent',\r\n\t\t\t\tenablejsapi : 1,\r\n\t\t\t\thtml5 : 1\r\n\t\t\t},\r\n\t\t\tparamPlace : 8,\r\n\t\t\ttype  : 'iframe',\r\n\t\t\turl   : '//www.youtube.com/embed/$4',\r\n\t\t\tthumb : '//img.youtube.com/vi/$4/hqdefault.jpg'\r\n\t\t},\r\n\r\n\t\tvimeo : {\r\n\t\t\tmatcher : /^.+vimeo.com\\/(.*\\/)?([\\d]+)(.*)?/,\r\n\t\t\tparams  : {\r\n\t\t\t\tautoplay : 1,\r\n\t\t\t\thd : 1,\r\n\t\t\t\tshow_title    : 1,\r\n\t\t\t\tshow_byline   : 1,\r\n\t\t\t\tshow_portrait : 0,\r\n\t\t\t\tfullscreen    : 1,\r\n\t\t\t\tapi : 1\r\n\t\t\t},\r\n\t\t\tparamPlace : 3,\r\n\t\t\ttype : 'iframe',\r\n\t\t\turl : '//player.vimeo.com/video/$2'\r\n\t\t},\r\n\r\n\t\tmetacafe : {\r\n\t\t\tmatcher : /metacafe.com\\/watch\\/(\\d+)\\/(.*)?/,\r\n\t\t\ttype    : 'iframe',\r\n\t\t\turl     : '//www.metacafe.com/embed/$1/?ap=1'\r\n\t\t},\r\n\r\n\t\tdailymotion : {\r\n\t\t\tmatcher : /dailymotion.com\\/video\\/(.*)\\/?(.*)/,\r\n\t\t\tparams : {\r\n\t\t\t\tadditionalInfos : 0,\r\n\t\t\t\tautoStart : 1\r\n\t\t\t},\r\n\t\t\ttype : 'iframe',\r\n\t\t\turl  : '//www.dailymotion.com/embed/video/$1'\r\n\t\t},\r\n\r\n\t\tvine : {\r\n\t\t\tmatcher : /vine.co\\/v\\/([a-zA-Z0-9\\?\\=\\-]+)/,\r\n\t\t\ttype    : 'iframe',\r\n\t\t\turl     : '//vine.co/v/$1/embed/simple'\r\n\t\t},\r\n\r\n\t\tinstagram : {\r\n\t\t\tmatcher : /(instagr\\.am|instagram\\.com)\\/p\\/([a-zA-Z0-9_\\-]+)\\/?/i,\r\n\t\t\ttype    : 'image',\r\n\t\t\turl     : '//$1/p/$2/media/?size=l'\r\n\t\t},\r\n\r\n\t\t// Examples:\r\n\t\t// http://maps.google.com/?ll=48.857995,2.294297&spn=0.007666,0.021136&t=m&z=16\r\n\t\t// https://www.google.com/maps/@37.7852006,-122.4146355,14.65z\r\n\t\t// https://www.google.com/maps/place/Googleplex/@37.4220041,-122.0833494,17z/data=!4m5!3m4!1s0x0:0x6c296c66619367e0!8m2!3d37.4219998!4d-122.0840572\r\n\t\tgmap_place : {\r\n\t\t\tmatcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(((maps\\/(place\\/(.*)\\/)?\\@(.*),(\\d+.?\\d+?)z))|(\\?ll=))(.*)?/i,\r\n\t\t\ttype    : 'iframe',\r\n\t\t\turl     : function (rez) {\r\n\t\t\t\treturn '//maps.google.' + rez[2] + '/?ll=' + ( rez[9] ? rez[9] + '&z=' + Math.floor(  rez[10]  ) + ( rez[12] ? rez[12].replace(/^\\//, \"&\") : '' )  : rez[12] ) + '&output=' + ( rez[12] && rez[12].indexOf('layer=c') > 0 ? 'svembed' : 'embed' );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Examples:\r\n\t\t// https://www.google.com/maps/search/Empire+State+Building/\r\n\t\t// https://www.google.com/maps/search/?api=1&query=centurylink+field\r\n\t\t// https://www.google.com/maps/search/?api=1&query=47.5951518,-122.3316393\r\n\t\tgmap_search : {\r\n\t\t\tmatcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(maps\\/search\\/)(.*)/i,\r\n\t\t\ttype    : 'iframe',\r\n\t\t\turl     : function (rez) {\r\n\t\t\t\treturn '//maps.google.' + rez[2] + '/maps?q=' + rez[5].replace('query=', 'q=').replace('api=1', '') + '&output=embed';\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t$(document).on('onInit.fb', function (e, instance) {\r\n\r\n\t\t$.each(instance.group, function( i, item ) {\r\n\r\n\t\t\tvar url\t = item.src || '',\r\n\t\t\t\ttype = false,\r\n\t\t\t\tmedia,\r\n\t\t\t\tthumb,\r\n\t\t\t\trez,\r\n\t\t\t\tparams,\r\n\t\t\t\turlParams,\r\n\t\t\t\to,\r\n\t\t\t\tprovider;\r\n\r\n\t\t\t// Skip items that already have content type\r\n\t\t\tif ( item.type ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tmedia = $.extend( true, {}, defaults, item.opts.media );\r\n\r\n\t\t\t// Look for any matching media type\r\n\t\t\t$.each(media, function ( n, el ) {\r\n\t\t\t\trez = url.match(el.matcher);\r\n\t\t\t\to   = {};\r\n\t\t\t\tprovider = n;\r\n\r\n\t\t\t\tif (!rez) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttype = el.type;\r\n\r\n\t\t\t\tif ( el.paramPlace && rez[ el.paramPlace ] ) {\r\n\t\t\t\t\turlParams = rez[ el.paramPlace ];\r\n\r\n\t\t\t\t\tif ( urlParams[ 0 ] == '?' ) {\r\n\t\t\t\t\t\turlParams = urlParams.substring(1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\turlParams = urlParams.split('&');\r\n\r\n\t\t\t\t\tfor ( var m = 0; m < urlParams.length; ++m ) {\r\n\t\t\t\t\t\tvar p = urlParams[ m ].split('=', 2);\r\n\r\n\t\t\t\t\t\tif ( p.length == 2 ) {\r\n\t\t\t\t\t\t\to[ p[0] ] = decodeURIComponent( p[1].replace(/\\+/g, \" \") );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tparams = $.extend( true, {}, el.params, item.opts[ n ], o );\r\n\r\n\t\t\t\turl   = $.type(el.url) === \"function\" ? el.url.call(this, rez, params, item) : format(el.url, rez, params);\r\n\t\t\t\tthumb = $.type(el.thumb) === \"function\" ? el.thumb.call(this, rez, params, item) : format(el.thumb, rez);\r\n\r\n\t\t\t\tif ( provider === 'vimeo' ) {\r\n\t\t\t\t\turl = url.replace('&%23', '#');\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\r\n\t\t\t// If it is found, then change content type and update the url\r\n\r\n\t\t\tif ( type ) {\r\n\t\t\t\titem.src  = url;\r\n\t\t\t\titem.type = type;\r\n\r\n\t\t\t\tif ( !item.opts.thumb && !( item.opts.$thumb && item.opts.$thumb.length ) ) {\r\n\t\t\t\t\titem.opts.thumb = thumb;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( type === 'iframe' ) {\r\n\t\t\t\t\t$.extend(true, item.opts, {\r\n\t\t\t\t\t\tiframe : {\r\n\t\t\t\t\t\t\tpreload : false,\r\n\t\t\t\t\t\t\tattr : {\r\n\t\t\t\t\t\t\t\tscrolling : \"no\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\titem.contentProvider = provider;\r\n\r\n\t\t\t\t\titem.opts.slideClass += ' fancybox-slide--' + ( provider == 'gmap_place' || provider == 'gmap_search' ? 'map' : 'video' );\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// If no content type is found, then set it to `image` as fallback\r\n\t\t\t\titem.type = 'image';\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n}(window.jQuery));\r\n\r\n// ==========================================================================\r\n//\r\n// Guestures\r\n// Adds touch guestures, handles click and tap events\r\n//\r\n// ==========================================================================\r\n;(function (window, document, $) {\r\n\t'use strict';\r\n\r\n\tvar requestAFrame = (function () {\r\n        return window.requestAnimationFrame ||\r\n                window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                window.oRequestAnimationFrame ||\r\n                // if all else fails, use setTimeout\r\n                function (callback) {\r\n                    return window.setTimeout(callback, 1000 / 60);\r\n                };\r\n    })();\r\n\r\n\r\n    var cancelAFrame = (function () {\r\n        return window.cancelAnimationFrame ||\r\n                window.webkitCancelAnimationFrame ||\r\n                window.mozCancelAnimationFrame ||\r\n                window.oCancelAnimationFrame ||\r\n                function (id) {\r\n                    window.clearTimeout(id);\r\n                };\r\n    })();\r\n\r\n\r\n\tvar pointers = function( e ) {\r\n\t\tvar result = [];\r\n\r\n\t\te = e.originalEvent || e || window.e;\r\n\t\te = e.touches && e.touches.length ? e.touches : ( e.changedTouches && e.changedTouches.length ? e.changedTouches : [ e ] );\r\n\r\n\t\tfor ( var key in e ) {\r\n\r\n\t\t\tif ( e[ key ].pageX ) {\r\n\t\t\t\tresult.push( { x : e[ key ].pageX, y : e[ key ].pageY } );\r\n\r\n\t\t\t} else if ( e[ key ].clientX ) {\r\n\t\t\t\tresult.push( { x : e[ key ].clientX, y : e[ key ].clientY } );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t};\r\n\r\n\tvar distance = function( point2, point1, what ) {\r\n\t\tif ( !point1 || !point2 ) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tif ( what === 'x' ) {\r\n\t\t\treturn point2.x - point1.x;\r\n\r\n\t\t} else if ( what === 'y' ) {\r\n\t\t\treturn point2.y - point1.y;\r\n\t\t}\r\n\r\n\t\treturn Math.sqrt( Math.pow( point2.x - point1.x, 2 ) + Math.pow( point2.y - point1.y, 2 ) );\r\n\t};\r\n\r\n\tvar isClickable = function( $el ) {\r\n\r\n\t\tif ( $el.is('a,button,input,select,textarea,label') || $.isFunction( $el.get(0).onclick ) || $el.data('selectable') ) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Check for attributes like data-fancybox-next or data-fancybox-close\r\n\t\tfor ( var i = 0, atts = $el[0].attributes, n = atts.length; i < n; i++ ) {\r\n            if ( atts[i].nodeName.substr(0, 14) === 'data-fancybox-' ) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n\t \treturn false;\r\n\t};\r\n\r\n\tvar hasScrollbars = function( el ) {\r\n\t\tvar overflowY = window.getComputedStyle( el )['overflow-y'];\r\n\t\tvar overflowX = window.getComputedStyle( el )['overflow-x'];\r\n\r\n\t\tvar vertical   = (overflowY === 'scroll' || overflowY === 'auto') && el.scrollHeight > el.clientHeight;\r\n\t\tvar horizontal = (overflowX === 'scroll' || overflowX === 'auto') && el.scrollWidth > el.clientWidth;\r\n\r\n\t\treturn vertical || horizontal;\r\n\t};\r\n\r\n\tvar isScrollable = function ( $el ) {\r\n\t\tvar rez = false;\r\n\r\n\t\twhile ( true ) {\r\n\t\t\trez\t= hasScrollbars( $el.get(0) );\r\n\r\n\t\t\tif ( rez ) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t$el = $el.parent();\r\n\r\n\t\t\tif ( !$el.length || $el.hasClass( 'fancybox-stage' ) || $el.is( 'body' ) ) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn rez;\r\n\t};\r\n\r\n\r\n\tvar Guestures = function ( instance ) {\r\n\t\tvar self = this;\r\n\r\n\t\tself.instance = instance;\r\n\r\n\t\tself.$bg        = instance.$refs.bg;\r\n\t\tself.$stage     = instance.$refs.stage;\r\n\t\tself.$container = instance.$refs.container;\r\n\r\n\t\tself.destroy();\r\n\r\n\t\tself.$container.on( 'touchstart.fb.touch mousedown.fb.touch', $.proxy(self, 'ontouchstart') );\r\n\t};\r\n\r\n\tGuestures.prototype.destroy = function() {\r\n\t\tthis.$container.off( '.fb.touch' );\r\n\t};\r\n\r\n\tGuestures.prototype.ontouchstart = function( e ) {\r\n\t\tvar self = this;\r\n\r\n\t\tvar $target  = $( e.target );\r\n\t\tvar instance = self.instance;\r\n\t\tvar current  = instance.current;\r\n\t\tvar $content = current.$content;\r\n\r\n\t\tvar isTouchDevice = ( e.type == 'touchstart' );\r\n\r\n\t\t// Do not respond to both events\r\n\t\tif ( isTouchDevice ) {\r\n\t        self.$container.off( 'mousedown.fb.touch' );\r\n\t    }\r\n\r\n\t\t// Ignore clicks while zooming or closing\r\n\t\tif ( !current || self.instance.isAnimating || self.instance.isClosing ) {\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Ignore right click\r\n\t\tif ( e.originalEvent && e.originalEvent.button == 2 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Ignore taping on links, buttons, input elements\r\n\t\tif ( !$target.length || isClickable( $target ) || isClickable( $target.parent() ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Ignore clicks on the scrollbar\r\n\t\tif ( e.originalEvent.clientX > $target[0].clientWidth + $target.offset().left ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tself.startPoints = pointers( e );\r\n\r\n\t\t// Prevent zooming if already swiping\r\n\t\tif ( !self.startPoints || ( self.startPoints.length > 1 && instance.isSliding ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tself.$target  = $target;\r\n\t\tself.$content = $content;\r\n\t\tself.canTap   = true;\r\n\r\n\t\t$(document).off( '.fb.touch' );\r\n\r\n\t\t$(document).on( isTouchDevice ? 'touchend.fb.touch touchcancel.fb.touch' : 'mouseup.fb.touch mouseleave.fb.touch',  $.proxy(self, \"ontouchend\"));\r\n\t\t$(document).on( isTouchDevice ? 'touchmove.fb.touch' : 'mousemove.fb.touch',  $.proxy(self, \"ontouchmove\"));\r\n\r\n\t\tif ( !(instance.current.opts.touch || instance.canPan() ) || !( $target.is( self.$stage ) || self.$stage.find( $target ).length ) ) {\r\n\r\n\t\t\t// Prevent ghosting\r\n\t\t\tif ( $target.is('img') ) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\te.stopPropagation();\r\n\r\n\t\tif ( !( $.fancybox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) ) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\tself.canvasWidth  = Math.round( current.$slide[0].clientWidth );\r\n\t\tself.canvasHeight = Math.round( current.$slide[0].clientHeight );\r\n\r\n\t\tself.startTime = new Date().getTime();\r\n\t\tself.distanceX = self.distanceY = self.distance = 0;\r\n\r\n\t\tself.isPanning = false;\r\n\t\tself.isSwiping = false;\r\n\t\tself.isZooming = false;\r\n\r\n\t\tself.sliderStartPos  = self.sliderLastPos || { top: 0, left: 0 };\r\n\t\tself.contentStartPos = $.fancybox.getTranslate( self.$content );\r\n\t\tself.contentLastPos  = null;\r\n\r\n\t\tif ( self.startPoints.length === 1 && !self.isZooming ) {\r\n\t\t\tself.canTap = !instance.isSliding;\r\n\r\n\t\t\tif ( current.type === 'image' && ( self.contentStartPos.width > self.canvasWidth + 1 || self.contentStartPos.height > self.canvasHeight + 1 ) ) {\r\n\r\n\t\t\t\t$.fancybox.stop( self.$content );\r\n\r\n\t\t\t\tself.$content.css( 'transition-duration', '0ms' );\r\n\r\n\t\t\t\tself.isPanning = true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tself.isSwiping = true;\r\n\t\t\t}\r\n\r\n\t\t\tself.$container.addClass('fancybox-controls--isGrabbing');\r\n\t\t}\r\n\r\n\t\tif ( self.startPoints.length === 2 && !instance.isAnimating && !current.hasError && current.type === 'image' && ( current.isLoaded || current.$ghost ) ) {\r\n\t\t\tself.isZooming = true;\r\n\r\n\t\t\tself.isSwiping = false;\r\n\t\t\tself.isPanning = false;\r\n\r\n\t\t\t$.fancybox.stop( self.$content );\r\n\r\n\t\t\tself.$content.css( 'transition-duration', '0ms' );\r\n\r\n\t\t\tself.centerPointStartX = ( ( self.startPoints[0].x + self.startPoints[1].x ) * 0.5 ) - $(window).scrollLeft();\r\n\t\t\tself.centerPointStartY = ( ( self.startPoints[0].y + self.startPoints[1].y ) * 0.5 ) - $(window).scrollTop();\r\n\r\n\t\t\tself.percentageOfImageAtPinchPointX = ( self.centerPointStartX - self.contentStartPos.left ) / self.contentStartPos.width;\r\n\t\t\tself.percentageOfImageAtPinchPointY = ( self.centerPointStartY - self.contentStartPos.top  ) / self.contentStartPos.height;\r\n\r\n\t\t\tself.startDistanceBetweenFingers = distance( self.startPoints[0], self.startPoints[1] );\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tGuestures.prototype.ontouchmove = function( e ) {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tself.newPoints = pointers( e );\r\n\r\n\t\tif ( $.fancybox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) {\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tself.canTap = false;\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( !( self.instance.current.opts.touch || self.instance.canPan() ) || !self.newPoints || !self.newPoints.length ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tself.distanceX = distance( self.newPoints[0], self.startPoints[0], 'x' );\r\n\t\tself.distanceY = distance( self.newPoints[0], self.startPoints[0], 'y' );\r\n\r\n\t\tself.distance = distance( self.newPoints[0], self.startPoints[0] );\r\n\r\n\t\t// Skip false ontouchmove events (Chrome)\r\n\t\tif ( self.distance > 0 ) {\r\n\r\n\t\t\tif ( !( self.$target.is( self.$stage ) || self.$stage.find( self.$target ).length ) ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tif ( self.isSwiping ) {\r\n\t\t\t\tself.onSwipe();\r\n\r\n\t\t\t} else if ( self.isPanning ) {\r\n\t\t\t\tself.onPan();\r\n\r\n\t\t\t} else if ( self.isZooming ) {\r\n\t\t\t\tself.onZoom();\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tGuestures.prototype.onSwipe = function() {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tvar swiping = self.isSwiping;\r\n\t\tvar left    = self.sliderStartPos.left || 0;\r\n\t\tvar angle;\r\n\r\n\t\tif ( swiping === true ) {\r\n\r\n\t\t\tif ( Math.abs( self.distance ) > 10 )  {\r\n\r\n\t\t\t\tself.canTap = false;\r\n\r\n\t\t\t\tif ( self.instance.group.length < 2 && self.instance.opts.touch.vertical ) {\r\n\t\t\t\t\tself.isSwiping  = 'y';\r\n\r\n\t\t\t\t} else if ( self.instance.isSliding || self.instance.opts.touch.vertical === false || ( self.instance.opts.touch.vertical === 'auto' && $( window ).width() > 800 ) ) {\r\n\t\t\t\t\tself.isSwiping  = 'x';\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tangle = Math.abs( Math.atan2( self.distanceY, self.distanceX ) * 180 / Math.PI );\r\n\r\n\t\t\t\t\tself.isSwiping = ( angle > 45 && angle < 135 ) ? 'y' : 'x';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tself.instance.isSliding = self.isSwiping;\r\n\r\n\t\t\t\t// Reset points to avoid jumping, because we dropped first swipes to calculate the angle\r\n\t\t\t\tself.startPoints = self.newPoints;\r\n\r\n\t\t\t\t$.each(self.instance.slides, function( index, slide ) {\r\n\t\t\t\t\t$.fancybox.stop( slide.$slide );\r\n\r\n\t\t\t\t\tslide.$slide.css( 'transition-duration', '0ms' );\r\n\r\n\t\t\t\t\tslide.inTransition = false;\r\n\r\n\t\t\t\t\tif ( slide.pos === self.instance.current.pos ) {\r\n\t\t\t\t\t\tself.sliderStartPos.left = $.fancybox.getTranslate( slide.$slide ).left;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t//self.instance.current.isMoved = true;\r\n\r\n\t\t\t\t// Stop slideshow\r\n\t\t\t\tif ( self.instance.SlideShow && self.instance.SlideShow.isActive ) {\r\n\t\t\t\t\tself.instance.SlideShow.stop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( swiping == 'x' ) {\r\n\r\n\t\t\t\t// Sticky edges\r\n\t\t\t\tif ( self.distanceX > 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === 0 && !self.instance.current.opts.loop ) ) ) {\r\n\t\t\t\t\tleft = left + Math.pow( self.distanceX, 0.8 );\r\n\r\n\t\t\t\t} else if ( self.distanceX < 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === self.instance.group.length - 1 && !self.instance.current.opts.loop ) ) ) {\r\n\t\t\t\t\tleft = left - Math.pow( -self.distanceX, 0.8 );\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tleft = left + self.distanceX;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tself.sliderLastPos = {\r\n\t\t\t\ttop  : swiping == 'x' ? 0 : self.sliderStartPos.top + self.distanceY,\r\n\t\t\t\tleft : left\r\n\t\t\t};\r\n\r\n\t\t\tif ( self.requestId ) {\r\n\t\t\t\tcancelAFrame( self.requestId );\r\n\r\n\t\t\t\tself.requestId = null;\r\n\t\t\t}\r\n\r\n\t\t\tself.requestId = requestAFrame(function() {\r\n\r\n\t\t\t\tif ( self.sliderLastPos ) {\r\n\t\t\t\t\t$.each(self.instance.slides, function( index, slide ) {\r\n\t\t\t\t\t\tvar pos = slide.pos - self.instance.currPos;\r\n\r\n\t\t\t\t\t\t$.fancybox.setTranslate( slide.$slide, {\r\n\t\t\t\t\t\t\ttop  : self.sliderLastPos.top,\r\n\t\t\t\t\t\t\tleft : self.sliderLastPos.left + ( pos * self.canvasWidth ) + ( pos * slide.opts.gutter )\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tself.$container.addClass( 'fancybox-is-sliding' );\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tGuestures.prototype.onPan = function() {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tvar newOffsetX, newOffsetY, newPos;\r\n\r\n\t\tself.canTap = false;\r\n\r\n\t\tif ( self.contentStartPos.width > self.canvasWidth ) {\r\n\t\t\tnewOffsetX = self.contentStartPos.left + self.distanceX;\r\n\r\n\t\t} else {\r\n\t\t\tnewOffsetX = self.contentStartPos.left;\r\n\t\t}\r\n\r\n\t\tnewOffsetY = self.contentStartPos.top + self.distanceY;\r\n\r\n\t\tnewPos = self.limitMovement( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height );\r\n\r\n\t\tnewPos.scaleX = self.contentStartPos.scaleX;\r\n\t\tnewPos.scaleY = self.contentStartPos.scaleY;\r\n\r\n\t\tself.contentLastPos = newPos;\r\n\r\n\t\tif ( self.requestId ) {\r\n\t\t\tcancelAFrame( self.requestId );\r\n\r\n\t\t\tself.requestId = null;\r\n\t\t}\r\n\r\n\t\tself.requestId = requestAFrame(function() {\r\n\t\t\t$.fancybox.setTranslate( self.$content, self.contentLastPos );\r\n\t\t});\r\n\t};\r\n\r\n\t// Make panning sticky to the edges\r\n\tGuestures.prototype.limitMovement = function( newOffsetX, newOffsetY, newWidth, newHeight ) {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tvar minTranslateX, minTranslateY, maxTranslateX, maxTranslateY;\r\n\r\n\t\tvar canvasWidth  = self.canvasWidth;\r\n\t\tvar canvasHeight = self.canvasHeight;\r\n\r\n\t\tvar currentOffsetX = self.contentStartPos.left;\r\n\t\tvar currentOffsetY = self.contentStartPos.top;\r\n\r\n\t\tvar distanceX = self.distanceX;\r\n\t\tvar distanceY = self.distanceY;\r\n\r\n\t\t// Slow down proportionally to traveled distance\r\n\r\n\t\tminTranslateX = Math.max(0, canvasWidth  * 0.5 - newWidth  * 0.5 );\r\n\t\tminTranslateY = Math.max(0, canvasHeight * 0.5 - newHeight * 0.5 );\r\n\r\n\t\tmaxTranslateX = Math.min( canvasWidth  - newWidth,  canvasWidth  * 0.5 - newWidth  * 0.5 );\r\n\t\tmaxTranslateY = Math.min( canvasHeight - newHeight, canvasHeight * 0.5 - newHeight * 0.5 );\r\n\r\n\t\tif ( newWidth > canvasWidth ) {\r\n\r\n\t\t\t//   ->\r\n\t\t\tif ( distanceX > 0 && newOffsetX > minTranslateX ) {\r\n\t\t\t\tnewOffsetX = minTranslateX - 1 + Math.pow( -minTranslateX + currentOffsetX + distanceX, 0.8 ) || 0;\r\n\t\t\t}\r\n\r\n\t\t\t//    <-\r\n\t\t\tif ( distanceX  < 0 && newOffsetX < maxTranslateX ) {\r\n\t\t\t\tnewOffsetX = maxTranslateX + 1 - Math.pow( maxTranslateX - currentOffsetX - distanceX, 0.8 ) || 0;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( newHeight > canvasHeight ) {\r\n\r\n\t\t\t//   \\/\r\n\t\t\tif ( distanceY > 0 && newOffsetY > minTranslateY ) {\r\n\t\t\t\tnewOffsetY = minTranslateY - 1 + Math.pow(-minTranslateY + currentOffsetY + distanceY, 0.8 ) || 0;\r\n\t\t\t}\r\n\r\n\t\t\t//   /\\\r\n\t\t\tif ( distanceY < 0 && newOffsetY < maxTranslateY ) {\r\n\t\t\t\tnewOffsetY = maxTranslateY + 1 - Math.pow ( maxTranslateY - currentOffsetY - distanceY, 0.8 ) || 0;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttop  : newOffsetY,\r\n\t\t\tleft : newOffsetX\r\n\t\t};\r\n\r\n\t};\r\n\r\n\r\n\tGuestures.prototype.limitPosition = function( newOffsetX, newOffsetY, newWidth, newHeight ) {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tvar canvasWidth  = self.canvasWidth;\r\n\t\tvar canvasHeight = self.canvasHeight;\r\n\r\n\t\tif ( newWidth > canvasWidth ) {\r\n\t\t\tnewOffsetX = newOffsetX > 0 ? 0 : newOffsetX;\r\n\t\t\tnewOffsetX = newOffsetX < canvasWidth - newWidth ? canvasWidth - newWidth : newOffsetX;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Center horizontally\r\n\t\t\tnewOffsetX = Math.max( 0, canvasWidth / 2 - newWidth / 2 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( newHeight > canvasHeight ) {\r\n\t\t\tnewOffsetY = newOffsetY > 0 ? 0 : newOffsetY;\r\n\t\t\tnewOffsetY = newOffsetY < canvasHeight - newHeight ? canvasHeight - newHeight : newOffsetY;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Center vertically\r\n\t\t\tnewOffsetY = Math.max( 0, canvasHeight / 2 - newHeight / 2 );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttop  : newOffsetY,\r\n\t\t\tleft : newOffsetX\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tGuestures.prototype.onZoom = function() {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\t// Calculate current distance between points to get pinch ratio and new width and height\r\n\r\n\t\tvar currentWidth  = self.contentStartPos.width;\r\n\t\tvar currentHeight = self.contentStartPos.height;\r\n\r\n\t\tvar currentOffsetX = self.contentStartPos.left;\r\n\t\tvar currentOffsetY = self.contentStartPos.top;\r\n\r\n\t\tvar endDistanceBetweenFingers = distance( self.newPoints[0], self.newPoints[1] );\r\n\r\n\t\tvar pinchRatio = endDistanceBetweenFingers / self.startDistanceBetweenFingers;\r\n\r\n\t\tvar newWidth  = Math.floor( currentWidth  * pinchRatio );\r\n\t\tvar newHeight = Math.floor( currentHeight * pinchRatio );\r\n\r\n\t\t// This is the translation due to pinch-zooming\r\n\t\tvar translateFromZoomingX = (currentWidth  - newWidth)  * self.percentageOfImageAtPinchPointX;\r\n\t\tvar translateFromZoomingY = (currentHeight - newHeight) * self.percentageOfImageAtPinchPointY;\r\n\r\n\t\t//Point between the two touches\r\n\r\n\t\tvar centerPointEndX = ((self.newPoints[0].x + self.newPoints[1].x) / 2) - $(window).scrollLeft();\r\n\t\tvar centerPointEndY = ((self.newPoints[0].y + self.newPoints[1].y) / 2) - $(window).scrollTop();\r\n\r\n\t\t// And this is the translation due to translation of the centerpoint\r\n\t\t// between the two fingers\r\n\r\n\t\tvar translateFromTranslatingX = centerPointEndX - self.centerPointStartX;\r\n\t\tvar translateFromTranslatingY = centerPointEndY - self.centerPointStartY;\r\n\r\n\t\t// The new offset is the old/current one plus the total translation\r\n\r\n\t\tvar newOffsetX = currentOffsetX + ( translateFromZoomingX + translateFromTranslatingX );\r\n\t\tvar newOffsetY = currentOffsetY + ( translateFromZoomingY + translateFromTranslatingY );\r\n\r\n\t\tvar newPos = {\r\n\t\t\ttop    : newOffsetY,\r\n\t\t\tleft   : newOffsetX,\r\n\t\t\tscaleX : self.contentStartPos.scaleX * pinchRatio,\r\n\t\t\tscaleY : self.contentStartPos.scaleY * pinchRatio\r\n\t\t};\r\n\r\n\t\tself.canTap = false;\r\n\r\n\t\tself.newWidth  = newWidth;\r\n\t\tself.newHeight = newHeight;\r\n\r\n\t\tself.contentLastPos = newPos;\r\n\r\n\t\tif ( self.requestId ) {\r\n\t\t\tcancelAFrame( self.requestId );\r\n\r\n\t\t\tself.requestId = null;\r\n\t\t}\r\n\r\n\t\tself.requestId = requestAFrame(function() {\r\n\t\t\t$.fancybox.setTranslate( self.$content, self.contentLastPos );\r\n\t\t});\r\n\r\n\t};\r\n\r\n\tGuestures.prototype.ontouchend = function( e ) {\r\n\r\n\t\tvar self = this;\r\n\t\tvar dMs  = Math.max( (new Date().getTime() ) - self.startTime, 1);\r\n\r\n\t\tvar swiping = self.isSwiping;\r\n\t\tvar panning = self.isPanning;\r\n\t\tvar zooming = self.isZooming;\r\n\r\n\t\tself.endPoints = pointers( e );\r\n\r\n\t\tself.$container.removeClass( 'fancybox-controls--isGrabbing' );\r\n\r\n\t\t$(document).off( '.fb.touch' );\r\n\r\n\t\tif ( self.requestId ) {\r\n\t\t\tcancelAFrame( self.requestId );\r\n\r\n\t\t\tself.requestId = null;\r\n\t\t}\r\n\r\n\t\tself.isSwiping = false;\r\n\t\tself.isPanning = false;\r\n\t\tself.isZooming = false;\r\n\r\n\t\tif ( self.canTap )  {\r\n\t\t\treturn self.onTap( e );\r\n\t\t}\r\n\r\n\t\tself.speed = 366;\r\n\r\n\t\t// Speed in px/ms\r\n\t\tself.velocityX = self.distanceX / dMs * 0.5;\r\n\t\tself.velocityY = self.distanceY / dMs * 0.5;\r\n\r\n\t\tself.speedX = Math.max( self.speed * 0.5, Math.min( self.speed * 1.5, ( 1 / Math.abs( self.velocityX ) ) * self.speed ) );\r\n\r\n\t\tif ( panning ) {\r\n\t\t\tself.endPanning();\r\n\r\n\t\t} else if ( zooming ) {\r\n\t\t\tself.endZooming();\r\n\r\n\t\t} else {\r\n\t\t\tself.endSwiping( swiping );\r\n\t\t}\r\n\r\n\t\treturn;\r\n\t};\r\n\r\n\tGuestures.prototype.endSwiping = function( swiping ) {\r\n\r\n\t\tvar self = this;\r\n\t\tvar ret = false;\r\n\r\n\t\tself.instance.isSliding = false;\r\n\t\tself.sliderLastPos      = null;\r\n\r\n\t\t// Close if swiped vertically / navigate if horizontally\r\n\t\tif ( swiping == 'y' && Math.abs( self.distanceY ) > 50 ) {\r\n\r\n\t\t\t// Continue vertical movement\r\n\t\t\t$.fancybox.animate( self.instance.current.$slide, {\r\n\t\t\t\ttop     : self.sliderStartPos.top + self.distanceY + ( self.velocityY * 150 ),\r\n\t\t\t\topacity : 0\r\n\t\t\t}, 150 );\r\n\r\n\t\t\tret = self.instance.close( true, 300 );\r\n\r\n\t\t} else if ( swiping == 'x' && self.distanceX > 50 && self.instance.group.length > 1 ) {\r\n\t\t\tret = self.instance.previous( self.speedX );\r\n\r\n\t\t} else if ( swiping == 'x' && self.distanceX < -50  && self.instance.group.length > 1 ) {\r\n\t\t\tret = self.instance.next( self.speedX );\r\n\t\t}\r\n\r\n\t\tif ( ret === false && ( swiping == 'x' || swiping == 'y' ) ) {\r\n\t\t\tself.instance.jumpTo( self.instance.current.index, 150 );\r\n\t\t}\r\n\r\n\t\tself.$container.removeClass( 'fancybox-is-sliding' );\r\n\r\n\t};\r\n\r\n\t// Limit panning from edges\r\n\t// ========================\r\n\r\n\tGuestures.prototype.endPanning = function() {\r\n\r\n\t\tvar self = this;\r\n\t\tvar newOffsetX, newOffsetY, newPos;\r\n\r\n\t\tif ( !self.contentLastPos ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( self.instance.current.opts.touch.momentum === false ) {\r\n\t\t\tnewOffsetX = self.contentLastPos.left;\r\n\t\t\tnewOffsetY = self.contentLastPos.top;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Continue movement\r\n\t\t\tnewOffsetX = self.contentLastPos.left + ( self.velocityX * self.speed );\r\n\t\t\tnewOffsetY = self.contentLastPos.top  + ( self.velocityY * self.speed );\r\n\t\t}\r\n\r\n\t\tnewPos = self.limitPosition( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height );\r\n\r\n\t\t newPos.width  = self.contentStartPos.width;\r\n\t\t newPos.height = self.contentStartPos.height;\r\n\r\n\t\t$.fancybox.animate( self.$content, newPos, 330 );\r\n\t};\r\n\r\n\r\n\tGuestures.prototype.endZooming = function() {\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tvar current = self.instance.current;\r\n\r\n\t\tvar newOffsetX, newOffsetY, newPos, reset;\r\n\r\n\t\tvar newWidth  = self.newWidth;\r\n\t\tvar newHeight = self.newHeight;\r\n\r\n\t\tif ( !self.contentLastPos ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tnewOffsetX = self.contentLastPos.left;\r\n\t\tnewOffsetY = self.contentLastPos.top;\r\n\r\n\t\treset = {\r\n\t\t   \ttop    : newOffsetY,\r\n\t\t   \tleft   : newOffsetX,\r\n\t\t   \twidth  : newWidth,\r\n\t\t   \theight : newHeight,\r\n\t\t\tscaleX : 1,\r\n\t\t\tscaleY : 1\r\n\t   };\r\n\r\n\t   // Reset scalex/scaleY values; this helps for perfomance and does not break animation\r\n\t   $.fancybox.setTranslate( self.$content, reset );\r\n\r\n\t\tif ( newWidth < self.canvasWidth && newHeight < self.canvasHeight ) {\r\n\t\t\tself.instance.scaleToFit( 150 );\r\n\r\n\t\t} else if ( newWidth > current.width || newHeight > current.height ) {\r\n\t\t\tself.instance.scaleToActual( self.centerPointStartX, self.centerPointStartY, 150 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tnewPos = self.limitPosition( newOffsetX, newOffsetY, newWidth, newHeight );\r\n\r\n\t\t\t// Switch from scale() to width/height or animation will not work correctly\r\n\t\t\t$.fancybox.setTranslate( self.content, $.fancybox.getTranslate( self.$content ) );\r\n\r\n\t\t\t$.fancybox.animate( self.$content, newPos, 150 );\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tGuestures.prototype.onTap = function(e) {\r\n\t\tvar self    = this;\r\n\t\tvar $target = $( e.target );\r\n\r\n\t\tvar instance = self.instance;\r\n\t\tvar current  = instance.current;\r\n\r\n\t\tvar endPoints = ( e && pointers( e ) ) || self.startPoints;\r\n\r\n\t\tvar tapX = endPoints[0] ? endPoints[0].x - self.$stage.offset().left : 0;\r\n\t\tvar tapY = endPoints[0] ? endPoints[0].y - self.$stage.offset().top  : 0;\r\n\r\n\t\tvar where;\r\n\r\n\t\tvar process = function ( prefix ) {\r\n\r\n\t\t\tvar action = current.opts[ prefix ];\r\n\r\n\t\t\tif ( $.isFunction( action ) ) {\r\n\t\t\t\taction = action.apply( instance, [ current, e ] );\r\n\t\t\t}\r\n\r\n\t\t\tif ( !action) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( action ) {\r\n\r\n\t\t\t\tcase \"close\" :\r\n\r\n\t\t\t\t\tinstance.close( self.startEvent );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"toggleControls\" :\r\n\r\n\t\t\t\t\tinstance.toggleControls( true );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"next\" :\r\n\r\n\t\t\t\t\tinstance.next();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"nextOrClose\" :\r\n\r\n\t\t\t\t\tif ( instance.group.length > 1 ) {\r\n\t\t\t\t\t\tinstance.next();\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tinstance.close( self.startEvent );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"zoom\" :\r\n\r\n\t\t\t\t\tif ( current.type == 'image' && ( current.isLoaded || current.$ghost ) ) {\r\n\r\n\t\t\t\t\t\tif ( instance.canPan() ) {\r\n\t\t\t\t\t\t\tinstance.scaleToFit();\r\n\r\n\t\t\t\t\t\t} else if ( instance.isScaledDown() ) {\r\n\t\t\t\t\t\t\tinstance.scaleToActual( tapX, tapY );\r\n\r\n\t\t\t\t\t\t} else if ( instance.group.length < 2 ) {\r\n\t\t\t\t\t\t\tinstance.close( self.startEvent );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\t// Ignore right click\r\n\t\tif ( e.originalEvent && e.originalEvent.button == 2 ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Skip if current slide is not in the center\r\n\t\tif ( instance.isSliding ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Skip if clicked on the scrollbar\r\n\t\tif ( tapX > $target[0].clientWidth + $target.offset().left ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check where is clicked\r\n\t\tif ( $target.is( '.fancybox-bg,.fancybox-inner,.fancybox-outer,.fancybox-container' ) ) {\r\n\t\t\twhere = 'Outside';\r\n\r\n\t\t} else if ( $target.is( '.fancybox-slide' ) ) {\r\n\t\t\twhere = 'Slide';\r\n\r\n\t\t} else if  ( instance.current.$content && instance.current.$content.has( e.target ).length ) {\r\n\t\t \twhere = 'Content';\r\n\r\n\t\t} else {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check if this is a double tap\r\n\t\tif ( self.tapped ) {\r\n\r\n\t\t\t// Stop previously created single tap\r\n\t\t\tclearTimeout( self.tapped );\r\n\t\t\tself.tapped = null;\r\n\r\n\t\t\t// Skip if distance between taps is too big\r\n\t\t\tif ( Math.abs( tapX - self.tapX ) > 50 || Math.abs( tapY - self.tapY ) > 50 || instance.isSliding ) {\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\r\n\t\t\t// OK, now we assume that this is a double-tap\r\n\t\t\tprocess( 'dblclick' + where );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Single tap will be processed if user has not clicked second time within 300ms\r\n\t\t\t// or there is no need to wait for double-tap\r\n\t\t\tself.tapX = tapX;\r\n\t\t\tself.tapY = tapY;\r\n\r\n\t\t\tif ( current.opts[ 'dblclick' + where ] && current.opts[ 'dblclick' + where ] !== current.opts[ 'click' + where ] ) {\r\n\t\t\t\tself.tapped = setTimeout(function() {\r\n\t\t\t\t\tself.tapped = null;\r\n\r\n\t\t\t\t\tprocess( 'click' + where );\r\n\r\n\t\t\t\t}, 300);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tprocess( 'click' + where );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$(document).on('onActivate.fb', function (e, instance) {\r\n\t\tif ( instance && !instance.Guestures ) {\r\n\t\t\tinstance.Guestures = new Guestures( instance );\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on('beforeClose.fb', function (e, instance) {\r\n\t\tif ( instance && instance.Guestures ) {\r\n\t\t\tinstance.Guestures.destroy();\r\n\t\t}\r\n\t});\r\n\r\n\r\n}(window, document, window.jQuery));\r\n\r\n// ==========================================================================\r\n//\r\n// SlideShow\r\n// Enables slideshow functionality\r\n//\r\n// Example of usage:\r\n// $.fancybox.getInstance().SlideShow.start()\r\n//\r\n// ==========================================================================\r\n;(function (document, $) {\r\n\t'use strict';\r\n\r\n\tvar SlideShow = function( instance ) {\r\n\t\tthis.instance = instance;\r\n\t\tthis.init();\r\n\t};\r\n\r\n\t$.extend( SlideShow.prototype, {\r\n\t\ttimer    : null,\r\n\t\tisActive : false,\r\n\t\t$button  : null,\r\n\t\tspeed    : 3000,\r\n\r\n\t\tinit : function() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tself.$button = self.instance.$refs.toolbar.find('[data-fancybox-play]').on('click', function() {\r\n\t\t\t\tself.toggle();\r\n\t\t\t});\r\n\r\n\t\t\tif ( self.instance.group.length < 2 || !self.instance.group[ self.instance.currIndex ].opts.slideShow ) {\r\n\t\t\t\tself.$button.hide();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tset : function() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\t// Check if reached last element\r\n\t\t\tif ( self.instance && self.instance.current && (self.instance.current.opts.loop || self.instance.currIndex < self.instance.group.length - 1 )) {\r\n\t\t\t\tself.timer = setTimeout(function() {\r\n\t\t\t\t\tself.instance.next();\r\n\r\n\t\t\t\t}, self.instance.current.opts.slideShow.speed || self.speed);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tself.stop();\r\n\t\t\t\tself.instance.idleSecondsCounter = 0;\r\n\t\t\t\tself.instance.showControls();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclear : function() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tclearTimeout( self.timer );\r\n\r\n\t\t\tself.timer = null;\r\n\t\t},\r\n\r\n\t\tstart : function() {\r\n\t\t\tvar self = this;\r\n\t\t\tvar current = self.instance.current;\r\n\r\n\t\t\tif ( self.instance && current && ( current.opts.loop || current.index < self.instance.group.length - 1 )) {\r\n\r\n\t\t\t\tself.isActive = true;\r\n\r\n\t\t\t\tself.$button\r\n\t\t\t\t\t.attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_STOP )\r\n\t\t\t\t\t.addClass( 'fancybox-button--pause' );\r\n\r\n\t\t\t\tif ( current.isComplete ) {\r\n\t\t\t\t\tself.set();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstop : function() {\r\n\t\t\tvar self = this;\r\n\t\t\tvar current = self.instance.current;\r\n\r\n\t\t\tself.clear();\r\n\r\n\t\t\tself.$button\r\n\t\t\t\t.attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_START )\r\n\t\t\t\t.removeClass( 'fancybox-button--pause' );\r\n\r\n\t\t\tself.isActive = false;\r\n\t\t},\r\n\r\n\t\ttoggle : function() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tif ( self.isActive ) {\r\n\t\t\t\tself.stop();\r\n\r\n\t\t\t} else {\r\n\t\t\t\tself.start();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t$(document).on({\r\n\t\t'onInit.fb' : function(e, instance) {\r\n\t\t\tif ( instance && !instance.SlideShow ) {\r\n\t\t\t\tinstance.SlideShow = new SlideShow( instance );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'beforeShow.fb' : function(e, instance, current, firstRun) {\r\n\t\t\tvar SlideShow = instance && instance.SlideShow;\r\n\r\n\t\t\tif ( firstRun ) {\r\n\r\n\t\t\t\tif ( SlideShow && current.opts.slideShow.autoStart ) {\r\n\t\t\t\t\tSlideShow.start();\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( SlideShow && SlideShow.isActive )  {\r\n\t\t\t\tSlideShow.clear();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'afterShow.fb' : function(e, instance, current) {\r\n\t\t\tvar SlideShow = instance && instance.SlideShow;\r\n\r\n\t\t\tif ( SlideShow && SlideShow.isActive ) {\r\n\t\t\t\tSlideShow.set();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'afterKeydown.fb' : function(e, instance, current, keypress, keycode) {\r\n\t\t\tvar SlideShow = instance && instance.SlideShow;\r\n\r\n\t\t\t// \"P\" or Spacebar\r\n\t\t\tif ( SlideShow && current.opts.slideShow && ( keycode === 80 || keycode === 32 ) && !$(document.activeElement).is( 'button,a,input' ) ) {\r\n\t\t\t\tkeypress.preventDefault();\r\n\r\n\t\t\t\tSlideShow.toggle();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'beforeClose.fb onDeactivate.fb' : function(e, instance) {\r\n\t\t\tvar SlideShow = instance && instance.SlideShow;\r\n\r\n\t\t\tif ( SlideShow ) {\r\n\t\t\t\tSlideShow.stop();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t// Page Visibility API to pause slideshow when window is not active\r\n\t$(document).on(\"visibilitychange\", function() {\r\n\t\tvar instance  = $.fancybox.getInstance();\r\n\t\tvar SlideShow = instance && instance.SlideShow;\r\n\r\n\t\tif ( SlideShow && SlideShow.isActive ) {\r\n\t\t\tif ( document.hidden ) {\r\n\t\t\t\tSlideShow.clear();\r\n\r\n\t\t\t} else {\r\n\t\t\t\tSlideShow.set();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n}(document, window.jQuery));\r\n\r\n// ==========================================================================\r\n//\r\n// FullScreen\r\n// Adds fullscreen functionality\r\n//\r\n// ==========================================================================\r\n;(function (document, $) {\r\n\t'use strict';\r\n\r\n\t// Collection of methods supported by user browser\r\n\tvar fn = (function () {\r\n\r\n\t\tvar fnMap = [\r\n\t\t\t[\r\n\t\t\t\t'requestFullscreen',\r\n\t\t\t\t'exitFullscreen',\r\n\t\t\t\t'fullscreenElement',\r\n\t\t\t\t'fullscreenEnabled',\r\n\t\t\t\t'fullscreenchange',\r\n\t\t\t\t'fullscreenerror'\r\n\t\t\t],\r\n\t\t\t// new WebKit\r\n\t\t\t[\r\n\t\t\t\t'webkitRequestFullscreen',\r\n\t\t\t\t'webkitExitFullscreen',\r\n\t\t\t\t'webkitFullscreenElement',\r\n\t\t\t\t'webkitFullscreenEnabled',\r\n\t\t\t\t'webkitfullscreenchange',\r\n\t\t\t\t'webkitfullscreenerror'\r\n\r\n\t\t\t],\r\n\t\t\t// old WebKit (Safari 5.1)\r\n\t\t\t[\r\n\t\t\t\t'webkitRequestFullScreen',\r\n\t\t\t\t'webkitCancelFullScreen',\r\n\t\t\t\t'webkitCurrentFullScreenElement',\r\n\t\t\t\t'webkitCancelFullScreen',\r\n\t\t\t\t'webkitfullscreenchange',\r\n\t\t\t\t'webkitfullscreenerror'\r\n\r\n\t\t\t],\r\n\t\t\t[\r\n\t\t\t\t'mozRequestFullScreen',\r\n\t\t\t\t'mozCancelFullScreen',\r\n\t\t\t\t'mozFullScreenElement',\r\n\t\t\t\t'mozFullScreenEnabled',\r\n\t\t\t\t'mozfullscreenchange',\r\n\t\t\t\t'mozfullscreenerror'\r\n\t\t\t],\r\n\t\t\t[\r\n\t\t\t\t'msRequestFullscreen',\r\n\t\t\t\t'msExitFullscreen',\r\n\t\t\t\t'msFullscreenElement',\r\n\t\t\t\t'msFullscreenEnabled',\r\n\t\t\t\t'MSFullscreenChange',\r\n\t\t\t\t'MSFullscreenError'\r\n\t\t\t]\r\n\t\t];\r\n\r\n\t\tvar val;\r\n\t\tvar ret = {};\r\n\t\tvar i, j;\r\n\r\n\t\tfor ( i = 0; i < fnMap.length; i++ ) {\r\n\t\t\tval = fnMap[ i ];\r\n\r\n\t\t\tif ( val && val[ 1 ] in document ) {\r\n\t\t\t\tfor ( j = 0; j < val.length; j++ ) {\r\n\t\t\t\t\tret[ fnMap[ 0 ][ j ] ] = val[ j ];\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t})();\r\n\r\n\t// If browser does not have Full Screen API, then simply unset default button template and stop\r\n\tif ( !fn ) {\r\n\r\n\t\tif ( $ && $.fancybox ) {\r\n\t\t\t$.fancybox.defaults.btnTpl.fullScreen = false;\r\n\t\t}\r\n\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar FullScreen = {\r\n\r\n\t\trequest : function ( elem ) {\r\n\r\n\t\t\telem = elem || document.documentElement;\r\n\r\n\t\t\telem[ fn.requestFullscreen ]( elem.ALLOW_KEYBOARD_INPUT );\r\n\r\n\t\t},\r\n\t\texit : function () {\r\n\r\n\t\t\tdocument[ fn.exitFullscreen ]();\r\n\r\n\t\t},\r\n\t\ttoggle : function ( elem ) {\r\n\r\n\t\t\telem = elem || document.documentElement;\r\n\r\n\t\t\tif ( this.isFullscreen() ) {\r\n\t\t\t\tthis.exit();\r\n\r\n\t\t\t} else {\r\n\t\t\t\tthis.request( elem );\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tisFullscreen : function()  {\r\n\r\n\t\t\treturn Boolean( document[ fn.fullscreenElement ] );\r\n\r\n\t\t},\r\n\t\tenabled : function()  {\r\n\r\n\t\t\treturn Boolean( document[ fn.fullscreenEnabled ] );\r\n\r\n\t\t}\r\n\t};\r\n\r\n\t$(document).on({\r\n\t\t'onInit.fb' : function(e, instance) {\r\n\t\t\tvar $container;\r\n\r\n\t\t\tvar $button = instance.$refs.toolbar.find('[data-fancybox-fullscreen]');\r\n\r\n\t\t\tif ( instance && !instance.FullScreen && instance.group[ instance.currIndex ].opts.fullScreen ) {\r\n\t\t\t\t$container = instance.$refs.container;\r\n\r\n\t\t\t\t$container.on('click.fb-fullscreen', '[data-fancybox-fullscreen]', function(e) {\r\n\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\tFullScreen.toggle( $container[ 0 ] );\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif ( instance.opts.fullScreen && instance.opts.fullScreen.autoStart === true ) {\r\n\t\t\t\t\tFullScreen.request( $container[ 0 ] );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Expose API\r\n\t\t\t\tinstance.FullScreen = FullScreen;\r\n\r\n\t\t\t} else {\r\n\t\t\t\t$button.hide();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t'afterKeydown.fb' : function(e, instance, current, keypress, keycode) {\r\n\r\n\t\t\t// \"P\" or Spacebar\r\n\t\t\tif ( instance && instance.FullScreen && keycode === 70 ) {\r\n\t\t\t\tkeypress.preventDefault();\r\n\r\n\t\t\t\tinstance.FullScreen.toggle( instance.$refs.container[ 0 ] );\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t'beforeClose.fb' : function( instance ) {\r\n\t\t\tif ( instance && instance.FullScreen ) {\r\n\t\t\t\tFullScreen.exit();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on(fn.fullscreenchange, function() {\r\n\t\tvar instance = $.fancybox.getInstance();\r\n\r\n\t\t// If image is zooming, then force to stop and reposition properly\r\n\t\tif ( instance.current && instance.current.type === 'image' && instance.isAnimating ) {\r\n\t\t\tinstance.current.$content.css( 'transition', 'none' );\r\n\r\n\t\t\tinstance.isAnimating = false;\r\n\r\n\t\t\tinstance.update( true, true, 0 );\r\n\t\t}\r\n\r\n\t\tinstance.trigger('onFullscreenChange', FullScreen.isFullscreen() );\r\n\r\n\t});\r\n\r\n}(document, window.jQuery));\r\n\r\n// ==========================================================================\r\n//\r\n// Thumbs\r\n// Displays thumbnails in a grid\r\n//\r\n// ==========================================================================\r\n;(function (document, $) {\r\n\t'use strict';\r\n\r\n\tvar FancyThumbs = function( instance ) {\r\n\t\tthis.instance = instance;\r\n\t\tthis.init();\r\n\t};\r\n\r\n\t$.extend( FancyThumbs.prototype, {\r\n\r\n\t\t$button\t\t: null,\r\n\t\t$grid\t\t: null,\r\n\t\t$list\t\t: null,\r\n\t\tisVisible\t: false,\r\n\r\n\t\tinit : function() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tvar first  = self.instance.group[0],\r\n\t\t\t\tsecond = self.instance.group[1];\r\n\r\n\t\t\tself.$button = self.instance.$refs.toolbar.find( '[data-fancybox-thumbs]' );\r\n\r\n\t\t\tif ( self.instance.group.length > 1 && self.instance.group[ self.instance.currIndex ].opts.thumbs && (\r\n\t\t    \t\t( first.type == 'image'  || first.opts.thumb  || first.opts.$thumb ) &&\r\n\t\t    \t\t( second.type == 'image' || second.opts.thumb || second.opts.$thumb )\r\n\t\t\t)) {\r\n\r\n\t\t\t\tself.$button.on('click', function() {\r\n\t\t\t\t\tself.toggle();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tself.isActive = true;\r\n\r\n\t\t\t} else {\r\n\t\t\t\tself.$button.hide();\r\n\r\n\t\t\t\tself.isActive = false;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcreate : function() {\r\n\t\t\tvar instance = this.instance,\r\n\t\t\t\tlist,\r\n\t\t\t\tsrc;\r\n\r\n\t\t\tthis.$grid = $('<div class=\"fancybox-thumbs\"></div>').appendTo( instance.$refs.container );\r\n\r\n\t\t\tlist = '<ul>';\r\n\r\n\t\t\t$.each(instance.group, function( i, item ) {\r\n\r\n\t\t\t\tsrc = item.opts.thumb || ( item.opts.$thumb ? item.opts.$thumb.attr('src') : null );\r\n\r\n\t\t\t\tif ( !src && item.type === 'image' ) {\r\n\t\t\t\t\tsrc = item.src;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( src && src.length ) {\r\n\t\t\t\t\tlist += '<li data-index=\"' + i + '\"  tabindex=\"0\" class=\"fancybox-thumbs-loading\"><img data-src=\"' + src + '\" /></li>';\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\tlist += '</ul>';\r\n\r\n\t\t\tthis.$list = $( list ).appendTo( this.$grid ).on('click', 'li', function() {\r\n\t\t\t\tinstance.jumpTo( $(this).data('index') );\r\n\t\t\t});\r\n\r\n\t\t\tthis.$list.find('img').hide().one('load', function() {\r\n\r\n\t\t\t\tvar $parent\t\t= $(this).parent().removeClass( 'fancybox-thumbs-loading' ),\r\n\t\t\t\t\tthumbWidth\t= $parent.outerWidth(),\r\n\t\t\t\t\tthumbHeight\t= $parent.outerHeight(),\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\theight,\r\n\t\t\t\t\twidthRatio,\r\n\t\t\t\t\theightRatio;\r\n\r\n\t\t\t\twidth  = this.naturalWidth\t|| this.width;\r\n\t\t\t\theight = this.naturalHeight\t|| this.height;\r\n\r\n\t\t\t\t// Calculate thumbnail width/height and center it\r\n\r\n\t\t\t\twidthRatio  = width  / thumbWidth;\r\n\t\t\t\theightRatio = height / thumbHeight;\r\n\r\n\t\t\t\tif ( widthRatio >= 1 && heightRatio >= 1 ) {\r\n\t\t\t\t\tif (widthRatio > heightRatio) {\r\n\t\t\t\t\t\twidth  = width / heightRatio;\r\n\t\t\t\t\t\theight = thumbHeight;\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\twidth  = thumbWidth;\r\n\t\t\t\t\t\theight = height / widthRatio;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(this).css({\r\n\t\t\t\t\twidth         : Math.floor(width),\r\n\t\t\t\t\theight        : Math.floor(height),\r\n\t\t\t\t\t'margin-top'  : Math.min( 0, Math.floor(thumbHeight * 0.3 - height * 0.3 ) ),\r\n\t\t\t\t\t'margin-left' : Math.min( 0, Math.floor(thumbWidth  * 0.5 - width  * 0.5 ) )\r\n\t\t\t\t}).show();\r\n\r\n\t\t\t})\r\n\t\t\t.each(function() {\r\n\t\t\t\tthis.src = $( this ).data( 'src' );\r\n\t\t\t});\r\n\r\n\t\t},\r\n\r\n\t\tfocus : function() {\r\n\r\n\t\t\tif ( this.instance.current ) {\r\n\t\t\t\tthis.$list\r\n\t\t\t\t\t.children()\r\n\t\t\t\t\t.removeClass( 'fancybox-thumbs-active' )\r\n\t\t\t\t\t.filter( '[data-index=\"' + this.instance.current.index  + '\"]' )\r\n\t\t\t\t\t.addClass( 'fancybox-thumbs-active' )\r\n\t\t\t\t\t.focus();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclose : function() {\r\n\t\t\tthis.$grid.hide();\r\n\t\t},\r\n\r\n\t\tupdate : function() {\r\n\r\n\t\t\tthis.instance.$refs.container.toggleClass( 'fancybox-show-thumbs', this.isVisible );\r\n\r\n\t\t\tif ( this.isVisible ) {\r\n\r\n\t\t\t\tif ( !this.$grid ) {\r\n\t\t\t\t\tthis.create();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.instance.trigger( 'onThumbsShow' );\r\n\r\n\t\t\t\tthis.focus();\r\n\r\n\t\t\t} else if ( this.$grid ) {\r\n\t\t\t\tthis.instance.trigger( 'onThumbsHide' );\r\n\t\t\t}\r\n\r\n\t\t\t// Update content position\r\n\t\t\tthis.instance.update();\r\n\r\n\t\t},\r\n\r\n\t\thide : function() {\r\n\t\t\tthis.isVisible = false;\r\n\t\t\tthis.update();\r\n\t\t},\r\n\r\n\t\tshow : function() {\r\n\t\t\tthis.isVisible = true;\r\n\t\t\tthis.update();\r\n\t\t},\r\n\r\n\t\ttoggle : function() {\r\n\t\t\tthis.isVisible = !this.isVisible;\r\n\t\t\tthis.update();\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t$(document).on({\r\n\r\n\t\t'onInit.fb' : function(e, instance) {\r\n\t\t\tif ( instance && !instance.Thumbs ) {\r\n\t\t\t\tinstance.Thumbs = new FancyThumbs( instance );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'beforeShow.fb' : function(e, instance, item, firstRun) {\r\n\t\t\tvar Thumbs = instance && instance.Thumbs;\r\n\r\n\t\t\tif ( !Thumbs || !Thumbs.isActive ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( item.modal ) {\r\n\t\t\t\tThumbs.$button.hide();\r\n\r\n\t\t\t\tThumbs.hide();\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( firstRun && item.opts.thumbs.autoStart === true ) {\r\n\t\t\t\tThumbs.show();\r\n\t\t\t}\r\n\r\n\t\t\tif ( Thumbs.isVisible ) {\r\n\t\t\t\tThumbs.focus();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'afterKeydown.fb' : function(e, instance, current, keypress, keycode) {\r\n\t\t\tvar Thumbs = instance && instance.Thumbs;\r\n\r\n\t\t\t// \"G\"\r\n\t\t\tif ( Thumbs && Thumbs.isActive && keycode === 71 ) {\r\n\t\t\t\tkeypress.preventDefault();\r\n\r\n\t\t\t\tThumbs.toggle();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t'beforeClose.fb' : function( e, instance ) {\r\n\t\t\tvar Thumbs = instance && instance.Thumbs;\r\n\r\n\t\t\tif ( Thumbs && Thumbs.isVisible && instance.opts.thumbs.hideOnClose !== false ) {\r\n\t\t\t\tThumbs.close();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\r\n}(document, window.jQuery));\r\n\r\n// ==========================================================================\r\n//\r\n// Hash\r\n// Enables linking to each modal\r\n//\r\n// ==========================================================================\r\n;(function (document, window, $) {\r\n\t'use strict';\r\n\r\n\t// Simple $.escapeSelector polyfill (for jQuery prior v3)\r\n\tif ( !$.escapeSelector ) {\r\n\t\t$.escapeSelector = function( sel ) {\r\n\t\t\tvar rcssescape = /([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\x80-\\uFFFF\\w-]/g;\r\n\t\t\tvar fcssescape = function( ch, asCodePoint ) {\r\n\t\t\t\tif ( asCodePoint ) {\r\n\t\t\t\t\t// U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER\r\n\t\t\t\t\tif ( ch === \"\\0\" ) {\r\n\t\t\t\t\t\treturn \"\\uFFFD\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Control characters and (dependent upon position) numbers get escaped as code points\r\n\t\t\t\t\treturn ch.slice( 0, -1 ) + \"\\\\\" + ch.charCodeAt( ch.length - 1 ).toString( 16 ) + \" \";\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Other potentially-special ASCII characters get backslash-escaped\r\n\t\t\t\treturn \"\\\\\" + ch;\r\n\t\t\t};\r\n\r\n\t\t\treturn ( sel + \"\" ).replace( rcssescape, fcssescape );\r\n\t\t};\r\n\t}\r\n\r\n\t// Create new history entry only once\r\n\tvar shouldCreateHistory = true;\r\n\r\n\t// Variable containing last hash value set by fancyBox\r\n\t// It will be used to determine if fancyBox needs to close after hash change is detected\r\n    var currentHash = null;\r\n\r\n\t// Throttling the history change\r\n\tvar timerID = null;\r\n\r\n\t// Get info about gallery name and current index from url\r\n    function parseUrl() {\r\n        var hash    = window.location.hash.substr( 1 );\r\n        var rez     = hash.split( '-' );\r\n        var index   = rez.length > 1 && /^\\+?\\d+$/.test( rez[ rez.length - 1 ] ) ? parseInt( rez.pop( -1 ), 10 ) || 1 : 1;\r\n        var gallery = rez.join( '-' );\r\n\r\n\t\t// Index is starting from 1\r\n\t\tif ( index < 1 ) {\r\n\t\t\tindex = 1;\r\n\t\t}\r\n\r\n        return {\r\n            hash    : hash,\r\n            index   : index,\r\n            gallery : gallery\r\n        };\r\n    }\r\n\r\n\t// Trigger click evnt on links to open new fancyBox instance\r\n\tfunction triggerFromUrl( url ) {\r\n\t\tvar $el;\r\n\r\n        if ( url.gallery !== '' ) {\r\n\r\n\t\t\t// If we can find element matching 'data-fancybox' atribute, then trigger click event for that ..\r\n\t\t\t$el = $( \"[data-fancybox='\" + $.escapeSelector( url.gallery ) + \"']\" ).eq( url.index - 1 );\r\n\r\n            if ( !$el.length ) {\r\n\t\t\t\t// .. if not, try finding element by ID\r\n\t\t\t\t$el = $( \"#\" + $.escapeSelector( url.gallery ) + \"\" );\r\n\t\t\t}\r\n\r\n\t\t\tif ( $el.length ) {\r\n\t\t\t\tshouldCreateHistory = false;\r\n\r\n\t\t\t\t$el.trigger( 'click' );\r\n\t\t\t}\r\n\r\n        }\r\n\t}\r\n\r\n\t// Get gallery name from current instance\r\n\tfunction getGalleryID( instance ) {\r\n\t\tvar opts;\r\n\r\n\t\tif ( !instance ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\topts = instance.current ? instance.current.opts : instance.opts;\r\n\r\n\t\treturn opts.hash || ( opts.$orig ? opts.$orig.data( 'fancybox' ) : ''  );\r\n\t}\r\n\r\n\t// Star when DOM becomes ready\r\n    $(function() {\r\n\r\n\t\t// Small delay is used to allow other scripts to process \"dom ready\" event\r\n\t\tsetTimeout(function() {\r\n\r\n\t\t\t// Check if this module is not disabled\r\n\t\t\tif ( $.fancybox.defaults.hash === false ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Update hash when opening/closing fancyBox\r\n\t\t    $(document).on({\r\n\t\t\t\t'onInit.fb' : function( e, instance ) {\r\n\t\t\t\t\tvar url, gallery;\r\n\r\n\t\t\t\t\tif ( instance.group[ instance.currIndex ].opts.hash === false ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\turl     = parseUrl();\r\n\t\t\t\t\tgallery = getGalleryID( instance );\r\n\r\n\t\t\t\t\t// Make sure gallery start index matches index from hash\r\n\t\t\t\t\tif ( gallery && url.gallery && gallery == url.gallery ) {\r\n\t\t\t\t\t\tinstance.currIndex = url.index - 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\t'beforeShow.fb' : function( e, instance, current ) {\r\n\t\t\t\t\tvar gallery;\r\n\r\n\t\t\t\t\tif ( !current || current.opts.hash === false ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t            gallery = getGalleryID( instance );\r\n\r\n\t\t            // Update window hash\r\n\t\t            if ( gallery && gallery !== '' ) {\r\n\r\n\t\t\t\t\t\tif ( window.location.hash.indexOf( gallery ) < 0 ) {\r\n\t\t\t                instance.opts.origHash = window.location.hash;\r\n\t\t\t            }\r\n\r\n\t\t\t\t\t\tcurrentHash = gallery + ( instance.group.length > 1 ? '-' + ( current.index + 1 ) : '' );\r\n\r\n\t\t\t\t\t\tif ( 'replaceState' in window.history ) {\r\n\t\t\t\t\t\t\tif ( timerID ) {\r\n\t\t\t\t\t\t\t\tclearTimeout( timerID );\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\ttimerID = setTimeout(function() {\r\n\t\t\t\t\t\t\t\twindow.history[ shouldCreateHistory ? 'pushState' : 'replaceState' ]( {} , document.title, window.location.pathname + window.location.search + '#' +  currentHash );\r\n\r\n\t\t\t\t\t\t\t\ttimerID = null;\r\n\r\n\t\t\t\t\t\t\t\tshouldCreateHistory = false;\r\n\r\n\t\t\t\t\t\t\t}, 300);\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\twindow.location.hash = currentHash;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t            }\r\n\r\n\t\t        },\r\n\r\n\t\t\t\t'beforeClose.fb' : function( e, instance, current ) {\r\n\t\t\t\t\tvar gallery, origHash;\r\n\r\n\t\t\t\t\tif ( timerID ) {\r\n\t\t\t\t\t\tclearTimeout( timerID );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( current.opts.hash === false ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgallery  = getGalleryID( instance );\r\n\t\t\t\t\torigHash = instance && instance.opts.origHash ? instance.opts.origHash : '';\r\n\r\n\t\t            // Remove hash from location bar\r\n\t\t            if ( gallery && gallery !== '' ) {\r\n\r\n\t\t                if ( 'replaceState' in history ) {\r\n\t\t\t\t\t\t\twindow.history.replaceState( {} , document.title, window.location.pathname + window.location.search + origHash );\r\n\r\n\t\t                } else {\r\n\t\t\t\t\t\t\twindow.location.hash = origHash;\r\n\r\n\t\t\t\t\t\t\t// Keep original scroll position\r\n\t\t\t\t\t\t\t$( window ).scrollTop( instance.scrollTop ).scrollLeft( instance.scrollLeft );\r\n\t\t                }\r\n\t\t            }\r\n\r\n\t\t\t\t\tcurrentHash = null;\r\n\t\t        }\r\n\t\t    });\r\n\r\n\t\t\t// Check if need to close after url has changed\r\n\t\t\t$(window).on('hashchange.fb', function() {\r\n\t\t\t\tvar url = parseUrl();\r\n\r\n\t\t\t\tif ( $.fancybox.getInstance() ) {\r\n\t\t\t\t\tif ( currentHash && currentHash !== url.gallery + '-' + url.index && !( url.index === 1 && currentHash == url.gallery ) ) {\r\n\t\t\t\t\t\tcurrentHash = null;\r\n\r\n\t\t\t\t\t\t$.fancybox.close();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( url.gallery !== '' ) {\r\n\t\t\t\t\ttriggerFromUrl( url );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Check current hash and trigger click event on matching element to start fancyBox, if needed\r\n\t\t\ttriggerFromUrl( parseUrl() );\r\n\r\n\t\t}, 50);\r\n\r\n    });\r\n\r\n}(document, window, window.jQuery));\r\n","/*!\r\n * Flickity PACKAGED v2.0.10\r\n * Touch, responsive, flickable carousels\r\n *\r\n * Licensed GPLv3 for open source use\r\n * or Flickity Commercial License for commercial use\r\n *\r\n * http://flickity.metafizzy.co\r\n * Copyright 2017 Metafizzy\r\n */\r\n\r\n/**\r\n * Bridget makes jQuery widgets\r\n * v2.0.1\r\n * MIT license\r\n */\r\n\r\n/* jshint browser: true, strict: true, undef: true, unused: true */\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /*jshint strict: false */ /* globals define, module, require */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'jquery-bridget/jquery-bridget',[ 'jquery' ], function( jQuery ) {\r\n      return factory( window, jQuery );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('jquery')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.jQueryBridget = factory(\r\n      window,\r\n      window.jQuery\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, jQuery ) {\r\n'use strict';\r\n\r\n// ----- utils ----- //\r\n\r\nvar arraySlice = Array.prototype.slice;\r\n\r\n// helper function for logging errors\r\n// $.error breaks jQuery chaining\r\nvar console = window.console;\r\nvar logError = typeof console == 'undefined' ? function() {} :\r\n  function( message ) {\r\n    console.error( message );\r\n  };\r\n\r\n// ----- jQueryBridget ----- //\r\n\r\nfunction jQueryBridget( namespace, PluginClass, $ ) {\r\n  $ = $ || jQuery || window.jQuery;\r\n  if ( !$ ) {\r\n    return;\r\n  }\r\n\r\n  // add option method -> $().plugin('option', {...})\r\n  if ( !PluginClass.prototype.option ) {\r\n    // option setter\r\n    PluginClass.prototype.option = function( opts ) {\r\n      // bail out if not an object\r\n      if ( !$.isPlainObject( opts ) ){\r\n        return;\r\n      }\r\n      this.options = $.extend( true, this.options, opts );\r\n    };\r\n  }\r\n\r\n  // make jQuery plugin\r\n  $.fn[ namespace ] = function( arg0 /*, arg1 */ ) {\r\n    if ( typeof arg0 == 'string' ) {\r\n      // method call $().plugin( 'methodName', { options } )\r\n      // shift arguments by 1\r\n      var args = arraySlice.call( arguments, 1 );\r\n      return methodCall( this, arg0, args );\r\n    }\r\n    // just $().plugin({ options })\r\n    plainCall( this, arg0 );\r\n    return this;\r\n  };\r\n\r\n  // $().plugin('methodName')\r\n  function methodCall( $elems, methodName, args ) {\r\n    var returnValue;\r\n    var pluginMethodStr = '$().' + namespace + '(\"' + methodName + '\")';\r\n\r\n    $elems.each( function( i, elem ) {\r\n      // get instance\r\n      var instance = $.data( elem, namespace );\r\n      if ( !instance ) {\r\n        logError( namespace + ' not initialized. Cannot call methods, i.e. ' +\r\n          pluginMethodStr );\r\n        return;\r\n      }\r\n\r\n      var method = instance[ methodName ];\r\n      if ( !method || methodName.charAt(0) == '_' ) {\r\n        logError( pluginMethodStr + ' is not a valid method' );\r\n        return;\r\n      }\r\n\r\n      // apply method, get return value\r\n      var value = method.apply( instance, args );\r\n      // set return value if value is returned, use only first value\r\n      returnValue = returnValue === undefined ? value : returnValue;\r\n    });\r\n\r\n    return returnValue !== undefined ? returnValue : $elems;\r\n  }\r\n\r\n  function plainCall( $elems, options ) {\r\n    $elems.each( function( i, elem ) {\r\n      var instance = $.data( elem, namespace );\r\n      if ( instance ) {\r\n        // set options & init\r\n        instance.option( options );\r\n        instance._init();\r\n      } else {\r\n        // initialize new instance\r\n        instance = new PluginClass( elem, options );\r\n        $.data( elem, namespace, instance );\r\n      }\r\n    });\r\n  }\r\n\r\n  updateJQuery( $ );\r\n\r\n}\r\n\r\n// ----- updateJQuery ----- //\r\n\r\n// set $.bridget for v1 backwards compatibility\r\nfunction updateJQuery( $ ) {\r\n  if ( !$ || ( $ && $.bridget ) ) {\r\n    return;\r\n  }\r\n  $.bridget = jQueryBridget;\r\n}\r\n\r\nupdateJQuery( jQuery || window.jQuery );\r\n\r\n// -----  ----- //\r\n\r\nreturn jQueryBridget;\r\n\r\n}));\r\n\r\n/**\r\n * EvEmitter v1.1.0\r\n * Lil' event emitter\r\n * MIT License\r\n */\r\n\r\n/* jshint unused: true, undef: true, strict: true */\r\n\r\n( function( global, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */ /* globals define, module, window */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD - RequireJS\r\n    define( 'ev-emitter/ev-emitter',factory );\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS - Browserify, Webpack\r\n    module.exports = factory();\r\n  } else {\r\n    // Browser globals\r\n    global.EvEmitter = factory();\r\n  }\r\n\r\n}( typeof window != 'undefined' ? window : this, function() {\r\n\r\n\r\n\r\nfunction EvEmitter() {}\r\n\r\nvar proto = EvEmitter.prototype;\r\n\r\nproto.on = function( eventName, listener ) {\r\n  if ( !eventName || !listener ) {\r\n    return;\r\n  }\r\n  // set events hash\r\n  var events = this._events = this._events || {};\r\n  // set listeners array\r\n  var listeners = events[ eventName ] = events[ eventName ] || [];\r\n  // only add once\r\n  if ( listeners.indexOf( listener ) == -1 ) {\r\n    listeners.push( listener );\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nproto.once = function( eventName, listener ) {\r\n  if ( !eventName || !listener ) {\r\n    return;\r\n  }\r\n  // add event\r\n  this.on( eventName, listener );\r\n  // set once flag\r\n  // set onceEvents hash\r\n  var onceEvents = this._onceEvents = this._onceEvents || {};\r\n  // set onceListeners object\r\n  var onceListeners = onceEvents[ eventName ] = onceEvents[ eventName ] || {};\r\n  // set flag\r\n  onceListeners[ listener ] = true;\r\n\r\n  return this;\r\n};\r\n\r\nproto.off = function( eventName, listener ) {\r\n  var listeners = this._events && this._events[ eventName ];\r\n  if ( !listeners || !listeners.length ) {\r\n    return;\r\n  }\r\n  var index = listeners.indexOf( listener );\r\n  if ( index != -1 ) {\r\n    listeners.splice( index, 1 );\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nproto.emitEvent = function( eventName, args ) {\r\n  var listeners = this._events && this._events[ eventName ];\r\n  if ( !listeners || !listeners.length ) {\r\n    return;\r\n  }\r\n  // copy over to avoid interference if .off() in listener\r\n  listeners = listeners.slice(0);\r\n  args = args || [];\r\n  // once stuff\r\n  var onceListeners = this._onceEvents && this._onceEvents[ eventName ];\r\n\r\n  for ( var i=0; i < listeners.length; i++ ) {\r\n    var listener = listeners[i]\r\n    var isOnce = onceListeners && onceListeners[ listener ];\r\n    if ( isOnce ) {\r\n      // remove listener\r\n      // remove before trigger to prevent recursion\r\n      this.off( eventName, listener );\r\n      // unset once flag\r\n      delete onceListeners[ listener ];\r\n    }\r\n    // trigger listener\r\n    listener.apply( this, args );\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nproto.allOff = function() {\r\n  delete this._events;\r\n  delete this._onceEvents;\r\n};\r\n\r\nreturn EvEmitter;\r\n\r\n}));\r\n\r\n/*!\r\n * getSize v2.0.2\r\n * measure size of elements\r\n * MIT license\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true, unused: true */\r\n/*global define: false, module: false, console: false */\r\n\r\n( function( window, factory ) {\r\n  'use strict';\r\n\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'get-size/get-size',[],function() {\r\n      return factory();\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory();\r\n  } else {\r\n    // browser global\r\n    window.getSize = factory();\r\n  }\r\n\r\n})( window, function factory() {\r\n'use strict';\r\n\r\n// -------------------------- helpers -------------------------- //\r\n\r\n// get a number from a string, not a percentage\r\nfunction getStyleSize( value ) {\r\n  var num = parseFloat( value );\r\n  // not a percent like '100%', and a number\r\n  var isValid = value.indexOf('%') == -1 && !isNaN( num );\r\n  return isValid && num;\r\n}\r\n\r\nfunction noop() {}\r\n\r\nvar logError = typeof console == 'undefined' ? noop :\r\n  function( message ) {\r\n    console.error( message );\r\n  };\r\n\r\n// -------------------------- measurements -------------------------- //\r\n\r\nvar measurements = [\r\n  'paddingLeft',\r\n  'paddingRight',\r\n  'paddingTop',\r\n  'paddingBottom',\r\n  'marginLeft',\r\n  'marginRight',\r\n  'marginTop',\r\n  'marginBottom',\r\n  'borderLeftWidth',\r\n  'borderRightWidth',\r\n  'borderTopWidth',\r\n  'borderBottomWidth'\r\n];\r\n\r\nvar measurementsLength = measurements.length;\r\n\r\nfunction getZeroSize() {\r\n  var size = {\r\n    width: 0,\r\n    height: 0,\r\n    innerWidth: 0,\r\n    innerHeight: 0,\r\n    outerWidth: 0,\r\n    outerHeight: 0\r\n  };\r\n  for ( var i=0; i < measurementsLength; i++ ) {\r\n    var measurement = measurements[i];\r\n    size[ measurement ] = 0;\r\n  }\r\n  return size;\r\n}\r\n\r\n// -------------------------- getStyle -------------------------- //\r\n\r\n/**\r\n * getStyle, get style of element, check for Firefox bug\r\n * https://bugzilla.mozilla.org/show_bug.cgi?id=548397\r\n */\r\nfunction getStyle( elem ) {\r\n  var style = getComputedStyle( elem );\r\n  if ( !style ) {\r\n    logError( 'Style returned ' + style +\r\n      '. Are you running this code in a hidden iframe on Firefox? ' +\r\n      'See http://bit.ly/getsizebug1' );\r\n  }\r\n  return style;\r\n}\r\n\r\n// -------------------------- setup -------------------------- //\r\n\r\nvar isSetup = false;\r\n\r\nvar isBoxSizeOuter;\r\n\r\n/**\r\n * setup\r\n * check isBoxSizerOuter\r\n * do on first getSize() rather than on page load for Firefox bug\r\n */\r\nfunction setup() {\r\n  // setup once\r\n  if ( isSetup ) {\r\n    return;\r\n  }\r\n  isSetup = true;\r\n\r\n  // -------------------------- box sizing -------------------------- //\r\n\r\n  /**\r\n   * WebKit measures the outer-width on style.width on border-box elems\r\n   * IE & Firefox<29 measures the inner-width\r\n   */\r\n  var div = document.createElement('div');\r\n  div.style.width = '200px';\r\n  div.style.padding = '1px 2px 3px 4px';\r\n  div.style.borderStyle = 'solid';\r\n  div.style.borderWidth = '1px 2px 3px 4px';\r\n  div.style.boxSizing = 'border-box';\r\n\r\n  var body = document.body || document.documentElement;\r\n  body.appendChild( div );\r\n  var style = getStyle( div );\r\n\r\n  getSize.isBoxSizeOuter = isBoxSizeOuter = getStyleSize( style.width ) == 200;\r\n  body.removeChild( div );\r\n\r\n}\r\n\r\n// -------------------------- getSize -------------------------- //\r\n\r\nfunction getSize( elem ) {\r\n  setup();\r\n\r\n  // use querySeletor if elem is string\r\n  if ( typeof elem == 'string' ) {\r\n    elem = document.querySelector( elem );\r\n  }\r\n\r\n  // do not proceed on non-objects\r\n  if ( !elem || typeof elem != 'object' || !elem.nodeType ) {\r\n    return;\r\n  }\r\n\r\n  var style = getStyle( elem );\r\n\r\n  // if hidden, everything is 0\r\n  if ( style.display == 'none' ) {\r\n    return getZeroSize();\r\n  }\r\n\r\n  var size = {};\r\n  size.width = elem.offsetWidth;\r\n  size.height = elem.offsetHeight;\r\n\r\n  var isBorderBox = size.isBorderBox = style.boxSizing == 'border-box';\r\n\r\n  // get all measurements\r\n  for ( var i=0; i < measurementsLength; i++ ) {\r\n    var measurement = measurements[i];\r\n    var value = style[ measurement ];\r\n    var num = parseFloat( value );\r\n    // any 'auto', 'medium' value will be 0\r\n    size[ measurement ] = !isNaN( num ) ? num : 0;\r\n  }\r\n\r\n  var paddingWidth = size.paddingLeft + size.paddingRight;\r\n  var paddingHeight = size.paddingTop + size.paddingBottom;\r\n  var marginWidth = size.marginLeft + size.marginRight;\r\n  var marginHeight = size.marginTop + size.marginBottom;\r\n  var borderWidth = size.borderLeftWidth + size.borderRightWidth;\r\n  var borderHeight = size.borderTopWidth + size.borderBottomWidth;\r\n\r\n  var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\r\n\r\n  // overwrite width and height if we can get it from style\r\n  var styleWidth = getStyleSize( style.width );\r\n  if ( styleWidth !== false ) {\r\n    size.width = styleWidth +\r\n      // add padding and border unless it's already including it\r\n      ( isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth );\r\n  }\r\n\r\n  var styleHeight = getStyleSize( style.height );\r\n  if ( styleHeight !== false ) {\r\n    size.height = styleHeight +\r\n      // add padding and border unless it's already including it\r\n      ( isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight );\r\n  }\r\n\r\n  size.innerWidth = size.width - ( paddingWidth + borderWidth );\r\n  size.innerHeight = size.height - ( paddingHeight + borderHeight );\r\n\r\n  size.outerWidth = size.width + marginWidth;\r\n  size.outerHeight = size.height + marginHeight;\r\n\r\n  return size;\r\n}\r\n\r\nreturn getSize;\r\n\r\n});\r\n\r\n/**\r\n * matchesSelector v2.0.2\r\n * matchesSelector( element, '.selector' )\r\n * MIT license\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true, unused: true */\r\n\r\n( function( window, factory ) {\r\n  /*global define: false, module: false */\r\n  'use strict';\r\n  // universal module definition\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'desandro-matches-selector/matches-selector',factory );\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory();\r\n  } else {\r\n    // browser global\r\n    window.matchesSelector = factory();\r\n  }\r\n\r\n}( window, function factory() {\r\n  'use strict';\r\n\r\n  var matchesMethod = ( function() {\r\n    var ElemProto = window.Element.prototype;\r\n    // check for the standard method name first\r\n    if ( ElemProto.matches ) {\r\n      return 'matches';\r\n    }\r\n    // check un-prefixed\r\n    if ( ElemProto.matchesSelector ) {\r\n      return 'matchesSelector';\r\n    }\r\n    // check vendor prefixes\r\n    var prefixes = [ 'webkit', 'moz', 'ms', 'o' ];\r\n\r\n    for ( var i=0; i < prefixes.length; i++ ) {\r\n      var prefix = prefixes[i];\r\n      var method = prefix + 'MatchesSelector';\r\n      if ( ElemProto[ method ] ) {\r\n        return method;\r\n      }\r\n    }\r\n  })();\r\n\r\n  return function matchesSelector( elem, selector ) {\r\n    return elem[ matchesMethod ]( selector );\r\n  };\r\n\r\n}));\r\n\r\n/**\r\n * Fizzy UI utils v2.0.5\r\n * MIT license\r\n */\r\n\r\n/*jshint browser: true, undef: true, unused: true, strict: true */\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /*jshint strict: false */ /*globals define, module, require */\r\n\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'fizzy-ui-utils/utils',[\r\n      'desandro-matches-selector/matches-selector'\r\n    ], function( matchesSelector ) {\r\n      return factory( window, matchesSelector );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('desandro-matches-selector')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.fizzyUIUtils = factory(\r\n      window,\r\n      window.matchesSelector\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, matchesSelector ) {\r\n\r\n\r\n\r\nvar utils = {};\r\n\r\n// ----- extend ----- //\r\n\r\n// extends objects\r\nutils.extend = function( a, b ) {\r\n  for ( var prop in b ) {\r\n    a[ prop ] = b[ prop ];\r\n  }\r\n  return a;\r\n};\r\n\r\n// ----- modulo ----- //\r\n\r\nutils.modulo = function( num, div ) {\r\n  return ( ( num % div ) + div ) % div;\r\n};\r\n\r\n// ----- makeArray ----- //\r\n\r\n// turn element or nodeList into an array\r\nutils.makeArray = function( obj ) {\r\n  var ary = [];\r\n  if ( Array.isArray( obj ) ) {\r\n    // use object if already an array\r\n    ary = obj;\r\n  } else if ( obj && typeof obj == 'object' &&\r\n    typeof obj.length == 'number' ) {\r\n    // convert nodeList to array\r\n    for ( var i=0; i < obj.length; i++ ) {\r\n      ary.push( obj[i] );\r\n    }\r\n  } else {\r\n    // array of single index\r\n    ary.push( obj );\r\n  }\r\n  return ary;\r\n};\r\n\r\n// ----- removeFrom ----- //\r\n\r\nutils.removeFrom = function( ary, obj ) {\r\n  var index = ary.indexOf( obj );\r\n  if ( index != -1 ) {\r\n    ary.splice( index, 1 );\r\n  }\r\n};\r\n\r\n// ----- getParent ----- //\r\n\r\nutils.getParent = function( elem, selector ) {\r\n  while ( elem.parentNode && elem != document.body ) {\r\n    elem = elem.parentNode;\r\n    if ( matchesSelector( elem, selector ) ) {\r\n      return elem;\r\n    }\r\n  }\r\n};\r\n\r\n// ----- getQueryElement ----- //\r\n\r\n// use element as selector string\r\nutils.getQueryElement = function( elem ) {\r\n  if ( typeof elem == 'string' ) {\r\n    return document.querySelector( elem );\r\n  }\r\n  return elem;\r\n};\r\n\r\n// ----- handleEvent ----- //\r\n\r\n// enable .ontype to trigger from .addEventListener( elem, 'type' )\r\nutils.handleEvent = function( event ) {\r\n  var method = 'on' + event.type;\r\n  if ( this[ method ] ) {\r\n    this[ method ]( event );\r\n  }\r\n};\r\n\r\n// ----- filterFindElements ----- //\r\n\r\nutils.filterFindElements = function( elems, selector ) {\r\n  // make array of elems\r\n  elems = utils.makeArray( elems );\r\n  var ffElems = [];\r\n\r\n  elems.forEach( function( elem ) {\r\n    // check that elem is an actual element\r\n    if ( !( elem instanceof HTMLElement ) ) {\r\n      return;\r\n    }\r\n    // add elem if no selector\r\n    if ( !selector ) {\r\n      ffElems.push( elem );\r\n      return;\r\n    }\r\n    // filter & find items if we have a selector\r\n    // filter\r\n    if ( matchesSelector( elem, selector ) ) {\r\n      ffElems.push( elem );\r\n    }\r\n    // find children\r\n    var childElems = elem.querySelectorAll( selector );\r\n    // concat childElems to filterFound array\r\n    for ( var i=0; i < childElems.length; i++ ) {\r\n      ffElems.push( childElems[i] );\r\n    }\r\n  });\r\n\r\n  return ffElems;\r\n};\r\n\r\n// ----- debounceMethod ----- //\r\n\r\nutils.debounceMethod = function( _class, methodName, threshold ) {\r\n  // original method\r\n  var method = _class.prototype[ methodName ];\r\n  var timeoutName = methodName + 'Timeout';\r\n\r\n  _class.prototype[ methodName ] = function() {\r\n    var timeout = this[ timeoutName ];\r\n    if ( timeout ) {\r\n      clearTimeout( timeout );\r\n    }\r\n    var args = arguments;\r\n\r\n    var _this = this;\r\n    this[ timeoutName ] = setTimeout( function() {\r\n      method.apply( _this, args );\r\n      delete _this[ timeoutName ];\r\n    }, threshold || 100 );\r\n  };\r\n};\r\n\r\n// ----- docReady ----- //\r\n\r\nutils.docReady = function( callback ) {\r\n  var readyState = document.readyState;\r\n  if ( readyState == 'complete' || readyState == 'interactive' ) {\r\n    // do async to allow for other scripts to run. metafizzy/flickity#441\r\n    setTimeout( callback );\r\n  } else {\r\n    document.addEventListener( 'DOMContentLoaded', callback );\r\n  }\r\n};\r\n\r\n// ----- htmlInit ----- //\r\n\r\n// http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/\r\nutils.toDashed = function( str ) {\r\n  return str.replace( /(.)([A-Z])/g, function( match, $1, $2 ) {\r\n    return $1 + '-' + $2;\r\n  }).toLowerCase();\r\n};\r\n\r\nvar console = window.console;\r\n/**\r\n * allow user to initialize classes via [data-namespace] or .js-namespace class\r\n * htmlInit( Widget, 'widgetName' )\r\n * options are parsed from data-namespace-options\r\n */\r\nutils.htmlInit = function( WidgetClass, namespace ) {\r\n  utils.docReady( function() {\r\n    var dashedNamespace = utils.toDashed( namespace );\r\n    var dataAttr = 'data-' + dashedNamespace;\r\n    var dataAttrElems = document.querySelectorAll( '[' + dataAttr + ']' );\r\n    var jsDashElems = document.querySelectorAll( '.js-' + dashedNamespace );\r\n    var elems = utils.makeArray( dataAttrElems )\r\n      .concat( utils.makeArray( jsDashElems ) );\r\n    var dataOptionsAttr = dataAttr + '-options';\r\n    var jQuery = window.jQuery;\r\n\r\n    elems.forEach( function( elem ) {\r\n      var attr = elem.getAttribute( dataAttr ) ||\r\n        elem.getAttribute( dataOptionsAttr );\r\n      var options;\r\n      try {\r\n        options = attr && JSON.parse( attr );\r\n      } catch ( error ) {\r\n        // log error, do not initialize\r\n        if ( console ) {\r\n          console.error( 'Error parsing ' + dataAttr + ' on ' + elem.className +\r\n          ': ' + error );\r\n        }\r\n        return;\r\n      }\r\n      // initialize\r\n      var instance = new WidgetClass( elem, options );\r\n      // make available via $().data('namespace')\r\n      if ( jQuery ) {\r\n        jQuery.data( elem, namespace, instance );\r\n      }\r\n    });\r\n\r\n  });\r\n};\r\n\r\n// -----  ----- //\r\n\r\nreturn utils;\r\n\r\n}));\r\n\r\n// Flickity.Cell\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/cell',[\r\n      'get-size/get-size'\r\n    ], function( getSize ) {\r\n      return factory( window, getSize );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('get-size')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.Flickity = window.Flickity || {};\r\n    window.Flickity.Cell = factory(\r\n      window,\r\n      window.getSize\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, getSize ) {\r\n\r\n\r\n\r\nfunction Cell( elem, parent ) {\r\n  this.element = elem;\r\n  this.parent = parent;\r\n\r\n  this.create();\r\n}\r\n\r\nvar proto = Cell.prototype;\r\n\r\nproto.create = function() {\r\n  this.element.style.position = 'absolute';\r\n  this.x = 0;\r\n  this.shift = 0;\r\n};\r\n\r\nproto.destroy = function() {\r\n  // reset style\r\n  this.element.style.position = '';\r\n  var side = this.parent.originSide;\r\n  this.element.style[ side ] = '';\r\n};\r\n\r\nproto.getSize = function() {\r\n  this.size = getSize( this.element );\r\n};\r\n\r\nproto.setPosition = function( x ) {\r\n  this.x = x;\r\n  this.updateTarget();\r\n  this.renderPosition( x );\r\n};\r\n\r\n// setDefaultTarget v1 method, backwards compatibility, remove in v3\r\nproto.updateTarget = proto.setDefaultTarget = function() {\r\n  var marginProperty = this.parent.originSide == 'left' ? 'marginLeft' : 'marginRight';\r\n  this.target = this.x + this.size[ marginProperty ] +\r\n    this.size.width * this.parent.cellAlign;\r\n};\r\n\r\nproto.renderPosition = function( x ) {\r\n  // render position of cell with in slider\r\n  var side = this.parent.originSide;\r\n  this.element.style[ side ] = this.parent.getPositionValue( x );\r\n};\r\n\r\n/**\r\n * @param {Integer} factor - 0, 1, or -1\r\n**/\r\nproto.wrapShift = function( shift ) {\r\n  this.shift = shift;\r\n  this.renderPosition( this.x + this.parent.slideableWidth * shift );\r\n};\r\n\r\nproto.remove = function() {\r\n  this.element.parentNode.removeChild( this.element );\r\n};\r\n\r\nreturn Cell;\r\n\r\n}));\r\n\r\n// slide\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/slide',factory );\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory();\r\n  } else {\r\n    // browser global\r\n    window.Flickity = window.Flickity || {};\r\n    window.Flickity.Slide = factory();\r\n  }\r\n\r\n}( window, function factory() {\r\n'use strict';\r\n\r\nfunction Slide( parent ) {\r\n  this.parent = parent;\r\n  this.isOriginLeft = parent.originSide == 'left';\r\n  this.cells = [];\r\n  this.outerWidth = 0;\r\n  this.height = 0;\r\n}\r\n\r\nvar proto = Slide.prototype;\r\n\r\nproto.addCell = function( cell ) {\r\n  this.cells.push( cell );\r\n  this.outerWidth += cell.size.outerWidth;\r\n  this.height = Math.max( cell.size.outerHeight, this.height );\r\n  // first cell stuff\r\n  if ( this.cells.length == 1 ) {\r\n    this.x = cell.x; // x comes from first cell\r\n    var beginMargin = this.isOriginLeft ? 'marginLeft' : 'marginRight';\r\n    this.firstMargin = cell.size[ beginMargin ];\r\n  }\r\n};\r\n\r\nproto.updateTarget = function() {\r\n  var endMargin = this.isOriginLeft ? 'marginRight' : 'marginLeft';\r\n  var lastCell = this.getLastCell();\r\n  var lastMargin = lastCell ? lastCell.size[ endMargin ] : 0;\r\n  var slideWidth = this.outerWidth - ( this.firstMargin + lastMargin );\r\n  this.target = this.x + this.firstMargin + slideWidth * this.parent.cellAlign;\r\n};\r\n\r\nproto.getLastCell = function() {\r\n  return this.cells[ this.cells.length - 1 ];\r\n};\r\n\r\nproto.select = function() {\r\n  this.changeSelectedClass('add');\r\n};\r\n\r\nproto.unselect = function() {\r\n  this.changeSelectedClass('remove');\r\n};\r\n\r\nproto.changeSelectedClass = function( method ) {\r\n  this.cells.forEach( function( cell ) {\r\n    cell.element.classList[ method ]('is-selected');\r\n  });\r\n};\r\n\r\nproto.getCellElements = function() {\r\n  return this.cells.map( function( cell ) {\r\n    return cell.element;\r\n  });\r\n};\r\n\r\nreturn Slide;\r\n\r\n}));\r\n\r\n// animate\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/animate',[\r\n      'fizzy-ui-utils/utils'\r\n    ], function( utils ) {\r\n      return factory( window, utils );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('fizzy-ui-utils')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.Flickity = window.Flickity || {};\r\n    window.Flickity.animatePrototype = factory(\r\n      window,\r\n      window.fizzyUIUtils\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, utils ) {\r\n\r\n\r\n\r\n// -------------------------- requestAnimationFrame -------------------------- //\r\n\r\n// get rAF, prefixed, if present\r\nvar requestAnimationFrame = window.requestAnimationFrame ||\r\n  window.webkitRequestAnimationFrame;\r\n\r\n// fallback to setTimeout\r\nvar lastTime = 0;\r\nif ( !requestAnimationFrame )  {\r\n  requestAnimationFrame = function( callback ) {\r\n    var currTime = new Date().getTime();\r\n    var timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\r\n    var id = setTimeout( callback, timeToCall );\r\n    lastTime = currTime + timeToCall;\r\n    return id;\r\n  };\r\n}\r\n\r\n// -------------------------- animate -------------------------- //\r\n\r\nvar proto = {};\r\n\r\nproto.startAnimation = function() {\r\n  if ( this.isAnimating ) {\r\n    return;\r\n  }\r\n\r\n  this.isAnimating = true;\r\n  this.restingFrames = 0;\r\n  this.animate();\r\n};\r\n\r\nproto.animate = function() {\r\n  this.applyDragForce();\r\n  this.applySelectedAttraction();\r\n\r\n  var previousX = this.x;\r\n\r\n  this.integratePhysics();\r\n  this.positionSlider();\r\n  this.settle( previousX );\r\n  // animate next frame\r\n  if ( this.isAnimating ) {\r\n    var _this = this;\r\n    requestAnimationFrame( function animateFrame() {\r\n      _this.animate();\r\n    });\r\n  }\r\n};\r\n\r\n\r\nvar transformProperty = ( function () {\r\n  var style = document.documentElement.style;\r\n  if ( typeof style.transform == 'string' ) {\r\n    return 'transform';\r\n  }\r\n  return 'WebkitTransform';\r\n})();\r\n\r\nproto.positionSlider = function() {\r\n  var x = this.x;\r\n  // wrap position around\r\n  if ( this.options.wrapAround && this.cells.length > 1 ) {\r\n    x = utils.modulo( x, this.slideableWidth );\r\n    x = x - this.slideableWidth;\r\n    this.shiftWrapCells( x );\r\n  }\r\n\r\n  x = x + this.cursorPosition;\r\n  // reverse if right-to-left and using transform\r\n  x = this.options.rightToLeft && transformProperty ? -x : x;\r\n  var value = this.getPositionValue( x );\r\n  // use 3D tranforms for hardware acceleration on iOS\r\n  // but use 2D when settled, for better font-rendering\r\n  this.slider.style[ transformProperty ] = this.isAnimating ?\r\n    'translate3d(' + value + ',0,0)' : 'translateX(' + value + ')';\r\n\r\n  // scroll event\r\n  var firstSlide = this.slides[0];\r\n  if ( firstSlide ) {\r\n    var positionX = -this.x - firstSlide.target;\r\n    var progress = positionX / this.slidesWidth;\r\n    this.dispatchEvent( 'scroll', null, [ progress, positionX ] );\r\n  }\r\n};\r\n\r\nproto.positionSliderAtSelected = function() {\r\n  if ( !this.cells.length ) {\r\n    return;\r\n  }\r\n  this.x = -this.selectedSlide.target;\r\n  this.positionSlider();\r\n};\r\n\r\nproto.getPositionValue = function( position ) {\r\n  if ( this.options.percentPosition ) {\r\n    // percent position, round to 2 digits, like 12.34%\r\n    return ( Math.round( ( position / this.size.innerWidth ) * 10000 ) * 0.01 )+ '%';\r\n  } else {\r\n    // pixel positioning\r\n    return Math.round( position ) + 'px';\r\n  }\r\n};\r\n\r\nproto.settle = function( previousX ) {\r\n  // keep track of frames where x hasn't moved\r\n  if ( !this.isPointerDown && Math.round( this.x * 100 ) == Math.round( previousX * 100 ) ) {\r\n    this.restingFrames++;\r\n  }\r\n  // stop animating if resting for 3 or more frames\r\n  if ( this.restingFrames > 2 ) {\r\n    this.isAnimating = false;\r\n    delete this.isFreeScrolling;\r\n    // render position with translateX when settled\r\n    this.positionSlider();\r\n    this.dispatchEvent('settle');\r\n  }\r\n};\r\n\r\nproto.shiftWrapCells = function( x ) {\r\n  // shift before cells\r\n  var beforeGap = this.cursorPosition + x;\r\n  this._shiftCells( this.beforeShiftCells, beforeGap, -1 );\r\n  // shift after cells\r\n  var afterGap = this.size.innerWidth - ( x + this.slideableWidth + this.cursorPosition );\r\n  this._shiftCells( this.afterShiftCells, afterGap, 1 );\r\n};\r\n\r\nproto._shiftCells = function( cells, gap, shift ) {\r\n  for ( var i=0; i < cells.length; i++ ) {\r\n    var cell = cells[i];\r\n    var cellShift = gap > 0 ? shift : 0;\r\n    cell.wrapShift( cellShift );\r\n    gap -= cell.size.outerWidth;\r\n  }\r\n};\r\n\r\nproto._unshiftCells = function( cells ) {\r\n  if ( !cells || !cells.length ) {\r\n    return;\r\n  }\r\n  for ( var i=0; i < cells.length; i++ ) {\r\n    cells[i].wrapShift( 0 );\r\n  }\r\n};\r\n\r\n// -------------------------- physics -------------------------- //\r\n\r\nproto.integratePhysics = function() {\r\n  this.x += this.velocity;\r\n  this.velocity *= this.getFrictionFactor();\r\n};\r\n\r\nproto.applyForce = function( force ) {\r\n  this.velocity += force;\r\n};\r\n\r\nproto.getFrictionFactor = function() {\r\n  return 1 - this.options[ this.isFreeScrolling ? 'freeScrollFriction' : 'friction' ];\r\n};\r\n\r\nproto.getRestingPosition = function() {\r\n  // my thanks to Steven Wittens, who simplified this math greatly\r\n  return this.x + this.velocity / ( 1 - this.getFrictionFactor() );\r\n};\r\n\r\nproto.applyDragForce = function() {\r\n  if ( !this.isPointerDown ) {\r\n    return;\r\n  }\r\n  // change the position to drag position by applying force\r\n  var dragVelocity = this.dragX - this.x;\r\n  var dragForce = dragVelocity - this.velocity;\r\n  this.applyForce( dragForce );\r\n};\r\n\r\nproto.applySelectedAttraction = function() {\r\n  // do not attract if pointer down or no cells\r\n  if ( this.isPointerDown || this.isFreeScrolling || !this.cells.length ) {\r\n    return;\r\n  }\r\n  var distance = this.selectedSlide.target * -1 - this.x;\r\n  var force = distance * this.options.selectedAttraction;\r\n  this.applyForce( force );\r\n};\r\n\r\nreturn proto;\r\n\r\n}));\r\n\r\n// Flickity main\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/flickity',[\r\n      'ev-emitter/ev-emitter',\r\n      'get-size/get-size',\r\n      'fizzy-ui-utils/utils',\r\n      './cell',\r\n      './slide',\r\n      './animate'\r\n    ], function( EvEmitter, getSize, utils, Cell, Slide, animatePrototype ) {\r\n      return factory( window, EvEmitter, getSize, utils, Cell, Slide, animatePrototype );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('ev-emitter'),\r\n      require('get-size'),\r\n      require('fizzy-ui-utils'),\r\n      require('./cell'),\r\n      require('./slide'),\r\n      require('./animate')\r\n    );\r\n  } else {\r\n    // browser global\r\n    var _Flickity = window.Flickity;\r\n\r\n    window.Flickity = factory(\r\n      window,\r\n      window.EvEmitter,\r\n      window.getSize,\r\n      window.fizzyUIUtils,\r\n      _Flickity.Cell,\r\n      _Flickity.Slide,\r\n      _Flickity.animatePrototype\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, EvEmitter, getSize,\r\n  utils, Cell, Slide, animatePrototype ) {\r\n\r\n\r\n\r\n// vars\r\nvar jQuery = window.jQuery;\r\nvar getComputedStyle = window.getComputedStyle;\r\nvar console = window.console;\r\n\r\nfunction moveElements( elems, toElem ) {\r\n  elems = utils.makeArray( elems );\r\n  while ( elems.length ) {\r\n    toElem.appendChild( elems.shift() );\r\n  }\r\n}\r\n\r\n// -------------------------- Flickity -------------------------- //\r\n\r\n// globally unique identifiers\r\nvar GUID = 0;\r\n// internal store of all Flickity intances\r\nvar instances = {};\r\n\r\nfunction Flickity( element, options ) {\r\n  var queryElement = utils.getQueryElement( element );\r\n  if ( !queryElement ) {\r\n    if ( console ) {\r\n      console.error( 'Bad element for Flickity: ' + ( queryElement || element ) );\r\n    }\r\n    return;\r\n  }\r\n  this.element = queryElement;\r\n  // do not initialize twice on same element\r\n  if ( this.element.flickityGUID ) {\r\n    var instance = instances[ this.element.flickityGUID ];\r\n    instance.option( options );\r\n    return instance;\r\n  }\r\n\r\n  // add jQuery\r\n  if ( jQuery ) {\r\n    this.$element = jQuery( this.element );\r\n  }\r\n  // options\r\n  this.options = utils.extend( {}, this.constructor.defaults );\r\n  this.option( options );\r\n\r\n  // kick things off\r\n  this._create();\r\n}\r\n\r\nFlickity.defaults = {\r\n  accessibility: true,\r\n  // adaptiveHeight: false,\r\n  cellAlign: 'center',\r\n  // cellSelector: undefined,\r\n  // contain: false,\r\n  freeScrollFriction: 0.075, // friction when free-scrolling\r\n  friction: 0.28, // friction when selecting\r\n  namespaceJQueryEvents: true,\r\n  // initialIndex: 0,\r\n  percentPosition: true,\r\n  resize: true,\r\n  selectedAttraction: 0.025,\r\n  setGallerySize: true\r\n  // watchCSS: false,\r\n  // wrapAround: false\r\n};\r\n\r\n// hash of methods triggered on _create()\r\nFlickity.createMethods = [];\r\n\r\nvar proto = Flickity.prototype;\r\n// inherit EventEmitter\r\nutils.extend( proto, EvEmitter.prototype );\r\n\r\nproto._create = function() {\r\n  // add id for Flickity.data\r\n  var id = this.guid = ++GUID;\r\n  this.element.flickityGUID = id; // expando\r\n  instances[ id ] = this; // associate via id\r\n  // initial properties\r\n  this.selectedIndex = 0;\r\n  // how many frames slider has been in same position\r\n  this.restingFrames = 0;\r\n  // initial physics properties\r\n  this.x = 0;\r\n  this.velocity = 0;\r\n  this.originSide = this.options.rightToLeft ? 'right' : 'left';\r\n  // create viewport & slider\r\n  this.viewport = document.createElement('div');\r\n  this.viewport.className = 'flickity-viewport';\r\n  this._createSlider();\r\n\r\n  if ( this.options.resize || this.options.watchCSS ) {\r\n    window.addEventListener( 'resize', this );\r\n  }\r\n\r\n  Flickity.createMethods.forEach( function( method ) {\r\n    this[ method ]();\r\n  }, this );\r\n\r\n  if ( this.options.watchCSS ) {\r\n    this.watchCSS();\r\n  } else {\r\n    this.activate();\r\n  }\r\n\r\n};\r\n\r\n/**\r\n * set options\r\n * @param {Object} opts\r\n */\r\nproto.option = function( opts ) {\r\n  utils.extend( this.options, opts );\r\n};\r\n\r\nproto.activate = function() {\r\n  if ( this.isActive ) {\r\n    return;\r\n  }\r\n  this.isActive = true;\r\n  this.element.classList.add('flickity-enabled');\r\n  if ( this.options.rightToLeft ) {\r\n    this.element.classList.add('flickity-rtl');\r\n  }\r\n\r\n  this.getSize();\r\n  // move initial cell elements so they can be loaded as cells\r\n  var cellElems = this._filterFindCellElements( this.element.children );\r\n  moveElements( cellElems, this.slider );\r\n  this.viewport.appendChild( this.slider );\r\n  this.element.appendChild( this.viewport );\r\n  // get cells from children\r\n  this.reloadCells();\r\n\r\n  if ( this.options.accessibility ) {\r\n    // allow element to focusable\r\n    this.element.tabIndex = 0;\r\n    // listen for key presses\r\n    this.element.addEventListener( 'keydown', this );\r\n  }\r\n\r\n  this.emitEvent('activate');\r\n\r\n  var index;\r\n  var initialIndex = this.options.initialIndex;\r\n  if ( this.isInitActivated ) {\r\n    index = this.selectedIndex;\r\n  } else if ( initialIndex !== undefined ) {\r\n    index = this.cells[ initialIndex ] ? initialIndex : 0;\r\n  } else {\r\n    index = 0;\r\n  }\r\n  // select instantly\r\n  this.select( index, false, true );\r\n  // flag for initial activation, for using initialIndex\r\n  this.isInitActivated = true;\r\n};\r\n\r\n// slider positions the cells\r\nproto._createSlider = function() {\r\n  // slider element does all the positioning\r\n  var slider = document.createElement('div');\r\n  slider.className = 'flickity-slider';\r\n  slider.style[ this.originSide ] = 0;\r\n  this.slider = slider;\r\n};\r\n\r\nproto._filterFindCellElements = function( elems ) {\r\n  return utils.filterFindElements( elems, this.options.cellSelector );\r\n};\r\n\r\n// goes through all children\r\nproto.reloadCells = function() {\r\n  // collection of item elements\r\n  this.cells = this._makeCells( this.slider.children );\r\n  this.positionCells();\r\n  this._getWrapShiftCells();\r\n  this.setGallerySize();\r\n};\r\n\r\n/**\r\n * turn elements into Flickity.Cells\r\n * @param {Array or NodeList or HTMLElement} elems\r\n * @returns {Array} items - collection of new Flickity Cells\r\n */\r\nproto._makeCells = function( elems ) {\r\n  var cellElems = this._filterFindCellElements( elems );\r\n\r\n  // create new Flickity for collection\r\n  var cells = cellElems.map( function( cellElem ) {\r\n    return new Cell( cellElem, this );\r\n  }, this );\r\n\r\n  return cells;\r\n};\r\n\r\nproto.getLastCell = function() {\r\n  return this.cells[ this.cells.length - 1 ];\r\n};\r\n\r\nproto.getLastSlide = function() {\r\n  return this.slides[ this.slides.length - 1 ];\r\n};\r\n\r\n// positions all cells\r\nproto.positionCells = function() {\r\n  // size all cells\r\n  this._sizeCells( this.cells );\r\n  // position all cells\r\n  this._positionCells( 0 );\r\n};\r\n\r\n/**\r\n * position certain cells\r\n * @param {Integer} index - which cell to start with\r\n */\r\nproto._positionCells = function( index ) {\r\n  index = index || 0;\r\n  // also measure maxCellHeight\r\n  // start 0 if positioning all cells\r\n  this.maxCellHeight = index ? this.maxCellHeight || 0 : 0;\r\n  var cellX = 0;\r\n  // get cellX\r\n  if ( index > 0 ) {\r\n    var startCell = this.cells[ index - 1 ];\r\n    cellX = startCell.x + startCell.size.outerWidth;\r\n  }\r\n  var len = this.cells.length;\r\n  for ( var i=index; i < len; i++ ) {\r\n    var cell = this.cells[i];\r\n    cell.setPosition( cellX );\r\n    cellX += cell.size.outerWidth;\r\n    this.maxCellHeight = Math.max( cell.size.outerHeight, this.maxCellHeight );\r\n  }\r\n  // keep track of cellX for wrap-around\r\n  this.slideableWidth = cellX;\r\n  // slides\r\n  this.updateSlides();\r\n  // contain slides target\r\n  this._containSlides();\r\n  // update slidesWidth\r\n  this.slidesWidth = len ? this.getLastSlide().target - this.slides[0].target : 0;\r\n};\r\n\r\n/**\r\n * cell.getSize() on multiple cells\r\n * @param {Array} cells\r\n */\r\nproto._sizeCells = function( cells ) {\r\n  cells.forEach( function( cell ) {\r\n    cell.getSize();\r\n  });\r\n};\r\n\r\n// --------------------------  -------------------------- //\r\n\r\nproto.updateSlides = function() {\r\n  this.slides = [];\r\n  if ( !this.cells.length ) {\r\n    return;\r\n  }\r\n\r\n  var slide = new Slide( this );\r\n  this.slides.push( slide );\r\n  var isOriginLeft = this.originSide == 'left';\r\n  var nextMargin = isOriginLeft ? 'marginRight' : 'marginLeft';\r\n\r\n  var canCellFit = this._getCanCellFit();\r\n\r\n  this.cells.forEach( function( cell, i ) {\r\n    // just add cell if first cell in slide\r\n    if ( !slide.cells.length ) {\r\n      slide.addCell( cell );\r\n      return;\r\n    }\r\n\r\n    var slideWidth = ( slide.outerWidth - slide.firstMargin ) +\r\n      ( cell.size.outerWidth - cell.size[ nextMargin ] );\r\n\r\n    if ( canCellFit.call( this, i, slideWidth ) ) {\r\n      slide.addCell( cell );\r\n    } else {\r\n      // doesn't fit, new slide\r\n      slide.updateTarget();\r\n\r\n      slide = new Slide( this );\r\n      this.slides.push( slide );\r\n      slide.addCell( cell );\r\n    }\r\n  }, this );\r\n  // last slide\r\n  slide.updateTarget();\r\n  // update .selectedSlide\r\n  this.updateSelectedSlide();\r\n};\r\n\r\nproto._getCanCellFit = function() {\r\n  var groupCells = this.options.groupCells;\r\n  if ( !groupCells ) {\r\n    return function() {\r\n      return false;\r\n    };\r\n  } else if ( typeof groupCells == 'number' ) {\r\n    // group by number. 3 -> [0,1,2], [3,4,5], ...\r\n    var number = parseInt( groupCells, 10 );\r\n    return function( i ) {\r\n      return ( i % number ) !== 0;\r\n    };\r\n  }\r\n  // default, group by width of slide\r\n  // parse '75%\r\n  var percentMatch = typeof groupCells == 'string' &&\r\n    groupCells.match(/^(\\d+)%$/);\r\n  var percent = percentMatch ? parseInt( percentMatch[1], 10 ) / 100 : 1;\r\n  return function( i, slideWidth ) {\r\n    return slideWidth <= ( this.size.innerWidth + 1 ) * percent;\r\n  };\r\n};\r\n\r\n// alias _init for jQuery plugin .flickity()\r\nproto._init =\r\nproto.reposition = function() {\r\n  this.positionCells();\r\n  this.positionSliderAtSelected();\r\n};\r\n\r\nproto.getSize = function() {\r\n  this.size = getSize( this.element );\r\n  this.setCellAlign();\r\n  this.cursorPosition = this.size.innerWidth * this.cellAlign;\r\n};\r\n\r\nvar cellAlignShorthands = {\r\n  // cell align, then based on origin side\r\n  center: {\r\n    left: 0.5,\r\n    right: 0.5\r\n  },\r\n  left: {\r\n    left: 0,\r\n    right: 1\r\n  },\r\n  right: {\r\n    right: 0,\r\n    left: 1\r\n  }\r\n};\r\n\r\nproto.setCellAlign = function() {\r\n  var shorthand = cellAlignShorthands[ this.options.cellAlign ];\r\n  this.cellAlign = shorthand ? shorthand[ this.originSide ] : this.options.cellAlign;\r\n};\r\n\r\nproto.setGallerySize = function() {\r\n  if ( this.options.setGallerySize ) {\r\n    var height = this.options.adaptiveHeight && this.selectedSlide ?\r\n      this.selectedSlide.height : this.maxCellHeight;\r\n    this.viewport.style.height = height + 'px';\r\n  }\r\n};\r\n\r\nproto._getWrapShiftCells = function() {\r\n  // only for wrap-around\r\n  if ( !this.options.wrapAround ) {\r\n    return;\r\n  }\r\n  // unshift previous cells\r\n  this._unshiftCells( this.beforeShiftCells );\r\n  this._unshiftCells( this.afterShiftCells );\r\n  // get before cells\r\n  // initial gap\r\n  var gapX = this.cursorPosition;\r\n  var cellIndex = this.cells.length - 1;\r\n  this.beforeShiftCells = this._getGapCells( gapX, cellIndex, -1 );\r\n  // get after cells\r\n  // ending gap between last cell and end of gallery viewport\r\n  gapX = this.size.innerWidth - this.cursorPosition;\r\n  // start cloning at first cell, working forwards\r\n  this.afterShiftCells = this._getGapCells( gapX, 0, 1 );\r\n};\r\n\r\nproto._getGapCells = function( gapX, cellIndex, increment ) {\r\n  // keep adding cells until the cover the initial gap\r\n  var cells = [];\r\n  while ( gapX > 0 ) {\r\n    var cell = this.cells[ cellIndex ];\r\n    if ( !cell ) {\r\n      break;\r\n    }\r\n    cells.push( cell );\r\n    cellIndex += increment;\r\n    gapX -= cell.size.outerWidth;\r\n  }\r\n  return cells;\r\n};\r\n\r\n// ----- contain ----- //\r\n\r\n// contain cell targets so no excess sliding\r\nproto._containSlides = function() {\r\n  if ( !this.options.contain || this.options.wrapAround || !this.cells.length ) {\r\n    return;\r\n  }\r\n  var isRightToLeft = this.options.rightToLeft;\r\n  var beginMargin = isRightToLeft ? 'marginRight' : 'marginLeft';\r\n  var endMargin = isRightToLeft ? 'marginLeft' : 'marginRight';\r\n  var contentWidth = this.slideableWidth - this.getLastCell().size[ endMargin ];\r\n  // content is less than gallery size\r\n  var isContentSmaller = contentWidth < this.size.innerWidth;\r\n  // bounds\r\n  var beginBound = this.cursorPosition + this.cells[0].size[ beginMargin ];\r\n  var endBound = contentWidth - this.size.innerWidth * ( 1 - this.cellAlign );\r\n  // contain each cell target\r\n  this.slides.forEach( function( slide ) {\r\n    if ( isContentSmaller ) {\r\n      // all cells fit inside gallery\r\n      slide.target = contentWidth * this.cellAlign;\r\n    } else {\r\n      // contain to bounds\r\n      slide.target = Math.max( slide.target, beginBound );\r\n      slide.target = Math.min( slide.target, endBound );\r\n    }\r\n  }, this );\r\n};\r\n\r\n// -----  ----- //\r\n\r\n/**\r\n * emits events via eventEmitter and jQuery events\r\n * @param {String} type - name of event\r\n * @param {Event} event - original event\r\n * @param {Array} args - extra arguments\r\n */\r\nproto.dispatchEvent = function( type, event, args ) {\r\n  var emitArgs = event ? [ event ].concat( args ) : args;\r\n  this.emitEvent( type, emitArgs );\r\n\r\n  if ( jQuery && this.$element ) {\r\n    // default trigger with type if no event\r\n    type += this.options.namespaceJQueryEvents ? '.flickity' : '';\r\n    var $event = type;\r\n    if ( event ) {\r\n      // create jQuery event\r\n      var jQEvent = jQuery.Event( event );\r\n      jQEvent.type = type;\r\n      $event = jQEvent;\r\n    }\r\n    this.$element.trigger( $event, args );\r\n  }\r\n};\r\n\r\n// -------------------------- select -------------------------- //\r\n\r\n/**\r\n * @param {Integer} index - index of the slide\r\n * @param {Boolean} isWrap - will wrap-around to last/first if at the end\r\n * @param {Boolean} isInstant - will immediately set position at selected cell\r\n */\r\nproto.select = function( index, isWrap, isInstant ) {\r\n  if ( !this.isActive ) {\r\n    return;\r\n  }\r\n  index = parseInt( index, 10 );\r\n  this._wrapSelect( index );\r\n\r\n  if ( this.options.wrapAround || isWrap ) {\r\n    index = utils.modulo( index, this.slides.length );\r\n  }\r\n  // bail if invalid index\r\n  if ( !this.slides[ index ] ) {\r\n    return;\r\n  }\r\n  this.selectedIndex = index;\r\n  this.updateSelectedSlide();\r\n  if ( isInstant ) {\r\n    this.positionSliderAtSelected();\r\n  } else {\r\n    this.startAnimation();\r\n  }\r\n  if ( this.options.adaptiveHeight ) {\r\n    this.setGallerySize();\r\n  }\r\n\r\n  this.dispatchEvent('select');\r\n  // old v1 event name, remove in v3\r\n  this.dispatchEvent('cellSelect');\r\n};\r\n\r\n// wraps position for wrapAround, to move to closest slide. #113\r\nproto._wrapSelect = function( index ) {\r\n  var len = this.slides.length;\r\n  var isWrapping = this.options.wrapAround && len > 1;\r\n  if ( !isWrapping ) {\r\n    return index;\r\n  }\r\n  var wrapIndex = utils.modulo( index, len );\r\n  // go to shortest\r\n  var delta = Math.abs( wrapIndex - this.selectedIndex );\r\n  var backWrapDelta = Math.abs( ( wrapIndex + len ) - this.selectedIndex );\r\n  var forewardWrapDelta = Math.abs( ( wrapIndex - len ) - this.selectedIndex );\r\n  if ( !this.isDragSelect && backWrapDelta < delta ) {\r\n    index += len;\r\n  } else if ( !this.isDragSelect && forewardWrapDelta < delta ) {\r\n    index -= len;\r\n  }\r\n  // wrap position so slider is within normal area\r\n  if ( index < 0 ) {\r\n    this.x -= this.slideableWidth;\r\n  } else if ( index >= len ) {\r\n    this.x += this.slideableWidth;\r\n  }\r\n};\r\n\r\nproto.previous = function( isWrap, isInstant ) {\r\n  this.select( this.selectedIndex - 1, isWrap, isInstant );\r\n};\r\n\r\nproto.next = function( isWrap, isInstant ) {\r\n  this.select( this.selectedIndex + 1, isWrap, isInstant );\r\n};\r\n\r\nproto.updateSelectedSlide = function() {\r\n  var slide = this.slides[ this.selectedIndex ];\r\n  // selectedIndex could be outside of slides, if triggered before resize()\r\n  if ( !slide ) {\r\n    return;\r\n  }\r\n  // unselect previous selected slide\r\n  this.unselectSelectedSlide();\r\n  // update new selected slide\r\n  this.selectedSlide = slide;\r\n  slide.select();\r\n  this.selectedCells = slide.cells;\r\n  this.selectedElements = slide.getCellElements();\r\n  // HACK: selectedCell & selectedElement is first cell in slide, backwards compatibility\r\n  // Remove in v3?\r\n  this.selectedCell = slide.cells[0];\r\n  this.selectedElement = this.selectedElements[0];\r\n};\r\n\r\nproto.unselectSelectedSlide = function() {\r\n  if ( this.selectedSlide ) {\r\n    this.selectedSlide.unselect();\r\n  }\r\n};\r\n\r\n/**\r\n * select slide from number or cell element\r\n * @param {Element or Number} elem\r\n */\r\nproto.selectCell = function( value, isWrap, isInstant ) {\r\n  // get cell\r\n  var cell;\r\n  if ( typeof value == 'number' ) {\r\n    cell = this.cells[ value ];\r\n  } else {\r\n    // use string as selector\r\n    if ( typeof value == 'string' ) {\r\n      value = this.element.querySelector( value );\r\n    }\r\n    // get cell from element\r\n    cell = this.getCell( value );\r\n  }\r\n  // select slide that has cell\r\n  for ( var i=0; cell && i < this.slides.length; i++ ) {\r\n    var slide = this.slides[i];\r\n    var index = slide.cells.indexOf( cell );\r\n    if ( index != -1 ) {\r\n      this.select( i, isWrap, isInstant );\r\n      return;\r\n    }\r\n  }\r\n};\r\n\r\n// -------------------------- get cells -------------------------- //\r\n\r\n/**\r\n * get Flickity.Cell, given an Element\r\n * @param {Element} elem\r\n * @returns {Flickity.Cell} item\r\n */\r\nproto.getCell = function( elem ) {\r\n  // loop through cells to get the one that matches\r\n  for ( var i=0; i < this.cells.length; i++ ) {\r\n    var cell = this.cells[i];\r\n    if ( cell.element == elem ) {\r\n      return cell;\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * get collection of Flickity.Cells, given Elements\r\n * @param {Element, Array, NodeList} elems\r\n * @returns {Array} cells - Flickity.Cells\r\n */\r\nproto.getCells = function( elems ) {\r\n  elems = utils.makeArray( elems );\r\n  var cells = [];\r\n  elems.forEach( function( elem ) {\r\n    var cell = this.getCell( elem );\r\n    if ( cell ) {\r\n      cells.push( cell );\r\n    }\r\n  }, this );\r\n  return cells;\r\n};\r\n\r\n/**\r\n * get cell elements\r\n * @returns {Array} cellElems\r\n */\r\nproto.getCellElements = function() {\r\n  return this.cells.map( function( cell ) {\r\n    return cell.element;\r\n  });\r\n};\r\n\r\n/**\r\n * get parent cell from an element\r\n * @param {Element} elem\r\n * @returns {Flickit.Cell} cell\r\n */\r\nproto.getParentCell = function( elem ) {\r\n  // first check if elem is cell\r\n  var cell = this.getCell( elem );\r\n  if ( cell ) {\r\n    return cell;\r\n  }\r\n  // try to get parent cell elem\r\n  elem = utils.getParent( elem, '.flickity-slider > *' );\r\n  return this.getCell( elem );\r\n};\r\n\r\n/**\r\n * get cells adjacent to a slide\r\n * @param {Integer} adjCount - number of adjacent slides\r\n * @param {Integer} index - index of slide to start\r\n * @returns {Array} cells - array of Flickity.Cells\r\n */\r\nproto.getAdjacentCellElements = function( adjCount, index ) {\r\n  if ( !adjCount ) {\r\n    return this.selectedSlide.getCellElements();\r\n  }\r\n  index = index === undefined ? this.selectedIndex : index;\r\n\r\n  var len = this.slides.length;\r\n  if ( 1 + ( adjCount * 2 ) >= len ) {\r\n    return this.getCellElements();\r\n  }\r\n\r\n  var cellElems = [];\r\n  for ( var i = index - adjCount; i <= index + adjCount ; i++ ) {\r\n    var slideIndex = this.options.wrapAround ? utils.modulo( i, len ) : i;\r\n    var slide = this.slides[ slideIndex ];\r\n    if ( slide ) {\r\n      cellElems = cellElems.concat( slide.getCellElements() );\r\n    }\r\n  }\r\n  return cellElems;\r\n};\r\n\r\n// -------------------------- events -------------------------- //\r\n\r\nproto.uiChange = function() {\r\n  this.emitEvent('uiChange');\r\n};\r\n\r\nproto.childUIPointerDown = function( event ) {\r\n  this.emitEvent( 'childUIPointerDown', [ event ] );\r\n};\r\n\r\n// ----- resize ----- //\r\n\r\nproto.onresize = function() {\r\n  this.watchCSS();\r\n  this.resize();\r\n};\r\n\r\nutils.debounceMethod( Flickity, 'onresize', 150 );\r\n\r\nproto.resize = function() {\r\n  if ( !this.isActive ) {\r\n    return;\r\n  }\r\n  this.getSize();\r\n  // wrap values\r\n  if ( this.options.wrapAround ) {\r\n    this.x = utils.modulo( this.x, this.slideableWidth );\r\n  }\r\n  this.positionCells();\r\n  this._getWrapShiftCells();\r\n  this.setGallerySize();\r\n  this.emitEvent('resize');\r\n  // update selected index for group slides, instant\r\n  // TODO: position can be lost between groups of various numbers\r\n  var selectedElement = this.selectedElements && this.selectedElements[0];\r\n  this.selectCell( selectedElement, false, true );\r\n};\r\n\r\n// watches the :after property, activates/deactivates\r\nproto.watchCSS = function() {\r\n  var watchOption = this.options.watchCSS;\r\n  if ( !watchOption ) {\r\n    return;\r\n  }\r\n\r\n  var afterContent = getComputedStyle( this.element, ':after' ).content;\r\n  // activate if :after { content: 'flickity' }\r\n  if ( afterContent.indexOf('flickity') != -1 ) {\r\n    this.activate();\r\n  } else {\r\n    this.deactivate();\r\n  }\r\n};\r\n\r\n// ----- keydown ----- //\r\n\r\n// go previous/next if left/right keys pressed\r\nproto.onkeydown = function( event ) {\r\n  // only work if element is in focus\r\n  if ( !this.options.accessibility ||\r\n    ( document.activeElement && document.activeElement != this.element ) ) {\r\n    return;\r\n  }\r\n\r\n  if ( event.keyCode == 37 ) {\r\n    // go left\r\n    var leftMethod = this.options.rightToLeft ? 'next' : 'previous';\r\n    this.uiChange();\r\n    this[ leftMethod ]();\r\n  } else if ( event.keyCode == 39 ) {\r\n    // go right\r\n    var rightMethod = this.options.rightToLeft ? 'previous' : 'next';\r\n    this.uiChange();\r\n    this[ rightMethod ]();\r\n  }\r\n};\r\n\r\n// -------------------------- destroy -------------------------- //\r\n\r\n// deactivate all Flickity functionality, but keep stuff available\r\nproto.deactivate = function() {\r\n  if ( !this.isActive ) {\r\n    return;\r\n  }\r\n  this.element.classList.remove('flickity-enabled');\r\n  this.element.classList.remove('flickity-rtl');\r\n  // destroy cells\r\n  this.cells.forEach( function( cell ) {\r\n    cell.destroy();\r\n  });\r\n  this.unselectSelectedSlide();\r\n  this.element.removeChild( this.viewport );\r\n  // move child elements back into element\r\n  moveElements( this.slider.children, this.element );\r\n  if ( this.options.accessibility ) {\r\n    this.element.removeAttribute('tabIndex');\r\n    this.element.removeEventListener( 'keydown', this );\r\n  }\r\n  // set flags\r\n  this.isActive = false;\r\n  this.emitEvent('deactivate');\r\n};\r\n\r\nproto.destroy = function() {\r\n  this.deactivate();\r\n  window.removeEventListener( 'resize', this );\r\n  this.emitEvent('destroy');\r\n  if ( jQuery && this.$element ) {\r\n    jQuery.removeData( this.element, 'flickity' );\r\n  }\r\n  delete this.element.flickityGUID;\r\n  delete instances[ this.guid ];\r\n};\r\n\r\n// -------------------------- prototype -------------------------- //\r\n\r\nutils.extend( proto, animatePrototype );\r\n\r\n// -------------------------- extras -------------------------- //\r\n\r\n/**\r\n * get Flickity instance from element\r\n * @param {Element} elem\r\n * @returns {Flickity}\r\n */\r\nFlickity.data = function( elem ) {\r\n  elem = utils.getQueryElement( elem );\r\n  var id = elem && elem.flickityGUID;\r\n  return id && instances[ id ];\r\n};\r\n\r\nutils.htmlInit( Flickity, 'flickity' );\r\n\r\nif ( jQuery && jQuery.bridget ) {\r\n  jQuery.bridget( 'flickity', Flickity );\r\n}\r\n\r\n// set internal jQuery, for Webpack + jQuery v3, #478\r\nFlickity.setJQuery = function( jq ) {\r\n  jQuery = jq;\r\n};\r\n\r\nFlickity.Cell = Cell;\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n/*!\r\n * Unipointer v2.2.0\r\n * base class for doing one thing with pointer event\r\n * MIT license\r\n */\r\n\r\n/*jshint browser: true, undef: true, unused: true, strict: true */\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */ /*global define, module, require */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'unipointer/unipointer',[\r\n      'ev-emitter/ev-emitter'\r\n    ], function( EvEmitter ) {\r\n      return factory( window, EvEmitter );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('ev-emitter')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.Unipointer = factory(\r\n      window,\r\n      window.EvEmitter\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, EvEmitter ) {\r\n\r\n\r\n\r\nfunction noop() {}\r\n\r\nfunction Unipointer() {}\r\n\r\n// inherit EvEmitter\r\nvar proto = Unipointer.prototype = Object.create( EvEmitter.prototype );\r\n\r\nproto.bindStartEvent = function( elem ) {\r\n  this._bindStartEvent( elem, true );\r\n};\r\n\r\nproto.unbindStartEvent = function( elem ) {\r\n  this._bindStartEvent( elem, false );\r\n};\r\n\r\n/**\r\n * works as unbinder, as you can ._bindStart( false ) to unbind\r\n * @param {Boolean} isBind - will unbind if falsey\r\n */\r\nproto._bindStartEvent = function( elem, isBind ) {\r\n  // munge isBind, default to true\r\n  isBind = isBind === undefined ? true : !!isBind;\r\n  var bindMethod = isBind ? 'addEventListener' : 'removeEventListener';\r\n\r\n  if ( window.PointerEvent ) {\r\n    // Pointer Events. Chrome 55, IE11, Edge 14\r\n    elem[ bindMethod ]( 'pointerdown', this );\r\n  } else {\r\n    // listen for both, for devices like Chrome Pixel\r\n    elem[ bindMethod ]( 'mousedown', this );\r\n    elem[ bindMethod ]( 'touchstart', this );\r\n  }\r\n};\r\n\r\n// trigger handler methods for events\r\nproto.handleEvent = function( event ) {\r\n  var method = 'on' + event.type;\r\n  if ( this[ method ] ) {\r\n    this[ method ]( event );\r\n  }\r\n};\r\n\r\n// returns the touch that we're keeping track of\r\nproto.getTouch = function( touches ) {\r\n  for ( var i=0; i < touches.length; i++ ) {\r\n    var touch = touches[i];\r\n    if ( touch.identifier == this.pointerIdentifier ) {\r\n      return touch;\r\n    }\r\n  }\r\n};\r\n\r\n// ----- start event ----- //\r\n\r\nproto.onmousedown = function( event ) {\r\n  // dismiss clicks from right or middle buttons\r\n  var button = event.button;\r\n  if ( button && ( button !== 0 && button !== 1 ) ) {\r\n    return;\r\n  }\r\n  this._pointerDown( event, event );\r\n};\r\n\r\nproto.ontouchstart = function( event ) {\r\n  this._pointerDown( event, event.changedTouches[0] );\r\n};\r\n\r\nproto.onpointerdown = function( event ) {\r\n  this._pointerDown( event, event );\r\n};\r\n\r\n/**\r\n * pointer start\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nproto._pointerDown = function( event, pointer ) {\r\n  // dismiss other pointers\r\n  if ( this.isPointerDown ) {\r\n    return;\r\n  }\r\n\r\n  this.isPointerDown = true;\r\n  // save pointer identifier to match up touch events\r\n  this.pointerIdentifier = pointer.pointerId !== undefined ?\r\n    // pointerId for pointer events, touch.indentifier for touch events\r\n    pointer.pointerId : pointer.identifier;\r\n\r\n  this.pointerDown( event, pointer );\r\n};\r\n\r\nproto.pointerDown = function( event, pointer ) {\r\n  this._bindPostStartEvents( event );\r\n  this.emitEvent( 'pointerDown', [ event, pointer ] );\r\n};\r\n\r\n// hash of events to be bound after start event\r\nvar postStartEvents = {\r\n  mousedown: [ 'mousemove', 'mouseup' ],\r\n  touchstart: [ 'touchmove', 'touchend', 'touchcancel' ],\r\n  pointerdown: [ 'pointermove', 'pointerup', 'pointercancel' ],\r\n};\r\n\r\nproto._bindPostStartEvents = function( event ) {\r\n  if ( !event ) {\r\n    return;\r\n  }\r\n  // get proper events to match start event\r\n  var events = postStartEvents[ event.type ];\r\n  // bind events to node\r\n  events.forEach( function( eventName ) {\r\n    window.addEventListener( eventName, this );\r\n  }, this );\r\n  // save these arguments\r\n  this._boundPointerEvents = events;\r\n};\r\n\r\nproto._unbindPostStartEvents = function() {\r\n  // check for _boundEvents, in case dragEnd triggered twice (old IE8 bug)\r\n  if ( !this._boundPointerEvents ) {\r\n    return;\r\n  }\r\n  this._boundPointerEvents.forEach( function( eventName ) {\r\n    window.removeEventListener( eventName, this );\r\n  }, this );\r\n\r\n  delete this._boundPointerEvents;\r\n};\r\n\r\n// ----- move event ----- //\r\n\r\nproto.onmousemove = function( event ) {\r\n  this._pointerMove( event, event );\r\n};\r\n\r\nproto.onpointermove = function( event ) {\r\n  if ( event.pointerId == this.pointerIdentifier ) {\r\n    this._pointerMove( event, event );\r\n  }\r\n};\r\n\r\nproto.ontouchmove = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  if ( touch ) {\r\n    this._pointerMove( event, touch );\r\n  }\r\n};\r\n\r\n/**\r\n * pointer move\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n * @private\r\n */\r\nproto._pointerMove = function( event, pointer ) {\r\n  this.pointerMove( event, pointer );\r\n};\r\n\r\n// public\r\nproto.pointerMove = function( event, pointer ) {\r\n  this.emitEvent( 'pointerMove', [ event, pointer ] );\r\n};\r\n\r\n// ----- end event ----- //\r\n\r\n\r\nproto.onmouseup = function( event ) {\r\n  this._pointerUp( event, event );\r\n};\r\n\r\nproto.onpointerup = function( event ) {\r\n  if ( event.pointerId == this.pointerIdentifier ) {\r\n    this._pointerUp( event, event );\r\n  }\r\n};\r\n\r\nproto.ontouchend = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  if ( touch ) {\r\n    this._pointerUp( event, touch );\r\n  }\r\n};\r\n\r\n/**\r\n * pointer up\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n * @private\r\n */\r\nproto._pointerUp = function( event, pointer ) {\r\n  this._pointerDone();\r\n  this.pointerUp( event, pointer );\r\n};\r\n\r\n// public\r\nproto.pointerUp = function( event, pointer ) {\r\n  this.emitEvent( 'pointerUp', [ event, pointer ] );\r\n};\r\n\r\n// ----- pointer done ----- //\r\n\r\n// triggered on pointer up & pointer cancel\r\nproto._pointerDone = function() {\r\n  // reset properties\r\n  this.isPointerDown = false;\r\n  delete this.pointerIdentifier;\r\n  // remove events\r\n  this._unbindPostStartEvents();\r\n  this.pointerDone();\r\n};\r\n\r\nproto.pointerDone = noop;\r\n\r\n// ----- pointer cancel ----- //\r\n\r\nproto.onpointercancel = function( event ) {\r\n  if ( event.pointerId == this.pointerIdentifier ) {\r\n    this._pointerCancel( event, event );\r\n  }\r\n};\r\n\r\nproto.ontouchcancel = function( event ) {\r\n  var touch = this.getTouch( event.changedTouches );\r\n  if ( touch ) {\r\n    this._pointerCancel( event, touch );\r\n  }\r\n};\r\n\r\n/**\r\n * pointer cancel\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n * @private\r\n */\r\nproto._pointerCancel = function( event, pointer ) {\r\n  this._pointerDone();\r\n  this.pointerCancel( event, pointer );\r\n};\r\n\r\n// public\r\nproto.pointerCancel = function( event, pointer ) {\r\n  this.emitEvent( 'pointerCancel', [ event, pointer ] );\r\n};\r\n\r\n// -----  ----- //\r\n\r\n// utility function for getting x/y coords from event\r\nUnipointer.getPointerPoint = function( pointer ) {\r\n  return {\r\n    x: pointer.pageX,\r\n    y: pointer.pageY\r\n  };\r\n};\r\n\r\n// -----  ----- //\r\n\r\nreturn Unipointer;\r\n\r\n}));\r\n\r\n/*!\r\n * Unidragger v2.2.3\r\n * Draggable base class\r\n * MIT license\r\n */\r\n\r\n/*jshint browser: true, unused: true, undef: true, strict: true */\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /*jshint strict: false */ /*globals define, module, require */\r\n\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'unidragger/unidragger',[\r\n      'unipointer/unipointer'\r\n    ], function( Unipointer ) {\r\n      return factory( window, Unipointer );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('unipointer')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.Unidragger = factory(\r\n      window,\r\n      window.Unipointer\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Unipointer ) {\r\n\r\n\r\n\r\n// -------------------------- Unidragger -------------------------- //\r\n\r\nfunction Unidragger() {}\r\n\r\n// inherit Unipointer & EvEmitter\r\nvar proto = Unidragger.prototype = Object.create( Unipointer.prototype );\r\n\r\n// ----- bind start ----- //\r\n\r\nproto.bindHandles = function() {\r\n  this._bindHandles( true );\r\n};\r\n\r\nproto.unbindHandles = function() {\r\n  this._bindHandles( false );\r\n};\r\n\r\n/**\r\n * works as unbinder, as you can .bindHandles( false ) to unbind\r\n * @param {Boolean} isBind - will unbind if falsey\r\n */\r\nproto._bindHandles = function( isBind ) {\r\n  // munge isBind, default to true\r\n  isBind = isBind === undefined ? true : !!isBind;\r\n  // bind each handle\r\n  var bindMethod = isBind ? 'addEventListener' : 'removeEventListener';\r\n  for ( var i=0; i < this.handles.length; i++ ) {\r\n    var handle = this.handles[i];\r\n    this._bindStartEvent( handle, isBind );\r\n    handle[ bindMethod ]( 'click', this );\r\n    // touch-action: none to override browser touch gestures\r\n    // metafizzy/flickity#540\r\n    if ( window.PointerEvent ) {\r\n      handle.style.touchAction = isBind ? this._touchActionValue : '';\r\n    }\r\n  }\r\n};\r\n\r\n// prototype so it can be overwriteable by Flickity\r\nproto._touchActionValue = 'none';\r\n\r\n// ----- start event ----- //\r\n\r\n/**\r\n * pointer start\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nproto.pointerDown = function( event, pointer ) {\r\n  // dismiss range sliders\r\n  if ( event.target.nodeName == 'INPUT' && event.target.type == 'range' ) {\r\n    // reset pointerDown logic\r\n    this.isPointerDown = false;\r\n    delete this.pointerIdentifier;\r\n    return;\r\n  }\r\n\r\n  this._dragPointerDown( event, pointer );\r\n  // kludge to blur focused inputs in dragger\r\n  var focused = document.activeElement;\r\n  if ( focused && focused.blur ) {\r\n    focused.blur();\r\n  }\r\n  // bind move and end events\r\n  this._bindPostStartEvents( event );\r\n  this.emitEvent( 'pointerDown', [ event, pointer ] );\r\n};\r\n\r\n// base pointer down logic\r\nproto._dragPointerDown = function( event, pointer ) {\r\n  // track to see when dragging starts\r\n  this.pointerDownPoint = Unipointer.getPointerPoint( pointer );\r\n\r\n  var canPreventDefault = this.canPreventDefaultOnPointerDown( event, pointer );\r\n  if ( canPreventDefault ) {\r\n    event.preventDefault();\r\n  }\r\n};\r\n\r\n// overwriteable method so Flickity can prevent for scrolling\r\nproto.canPreventDefaultOnPointerDown = function( event ) {\r\n  // prevent default, unless touchstart or <select>\r\n  return event.target.nodeName != 'SELECT';\r\n};\r\n\r\n// ----- move event ----- //\r\n\r\n/**\r\n * drag move\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nproto.pointerMove = function( event, pointer ) {\r\n  var moveVector = this._dragPointerMove( event, pointer );\r\n  this.emitEvent( 'pointerMove', [ event, pointer, moveVector ] );\r\n  this._dragMove( event, pointer, moveVector );\r\n};\r\n\r\n// base pointer move logic\r\nproto._dragPointerMove = function( event, pointer ) {\r\n  var movePoint = Unipointer.getPointerPoint( pointer );\r\n  var moveVector = {\r\n    x: movePoint.x - this.pointerDownPoint.x,\r\n    y: movePoint.y - this.pointerDownPoint.y\r\n  };\r\n  // start drag if pointer has moved far enough to start drag\r\n  if ( !this.isDragging && this.hasDragStarted( moveVector ) ) {\r\n    this._dragStart( event, pointer );\r\n  }\r\n  return moveVector;\r\n};\r\n\r\n// condition if pointer has moved far enough to start drag\r\nproto.hasDragStarted = function( moveVector ) {\r\n  return Math.abs( moveVector.x ) > 3 || Math.abs( moveVector.y ) > 3;\r\n};\r\n\r\n\r\n// ----- end event ----- //\r\n\r\n/**\r\n * pointer up\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nproto.pointerUp = function( event, pointer ) {\r\n  this.emitEvent( 'pointerUp', [ event, pointer ] );\r\n  this._dragPointerUp( event, pointer );\r\n};\r\n\r\nproto._dragPointerUp = function( event, pointer ) {\r\n  if ( this.isDragging ) {\r\n    this._dragEnd( event, pointer );\r\n  } else {\r\n    // pointer didn't move enough for drag to start\r\n    this._staticClick( event, pointer );\r\n  }\r\n};\r\n\r\n// -------------------------- drag -------------------------- //\r\n\r\n// dragStart\r\nproto._dragStart = function( event, pointer ) {\r\n  this.isDragging = true;\r\n  this.dragStartPoint = Unipointer.getPointerPoint( pointer );\r\n  // prevent clicks\r\n  this.isPreventingClicks = true;\r\n\r\n  this.dragStart( event, pointer );\r\n};\r\n\r\nproto.dragStart = function( event, pointer ) {\r\n  this.emitEvent( 'dragStart', [ event, pointer ] );\r\n};\r\n\r\n// dragMove\r\nproto._dragMove = function( event, pointer, moveVector ) {\r\n  // do not drag if not dragging yet\r\n  if ( !this.isDragging ) {\r\n    return;\r\n  }\r\n\r\n  this.dragMove( event, pointer, moveVector );\r\n};\r\n\r\nproto.dragMove = function( event, pointer, moveVector ) {\r\n  event.preventDefault();\r\n  this.emitEvent( 'dragMove', [ event, pointer, moveVector ] );\r\n};\r\n\r\n// dragEnd\r\nproto._dragEnd = function( event, pointer ) {\r\n  // set flags\r\n  this.isDragging = false;\r\n  // re-enable clicking async\r\n  setTimeout( function() {\r\n    delete this.isPreventingClicks;\r\n  }.bind( this ) );\r\n\r\n  this.dragEnd( event, pointer );\r\n};\r\n\r\nproto.dragEnd = function( event, pointer ) {\r\n  this.emitEvent( 'dragEnd', [ event, pointer ] );\r\n};\r\n\r\n// ----- onclick ----- //\r\n\r\n// handle all clicks and prevent clicks when dragging\r\nproto.onclick = function( event ) {\r\n  if ( this.isPreventingClicks ) {\r\n    event.preventDefault();\r\n  }\r\n};\r\n\r\n// ----- staticClick ----- //\r\n\r\n// triggered after pointer down & up with no/tiny movement\r\nproto._staticClick = function( event, pointer ) {\r\n  // ignore emulated mouse up clicks\r\n  if ( this.isIgnoringMouseUp && event.type == 'mouseup' ) {\r\n    return;\r\n  }\r\n\r\n  // allow click in <input>s and <textarea>s\r\n  var nodeName = event.target.nodeName;\r\n  if ( nodeName == 'INPUT' || nodeName == 'TEXTAREA' ) {\r\n    event.target.focus();\r\n  }\r\n  this.staticClick( event, pointer );\r\n\r\n  // set flag for emulated clicks 300ms after touchend\r\n  if ( event.type != 'mouseup' ) {\r\n    this.isIgnoringMouseUp = true;\r\n    // reset flag after 300ms\r\n    setTimeout( function() {\r\n      delete this.isIgnoringMouseUp;\r\n    }.bind( this ), 400 );\r\n  }\r\n};\r\n\r\nproto.staticClick = function( event, pointer ) {\r\n  this.emitEvent( 'staticClick', [ event, pointer ] );\r\n};\r\n\r\n// ----- utils ----- //\r\n\r\nUnidragger.getPointerPoint = Unipointer.getPointerPoint;\r\n\r\n// -----  ----- //\r\n\r\nreturn Unidragger;\r\n\r\n}));\r\n\r\n// drag\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/drag',[\r\n      './flickity',\r\n      'unidragger/unidragger',\r\n      'fizzy-ui-utils/utils'\r\n    ], function( Flickity, Unidragger, utils ) {\r\n      return factory( window, Flickity, Unidragger, utils );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('./flickity'),\r\n      require('unidragger'),\r\n      require('fizzy-ui-utils')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.Flickity = factory(\r\n      window,\r\n      window.Flickity,\r\n      window.Unidragger,\r\n      window.fizzyUIUtils\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Flickity, Unidragger, utils ) {\r\n\r\n\r\n\r\n// ----- defaults ----- //\r\n\r\nutils.extend( Flickity.defaults, {\r\n  draggable: true,\r\n  dragThreshold: 3,\r\n});\r\n\r\n// ----- create ----- //\r\n\r\nFlickity.createMethods.push('_createDrag');\r\n\r\n// -------------------------- drag prototype -------------------------- //\r\n\r\nvar proto = Flickity.prototype;\r\nutils.extend( proto, Unidragger.prototype );\r\nproto._touchActionValue = 'pan-y';\r\n\r\n// --------------------------  -------------------------- //\r\n\r\nvar isTouch = 'createTouch' in document;\r\nvar isTouchmoveScrollCanceled = false;\r\n\r\nproto._createDrag = function() {\r\n  this.on( 'activate', this.bindDrag );\r\n  this.on( 'uiChange', this._uiChangeDrag );\r\n  this.on( 'childUIPointerDown', this._childUIPointerDownDrag );\r\n  this.on( 'deactivate', this.unbindDrag );\r\n  // HACK - add seemingly innocuous handler to fix iOS 10 scroll behavior\r\n  // #457, RubaXa/Sortable#973\r\n  if ( isTouch && !isTouchmoveScrollCanceled ) {\r\n    window.addEventListener( 'touchmove', function() {});\r\n    isTouchmoveScrollCanceled = true;\r\n  }\r\n};\r\n\r\nproto.bindDrag = function() {\r\n  if ( !this.options.draggable || this.isDragBound ) {\r\n    return;\r\n  }\r\n  this.element.classList.add('is-draggable');\r\n  this.handles = [ this.viewport ];\r\n  this.bindHandles();\r\n  this.isDragBound = true;\r\n};\r\n\r\nproto.unbindDrag = function() {\r\n  if ( !this.isDragBound ) {\r\n    return;\r\n  }\r\n  this.element.classList.remove('is-draggable');\r\n  this.unbindHandles();\r\n  delete this.isDragBound;\r\n};\r\n\r\nproto._uiChangeDrag = function() {\r\n  delete this.isFreeScrolling;\r\n};\r\n\r\nproto._childUIPointerDownDrag = function( event ) {\r\n  event.preventDefault();\r\n  this.pointerDownFocus( event );\r\n};\r\n\r\n// -------------------------- pointer events -------------------------- //\r\n\r\n// nodes that have text fields\r\nvar cursorNodes = {\r\n  TEXTAREA: true,\r\n  INPUT: true,\r\n  OPTION: true,\r\n};\r\n\r\n// input types that do not have text fields\r\nvar clickTypes = {\r\n  radio: true,\r\n  checkbox: true,\r\n  button: true,\r\n  submit: true,\r\n  image: true,\r\n  file: true,\r\n};\r\n\r\nproto.pointerDown = function( event, pointer ) {\r\n  // dismiss inputs with text fields. #403, #404\r\n  var isCursorInput = cursorNodes[ event.target.nodeName ] &&\r\n    !clickTypes[ event.target.type ];\r\n  if ( isCursorInput ) {\r\n    // reset pointerDown logic\r\n    this.isPointerDown = false;\r\n    delete this.pointerIdentifier;\r\n    return;\r\n  }\r\n\r\n  this._dragPointerDown( event, pointer );\r\n\r\n  // kludge to blur focused inputs in dragger\r\n  var focused = document.activeElement;\r\n  if ( focused && focused.blur && focused != this.element &&\r\n    // do not blur body for IE9 & 10, #117\r\n    focused != document.body ) {\r\n    focused.blur();\r\n  }\r\n  this.pointerDownFocus( event );\r\n  // stop if it was moving\r\n  this.dragX = this.x;\r\n  this.viewport.classList.add('is-pointer-down');\r\n  // bind move and end events\r\n  this._bindPostStartEvents( event );\r\n  // track scrolling\r\n  this.pointerDownScroll = getScrollPosition();\r\n  window.addEventListener( 'scroll', this );\r\n\r\n  this.dispatchEvent( 'pointerDown', event, [ pointer ] );\r\n};\r\n\r\nproto.pointerDownFocus = function( event ) {\r\n  // focus element, if not touch, and its not an input or select\r\n  var canPointerDown = getCanPointerDown( event );\r\n  if ( !this.options.accessibility || canPointerDown ) {\r\n    return;\r\n  }\r\n  var prevScrollY = window.pageYOffset;\r\n  this.element.focus();\r\n  // hack to fix scroll jump after focus, #76\r\n  if ( window.pageYOffset != prevScrollY ) {\r\n    window.scrollTo( window.pageXOffset, prevScrollY );\r\n  }\r\n};\r\n\r\nvar focusNodes = {\r\n  INPUT: true,\r\n  SELECT: true,\r\n};\r\n\r\nfunction getCanPointerDown( event ) {\r\n  var isTouchStart = event.type == 'touchstart';\r\n  var isTouchPointer = event.pointerType == 'touch';\r\n  var isFocusNode = focusNodes[ event.target.nodeName ];\r\n  return isTouchStart || isTouchPointer || isFocusNode;\r\n}\r\n\r\nproto.canPreventDefaultOnPointerDown = function( event ) {\r\n  // prevent default, unless touchstart or input\r\n  var canPointerDown = getCanPointerDown( event );\r\n  return !canPointerDown;\r\n};\r\n\r\n// ----- move ----- //\r\n\r\nproto.hasDragStarted = function( moveVector ) {\r\n  return Math.abs( moveVector.x ) > this.options.dragThreshold;\r\n};\r\n\r\n// ----- up ----- //\r\n\r\nproto.pointerUp = function( event, pointer ) {\r\n  delete this.isTouchScrolling;\r\n  this.viewport.classList.remove('is-pointer-down');\r\n  this.dispatchEvent( 'pointerUp', event, [ pointer ] );\r\n  this._dragPointerUp( event, pointer );\r\n};\r\n\r\nproto.pointerDone = function() {\r\n  window.removeEventListener( 'scroll', this );\r\n  delete this.pointerDownScroll;\r\n};\r\n\r\n// -------------------------- dragging -------------------------- //\r\n\r\nproto.dragStart = function( event, pointer ) {\r\n  this.dragStartPosition = this.x;\r\n  this.startAnimation();\r\n  window.removeEventListener( 'scroll', this );\r\n  this.dispatchEvent( 'dragStart', event, [ pointer ] );\r\n};\r\n\r\nproto.pointerMove = function( event, pointer ) {\r\n  var moveVector = this._dragPointerMove( event, pointer );\r\n  this.dispatchEvent( 'pointerMove', event, [ pointer, moveVector ] );\r\n  this._dragMove( event, pointer, moveVector );\r\n};\r\n\r\nproto.dragMove = function( event, pointer, moveVector ) {\r\n  event.preventDefault();\r\n\r\n  this.previousDragX = this.dragX;\r\n  // reverse if right-to-left\r\n  var direction = this.options.rightToLeft ? -1 : 1;\r\n  var dragX = this.dragStartPosition + moveVector.x * direction;\r\n\r\n  if ( !this.options.wrapAround && this.slides.length ) {\r\n    // slow drag\r\n    var originBound = Math.max( -this.slides[0].target, this.dragStartPosition );\r\n    dragX = dragX > originBound ? ( dragX + originBound ) * 0.5 : dragX;\r\n    var endBound = Math.min( -this.getLastSlide().target, this.dragStartPosition );\r\n    dragX = dragX < endBound ? ( dragX + endBound ) * 0.5 : dragX;\r\n  }\r\n\r\n  this.dragX = dragX;\r\n\r\n  this.dragMoveTime = new Date();\r\n  this.dispatchEvent( 'dragMove', event, [ pointer, moveVector ] );\r\n};\r\n\r\nproto.dragEnd = function( event, pointer ) {\r\n  if ( this.options.freeScroll ) {\r\n    this.isFreeScrolling = true;\r\n  }\r\n  // set selectedIndex based on where flick will end up\r\n  var index = this.dragEndRestingSelect();\r\n\r\n  if ( this.options.freeScroll && !this.options.wrapAround ) {\r\n    // if free-scroll & not wrap around\r\n    // do not free-scroll if going outside of bounding slides\r\n    // so bounding slides can attract slider, and keep it in bounds\r\n    var restingX = this.getRestingPosition();\r\n    this.isFreeScrolling = -restingX > this.slides[0].target &&\r\n      -restingX < this.getLastSlide().target;\r\n  } else if ( !this.options.freeScroll && index == this.selectedIndex ) {\r\n    // boost selection if selected index has not changed\r\n    index += this.dragEndBoostSelect();\r\n  }\r\n  delete this.previousDragX;\r\n  // apply selection\r\n  // TODO refactor this, selecting here feels weird\r\n  // HACK, set flag so dragging stays in correct direction\r\n  this.isDragSelect = this.options.wrapAround;\r\n  this.select( index );\r\n  delete this.isDragSelect;\r\n  this.dispatchEvent( 'dragEnd', event, [ pointer ] );\r\n};\r\n\r\nproto.dragEndRestingSelect = function() {\r\n  var restingX = this.getRestingPosition();\r\n  // how far away from selected slide\r\n  var distance = Math.abs( this.getSlideDistance( -restingX, this.selectedIndex ) );\r\n  // get closet resting going up and going down\r\n  var positiveResting = this._getClosestResting( restingX, distance, 1 );\r\n  var negativeResting = this._getClosestResting( restingX, distance, -1 );\r\n  // use closer resting for wrap-around\r\n  var index = positiveResting.distance < negativeResting.distance ?\r\n    positiveResting.index : negativeResting.index;\r\n  return index;\r\n};\r\n\r\n/**\r\n * given resting X and distance to selected cell\r\n * get the distance and index of the closest cell\r\n * @param {Number} restingX - estimated post-flick resting position\r\n * @param {Number} distance - distance to selected cell\r\n * @param {Integer} increment - +1 or -1, going up or down\r\n * @returns {Object} - { distance: {Number}, index: {Integer} }\r\n */\r\nproto._getClosestResting = function( restingX, distance, increment ) {\r\n  var index = this.selectedIndex;\r\n  var minDistance = Infinity;\r\n  var condition = this.options.contain && !this.options.wrapAround ?\r\n    // if contain, keep going if distance is equal to minDistance\r\n    function( d, md ) { return d <= md; } : function( d, md ) { return d < md; };\r\n  while ( condition( distance, minDistance ) ) {\r\n    // measure distance to next cell\r\n    index += increment;\r\n    minDistance = distance;\r\n    distance = this.getSlideDistance( -restingX, index );\r\n    if ( distance === null ) {\r\n      break;\r\n    }\r\n    distance = Math.abs( distance );\r\n  }\r\n  return {\r\n    distance: minDistance,\r\n    // selected was previous index\r\n    index: index - increment\r\n  };\r\n};\r\n\r\n/**\r\n * measure distance between x and a slide target\r\n * @param {Number} x\r\n * @param {Integer} index - slide index\r\n */\r\nproto.getSlideDistance = function( x, index ) {\r\n  var len = this.slides.length;\r\n  // wrap around if at least 2 slides\r\n  var isWrapAround = this.options.wrapAround && len > 1;\r\n  var slideIndex = isWrapAround ? utils.modulo( index, len ) : index;\r\n  var slide = this.slides[ slideIndex ];\r\n  if ( !slide ) {\r\n    return null;\r\n  }\r\n  // add distance for wrap-around slides\r\n  var wrap = isWrapAround ? this.slideableWidth * Math.floor( index / len ) : 0;\r\n  return x - ( slide.target + wrap );\r\n};\r\n\r\nproto.dragEndBoostSelect = function() {\r\n  // do not boost if no previousDragX or dragMoveTime\r\n  if ( this.previousDragX === undefined || !this.dragMoveTime ||\r\n    // or if drag was held for 100 ms\r\n    new Date() - this.dragMoveTime > 100 ) {\r\n    return 0;\r\n  }\r\n\r\n  var distance = this.getSlideDistance( -this.dragX, this.selectedIndex );\r\n  var delta = this.previousDragX - this.dragX;\r\n  if ( distance > 0 && delta > 0 ) {\r\n    // boost to next if moving towards the right, and positive velocity\r\n    return 1;\r\n  } else if ( distance < 0 && delta < 0 ) {\r\n    // boost to previous if moving towards the left, and negative velocity\r\n    return -1;\r\n  }\r\n  return 0;\r\n};\r\n\r\n// ----- staticClick ----- //\r\n\r\nproto.staticClick = function( event, pointer ) {\r\n  // get clickedCell, if cell was clicked\r\n  var clickedCell = this.getParentCell( event.target );\r\n  var cellElem = clickedCell && clickedCell.element;\r\n  var cellIndex = clickedCell && this.cells.indexOf( clickedCell );\r\n  this.dispatchEvent( 'staticClick', event, [ pointer, cellElem, cellIndex ] );\r\n};\r\n\r\n// ----- scroll ----- //\r\n\r\nproto.onscroll = function() {\r\n  var scroll = getScrollPosition();\r\n  var scrollMoveX = this.pointerDownScroll.x - scroll.x;\r\n  var scrollMoveY = this.pointerDownScroll.y - scroll.y;\r\n  // cancel click/tap if scroll is too much\r\n  if ( Math.abs( scrollMoveX ) > 3 || Math.abs( scrollMoveY ) > 3 ) {\r\n    this._pointerDone();\r\n  }\r\n};\r\n\r\n// ----- utils ----- //\r\n\r\nfunction getScrollPosition() {\r\n  return {\r\n    x: window.pageXOffset,\r\n    y: window.pageYOffset\r\n  };\r\n}\r\n\r\n// -----  ----- //\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n/*!\r\n * Tap listener v2.0.0\r\n * listens to taps\r\n * MIT license\r\n */\r\n\r\n/*jshint browser: true, unused: true, undef: true, strict: true */\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /*jshint strict: false*/ /*globals define, module, require */\r\n\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'tap-listener/tap-listener',[\r\n      'unipointer/unipointer'\r\n    ], function( Unipointer ) {\r\n      return factory( window, Unipointer );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('unipointer')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.TapListener = factory(\r\n      window,\r\n      window.Unipointer\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Unipointer ) {\r\n\r\n\r\n\r\n// --------------------------  TapListener -------------------------- //\r\n\r\nfunction TapListener( elem ) {\r\n  this.bindTap( elem );\r\n}\r\n\r\n// inherit Unipointer & EventEmitter\r\nvar proto = TapListener.prototype = Object.create( Unipointer.prototype );\r\n\r\n/**\r\n * bind tap event to element\r\n * @param {Element} elem\r\n */\r\nproto.bindTap = function( elem ) {\r\n  if ( !elem ) {\r\n    return;\r\n  }\r\n  this.unbindTap();\r\n  this.tapElement = elem;\r\n  this._bindStartEvent( elem, true );\r\n};\r\n\r\nproto.unbindTap = function() {\r\n  if ( !this.tapElement ) {\r\n    return;\r\n  }\r\n  this._bindStartEvent( this.tapElement, true );\r\n  delete this.tapElement;\r\n};\r\n\r\n/**\r\n * pointer up\r\n * @param {Event} event\r\n * @param {Event or Touch} pointer\r\n */\r\nproto.pointerUp = function( event, pointer ) {\r\n  // ignore emulated mouse up clicks\r\n  if ( this.isIgnoringMouseUp && event.type == 'mouseup' ) {\r\n    return;\r\n  }\r\n\r\n  var pointerPoint = Unipointer.getPointerPoint( pointer );\r\n  var boundingRect = this.tapElement.getBoundingClientRect();\r\n  var scrollX = window.pageXOffset;\r\n  var scrollY = window.pageYOffset;\r\n  // calculate if pointer is inside tapElement\r\n  var isInside = pointerPoint.x >= boundingRect.left + scrollX &&\r\n    pointerPoint.x <= boundingRect.right + scrollX &&\r\n    pointerPoint.y >= boundingRect.top + scrollY &&\r\n    pointerPoint.y <= boundingRect.bottom + scrollY;\r\n  // trigger callback if pointer is inside element\r\n  if ( isInside ) {\r\n    this.emitEvent( 'tap', [ event, pointer ] );\r\n  }\r\n\r\n  // set flag for emulated clicks 300ms after touchend\r\n  if ( event.type != 'mouseup' ) {\r\n    this.isIgnoringMouseUp = true;\r\n    // reset flag after 300ms\r\n    var _this = this;\r\n    setTimeout( function() {\r\n      delete _this.isIgnoringMouseUp;\r\n    }, 400 );\r\n  }\r\n};\r\n\r\nproto.destroy = function() {\r\n  this.pointerDone();\r\n  this.unbindTap();\r\n};\r\n\r\n// -----  ----- //\r\n\r\nreturn TapListener;\r\n\r\n}));\r\n\r\n// prev/next buttons\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/prev-next-button',[\r\n      './flickity',\r\n      'tap-listener/tap-listener',\r\n      'fizzy-ui-utils/utils'\r\n    ], function( Flickity, TapListener, utils ) {\r\n      return factory( window, Flickity, TapListener, utils );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('./flickity'),\r\n      require('tap-listener'),\r\n      require('fizzy-ui-utils')\r\n    );\r\n  } else {\r\n    // browser global\r\n    factory(\r\n      window,\r\n      window.Flickity,\r\n      window.TapListener,\r\n      window.fizzyUIUtils\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Flickity, TapListener, utils ) {\r\n'use strict';\r\n\r\nvar svgURI = 'http://www.w3.org/2000/svg';\r\n\r\n// -------------------------- PrevNextButton -------------------------- //\r\n\r\nfunction PrevNextButton( direction, parent ) {\r\n  this.direction = direction;\r\n  this.parent = parent;\r\n  this._create();\r\n}\r\n\r\nPrevNextButton.prototype = new TapListener();\r\n\r\nPrevNextButton.prototype._create = function() {\r\n  // properties\r\n  this.isEnabled = true;\r\n  this.isPrevious = this.direction == -1;\r\n  var leftDirection = this.parent.options.rightToLeft ? 1 : -1;\r\n  this.isLeft = this.direction == leftDirection;\r\n\r\n  var element = this.element = document.createElement('button');\r\n  element.className = 'flickity-prev-next-button';\r\n  element.className += this.isPrevious ? ' previous' : ' next';\r\n  // prevent button from submitting form http://stackoverflow.com/a/10836076/182183\r\n  element.setAttribute( 'type', 'button' );\r\n  // init as disabled\r\n  this.disable();\r\n\r\n  element.setAttribute( 'aria-label', this.isPrevious ? 'previous' : 'next' );\r\n\r\n  // create arrow\r\n  var svg = this.createSVG();\r\n  element.appendChild( svg );\r\n  // events\r\n  this.on( 'tap', this.onTap );\r\n  this.parent.on( 'select', this.update.bind( this ) );\r\n  this.on( 'pointerDown', this.parent.childUIPointerDown.bind( this.parent ) );\r\n};\r\n\r\nPrevNextButton.prototype.activate = function() {\r\n  this.bindTap( this.element );\r\n  // click events from keyboard\r\n  this.element.addEventListener( 'click', this );\r\n  // add to DOM\r\n  this.parent.element.appendChild( this.element );\r\n};\r\n\r\nPrevNextButton.prototype.deactivate = function() {\r\n  // remove from DOM\r\n  this.parent.element.removeChild( this.element );\r\n  // do regular TapListener destroy\r\n  TapListener.prototype.destroy.call( this );\r\n  // click events from keyboard\r\n  this.element.removeEventListener( 'click', this );\r\n};\r\n\r\nPrevNextButton.prototype.createSVG = function() {\r\n  var svg = document.createElementNS( svgURI, 'svg');\r\n  svg.setAttribute( 'viewBox', '0 0 100 100' );\r\n  var path = document.createElementNS( svgURI, 'path');\r\n  var pathMovements = getArrowMovements( this.parent.options.arrowShape );\r\n  path.setAttribute( 'd', pathMovements );\r\n  path.setAttribute( 'class', 'arrow' );\r\n  // rotate arrow\r\n  if ( !this.isLeft ) {\r\n    path.setAttribute( 'transform', 'translate(100, 100) rotate(180) ' );\r\n  }\r\n  svg.appendChild( path );\r\n  return svg;\r\n};\r\n\r\n// get SVG path movmement\r\nfunction getArrowMovements( shape ) {\r\n  // use shape as movement if string\r\n  if ( typeof shape == 'string' ) {\r\n    return shape;\r\n  }\r\n  // create movement string\r\n  return 'M ' + shape.x0 + ',50' +\r\n    ' L ' + shape.x1 + ',' + ( shape.y1 + 50 ) +\r\n    ' L ' + shape.x2 + ',' + ( shape.y2 + 50 ) +\r\n    ' L ' + shape.x3 + ',50 ' +\r\n    ' L ' + shape.x2 + ',' + ( 50 - shape.y2 ) +\r\n    ' L ' + shape.x1 + ',' + ( 50 - shape.y1 ) +\r\n    ' Z';\r\n}\r\n\r\nPrevNextButton.prototype.onTap = function() {\r\n  if ( !this.isEnabled ) {\r\n    return;\r\n  }\r\n  this.parent.uiChange();\r\n  var method = this.isPrevious ? 'previous' : 'next';\r\n  this.parent[ method ]();\r\n};\r\n\r\nPrevNextButton.prototype.handleEvent = utils.handleEvent;\r\n\r\nPrevNextButton.prototype.onclick = function() {\r\n  // only allow clicks from keyboard\r\n  var focused = document.activeElement;\r\n  if ( focused && focused == this.element ) {\r\n    this.onTap();\r\n  }\r\n};\r\n\r\n// -----  ----- //\r\n\r\nPrevNextButton.prototype.enable = function() {\r\n  if ( this.isEnabled ) {\r\n    return;\r\n  }\r\n  this.element.disabled = false;\r\n  this.isEnabled = true;\r\n};\r\n\r\nPrevNextButton.prototype.disable = function() {\r\n  if ( !this.isEnabled ) {\r\n    return;\r\n  }\r\n  this.element.disabled = true;\r\n  this.isEnabled = false;\r\n};\r\n\r\nPrevNextButton.prototype.update = function() {\r\n  // index of first or last slide, if previous or next\r\n  var slides = this.parent.slides;\r\n  // enable is wrapAround and at least 2 slides\r\n  if ( this.parent.options.wrapAround && slides.length > 1 ) {\r\n    this.enable();\r\n    return;\r\n  }\r\n  var lastIndex = slides.length ? slides.length - 1 : 0;\r\n  var boundIndex = this.isPrevious ? 0 : lastIndex;\r\n  var method = this.parent.selectedIndex == boundIndex ? 'disable' : 'enable';\r\n  this[ method ]();\r\n};\r\n\r\nPrevNextButton.prototype.destroy = function() {\r\n  this.deactivate();\r\n};\r\n\r\n// -------------------------- Flickity prototype -------------------------- //\r\n\r\nutils.extend( Flickity.defaults, {\r\n  prevNextButtons: true,\r\n  arrowShape: {\r\n    x0: 10,\r\n    x1: 60, y1: 50,\r\n    x2: 70, y2: 40,\r\n    x3: 30\r\n  }\r\n});\r\n\r\nFlickity.createMethods.push('_createPrevNextButtons');\r\nvar proto = Flickity.prototype;\r\n\r\nproto._createPrevNextButtons = function() {\r\n  if ( !this.options.prevNextButtons ) {\r\n    return;\r\n  }\r\n\r\n  this.prevButton = new PrevNextButton( -1, this );\r\n  this.nextButton = new PrevNextButton( 1, this );\r\n\r\n  this.on( 'activate', this.activatePrevNextButtons );\r\n};\r\n\r\nproto.activatePrevNextButtons = function() {\r\n  this.prevButton.activate();\r\n  this.nextButton.activate();\r\n  this.on( 'deactivate', this.deactivatePrevNextButtons );\r\n};\r\n\r\nproto.deactivatePrevNextButtons = function() {\r\n  this.prevButton.deactivate();\r\n  this.nextButton.deactivate();\r\n  this.off( 'deactivate', this.deactivatePrevNextButtons );\r\n};\r\n\r\n// --------------------------  -------------------------- //\r\n\r\nFlickity.PrevNextButton = PrevNextButton;\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n// page dots\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/page-dots',[\r\n      './flickity',\r\n      'tap-listener/tap-listener',\r\n      'fizzy-ui-utils/utils'\r\n    ], function( Flickity, TapListener, utils ) {\r\n      return factory( window, Flickity, TapListener, utils );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('./flickity'),\r\n      require('tap-listener'),\r\n      require('fizzy-ui-utils')\r\n    );\r\n  } else {\r\n    // browser global\r\n    factory(\r\n      window,\r\n      window.Flickity,\r\n      window.TapListener,\r\n      window.fizzyUIUtils\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Flickity, TapListener, utils ) {\r\n\r\n// -------------------------- PageDots -------------------------- //\r\n\r\n\r\n\r\nfunction PageDots( parent ) {\r\n  this.parent = parent;\r\n  this._create();\r\n}\r\n\r\nPageDots.prototype = new TapListener();\r\n\r\nPageDots.prototype._create = function() {\r\n  // create holder element\r\n  this.holder = document.createElement('ol');\r\n  this.holder.className = 'flickity-page-dots';\r\n  // create dots, array of elements\r\n  this.dots = [];\r\n  // events\r\n  this.on( 'tap', this.onTap );\r\n  this.on( 'pointerDown', this.parent.childUIPointerDown.bind( this.parent ) );\r\n};\r\n\r\nPageDots.prototype.activate = function() {\r\n  this.setDots();\r\n  this.bindTap( this.holder );\r\n  // add to DOM\r\n  this.parent.element.appendChild( this.holder );\r\n};\r\n\r\nPageDots.prototype.deactivate = function() {\r\n  // remove from DOM\r\n  this.parent.element.removeChild( this.holder );\r\n  TapListener.prototype.destroy.call( this );\r\n};\r\n\r\nPageDots.prototype.setDots = function() {\r\n  // get difference between number of slides and number of dots\r\n  var delta = this.parent.slides.length - this.dots.length;\r\n  if ( delta > 0 ) {\r\n    this.addDots( delta );\r\n  } else if ( delta < 0 ) {\r\n    this.removeDots( -delta );\r\n  }\r\n};\r\n\r\nPageDots.prototype.addDots = function( count ) {\r\n  var fragment = document.createDocumentFragment();\r\n  var newDots = [];\r\n  while ( count ) {\r\n    var dot = document.createElement('li');\r\n    dot.className = 'dot';\r\n    fragment.appendChild( dot );\r\n    newDots.push( dot );\r\n    count--;\r\n  }\r\n  this.holder.appendChild( fragment );\r\n  this.dots = this.dots.concat( newDots );\r\n};\r\n\r\nPageDots.prototype.removeDots = function( count ) {\r\n  // remove from this.dots collection\r\n  var removeDots = this.dots.splice( this.dots.length - count, count );\r\n  // remove from DOM\r\n  removeDots.forEach( function( dot ) {\r\n    this.holder.removeChild( dot );\r\n  }, this );\r\n};\r\n\r\nPageDots.prototype.updateSelected = function() {\r\n  // remove selected class on previous\r\n  if ( this.selectedDot ) {\r\n    this.selectedDot.className = 'dot';\r\n  }\r\n  // don't proceed if no dots\r\n  if ( !this.dots.length ) {\r\n    return;\r\n  }\r\n  this.selectedDot = this.dots[ this.parent.selectedIndex ];\r\n  this.selectedDot.className = 'dot is-selected';\r\n};\r\n\r\nPageDots.prototype.onTap = function( event ) {\r\n  var target = event.target;\r\n  // only care about dot clicks\r\n  if ( target.nodeName != 'LI' ) {\r\n    return;\r\n  }\r\n\r\n  this.parent.uiChange();\r\n  var index = this.dots.indexOf( target );\r\n  this.parent.select( index );\r\n};\r\n\r\nPageDots.prototype.destroy = function() {\r\n  this.deactivate();\r\n};\r\n\r\nFlickity.PageDots = PageDots;\r\n\r\n// -------------------------- Flickity -------------------------- //\r\n\r\nutils.extend( Flickity.defaults, {\r\n  pageDots: true\r\n});\r\n\r\nFlickity.createMethods.push('_createPageDots');\r\n\r\nvar proto = Flickity.prototype;\r\n\r\nproto._createPageDots = function() {\r\n  if ( !this.options.pageDots ) {\r\n    return;\r\n  }\r\n  this.pageDots = new PageDots( this );\r\n  // events\r\n  this.on( 'activate', this.activatePageDots );\r\n  this.on( 'select', this.updateSelectedPageDots );\r\n  this.on( 'cellChange', this.updatePageDots );\r\n  this.on( 'resize', this.updatePageDots );\r\n  this.on( 'deactivate', this.deactivatePageDots );\r\n};\r\n\r\nproto.activatePageDots = function() {\r\n  this.pageDots.activate();\r\n};\r\n\r\nproto.updateSelectedPageDots = function() {\r\n  this.pageDots.updateSelected();\r\n};\r\n\r\nproto.updatePageDots = function() {\r\n  this.pageDots.setDots();\r\n};\r\n\r\nproto.deactivatePageDots = function() {\r\n  this.pageDots.deactivate();\r\n};\r\n\r\n// -----  ----- //\r\n\r\nFlickity.PageDots = PageDots;\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n// player & autoPlay\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/player',[\r\n      'ev-emitter/ev-emitter',\r\n      'fizzy-ui-utils/utils',\r\n      './flickity'\r\n    ], function( EvEmitter, utils, Flickity ) {\r\n      return factory( EvEmitter, utils, Flickity );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      require('ev-emitter'),\r\n      require('fizzy-ui-utils'),\r\n      require('./flickity')\r\n    );\r\n  } else {\r\n    // browser global\r\n    factory(\r\n      window.EvEmitter,\r\n      window.fizzyUIUtils,\r\n      window.Flickity\r\n    );\r\n  }\r\n\r\n}( window, function factory( EvEmitter, utils, Flickity ) {\r\n\r\n\r\n\r\n// -------------------------- Page Visibility -------------------------- //\r\n// https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\r\n\r\nvar hiddenProperty, visibilityEvent;\r\nif ( 'hidden' in document ) {\r\n  hiddenProperty = 'hidden';\r\n  visibilityEvent = 'visibilitychange';\r\n} else if ( 'webkitHidden' in document ) {\r\n  hiddenProperty = 'webkitHidden';\r\n  visibilityEvent = 'webkitvisibilitychange';\r\n}\r\n\r\n// -------------------------- Player -------------------------- //\r\n\r\nfunction Player( parent ) {\r\n  this.parent = parent;\r\n  this.state = 'stopped';\r\n  // visibility change event handler\r\n  if ( visibilityEvent ) {\r\n    this.onVisibilityChange = function() {\r\n      this.visibilityChange();\r\n    }.bind( this );\r\n    this.onVisibilityPlay = function() {\r\n      this.visibilityPlay();\r\n    }.bind( this );\r\n  }\r\n}\r\n\r\nPlayer.prototype = Object.create( EvEmitter.prototype );\r\n\r\n// start play\r\nPlayer.prototype.play = function() {\r\n  if ( this.state == 'playing' ) {\r\n    return;\r\n  }\r\n  // do not play if page is hidden, start playing when page is visible\r\n  var isPageHidden = document[ hiddenProperty ];\r\n  if ( visibilityEvent && isPageHidden ) {\r\n    document.addEventListener( visibilityEvent, this.onVisibilityPlay );\r\n    return;\r\n  }\r\n\r\n  this.state = 'playing';\r\n  // listen to visibility change\r\n  if ( visibilityEvent ) {\r\n    document.addEventListener( visibilityEvent, this.onVisibilityChange );\r\n  }\r\n  // start ticking\r\n  this.tick();\r\n};\r\n\r\nPlayer.prototype.tick = function() {\r\n  // do not tick if not playing\r\n  if ( this.state != 'playing' ) {\r\n    return;\r\n  }\r\n\r\n  var time = this.parent.options.autoPlay;\r\n  // default to 3 seconds\r\n  time = typeof time == 'number' ? time : 3000;\r\n  var _this = this;\r\n  // HACK: reset ticks if stopped and started within interval\r\n  this.clear();\r\n  this.timeout = setTimeout( function() {\r\n    _this.parent.next( true );\r\n    _this.tick();\r\n  }, time );\r\n};\r\n\r\nPlayer.prototype.stop = function() {\r\n  this.state = 'stopped';\r\n  this.clear();\r\n  // remove visibility change event\r\n  if ( visibilityEvent ) {\r\n    document.removeEventListener( visibilityEvent, this.onVisibilityChange );\r\n  }\r\n};\r\n\r\nPlayer.prototype.clear = function() {\r\n  clearTimeout( this.timeout );\r\n};\r\n\r\nPlayer.prototype.pause = function() {\r\n  if ( this.state == 'playing' ) {\r\n    this.state = 'paused';\r\n    this.clear();\r\n  }\r\n};\r\n\r\nPlayer.prototype.unpause = function() {\r\n  // re-start play if paused\r\n  if ( this.state == 'paused' ) {\r\n    this.play();\r\n  }\r\n};\r\n\r\n// pause if page visibility is hidden, unpause if visible\r\nPlayer.prototype.visibilityChange = function() {\r\n  var isPageHidden = document[ hiddenProperty ];\r\n  this[ isPageHidden ? 'pause' : 'unpause' ]();\r\n};\r\n\r\nPlayer.prototype.visibilityPlay = function() {\r\n  this.play();\r\n  document.removeEventListener( visibilityEvent, this.onVisibilityPlay );\r\n};\r\n\r\n// -------------------------- Flickity -------------------------- //\r\n\r\nutils.extend( Flickity.defaults, {\r\n  pauseAutoPlayOnHover: true\r\n});\r\n\r\nFlickity.createMethods.push('_createPlayer');\r\nvar proto = Flickity.prototype;\r\n\r\nproto._createPlayer = function() {\r\n  this.player = new Player( this );\r\n\r\n  this.on( 'activate', this.activatePlayer );\r\n  this.on( 'uiChange', this.stopPlayer );\r\n  this.on( 'pointerDown', this.stopPlayer );\r\n  this.on( 'deactivate', this.deactivatePlayer );\r\n};\r\n\r\nproto.activatePlayer = function() {\r\n  if ( !this.options.autoPlay ) {\r\n    return;\r\n  }\r\n  this.player.play();\r\n  this.element.addEventListener( 'mouseenter', this );\r\n};\r\n\r\n// Player API, don't hate the ... thanks I know where the door is\r\n\r\nproto.playPlayer = function() {\r\n  this.player.play();\r\n};\r\n\r\nproto.stopPlayer = function() {\r\n  this.player.stop();\r\n};\r\n\r\nproto.pausePlayer = function() {\r\n  this.player.pause();\r\n};\r\n\r\nproto.unpausePlayer = function() {\r\n  this.player.unpause();\r\n};\r\n\r\nproto.deactivatePlayer = function() {\r\n  this.player.stop();\r\n  this.element.removeEventListener( 'mouseenter', this );\r\n};\r\n\r\n// ----- mouseenter/leave ----- //\r\n\r\n// pause auto-play on hover\r\nproto.onmouseenter = function() {\r\n  if ( !this.options.pauseAutoPlayOnHover ) {\r\n    return;\r\n  }\r\n  this.player.pause();\r\n  this.element.addEventListener( 'mouseleave', this );\r\n};\r\n\r\n// resume auto-play on hover off\r\nproto.onmouseleave = function() {\r\n  this.player.unpause();\r\n  this.element.removeEventListener( 'mouseleave', this );\r\n};\r\n\r\n// -----  ----- //\r\n\r\nFlickity.Player = Player;\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n// add, remove cell\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/add-remove-cell',[\r\n      './flickity',\r\n      'fizzy-ui-utils/utils'\r\n    ], function( Flickity, utils ) {\r\n      return factory( window, Flickity, utils );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('./flickity'),\r\n      require('fizzy-ui-utils')\r\n    );\r\n  } else {\r\n    // browser global\r\n    factory(\r\n      window,\r\n      window.Flickity,\r\n      window.fizzyUIUtils\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Flickity, utils ) {\r\n\r\n\r\n\r\n// append cells to a document fragment\r\nfunction getCellsFragment( cells ) {\r\n  var fragment = document.createDocumentFragment();\r\n  cells.forEach( function( cell ) {\r\n    fragment.appendChild( cell.element );\r\n  });\r\n  return fragment;\r\n}\r\n\r\n// -------------------------- add/remove cell prototype -------------------------- //\r\n\r\nvar proto = Flickity.prototype;\r\n\r\n/**\r\n * Insert, prepend, or append cells\r\n * @param {Element, Array, NodeList} elems\r\n * @param {Integer} index\r\n */\r\nproto.insert = function( elems, index ) {\r\n  var cells = this._makeCells( elems );\r\n  if ( !cells || !cells.length ) {\r\n    return;\r\n  }\r\n  var len = this.cells.length;\r\n  // default to append\r\n  index = index === undefined ? len : index;\r\n  // add cells with document fragment\r\n  var fragment = getCellsFragment( cells );\r\n  // append to slider\r\n  var isAppend = index == len;\r\n  if ( isAppend ) {\r\n    this.slider.appendChild( fragment );\r\n  } else {\r\n    var insertCellElement = this.cells[ index ].element;\r\n    this.slider.insertBefore( fragment, insertCellElement );\r\n  }\r\n  // add to this.cells\r\n  if ( index === 0 ) {\r\n    // prepend, add to start\r\n    this.cells = cells.concat( this.cells );\r\n  } else if ( isAppend ) {\r\n    // append, add to end\r\n    this.cells = this.cells.concat( cells );\r\n  } else {\r\n    // insert in this.cells\r\n    var endCells = this.cells.splice( index, len - index );\r\n    this.cells = this.cells.concat( cells ).concat( endCells );\r\n  }\r\n\r\n  this._sizeCells( cells );\r\n\r\n  var selectedIndexDelta = index > this.selectedIndex ? 0 : cells.length;\r\n  this._cellAddedRemoved( index, selectedIndexDelta );\r\n};\r\n\r\nproto.append = function( elems ) {\r\n  this.insert( elems, this.cells.length );\r\n};\r\n\r\nproto.prepend = function( elems ) {\r\n  this.insert( elems, 0 );\r\n};\r\n\r\n/**\r\n * Remove cells\r\n * @param {Element, Array, NodeList} elems\r\n */\r\nproto.remove = function( elems ) {\r\n  var cells = this.getCells( elems );\r\n  var selectedIndexDelta = 0;\r\n  var len = cells.length;\r\n  var i, cell;\r\n  // calculate selectedIndexDelta, easier if done in seperate loop\r\n  for ( i=0; i < len; i++ ) {\r\n    cell = cells[i];\r\n    var wasBefore = this.cells.indexOf( cell ) < this.selectedIndex;\r\n    selectedIndexDelta -= wasBefore ? 1 : 0;\r\n  }\r\n\r\n  for ( i=0; i < len; i++ ) {\r\n    cell = cells[i];\r\n    cell.remove();\r\n    // remove item from collection\r\n    utils.removeFrom( this.cells, cell );\r\n  }\r\n\r\n  if ( cells.length ) {\r\n    // update stuff\r\n    this._cellAddedRemoved( 0, selectedIndexDelta );\r\n  }\r\n};\r\n\r\n// updates when cells are added or removed\r\nproto._cellAddedRemoved = function( changedCellIndex, selectedIndexDelta ) {\r\n  // TODO this math isn't perfect with grouped slides\r\n  selectedIndexDelta = selectedIndexDelta || 0;\r\n  this.selectedIndex += selectedIndexDelta;\r\n  this.selectedIndex = Math.max( 0, Math.min( this.slides.length - 1, this.selectedIndex ) );\r\n\r\n  this.cellChange( changedCellIndex, true );\r\n  // backwards compatibility\r\n  this.emitEvent( 'cellAddedRemoved', [ changedCellIndex, selectedIndexDelta ] );\r\n};\r\n\r\n/**\r\n * logic to be run after a cell's size changes\r\n * @param {Element} elem - cell's element\r\n */\r\nproto.cellSizeChange = function( elem ) {\r\n  var cell = this.getCell( elem );\r\n  if ( !cell ) {\r\n    return;\r\n  }\r\n  cell.getSize();\r\n\r\n  var index = this.cells.indexOf( cell );\r\n  this.cellChange( index );\r\n};\r\n\r\n/**\r\n * logic any time a cell is changed: added, removed, or size changed\r\n * @param {Integer} changedCellIndex - index of the changed cell, optional\r\n */\r\nproto.cellChange = function( changedCellIndex, isPositioningSlider ) {\r\n  var prevSlideableWidth = this.slideableWidth;\r\n  this._positionCells( changedCellIndex );\r\n  this._getWrapShiftCells();\r\n  this.setGallerySize();\r\n  this.emitEvent( 'cellChange', [ changedCellIndex ] );\r\n  // position slider\r\n  if ( this.options.freeScroll ) {\r\n    // shift x by change in slideableWidth\r\n    // TODO fix position shifts when prepending w/ freeScroll\r\n    var deltaX = prevSlideableWidth - this.slideableWidth;\r\n    this.x += deltaX * this.cellAlign;\r\n    this.positionSlider();\r\n  } else {\r\n    // do not position slider after lazy load\r\n    if ( isPositioningSlider ) {\r\n      this.positionSliderAtSelected();\r\n    }\r\n    this.select( this.selectedIndex );\r\n  }\r\n};\r\n\r\n// -----  ----- //\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n// lazyload\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/lazyload',[\r\n      './flickity',\r\n      'fizzy-ui-utils/utils'\r\n    ], function( Flickity, utils ) {\r\n      return factory( window, Flickity, utils );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('./flickity'),\r\n      require('fizzy-ui-utils')\r\n    );\r\n  } else {\r\n    // browser global\r\n    factory(\r\n      window,\r\n      window.Flickity,\r\n      window.fizzyUIUtils\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Flickity, utils ) {\r\n'use strict';\r\n\r\nFlickity.createMethods.push('_createLazyload');\r\nvar proto = Flickity.prototype;\r\n\r\nproto._createLazyload = function() {\r\n  this.on( 'select', this.lazyLoad );\r\n};\r\n\r\nproto.lazyLoad = function() {\r\n  var lazyLoad = this.options.lazyLoad;\r\n  if ( !lazyLoad ) {\r\n    return;\r\n  }\r\n  // get adjacent cells, use lazyLoad option for adjacent count\r\n  var adjCount = typeof lazyLoad == 'number' ? lazyLoad : 0;\r\n  var cellElems = this.getAdjacentCellElements( adjCount );\r\n  // get lazy images in those cells\r\n  var lazyImages = [];\r\n  cellElems.forEach( function( cellElem ) {\r\n    var lazyCellImages = getCellLazyImages( cellElem );\r\n    lazyImages = lazyImages.concat( lazyCellImages );\r\n  });\r\n  // load lazy images\r\n  lazyImages.forEach( function( img ) {\r\n    new LazyLoader( img, this );\r\n  }, this );\r\n};\r\n\r\nfunction getCellLazyImages( cellElem ) {\r\n  // check if cell element is lazy image\r\n  if ( cellElem.nodeName == 'IMG' &&\r\n    cellElem.getAttribute('data-flickity-lazyload') ) {\r\n    return [ cellElem ];\r\n  }\r\n  // select lazy images in cell\r\n  var imgs = cellElem.querySelectorAll('img[data-flickity-lazyload]');\r\n  return utils.makeArray( imgs );\r\n}\r\n\r\n// -------------------------- LazyLoader -------------------------- //\r\n\r\n/**\r\n * class to handle loading images\r\n */\r\nfunction LazyLoader( img, flickity ) {\r\n  this.img = img;\r\n  this.flickity = flickity;\r\n  this.load();\r\n}\r\n\r\nLazyLoader.prototype.handleEvent = utils.handleEvent;\r\n\r\nLazyLoader.prototype.load = function() {\r\n  this.img.addEventListener( 'load', this );\r\n  this.img.addEventListener( 'error', this );\r\n  // load image\r\n  this.img.src = this.img.getAttribute('data-flickity-lazyload');\r\n  // remove attr\r\n  this.img.removeAttribute('data-flickity-lazyload');\r\n};\r\n\r\nLazyLoader.prototype.onload = function( event ) {\r\n  this.complete( event, 'flickity-lazyloaded' );\r\n};\r\n\r\nLazyLoader.prototype.onerror = function( event ) {\r\n  this.complete( event, 'flickity-lazyerror' );\r\n};\r\n\r\nLazyLoader.prototype.complete = function( event, className ) {\r\n  // unbind events\r\n  this.img.removeEventListener( 'load', this );\r\n  this.img.removeEventListener( 'error', this );\r\n\r\n  var cell = this.flickity.getParentCell( this.img );\r\n  var cellElem = cell && cell.element;\r\n  this.flickity.cellSizeChange( cellElem );\r\n\r\n  this.img.classList.add( className );\r\n  this.flickity.dispatchEvent( 'lazyLoad', event, cellElem );\r\n};\r\n\r\n// -----  ----- //\r\n\r\nFlickity.LazyLoader = LazyLoader;\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n/*!\r\n * Flickity v2.0.10\r\n * Touch, responsive, flickable carousels\r\n *\r\n * Licensed GPLv3 for open source use\r\n * or Flickity Commercial License for commercial use\r\n *\r\n * http://flickity.metafizzy.co\r\n * Copyright 2017 Metafizzy\r\n */\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /* jshint strict: false */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity/js/index',[\r\n      './flickity',\r\n      './drag',\r\n      './prev-next-button',\r\n      './page-dots',\r\n      './player',\r\n      './add-remove-cell',\r\n      './lazyload'\r\n    ], factory );\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      require('./flickity'),\r\n      require('./drag'),\r\n      require('./prev-next-button'),\r\n      require('./page-dots'),\r\n      require('./player'),\r\n      require('./add-remove-cell'),\r\n      require('./lazyload')\r\n    );\r\n  }\r\n\r\n})( window, function factory( Flickity ) {\r\n  /*jshint strict: false*/\r\n  return Flickity;\r\n});\r\n\r\n/*!\r\n * Flickity asNavFor v2.0.1\r\n * enable asNavFor for Flickity\r\n */\r\n\r\n/*jshint browser: true, undef: true, unused: true, strict: true*/\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /*jshint strict: false */ /*globals define, module, require */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'flickity-as-nav-for/as-nav-for',[\r\n      'flickity/js/index',\r\n      'fizzy-ui-utils/utils'\r\n    ], factory );\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      require('flickity'),\r\n      require('fizzy-ui-utils')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.Flickity = factory(\r\n      window.Flickity,\r\n      window.fizzyUIUtils\r\n    );\r\n  }\r\n\r\n}( window, function factory( Flickity, utils ) {\r\n\r\n\r\n\r\n// -------------------------- asNavFor prototype -------------------------- //\r\n\r\n// Flickity.defaults.asNavFor = null;\r\n\r\nFlickity.createMethods.push('_createAsNavFor');\r\n\r\nvar proto = Flickity.prototype;\r\n\r\nproto._createAsNavFor = function() {\r\n  this.on( 'activate', this.activateAsNavFor );\r\n  this.on( 'deactivate', this.deactivateAsNavFor );\r\n  this.on( 'destroy', this.destroyAsNavFor );\r\n\r\n  var asNavForOption = this.options.asNavFor;\r\n  if ( !asNavForOption ) {\r\n    return;\r\n  }\r\n  // HACK do async, give time for other flickity to be initalized\r\n  var _this = this;\r\n  setTimeout( function initNavCompanion() {\r\n    _this.setNavCompanion( asNavForOption );\r\n  });\r\n};\r\n\r\nproto.setNavCompanion = function( elem ) {\r\n  elem = utils.getQueryElement( elem );\r\n  var companion = Flickity.data( elem );\r\n  // stop if no companion or companion is self\r\n  if ( !companion || companion == this ) {\r\n    return;\r\n  }\r\n\r\n  this.navCompanion = companion;\r\n  // companion select\r\n  var _this = this;\r\n  this.onNavCompanionSelect = function() {\r\n    _this.navCompanionSelect();\r\n  };\r\n  companion.on( 'select', this.onNavCompanionSelect );\r\n  // click\r\n  this.on( 'staticClick', this.onNavStaticClick );\r\n\r\n  this.navCompanionSelect( true );\r\n};\r\n\r\nproto.navCompanionSelect = function( isInstant ) {\r\n  if ( !this.navCompanion ) {\r\n    return;\r\n  }\r\n  // select slide that matches first cell of slide\r\n  var selectedCell = this.navCompanion.selectedCells[0];\r\n  var firstIndex = this.navCompanion.cells.indexOf( selectedCell );\r\n  var lastIndex = firstIndex + this.navCompanion.selectedCells.length - 1;\r\n  var selectIndex = Math.floor( lerp( firstIndex, lastIndex,\r\n    this.navCompanion.cellAlign ) );\r\n  this.selectCell( selectIndex, false, isInstant );\r\n  // set nav selected class\r\n  this.removeNavSelectedElements();\r\n  // stop if companion has more cells than this one\r\n  if ( selectIndex >= this.cells.length ) {\r\n    return;\r\n  }\r\n\r\n  var selectedCells = this.cells.slice( firstIndex, lastIndex + 1 );\r\n  this.navSelectedElements = selectedCells.map( function( cell ) {\r\n    return cell.element;\r\n  });\r\n  this.changeNavSelectedClass('add');\r\n};\r\n\r\nfunction lerp( a, b, t ) {\r\n  return ( b - a ) * t + a;\r\n}\r\n\r\nproto.changeNavSelectedClass = function( method ) {\r\n  this.navSelectedElements.forEach( function( navElem ) {\r\n    navElem.classList[ method ]('is-nav-selected');\r\n  });\r\n};\r\n\r\nproto.activateAsNavFor = function() {\r\n  this.navCompanionSelect( true );\r\n};\r\n\r\nproto.removeNavSelectedElements = function() {\r\n  if ( !this.navSelectedElements ) {\r\n    return;\r\n  }\r\n  this.changeNavSelectedClass('remove');\r\n  delete this.navSelectedElements;\r\n};\r\n\r\nproto.onNavStaticClick = function( event, pointer, cellElement, cellIndex ) {\r\n  if ( typeof cellIndex == 'number' ) {\r\n    this.navCompanion.selectCell( cellIndex );\r\n  }\r\n};\r\n\r\nproto.deactivateAsNavFor = function() {\r\n  this.removeNavSelectedElements();\r\n};\r\n\r\nproto.destroyAsNavFor = function() {\r\n  if ( !this.navCompanion ) {\r\n    return;\r\n  }\r\n  this.navCompanion.off( 'select', this.onNavCompanionSelect );\r\n  this.off( 'staticClick', this.onNavStaticClick );\r\n  delete this.navCompanion;\r\n};\r\n\r\n// -----  ----- //\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n/*!\r\n * imagesLoaded v4.1.3\r\n * JavaScript is all like \"You images are done yet or what?\"\r\n * MIT License\r\n */\r\n\r\n( function( window, factory ) { 'use strict';\r\n  // universal module definition\r\n\r\n  /*global define: false, module: false, require: false */\r\n\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( 'imagesloaded/imagesloaded',[\r\n      'ev-emitter/ev-emitter'\r\n    ], function( EvEmitter ) {\r\n      return factory( window, EvEmitter );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('ev-emitter')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.imagesLoaded = factory(\r\n      window,\r\n      window.EvEmitter\r\n    );\r\n  }\r\n\r\n})( typeof window !== 'undefined' ? window : this,\r\n\r\n// --------------------------  factory -------------------------- //\r\n\r\nfunction factory( window, EvEmitter ) {\r\n\r\n\r\n\r\nvar $ = window.jQuery;\r\nvar console = window.console;\r\n\r\n// -------------------------- helpers -------------------------- //\r\n\r\n// extend objects\r\nfunction extend( a, b ) {\r\n  for ( var prop in b ) {\r\n    a[ prop ] = b[ prop ];\r\n  }\r\n  return a;\r\n}\r\n\r\n// turn element or nodeList into an array\r\nfunction makeArray( obj ) {\r\n  var ary = [];\r\n  if ( Array.isArray( obj ) ) {\r\n    // use object if already an array\r\n    ary = obj;\r\n  } else if ( typeof obj.length == 'number' ) {\r\n    // convert nodeList to array\r\n    for ( var i=0; i < obj.length; i++ ) {\r\n      ary.push( obj[i] );\r\n    }\r\n  } else {\r\n    // array of single index\r\n    ary.push( obj );\r\n  }\r\n  return ary;\r\n}\r\n\r\n// -------------------------- imagesLoaded -------------------------- //\r\n\r\n/**\r\n * @param {Array, Element, NodeList, String} elem\r\n * @param {Object or Function} options - if function, use as callback\r\n * @param {Function} onAlways - callback function\r\n */\r\nfunction ImagesLoaded( elem, options, onAlways ) {\r\n  // coerce ImagesLoaded() without new, to be new ImagesLoaded()\r\n  if ( !( this instanceof ImagesLoaded ) ) {\r\n    return new ImagesLoaded( elem, options, onAlways );\r\n  }\r\n  // use elem as selector string\r\n  if ( typeof elem == 'string' ) {\r\n    elem = document.querySelectorAll( elem );\r\n  }\r\n\r\n  this.elements = makeArray( elem );\r\n  this.options = extend( {}, this.options );\r\n\r\n  if ( typeof options == 'function' ) {\r\n    onAlways = options;\r\n  } else {\r\n    extend( this.options, options );\r\n  }\r\n\r\n  if ( onAlways ) {\r\n    this.on( 'always', onAlways );\r\n  }\r\n\r\n  this.getImages();\r\n\r\n  if ( $ ) {\r\n    // add jQuery Deferred object\r\n    this.jqDeferred = new $.Deferred();\r\n  }\r\n\r\n  // HACK check async to allow time to bind listeners\r\n  setTimeout( function() {\r\n    this.check();\r\n  }.bind( this ));\r\n}\r\n\r\nImagesLoaded.prototype = Object.create( EvEmitter.prototype );\r\n\r\nImagesLoaded.prototype.options = {};\r\n\r\nImagesLoaded.prototype.getImages = function() {\r\n  this.images = [];\r\n\r\n  // filter & find items if we have an item selector\r\n  this.elements.forEach( this.addElementImages, this );\r\n};\r\n\r\n/**\r\n * @param {Node} element\r\n */\r\nImagesLoaded.prototype.addElementImages = function( elem ) {\r\n  // filter siblings\r\n  if ( elem.nodeName == 'IMG' ) {\r\n    this.addImage( elem );\r\n  }\r\n  // get background image on element\r\n  if ( this.options.background === true ) {\r\n    this.addElementBackgroundImages( elem );\r\n  }\r\n\r\n  // find children\r\n  // no non-element nodes, #143\r\n  var nodeType = elem.nodeType;\r\n  if ( !nodeType || !elementNodeTypes[ nodeType ] ) {\r\n    return;\r\n  }\r\n  var childImgs = elem.querySelectorAll('img');\r\n  // concat childElems to filterFound array\r\n  for ( var i=0; i < childImgs.length; i++ ) {\r\n    var img = childImgs[i];\r\n    this.addImage( img );\r\n  }\r\n\r\n  // get child background images\r\n  if ( typeof this.options.background == 'string' ) {\r\n    var children = elem.querySelectorAll( this.options.background );\r\n    for ( i=0; i < children.length; i++ ) {\r\n      var child = children[i];\r\n      this.addElementBackgroundImages( child );\r\n    }\r\n  }\r\n};\r\n\r\nvar elementNodeTypes = {\r\n  1: true,\r\n  9: true,\r\n  11: true\r\n};\r\n\r\nImagesLoaded.prototype.addElementBackgroundImages = function( elem ) {\r\n  var style = getComputedStyle( elem );\r\n  if ( !style ) {\r\n    // Firefox returns null if in a hidden iframe https://bugzil.la/548397\r\n    return;\r\n  }\r\n  // get url inside url(\"...\")\r\n  var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\r\n  var matches = reURL.exec( style.backgroundImage );\r\n  while ( matches !== null ) {\r\n    var url = matches && matches[2];\r\n    if ( url ) {\r\n      this.addBackground( url, elem );\r\n    }\r\n    matches = reURL.exec( style.backgroundImage );\r\n  }\r\n};\r\n\r\n/**\r\n * @param {Image} img\r\n */\r\nImagesLoaded.prototype.addImage = function( img ) {\r\n  var loadingImage = new LoadingImage( img );\r\n  this.images.push( loadingImage );\r\n};\r\n\r\nImagesLoaded.prototype.addBackground = function( url, elem ) {\r\n  var background = new Background( url, elem );\r\n  this.images.push( background );\r\n};\r\n\r\nImagesLoaded.prototype.check = function() {\r\n  var _this = this;\r\n  this.progressedCount = 0;\r\n  this.hasAnyBroken = false;\r\n  // complete if no images\r\n  if ( !this.images.length ) {\r\n    this.complete();\r\n    return;\r\n  }\r\n\r\n  function onProgress( image, elem, message ) {\r\n    // HACK - Chrome triggers event before object properties have changed. #83\r\n    setTimeout( function() {\r\n      _this.progress( image, elem, message );\r\n    });\r\n  }\r\n\r\n  this.images.forEach( function( loadingImage ) {\r\n    loadingImage.once( 'progress', onProgress );\r\n    loadingImage.check();\r\n  });\r\n};\r\n\r\nImagesLoaded.prototype.progress = function( image, elem, message ) {\r\n  this.progressedCount++;\r\n  this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;\r\n  // progress event\r\n  this.emitEvent( 'progress', [ this, image, elem ] );\r\n  if ( this.jqDeferred && this.jqDeferred.notify ) {\r\n    this.jqDeferred.notify( this, image );\r\n  }\r\n  // check if completed\r\n  if ( this.progressedCount == this.images.length ) {\r\n    this.complete();\r\n  }\r\n\r\n  if ( this.options.debug && console ) {\r\n    console.log( 'progress: ' + message, image, elem );\r\n  }\r\n};\r\n\r\nImagesLoaded.prototype.complete = function() {\r\n  var eventName = this.hasAnyBroken ? 'fail' : 'done';\r\n  this.isComplete = true;\r\n  this.emitEvent( eventName, [ this ] );\r\n  this.emitEvent( 'always', [ this ] );\r\n  if ( this.jqDeferred ) {\r\n    var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\r\n    this.jqDeferred[ jqMethod ]( this );\r\n  }\r\n};\r\n\r\n// --------------------------  -------------------------- //\r\n\r\nfunction LoadingImage( img ) {\r\n  this.img = img;\r\n}\r\n\r\nLoadingImage.prototype = Object.create( EvEmitter.prototype );\r\n\r\nLoadingImage.prototype.check = function() {\r\n  // If complete is true and browser supports natural sizes,\r\n  // try to check for image status manually.\r\n  var isComplete = this.getIsImageComplete();\r\n  if ( isComplete ) {\r\n    // report based on naturalWidth\r\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\r\n    return;\r\n  }\r\n\r\n  // If none of the checks above matched, simulate loading on detached element.\r\n  this.proxyImage = new Image();\r\n  this.proxyImage.addEventListener( 'load', this );\r\n  this.proxyImage.addEventListener( 'error', this );\r\n  // bind to image as well for Firefox. #191\r\n  this.img.addEventListener( 'load', this );\r\n  this.img.addEventListener( 'error', this );\r\n  this.proxyImage.src = this.img.src;\r\n};\r\n\r\nLoadingImage.prototype.getIsImageComplete = function() {\r\n  return this.img.complete && this.img.naturalWidth !== undefined;\r\n};\r\n\r\nLoadingImage.prototype.confirm = function( isLoaded, message ) {\r\n  this.isLoaded = isLoaded;\r\n  this.emitEvent( 'progress', [ this, this.img, message ] );\r\n};\r\n\r\n// ----- events ----- //\r\n\r\n// trigger specified handler for event type\r\nLoadingImage.prototype.handleEvent = function( event ) {\r\n  var method = 'on' + event.type;\r\n  if ( this[ method ] ) {\r\n    this[ method ]( event );\r\n  }\r\n};\r\n\r\nLoadingImage.prototype.onload = function() {\r\n  this.confirm( true, 'onload' );\r\n  this.unbindEvents();\r\n};\r\n\r\nLoadingImage.prototype.onerror = function() {\r\n  this.confirm( false, 'onerror' );\r\n  this.unbindEvents();\r\n};\r\n\r\nLoadingImage.prototype.unbindEvents = function() {\r\n  this.proxyImage.removeEventListener( 'load', this );\r\n  this.proxyImage.removeEventListener( 'error', this );\r\n  this.img.removeEventListener( 'load', this );\r\n  this.img.removeEventListener( 'error', this );\r\n};\r\n\r\n// -------------------------- Background -------------------------- //\r\n\r\nfunction Background( url, element ) {\r\n  this.url = url;\r\n  this.element = element;\r\n  this.img = new Image();\r\n}\r\n\r\n// inherit LoadingImage prototype\r\nBackground.prototype = Object.create( LoadingImage.prototype );\r\n\r\nBackground.prototype.check = function() {\r\n  this.img.addEventListener( 'load', this );\r\n  this.img.addEventListener( 'error', this );\r\n  this.img.src = this.url;\r\n  // check if image is already complete\r\n  var isComplete = this.getIsImageComplete();\r\n  if ( isComplete ) {\r\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\r\n    this.unbindEvents();\r\n  }\r\n};\r\n\r\nBackground.prototype.unbindEvents = function() {\r\n  this.img.removeEventListener( 'load', this );\r\n  this.img.removeEventListener( 'error', this );\r\n};\r\n\r\nBackground.prototype.confirm = function( isLoaded, message ) {\r\n  this.isLoaded = isLoaded;\r\n  this.emitEvent( 'progress', [ this, this.element, message ] );\r\n};\r\n\r\n// -------------------------- jQuery -------------------------- //\r\n\r\nImagesLoaded.makeJQueryPlugin = function( jQuery ) {\r\n  jQuery = jQuery || window.jQuery;\r\n  if ( !jQuery ) {\r\n    return;\r\n  }\r\n  // set local variable\r\n  $ = jQuery;\r\n  // $().imagesLoaded()\r\n  $.fn.imagesLoaded = function( options, callback ) {\r\n    var instance = new ImagesLoaded( this, options, callback );\r\n    return instance.jqDeferred.promise( $(this) );\r\n  };\r\n};\r\n// try making plugin\r\nImagesLoaded.makeJQueryPlugin();\r\n\r\n// --------------------------  -------------------------- //\r\n\r\nreturn ImagesLoaded;\r\n\r\n});\r\n\r\n/*!\r\n * Flickity imagesLoaded v2.0.0\r\n * enables imagesLoaded option for Flickity\r\n */\r\n\r\n/*jshint browser: true, strict: true, undef: true, unused: true */\r\n\r\n( function( window, factory ) {\r\n  // universal module definition\r\n  /*jshint strict: false */ /*globals define, module, require */\r\n  if ( typeof define == 'function' && define.amd ) {\r\n    // AMD\r\n    define( [\r\n      'flickity/js/index',\r\n      'imagesloaded/imagesloaded'\r\n    ], function( Flickity, imagesLoaded ) {\r\n      return factory( window, Flickity, imagesLoaded );\r\n    });\r\n  } else if ( typeof module == 'object' && module.exports ) {\r\n    // CommonJS\r\n    module.exports = factory(\r\n      window,\r\n      require('flickity'),\r\n      require('imagesloaded')\r\n    );\r\n  } else {\r\n    // browser global\r\n    window.Flickity = factory(\r\n      window,\r\n      window.Flickity,\r\n      window.imagesLoaded\r\n    );\r\n  }\r\n\r\n}( window, function factory( window, Flickity, imagesLoaded ) {\r\n'use strict';\r\n\r\nFlickity.createMethods.push('_createImagesLoaded');\r\n\r\nvar proto = Flickity.prototype;\r\n\r\nproto._createImagesLoaded = function() {\r\n  this.on( 'activate', this.imagesLoaded );\r\n};\r\n\r\nproto.imagesLoaded = function() {\r\n  if ( !this.options.imagesLoaded ) {\r\n    return;\r\n  }\r\n  var _this = this;\r\n  function onImagesLoadedProgress( instance, image ) {\r\n    var cell = _this.getParentCell( image.img );\r\n    _this.cellSizeChange( cell && cell.element );\r\n    if ( !_this.options.freeScroll ) {\r\n      _this.positionSliderAtSelected();\r\n    }\r\n  }\r\n  imagesLoaded( this.slider ).on( 'progress', onImagesLoadedProgress );\r\n};\r\n\r\nreturn Flickity;\r\n\r\n}));\r\n\r\n","/*!\r\n * jQuery Validation Plugin v1.17.0\r\n *\r\n * https://jqueryvalidation.org/\r\n *\r\n * Copyright (c) 2017 Jörn Zaefferer\r\n * Released under the MIT license\r\n */\r\n(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\tdefine( [\"jquery\"], factory );\r\n\t} else if (typeof module === \"object\" && module.exports) {\r\n\t\tmodule.exports = factory( require( \"jquery\" ) );\r\n\t} else {\r\n\t\tfactory( jQuery );\r\n\t}\r\n}(function( $ ) {\r\n\r\n$.extend( $.fn, {\n\n\t// https://jqueryvalidation.org/validate/\n\tvalidate: function( options ) {\n\n\t\t// If nothing is selected, return nothing; can't chain anyway\n\t\tif ( !this.length ) {\n\t\t\tif ( options && options.debug && window.console ) {\n\t\t\t\tconsole.warn( \"Nothing selected, can't validate, returning nothing.\" );\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Check if a validator for this form was already created\n\t\tvar validator = $.data( this[ 0 ], \"validator\" );\n\t\tif ( validator ) {\n\t\t\treturn validator;\n\t\t}\n\n\t\t// Add novalidate tag if HTML5.\n\t\tthis.attr( \"novalidate\", \"novalidate\" );\n\n\t\tvalidator = new $.validator( options, this[ 0 ] );\n\t\t$.data( this[ 0 ], \"validator\", validator );\n\n\t\tif ( validator.settings.onsubmit ) {\n\n\t\t\tthis.on( \"click.validate\", \":submit\", function( event ) {\n\n\t\t\t\t// Track the used submit button to properly handle scripted\n\t\t\t\t// submits later.\n\t\t\t\tvalidator.submitButton = event.currentTarget;\n\n\t\t\t\t// Allow suppressing validation by adding a cancel class to the submit button\n\t\t\t\tif ( $( this ).hasClass( \"cancel\" ) ) {\n\t\t\t\t\tvalidator.cancelSubmit = true;\n\t\t\t\t}\n\n\t\t\t\t// Allow suppressing validation by adding the html5 formnovalidate attribute to the submit button\n\t\t\t\tif ( $( this ).attr( \"formnovalidate\" ) !== undefined ) {\n\t\t\t\t\tvalidator.cancelSubmit = true;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Validate the form on submit\n\t\t\tthis.on( \"submit.validate\", function( event ) {\n\t\t\t\tif ( validator.settings.debug ) {\n\n\t\t\t\t\t// Prevent form submit to be able to see console output\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tfunction handle() {\n\t\t\t\t\tvar hidden, result;\n\n\t\t\t\t\t// Insert a hidden input as a replacement for the missing submit button\n\t\t\t\t\t// The hidden input is inserted in two cases:\n\t\t\t\t\t//   - A user defined a `submitHandler`\n\t\t\t\t\t//   - There was a pending request due to `remote` method and `stopRequest()`\n\t\t\t\t\t//     was called to submit the form in case it's valid\n\t\t\t\t\tif ( validator.submitButton && ( validator.settings.submitHandler || validator.formSubmitted ) ) {\n\t\t\t\t\t\thidden = $( \"<input type='hidden'/>\" )\n\t\t\t\t\t\t\t.attr( \"name\", validator.submitButton.name )\n\t\t\t\t\t\t\t.val( $( validator.submitButton ).val() )\n\t\t\t\t\t\t\t.appendTo( validator.currentForm );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( validator.settings.submitHandler ) {\n\t\t\t\t\t\tresult = validator.settings.submitHandler.call( validator, validator.currentForm, event );\n\t\t\t\t\t\tif ( hidden ) {\n\n\t\t\t\t\t\t\t// And clean up afterwards; thanks to no-block-scope, hidden can be referenced\n\t\t\t\t\t\t\thidden.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( result !== undefined ) {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t// Prevent submit for invalid forms or custom submit handlers\n\t\t\t\tif ( validator.cancelSubmit ) {\n\t\t\t\t\tvalidator.cancelSubmit = false;\n\t\t\t\t\treturn handle();\n\t\t\t\t}\n\t\t\t\tif ( validator.form() ) {\n\t\t\t\t\tif ( validator.pendingRequest ) {\n\t\t\t\t\t\tvalidator.formSubmitted = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn handle();\n\t\t\t\t} else {\n\t\t\t\t\tvalidator.focusInvalid();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\treturn validator;\n\t},\n\n\t// https://jqueryvalidation.org/valid/\n\tvalid: function() {\n\t\tvar valid, validator, errorList;\n\n\t\tif ( $( this[ 0 ] ).is( \"form\" ) ) {\n\t\t\tvalid = this.validate().form();\n\t\t} else {\n\t\t\terrorList = [];\n\t\t\tvalid = true;\n\t\t\tvalidator = $( this[ 0 ].form ).validate();\n\t\t\tthis.each( function() {\n\t\t\t\tvalid = validator.element( this ) && valid;\n\t\t\t\tif ( !valid ) {\n\t\t\t\t\terrorList = errorList.concat( validator.errorList );\n\t\t\t\t}\n\t\t\t} );\n\t\t\tvalidator.errorList = errorList;\n\t\t}\n\t\treturn valid;\n\t},\n\n\t// https://jqueryvalidation.org/rules/\n\trules: function( command, argument ) {\n\t\tvar element = this[ 0 ],\n\t\t\tsettings, staticRules, existingRules, data, param, filtered;\n\n\t\t// If nothing is selected, return empty object; can't chain anyway\n\t\tif ( element == null ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !element.form && element.hasAttribute( \"contenteditable\" ) ) {\n\t\t\telement.form = this.closest( \"form\" )[ 0 ];\n\t\t\telement.name = this.attr( \"name\" );\n\t\t}\n\n\t\tif ( element.form == null ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( command ) {\n\t\t\tsettings = $.data( element.form, \"validator\" ).settings;\n\t\t\tstaticRules = settings.rules;\n\t\t\texistingRules = $.validator.staticRules( element );\n\t\t\tswitch ( command ) {\n\t\t\tcase \"add\":\n\t\t\t\t$.extend( existingRules, $.validator.normalizeRule( argument ) );\n\n\t\t\t\t// Remove messages from rules, but allow them to be set separately\n\t\t\t\tdelete existingRules.messages;\n\t\t\t\tstaticRules[ element.name ] = existingRules;\n\t\t\t\tif ( argument.messages ) {\n\t\t\t\t\tsettings.messages[ element.name ] = $.extend( settings.messages[ element.name ], argument.messages );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"remove\":\n\t\t\t\tif ( !argument ) {\n\t\t\t\t\tdelete staticRules[ element.name ];\n\t\t\t\t\treturn existingRules;\n\t\t\t\t}\n\t\t\t\tfiltered = {};\n\t\t\t\t$.each( argument.split( /\\s/ ), function( index, method ) {\n\t\t\t\t\tfiltered[ method ] = existingRules[ method ];\n\t\t\t\t\tdelete existingRules[ method ];\n\t\t\t\t} );\n\t\t\t\treturn filtered;\n\t\t\t}\n\t\t}\n\n\t\tdata = $.validator.normalizeRules(\n\t\t$.extend(\n\t\t\t{},\n\t\t\t$.validator.classRules( element ),\n\t\t\t$.validator.attributeRules( element ),\n\t\t\t$.validator.dataRules( element ),\n\t\t\t$.validator.staticRules( element )\n\t\t), element );\n\n\t\t// Make sure required is at front\n\t\tif ( data.required ) {\n\t\t\tparam = data.required;\n\t\t\tdelete data.required;\n\t\t\tdata = $.extend( { required: param }, data );\n\t\t}\n\n\t\t// Make sure remote is at back\n\t\tif ( data.remote ) {\n\t\t\tparam = data.remote;\n\t\t\tdelete data.remote;\n\t\t\tdata = $.extend( data, { remote: param } );\n\t\t}\n\n\t\treturn data;\n\t}\n} );\n\n// Custom selectors\n$.extend( $.expr.pseudos || $.expr[ \":\" ], {\t\t// '|| $.expr[ \":\" ]' here enables backwards compatibility to jQuery 1.7. Can be removed when dropping jQ 1.7.x support\n\n\t// https://jqueryvalidation.org/blank-selector/\n\tblank: function( a ) {\n\t\treturn !$.trim( \"\" + $( a ).val() );\n\t},\n\n\t// https://jqueryvalidation.org/filled-selector/\n\tfilled: function( a ) {\n\t\tvar val = $( a ).val();\n\t\treturn val !== null && !!$.trim( \"\" + val );\n\t},\n\n\t// https://jqueryvalidation.org/unchecked-selector/\n\tunchecked: function( a ) {\n\t\treturn !$( a ).prop( \"checked\" );\n\t}\n} );\n\n// Constructor for validator\n$.validator = function( options, form ) {\n\tthis.settings = $.extend( true, {}, $.validator.defaults, options );\n\tthis.currentForm = form;\n\tthis.init();\n};\n\n// https://jqueryvalidation.org/jQuery.validator.format/\n$.validator.format = function( source, params ) {\n\tif ( arguments.length === 1 ) {\n\t\treturn function() {\n\t\t\tvar args = $.makeArray( arguments );\n\t\t\targs.unshift( source );\n\t\t\treturn $.validator.format.apply( this, args );\n\t\t};\n\t}\n\tif ( params === undefined ) {\n\t\treturn source;\n\t}\n\tif ( arguments.length > 2 && params.constructor !== Array  ) {\n\t\tparams = $.makeArray( arguments ).slice( 1 );\n\t}\n\tif ( params.constructor !== Array ) {\n\t\tparams = [ params ];\n\t}\n\t$.each( params, function( i, n ) {\n\t\tsource = source.replace( new RegExp( \"\\\\{\" + i + \"\\\\}\", \"g\" ), function() {\n\t\t\treturn n;\n\t\t} );\n\t} );\n\treturn source;\n};\n\n$.extend( $.validator, {\n\n\tdefaults: {\n\t\tmessages: {},\n\t\tgroups: {},\n\t\trules: {},\n\t\terrorClass: \"error\",\n\t\tpendingClass: \"pending\",\n\t\tvalidClass: \"valid\",\n\t\terrorElement: \"label\",\n\t\tfocusCleanup: false,\n\t\tfocusInvalid: true,\n\t\terrorContainer: $( [] ),\n\t\terrorLabelContainer: $( [] ),\n\t\tonsubmit: true,\n\t\tignore: \":hidden\",\n\t\tignoreTitle: false,\n\t\tonfocusin: function( element ) {\n\t\t\tthis.lastActive = element;\n\n\t\t\t// Hide error label and remove error class on focus if enabled\n\t\t\tif ( this.settings.focusCleanup ) {\n\t\t\t\tif ( this.settings.unhighlight ) {\n\t\t\t\t\tthis.settings.unhighlight.call( this, element, this.settings.errorClass, this.settings.validClass );\n\t\t\t\t}\n\t\t\t\tthis.hideThese( this.errorsFor( element ) );\n\t\t\t}\n\t\t},\n\t\tonfocusout: function( element ) {\n\t\t\tif ( !this.checkable( element ) && ( element.name in this.submitted || !this.optional( element ) ) ) {\n\t\t\t\tthis.element( element );\n\t\t\t}\n\t\t},\n\t\tonkeyup: function( element, event ) {\n\n\t\t\t// Avoid revalidate the field when pressing one of the following keys\n\t\t\t// Shift       => 16\n\t\t\t// Ctrl        => 17\n\t\t\t// Alt         => 18\n\t\t\t// Caps lock   => 20\n\t\t\t// End         => 35\n\t\t\t// Home        => 36\n\t\t\t// Left arrow  => 37\n\t\t\t// Up arrow    => 38\n\t\t\t// Right arrow => 39\n\t\t\t// Down arrow  => 40\n\t\t\t// Insert      => 45\n\t\t\t// Num lock    => 144\n\t\t\t// AltGr key   => 225\n\t\t\tvar excludedKeys = [\n\t\t\t\t16, 17, 18, 20, 35, 36, 37,\n\t\t\t\t38, 39, 40, 45, 144, 225\n\t\t\t];\n\n\t\t\tif ( event.which === 9 && this.elementValue( element ) === \"\" || $.inArray( event.keyCode, excludedKeys ) !== -1 ) {\n\t\t\t\treturn;\n\t\t\t} else if ( element.name in this.submitted || element.name in this.invalid ) {\n\t\t\t\tthis.element( element );\n\t\t\t}\n\t\t},\n\t\tonclick: function( element ) {\n\n\t\t\t// Click on selects, radiobuttons and checkboxes\n\t\t\tif ( element.name in this.submitted ) {\n\t\t\t\tthis.element( element );\n\n\t\t\t// Or option elements, check parent select in that case\n\t\t\t} else if ( element.parentNode.name in this.submitted ) {\n\t\t\t\tthis.element( element.parentNode );\n\t\t\t}\n\t\t},\n\t\thighlight: function( element, errorClass, validClass ) {\n\t\t\tif ( element.type === \"radio\" ) {\n\t\t\t\tthis.findByName( element.name ).addClass( errorClass ).removeClass( validClass );\n\t\t\t} else {\n\t\t\t\t$( element ).addClass( errorClass ).removeClass( validClass );\n\t\t\t}\n\t\t},\n\t\tunhighlight: function( element, errorClass, validClass ) {\n\t\t\tif ( element.type === \"radio\" ) {\n\t\t\t\tthis.findByName( element.name ).removeClass( errorClass ).addClass( validClass );\n\t\t\t} else {\n\t\t\t\t$( element ).removeClass( errorClass ).addClass( validClass );\n\t\t\t}\n\t\t}\n\t},\n\n\t// https://jqueryvalidation.org/jQuery.validator.setDefaults/\n\tsetDefaults: function( settings ) {\n\t\t$.extend( $.validator.defaults, settings );\n\t},\n\n\tmessages: {\n\t\trequired: \"This field is required.\",\n\t\tremote: \"Please fix this field.\",\n\t\temail: \"Please enter a valid email address.\",\n\t\turl: \"Please enter a valid URL.\",\n\t\tdate: \"Please enter a valid date.\",\n\t\tdateISO: \"Please enter a valid date (ISO).\",\n\t\tnumber: \"Please enter a valid number.\",\n\t\tdigits: \"Please enter only digits.\",\n\t\tequalTo: \"Please enter the same value again.\",\n\t\tmaxlength: $.validator.format( \"Please enter no more than {0} characters.\" ),\n\t\tminlength: $.validator.format( \"Please enter at least {0} characters.\" ),\n\t\trangelength: $.validator.format( \"Please enter a value between {0} and {1} characters long.\" ),\n\t\trange: $.validator.format( \"Please enter a value between {0} and {1}.\" ),\n\t\tmax: $.validator.format( \"Please enter a value less than or equal to {0}.\" ),\n\t\tmin: $.validator.format( \"Please enter a value greater than or equal to {0}.\" ),\n\t\tstep: $.validator.format( \"Please enter a multiple of {0}.\" )\n\t},\n\n\tautoCreateRanges: false,\n\n\tprototype: {\n\n\t\tinit: function() {\n\t\t\tthis.labelContainer = $( this.settings.errorLabelContainer );\n\t\t\tthis.errorContext = this.labelContainer.length && this.labelContainer || $( this.currentForm );\n\t\t\tthis.containers = $( this.settings.errorContainer ).add( this.settings.errorLabelContainer );\n\t\t\tthis.submitted = {};\n\t\t\tthis.valueCache = {};\n\t\t\tthis.pendingRequest = 0;\n\t\t\tthis.pending = {};\n\t\t\tthis.invalid = {};\n\t\t\tthis.reset();\n\n\t\t\tvar groups = ( this.groups = {} ),\n\t\t\t\trules;\n\t\t\t$.each( this.settings.groups, function( key, value ) {\n\t\t\t\tif ( typeof value === \"string\" ) {\n\t\t\t\t\tvalue = value.split( /\\s/ );\n\t\t\t\t}\n\t\t\t\t$.each( value, function( index, name ) {\n\t\t\t\t\tgroups[ name ] = key;\n\t\t\t\t} );\n\t\t\t} );\n\t\t\trules = this.settings.rules;\n\t\t\t$.each( rules, function( key, value ) {\n\t\t\t\trules[ key ] = $.validator.normalizeRule( value );\n\t\t\t} );\n\n\t\t\tfunction delegate( event ) {\n\n\t\t\t\t// Set form expando on contenteditable\n\t\t\t\tif ( !this.form && this.hasAttribute( \"contenteditable\" ) ) {\n\t\t\t\t\tthis.form = $( this ).closest( \"form\" )[ 0 ];\n\t\t\t\t\tthis.name = $( this ).attr( \"name\" );\n\t\t\t\t}\n\n\t\t\t\tvar validator = $.data( this.form, \"validator\" ),\n\t\t\t\t\teventType = \"on\" + event.type.replace( /^validate/, \"\" ),\n\t\t\t\t\tsettings = validator.settings;\n\t\t\t\tif ( settings[ eventType ] && !$( this ).is( settings.ignore ) ) {\n\t\t\t\t\tsettings[ eventType ].call( validator, this, event );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$( this.currentForm )\n\t\t\t\t.on( \"focusin.validate focusout.validate keyup.validate\",\n\t\t\t\t\t\":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], \" +\n\t\t\t\t\t\"[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], \" +\n\t\t\t\t\t\"[type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], \" +\n\t\t\t\t\t\"[type='radio'], [type='checkbox'], [contenteditable], [type='button']\", delegate )\n\n\t\t\t\t// Support: Chrome, oldIE\n\t\t\t\t// \"select\" is provided as event.target when clicking a option\n\t\t\t\t.on( \"click.validate\", \"select, option, [type='radio'], [type='checkbox']\", delegate );\n\n\t\t\tif ( this.settings.invalidHandler ) {\n\t\t\t\t$( this.currentForm ).on( \"invalid-form.validate\", this.settings.invalidHandler );\n\t\t\t}\n\t\t},\n\n\t\t// https://jqueryvalidation.org/Validator.form/\n\t\tform: function() {\n\t\t\tthis.checkForm();\n\t\t\t$.extend( this.submitted, this.errorMap );\n\t\t\tthis.invalid = $.extend( {}, this.errorMap );\n\t\t\tif ( !this.valid() ) {\n\t\t\t\t$( this.currentForm ).triggerHandler( \"invalid-form\", [ this ] );\n\t\t\t}\n\t\t\tthis.showErrors();\n\t\t\treturn this.valid();\n\t\t},\n\n\t\tcheckForm: function() {\n\t\t\tthis.prepareForm();\n\t\t\tfor ( var i = 0, elements = ( this.currentElements = this.elements() ); elements[ i ]; i++ ) {\n\t\t\t\tthis.check( elements[ i ] );\n\t\t\t}\n\t\t\treturn this.valid();\n\t\t},\n\n\t\t// https://jqueryvalidation.org/Validator.element/\n\t\telement: function( element ) {\n\t\t\tvar cleanElement = this.clean( element ),\n\t\t\t\tcheckElement = this.validationTargetFor( cleanElement ),\n\t\t\t\tv = this,\n\t\t\t\tresult = true,\n\t\t\t\trs, group;\n\n\t\t\tif ( checkElement === undefined ) {\n\t\t\t\tdelete this.invalid[ cleanElement.name ];\n\t\t\t} else {\n\t\t\t\tthis.prepareElement( checkElement );\n\t\t\t\tthis.currentElements = $( checkElement );\n\n\t\t\t\t// If this element is grouped, then validate all group elements already\n\t\t\t\t// containing a value\n\t\t\t\tgroup = this.groups[ checkElement.name ];\n\t\t\t\tif ( group ) {\n\t\t\t\t\t$.each( this.groups, function( name, testgroup ) {\n\t\t\t\t\t\tif ( testgroup === group && name !== checkElement.name ) {\n\t\t\t\t\t\t\tcleanElement = v.validationTargetFor( v.clean( v.findByName( name ) ) );\n\t\t\t\t\t\t\tif ( cleanElement && cleanElement.name in v.invalid ) {\n\t\t\t\t\t\t\t\tv.currentElements.push( cleanElement );\n\t\t\t\t\t\t\t\tresult = v.check( cleanElement ) && result;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\trs = this.check( checkElement ) !== false;\n\t\t\t\tresult = result && rs;\n\t\t\t\tif ( rs ) {\n\t\t\t\t\tthis.invalid[ checkElement.name ] = false;\n\t\t\t\t} else {\n\t\t\t\t\tthis.invalid[ checkElement.name ] = true;\n\t\t\t\t}\n\n\t\t\t\tif ( !this.numberOfInvalids() ) {\n\n\t\t\t\t\t// Hide error containers on last error\n\t\t\t\t\tthis.toHide = this.toHide.add( this.containers );\n\t\t\t\t}\n\t\t\t\tthis.showErrors();\n\n\t\t\t\t// Add aria-invalid status for screen readers\n\t\t\t\t$( element ).attr( \"aria-invalid\", !rs );\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\n\t\t// https://jqueryvalidation.org/Validator.showErrors/\n\t\tshowErrors: function( errors ) {\n\t\t\tif ( errors ) {\n\t\t\t\tvar validator = this;\n\n\t\t\t\t// Add items to error list and map\n\t\t\t\t$.extend( this.errorMap, errors );\n\t\t\t\tthis.errorList = $.map( this.errorMap, function( message, name ) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmessage: message,\n\t\t\t\t\t\telement: validator.findByName( name )[ 0 ]\n\t\t\t\t\t};\n\t\t\t\t} );\n\n\t\t\t\t// Remove items from success list\n\t\t\t\tthis.successList = $.grep( this.successList, function( element ) {\n\t\t\t\t\treturn !( element.name in errors );\n\t\t\t\t} );\n\t\t\t}\n\t\t\tif ( this.settings.showErrors ) {\n\t\t\t\tthis.settings.showErrors.call( this, this.errorMap, this.errorList );\n\t\t\t} else {\n\t\t\t\tthis.defaultShowErrors();\n\t\t\t}\n\t\t},\n\n\t\t// https://jqueryvalidation.org/Validator.resetForm/\n\t\tresetForm: function() {\n\t\t\tif ( $.fn.resetForm ) {\n\t\t\t\t$( this.currentForm ).resetForm();\n\t\t\t}\n\t\t\tthis.invalid = {};\n\t\t\tthis.submitted = {};\n\t\t\tthis.prepareForm();\n\t\t\tthis.hideErrors();\n\t\t\tvar elements = this.elements()\n\t\t\t\t.removeData( \"previousValue\" )\n\t\t\t\t.removeAttr( \"aria-invalid\" );\n\n\t\t\tthis.resetElements( elements );\n\t\t},\n\n\t\tresetElements: function( elements ) {\n\t\t\tvar i;\n\n\t\t\tif ( this.settings.unhighlight ) {\n\t\t\t\tfor ( i = 0; elements[ i ]; i++ ) {\n\t\t\t\t\tthis.settings.unhighlight.call( this, elements[ i ],\n\t\t\t\t\t\tthis.settings.errorClass, \"\" );\n\t\t\t\t\tthis.findByName( elements[ i ].name ).removeClass( this.settings.validClass );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\telements\n\t\t\t\t\t.removeClass( this.settings.errorClass )\n\t\t\t\t\t.removeClass( this.settings.validClass );\n\t\t\t}\n\t\t},\n\n\t\tnumberOfInvalids: function() {\n\t\t\treturn this.objectLength( this.invalid );\n\t\t},\n\n\t\tobjectLength: function( obj ) {\n\t\t\t/* jshint unused: false */\n\t\t\tvar count = 0,\n\t\t\t\ti;\n\t\t\tfor ( i in obj ) {\n\n\t\t\t\t// This check allows counting elements with empty error\n\t\t\t\t// message as invalid elements\n\t\t\t\tif ( obj[ i ] !== undefined && obj[ i ] !== null && obj[ i ] !== false ) {\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn count;\n\t\t},\n\n\t\thideErrors: function() {\n\t\t\tthis.hideThese( this.toHide );\n\t\t},\n\n\t\thideThese: function( errors ) {\n\t\t\terrors.not( this.containers ).text( \"\" );\n\t\t\tthis.addWrapper( errors ).hide();\n\t\t},\n\n\t\tvalid: function() {\n\t\t\treturn this.size() === 0;\n\t\t},\n\n\t\tsize: function() {\n\t\t\treturn this.errorList.length;\n\t\t},\n\n\t\tfocusInvalid: function() {\n\t\t\tif ( this.settings.focusInvalid ) {\n\t\t\t\ttry {\n\t\t\t\t\t$( this.findLastActive() || this.errorList.length && this.errorList[ 0 ].element || [] )\n\t\t\t\t\t.filter( \":visible\" )\n\t\t\t\t\t.focus()\n\n\t\t\t\t\t// Manually trigger focusin event; without it, focusin handler isn't called, findLastActive won't have anything to find\n\t\t\t\t\t.trigger( \"focusin\" );\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t// Ignore IE throwing errors when focusing hidden elements\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tfindLastActive: function() {\n\t\t\tvar lastActive = this.lastActive;\n\t\t\treturn lastActive && $.grep( this.errorList, function( n ) {\n\t\t\t\treturn n.element.name === lastActive.name;\n\t\t\t} ).length === 1 && lastActive;\n\t\t},\n\n\t\telements: function() {\n\t\t\tvar validator = this,\n\t\t\t\trulesCache = {};\n\n\t\t\t// Select all valid inputs inside the form (no submit or reset buttons)\n\t\t\treturn $( this.currentForm )\n\t\t\t.find( \"input, select, textarea, [contenteditable]\" )\n\t\t\t.not( \":submit, :reset, :image, :disabled\" )\n\t\t\t.not( this.settings.ignore )\n\t\t\t.filter( function() {\n\t\t\t\tvar name = this.name || $( this ).attr( \"name\" ); // For contenteditable\n\t\t\t\tif ( !name && validator.settings.debug && window.console ) {\n\t\t\t\t\tconsole.error( \"%o has no name assigned\", this );\n\t\t\t\t}\n\n\t\t\t\t// Set form expando on contenteditable\n\t\t\t\tif ( this.hasAttribute( \"contenteditable\" ) ) {\n\t\t\t\t\tthis.form = $( this ).closest( \"form\" )[ 0 ];\n\t\t\t\t\tthis.name = name;\n\t\t\t\t}\n\n\t\t\t\t// Select only the first element for each name, and only those with rules specified\n\t\t\t\tif ( name in rulesCache || !validator.objectLength( $( this ).rules() ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\trulesCache[ name ] = true;\n\t\t\t\treturn true;\n\t\t\t} );\n\t\t},\n\n\t\tclean: function( selector ) {\n\t\t\treturn $( selector )[ 0 ];\n\t\t},\n\n\t\terrors: function() {\n\t\t\tvar errorClass = this.settings.errorClass.split( \" \" ).join( \".\" );\n\t\t\treturn $( this.settings.errorElement + \".\" + errorClass, this.errorContext );\n\t\t},\n\n\t\tresetInternals: function() {\n\t\t\tthis.successList = [];\n\t\t\tthis.errorList = [];\n\t\t\tthis.errorMap = {};\n\t\t\tthis.toShow = $( [] );\n\t\t\tthis.toHide = $( [] );\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.resetInternals();\n\t\t\tthis.currentElements = $( [] );\n\t\t},\n\n\t\tprepareForm: function() {\n\t\t\tthis.reset();\n\t\t\tthis.toHide = this.errors().add( this.containers );\n\t\t},\n\n\t\tprepareElement: function( element ) {\n\t\t\tthis.reset();\n\t\t\tthis.toHide = this.errorsFor( element );\n\t\t},\n\n\t\telementValue: function( element ) {\n\t\t\tvar $element = $( element ),\n\t\t\t\ttype = element.type,\n\t\t\t\tval, idx;\n\n\t\t\tif ( type === \"radio\" || type === \"checkbox\" ) {\n\t\t\t\treturn this.findByName( element.name ).filter( \":checked\" ).val();\n\t\t\t} else if ( type === \"number\" && typeof element.validity !== \"undefined\" ) {\n\t\t\t\treturn element.validity.badInput ? \"NaN\" : $element.val();\n\t\t\t}\n\n\t\t\tif ( element.hasAttribute( \"contenteditable\" ) ) {\n\t\t\t\tval = $element.text();\n\t\t\t} else {\n\t\t\t\tval = $element.val();\n\t\t\t}\n\n\t\t\tif ( type === \"file\" ) {\n\n\t\t\t\t// Modern browser (chrome & safari)\n\t\t\t\tif ( val.substr( 0, 12 ) === \"C:\\\\fakepath\\\\\" ) {\n\t\t\t\t\treturn val.substr( 12 );\n\t\t\t\t}\n\n\t\t\t\t// Legacy browsers\n\t\t\t\t// Unix-based path\n\t\t\t\tidx = val.lastIndexOf( \"/\" );\n\t\t\t\tif ( idx >= 0 ) {\n\t\t\t\t\treturn val.substr( idx + 1 );\n\t\t\t\t}\n\n\t\t\t\t// Windows-based path\n\t\t\t\tidx = val.lastIndexOf( \"\\\\\" );\n\t\t\t\tif ( idx >= 0 ) {\n\t\t\t\t\treturn val.substr( idx + 1 );\n\t\t\t\t}\n\n\t\t\t\t// Just the file name\n\t\t\t\treturn val;\n\t\t\t}\n\n\t\t\tif ( typeof val === \"string\" ) {\n\t\t\t\treturn val.replace( /\\r/g, \"\" );\n\t\t\t}\n\t\t\treturn val;\n\t\t},\n\n\t\tcheck: function( element ) {\n\t\t\telement = this.validationTargetFor( this.clean( element ) );\n\n\t\t\tvar rules = $( element ).rules(),\n\t\t\t\trulesCount = $.map( rules, function( n, i ) {\n\t\t\t\t\treturn i;\n\t\t\t\t} ).length,\n\t\t\t\tdependencyMismatch = false,\n\t\t\t\tval = this.elementValue( element ),\n\t\t\t\tresult, method, rule, normalizer;\n\n\t\t\t// Prioritize the local normalizer defined for this element over the global one\n\t\t\t// if the former exists, otherwise user the global one in case it exists.\n\t\t\tif ( typeof rules.normalizer === \"function\" ) {\n\t\t\t\tnormalizer = rules.normalizer;\n\t\t\t} else if (\ttypeof this.settings.normalizer === \"function\" ) {\n\t\t\t\tnormalizer = this.settings.normalizer;\n\t\t\t}\n\n\t\t\t// If normalizer is defined, then call it to retreive the changed value instead\n\t\t\t// of using the real one.\n\t\t\t// Note that `this` in the normalizer is `element`.\n\t\t\tif ( normalizer ) {\n\t\t\t\tval = normalizer.call( element, val );\n\n\t\t\t\tif ( typeof val !== \"string\" ) {\n\t\t\t\t\tthrow new TypeError( \"The normalizer should return a string value.\" );\n\t\t\t\t}\n\n\t\t\t\t// Delete the normalizer from rules to avoid treating it as a pre-defined method.\n\t\t\t\tdelete rules.normalizer;\n\t\t\t}\n\n\t\t\tfor ( method in rules ) {\n\t\t\t\trule = { method: method, parameters: rules[ method ] };\n\t\t\t\ttry {\n\t\t\t\t\tresult = $.validator.methods[ method ].call( this, val, element, rule.parameters );\n\n\t\t\t\t\t// If a method indicates that the field is optional and therefore valid,\n\t\t\t\t\t// don't mark it as valid when there are no other rules\n\t\t\t\t\tif ( result === \"dependency-mismatch\" && rulesCount === 1 ) {\n\t\t\t\t\t\tdependencyMismatch = true;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdependencyMismatch = false;\n\n\t\t\t\t\tif ( result === \"pending\" ) {\n\t\t\t\t\t\tthis.toHide = this.toHide.not( this.errorsFor( element ) );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !result ) {\n\t\t\t\t\t\tthis.formatAndAdd( element, rule );\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\tif ( this.settings.debug && window.console ) {\n\t\t\t\t\t\tconsole.log( \"Exception occurred when checking element \" + element.id + \", check the '\" + rule.method + \"' method.\", e );\n\t\t\t\t\t}\n\t\t\t\t\tif ( e instanceof TypeError ) {\n\t\t\t\t\t\te.message += \".  Exception occurred when checking element \" + element.id + \", check the '\" + rule.method + \"' method.\";\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( dependencyMismatch ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( this.objectLength( rules ) ) {\n\t\t\t\tthis.successList.push( element );\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t// Return the custom message for the given element and validation method\n\t\t// specified in the element's HTML5 data attribute\n\t\t// return the generic message if present and no method specific message is present\n\t\tcustomDataMessage: function( element, method ) {\n\t\t\treturn $( element ).data( \"msg\" + method.charAt( 0 ).toUpperCase() +\n\t\t\t\tmethod.substring( 1 ).toLowerCase() ) || $( element ).data( \"msg\" );\n\t\t},\n\n\t\t// Return the custom message for the given element name and validation method\n\t\tcustomMessage: function( name, method ) {\n\t\t\tvar m = this.settings.messages[ name ];\n\t\t\treturn m && ( m.constructor === String ? m : m[ method ] );\n\t\t},\n\n\t\t// Return the first defined argument, allowing empty strings\n\t\tfindDefined: function() {\n\t\t\tfor ( var i = 0; i < arguments.length; i++ ) {\n\t\t\t\tif ( arguments[ i ] !== undefined ) {\n\t\t\t\t\treturn arguments[ i ];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t},\n\n\t\t// The second parameter 'rule' used to be a string, and extended to an object literal\n\t\t// of the following form:\n\t\t// rule = {\n\t\t//     method: \"method name\",\n\t\t//     parameters: \"the given method parameters\"\n\t\t// }\n\t\t//\n\t\t// The old behavior still supported, kept to maintain backward compatibility with\n\t\t// old code, and will be removed in the next major release.\n\t\tdefaultMessage: function( element, rule ) {\n\t\t\tif ( typeof rule === \"string\" ) {\n\t\t\t\trule = { method: rule };\n\t\t\t}\n\n\t\t\tvar message = this.findDefined(\n\t\t\t\t\tthis.customMessage( element.name, rule.method ),\n\t\t\t\t\tthis.customDataMessage( element, rule.method ),\n\n\t\t\t\t\t// 'title' is never undefined, so handle empty string as undefined\n\t\t\t\t\t!this.settings.ignoreTitle && element.title || undefined,\n\t\t\t\t\t$.validator.messages[ rule.method ],\n\t\t\t\t\t\"<strong>Warning: No message defined for \" + element.name + \"</strong>\"\n\t\t\t\t),\n\t\t\t\ttheregex = /\\$?\\{(\\d+)\\}/g;\n\t\t\tif ( typeof message === \"function\" ) {\n\t\t\t\tmessage = message.call( this, rule.parameters, element );\n\t\t\t} else if ( theregex.test( message ) ) {\n\t\t\t\tmessage = $.validator.format( message.replace( theregex, \"{$1}\" ), rule.parameters );\n\t\t\t}\n\n\t\t\treturn message;\n\t\t},\n\n\t\tformatAndAdd: function( element, rule ) {\n\t\t\tvar message = this.defaultMessage( element, rule );\n\n\t\t\tthis.errorList.push( {\n\t\t\t\tmessage: message,\n\t\t\t\telement: element,\n\t\t\t\tmethod: rule.method\n\t\t\t} );\n\n\t\t\tthis.errorMap[ element.name ] = message;\n\t\t\tthis.submitted[ element.name ] = message;\n\t\t},\n\n\t\taddWrapper: function( toToggle ) {\n\t\t\tif ( this.settings.wrapper ) {\n\t\t\t\ttoToggle = toToggle.add( toToggle.parent( this.settings.wrapper ) );\n\t\t\t}\n\t\t\treturn toToggle;\n\t\t},\n\n\t\tdefaultShowErrors: function() {\n\t\t\tvar i, elements, error;\n\t\t\tfor ( i = 0; this.errorList[ i ]; i++ ) {\n\t\t\t\terror = this.errorList[ i ];\n\t\t\t\tif ( this.settings.highlight ) {\n\t\t\t\t\tthis.settings.highlight.call( this, error.element, this.settings.errorClass, this.settings.validClass );\n\t\t\t\t}\n\t\t\t\tthis.showLabel( error.element, error.message );\n\t\t\t}\n\t\t\tif ( this.errorList.length ) {\n\t\t\t\tthis.toShow = this.toShow.add( this.containers );\n\t\t\t}\n\t\t\tif ( this.settings.success ) {\n\t\t\t\tfor ( i = 0; this.successList[ i ]; i++ ) {\n\t\t\t\t\tthis.showLabel( this.successList[ i ] );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.settings.unhighlight ) {\n\t\t\t\tfor ( i = 0, elements = this.validElements(); elements[ i ]; i++ ) {\n\t\t\t\t\tthis.settings.unhighlight.call( this, elements[ i ], this.settings.errorClass, this.settings.validClass );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.toHide = this.toHide.not( this.toShow );\n\t\t\tthis.hideErrors();\n\t\t\tthis.addWrapper( this.toShow ).show();\n\t\t},\n\n\t\tvalidElements: function() {\n\t\t\treturn this.currentElements.not( this.invalidElements() );\n\t\t},\n\n\t\tinvalidElements: function() {\n\t\t\treturn $( this.errorList ).map( function() {\n\t\t\t\treturn this.element;\n\t\t\t} );\n\t\t},\n\n\t\tshowLabel: function( element, message ) {\n\t\t\tvar place, group, errorID, v,\n\t\t\t\terror = this.errorsFor( element ),\n\t\t\t\telementID = this.idOrName( element ),\n\t\t\t\tdescribedBy = $( element ).attr( \"aria-describedby\" );\n\n\t\t\tif ( error.length ) {\n\n\t\t\t\t// Refresh error/success class\n\t\t\t\terror.removeClass( this.settings.validClass ).addClass( this.settings.errorClass );\n\n\t\t\t\t// Replace message on existing label\n\t\t\t\terror.html( message );\n\t\t\t} else {\n\n\t\t\t\t// Create error element\n\t\t\t\terror = $( \"<\" + this.settings.errorElement + \">\" )\n\t\t\t\t\t.attr( \"id\", elementID + \"-error\" )\n\t\t\t\t\t.addClass( this.settings.errorClass )\n\t\t\t\t\t.html( message || \"\" );\n\n\t\t\t\t// Maintain reference to the element to be placed into the DOM\n\t\t\t\tplace = error;\n\t\t\t\tif ( this.settings.wrapper ) {\n\n\t\t\t\t\t// Make sure the element is visible, even in IE\n\t\t\t\t\t// actually showing the wrapped element is handled elsewhere\n\t\t\t\t\tplace = error.hide().show().wrap( \"<\" + this.settings.wrapper + \"/>\" ).parent();\n\t\t\t\t}\n\t\t\t\tif ( this.labelContainer.length ) {\n\t\t\t\t\tthis.labelContainer.append( place );\n\t\t\t\t} else if ( this.settings.errorPlacement ) {\n\t\t\t\t\tthis.settings.errorPlacement.call( this, place, $( element ) );\n\t\t\t\t} else {\n\t\t\t\t\tplace.insertAfter( element );\n\t\t\t\t}\n\n\t\t\t\t// Link error back to the element\n\t\t\t\tif ( error.is( \"label\" ) ) {\n\n\t\t\t\t\t// If the error is a label, then associate using 'for'\n\t\t\t\t\terror.attr( \"for\", elementID );\n\n\t\t\t\t\t// If the element is not a child of an associated label, then it's necessary\n\t\t\t\t\t// to explicitly apply aria-describedby\n\t\t\t\t} else if ( error.parents( \"label[for='\" + this.escapeCssMeta( elementID ) + \"']\" ).length === 0 ) {\n\t\t\t\t\terrorID = error.attr( \"id\" );\n\n\t\t\t\t\t// Respect existing non-error aria-describedby\n\t\t\t\t\tif ( !describedBy ) {\n\t\t\t\t\t\tdescribedBy = errorID;\n\t\t\t\t\t} else if ( !describedBy.match( new RegExp( \"\\\\b\" + this.escapeCssMeta( errorID ) + \"\\\\b\" ) ) ) {\n\n\t\t\t\t\t\t// Add to end of list if not already present\n\t\t\t\t\t\tdescribedBy += \" \" + errorID;\n\t\t\t\t\t}\n\t\t\t\t\t$( element ).attr( \"aria-describedby\", describedBy );\n\n\t\t\t\t\t// If this element is grouped, then assign to all elements in the same group\n\t\t\t\t\tgroup = this.groups[ element.name ];\n\t\t\t\t\tif ( group ) {\n\t\t\t\t\t\tv = this;\n\t\t\t\t\t\t$.each( v.groups, function( name, testgroup ) {\n\t\t\t\t\t\t\tif ( testgroup === group ) {\n\t\t\t\t\t\t\t\t$( \"[name='\" + v.escapeCssMeta( name ) + \"']\", v.currentForm )\n\t\t\t\t\t\t\t\t\t.attr( \"aria-describedby\", error.attr( \"id\" ) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( !message && this.settings.success ) {\n\t\t\t\terror.text( \"\" );\n\t\t\t\tif ( typeof this.settings.success === \"string\" ) {\n\t\t\t\t\terror.addClass( this.settings.success );\n\t\t\t\t} else {\n\t\t\t\t\tthis.settings.success( error, element );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.toShow = this.toShow.add( error );\n\t\t},\n\n\t\terrorsFor: function( element ) {\n\t\t\tvar name = this.escapeCssMeta( this.idOrName( element ) ),\n\t\t\t\tdescriber = $( element ).attr( \"aria-describedby\" ),\n\t\t\t\tselector = \"label[for='\" + name + \"'], label[for='\" + name + \"'] *\";\n\n\t\t\t// 'aria-describedby' should directly reference the error element\n\t\t\tif ( describer ) {\n\t\t\t\tselector = selector + \", #\" + this.escapeCssMeta( describer )\n\t\t\t\t\t.replace( /\\s+/g, \", #\" );\n\t\t\t}\n\n\t\t\treturn this\n\t\t\t\t.errors()\n\t\t\t\t.filter( selector );\n\t\t},\n\n\t\t// See https://api.jquery.com/category/selectors/, for CSS\n\t\t// meta-characters that should be escaped in order to be used with JQuery\n\t\t// as a literal part of a name/id or any selector.\n\t\tescapeCssMeta: function( string ) {\n\t\t\treturn string.replace( /([\\\\!\"#$%&'()*+,./:;<=>?@\\[\\]^`{|}~])/g, \"\\\\$1\" );\n\t\t},\n\n\t\tidOrName: function( element ) {\n\t\t\treturn this.groups[ element.name ] || ( this.checkable( element ) ? element.name : element.id || element.name );\n\t\t},\n\n\t\tvalidationTargetFor: function( element ) {\n\n\t\t\t// If radio/checkbox, validate first element in group instead\n\t\t\tif ( this.checkable( element ) ) {\n\t\t\t\telement = this.findByName( element.name );\n\t\t\t}\n\n\t\t\t// Always apply ignore filter\n\t\t\treturn $( element ).not( this.settings.ignore )[ 0 ];\n\t\t},\n\n\t\tcheckable: function( element ) {\n\t\t\treturn ( /radio|checkbox/i ).test( element.type );\n\t\t},\n\n\t\tfindByName: function( name ) {\n\t\t\treturn $( this.currentForm ).find( \"[name='\" + this.escapeCssMeta( name ) + \"']\" );\n\t\t},\n\n\t\tgetLength: function( value, element ) {\n\t\t\tswitch ( element.nodeName.toLowerCase() ) {\n\t\t\tcase \"select\":\n\t\t\t\treturn $( \"option:selected\", element ).length;\n\t\t\tcase \"input\":\n\t\t\t\tif ( this.checkable( element ) ) {\n\t\t\t\t\treturn this.findByName( element.name ).filter( \":checked\" ).length;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value.length;\n\t\t},\n\n\t\tdepend: function( param, element ) {\n\t\t\treturn this.dependTypes[ typeof param ] ? this.dependTypes[ typeof param ]( param, element ) : true;\n\t\t},\n\n\t\tdependTypes: {\n\t\t\t\"boolean\": function( param ) {\n\t\t\t\treturn param;\n\t\t\t},\n\t\t\t\"string\": function( param, element ) {\n\t\t\t\treturn !!$( param, element.form ).length;\n\t\t\t},\n\t\t\t\"function\": function( param, element ) {\n\t\t\t\treturn param( element );\n\t\t\t}\n\t\t},\n\n\t\toptional: function( element ) {\n\t\t\tvar val = this.elementValue( element );\n\t\t\treturn !$.validator.methods.required.call( this, val, element ) && \"dependency-mismatch\";\n\t\t},\n\n\t\tstartRequest: function( element ) {\n\t\t\tif ( !this.pending[ element.name ] ) {\n\t\t\t\tthis.pendingRequest++;\n\t\t\t\t$( element ).addClass( this.settings.pendingClass );\n\t\t\t\tthis.pending[ element.name ] = true;\n\t\t\t}\n\t\t},\n\n\t\tstopRequest: function( element, valid ) {\n\t\t\tthis.pendingRequest--;\n\n\t\t\t// Sometimes synchronization fails, make sure pendingRequest is never < 0\n\t\t\tif ( this.pendingRequest < 0 ) {\n\t\t\t\tthis.pendingRequest = 0;\n\t\t\t}\n\t\t\tdelete this.pending[ element.name ];\n\t\t\t$( element ).removeClass( this.settings.pendingClass );\n\t\t\tif ( valid && this.pendingRequest === 0 && this.formSubmitted && this.form() ) {\n\t\t\t\t$( this.currentForm ).submit();\n\n\t\t\t\t// Remove the hidden input that was used as a replacement for the\n\t\t\t\t// missing submit button. The hidden input is added by `handle()`\n\t\t\t\t// to ensure that the value of the used submit button is passed on\n\t\t\t\t// for scripted submits triggered by this method\n\t\t\t\tif ( this.submitButton ) {\n\t\t\t\t\t$( \"input:hidden[name='\" + this.submitButton.name + \"']\", this.currentForm ).remove();\n\t\t\t\t}\n\n\t\t\t\tthis.formSubmitted = false;\n\t\t\t} else if ( !valid && this.pendingRequest === 0 && this.formSubmitted ) {\n\t\t\t\t$( this.currentForm ).triggerHandler( \"invalid-form\", [ this ] );\n\t\t\t\tthis.formSubmitted = false;\n\t\t\t}\n\t\t},\n\n\t\tpreviousValue: function( element, method ) {\n\t\t\tmethod = typeof method === \"string\" && method || \"remote\";\n\n\t\t\treturn $.data( element, \"previousValue\" ) || $.data( element, \"previousValue\", {\n\t\t\t\told: null,\n\t\t\t\tvalid: true,\n\t\t\t\tmessage: this.defaultMessage( element, { method: method } )\n\t\t\t} );\n\t\t},\n\n\t\t// Cleans up all forms and elements, removes validator-specific events\n\t\tdestroy: function() {\n\t\t\tthis.resetForm();\n\n\t\t\t$( this.currentForm )\n\t\t\t\t.off( \".validate\" )\n\t\t\t\t.removeData( \"validator\" )\n\t\t\t\t.find( \".validate-equalTo-blur\" )\n\t\t\t\t\t.off( \".validate-equalTo\" )\n\t\t\t\t\t.removeClass( \"validate-equalTo-blur\" );\n\t\t}\n\n\t},\n\n\tclassRuleSettings: {\n\t\trequired: { required: true },\n\t\temail: { email: true },\n\t\turl: { url: true },\n\t\tdate: { date: true },\n\t\tdateISO: { dateISO: true },\n\t\tnumber: { number: true },\n\t\tdigits: { digits: true },\n\t\tcreditcard: { creditcard: true }\n\t},\n\n\taddClassRules: function( className, rules ) {\n\t\tif ( className.constructor === String ) {\n\t\t\tthis.classRuleSettings[ className ] = rules;\n\t\t} else {\n\t\t\t$.extend( this.classRuleSettings, className );\n\t\t}\n\t},\n\n\tclassRules: function( element ) {\n\t\tvar rules = {},\n\t\t\tclasses = $( element ).attr( \"class\" );\n\n\t\tif ( classes ) {\n\t\t\t$.each( classes.split( \" \" ), function() {\n\t\t\t\tif ( this in $.validator.classRuleSettings ) {\n\t\t\t\t\t$.extend( rules, $.validator.classRuleSettings[ this ] );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\treturn rules;\n\t},\n\n\tnormalizeAttributeRule: function( rules, type, method, value ) {\n\n\t\t// Convert the value to a number for number inputs, and for text for backwards compability\n\t\t// allows type=\"date\" and others to be compared as strings\n\t\tif ( /min|max|step/.test( method ) && ( type === null || /number|range|text/.test( type ) ) ) {\n\t\t\tvalue = Number( value );\n\n\t\t\t// Support Opera Mini, which returns NaN for undefined minlength\n\t\t\tif ( isNaN( value ) ) {\n\t\t\t\tvalue = undefined;\n\t\t\t}\n\t\t}\n\n\t\tif ( value || value === 0 ) {\n\t\t\trules[ method ] = value;\n\t\t} else if ( type === method && type !== \"range\" ) {\n\n\t\t\t// Exception: the jquery validate 'range' method\n\t\t\t// does not test for the html5 'range' type\n\t\t\trules[ method ] = true;\n\t\t}\n\t},\n\n\tattributeRules: function( element ) {\n\t\tvar rules = {},\n\t\t\t$element = $( element ),\n\t\t\ttype = element.getAttribute( \"type\" ),\n\t\t\tmethod, value;\n\n\t\tfor ( method in $.validator.methods ) {\n\n\t\t\t// Support for <input required> in both html5 and older browsers\n\t\t\tif ( method === \"required\" ) {\n\t\t\t\tvalue = element.getAttribute( method );\n\n\t\t\t\t// Some browsers return an empty string for the required attribute\n\t\t\t\t// and non-HTML5 browsers might have required=\"\" markup\n\t\t\t\tif ( value === \"\" ) {\n\t\t\t\t\tvalue = true;\n\t\t\t\t}\n\n\t\t\t\t// Force non-HTML5 browsers to return bool\n\t\t\t\tvalue = !!value;\n\t\t\t} else {\n\t\t\t\tvalue = $element.attr( method );\n\t\t\t}\n\n\t\t\tthis.normalizeAttributeRule( rules, type, method, value );\n\t\t}\n\n\t\t// 'maxlength' may be returned as -1, 2147483647 ( IE ) and 524288 ( safari ) for text inputs\n\t\tif ( rules.maxlength && /-1|2147483647|524288/.test( rules.maxlength ) ) {\n\t\t\tdelete rules.maxlength;\n\t\t}\n\n\t\treturn rules;\n\t},\n\n\tdataRules: function( element ) {\n\t\tvar rules = {},\n\t\t\t$element = $( element ),\n\t\t\ttype = element.getAttribute( \"type\" ),\n\t\t\tmethod, value;\n\n\t\tfor ( method in $.validator.methods ) {\n\t\t\tvalue = $element.data( \"rule\" + method.charAt( 0 ).toUpperCase() + method.substring( 1 ).toLowerCase() );\n\t\t\tthis.normalizeAttributeRule( rules, type, method, value );\n\t\t}\n\t\treturn rules;\n\t},\n\n\tstaticRules: function( element ) {\n\t\tvar rules = {},\n\t\t\tvalidator = $.data( element.form, \"validator\" );\n\n\t\tif ( validator.settings.rules ) {\n\t\t\trules = $.validator.normalizeRule( validator.settings.rules[ element.name ] ) || {};\n\t\t}\n\t\treturn rules;\n\t},\n\n\tnormalizeRules: function( rules, element ) {\n\n\t\t// Handle dependency check\n\t\t$.each( rules, function( prop, val ) {\n\n\t\t\t// Ignore rule when param is explicitly false, eg. required:false\n\t\t\tif ( val === false ) {\n\t\t\t\tdelete rules[ prop ];\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( val.param || val.depends ) {\n\t\t\t\tvar keepRule = true;\n\t\t\t\tswitch ( typeof val.depends ) {\n\t\t\t\tcase \"string\":\n\t\t\t\t\tkeepRule = !!$( val.depends, element.form ).length;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"function\":\n\t\t\t\t\tkeepRule = val.depends.call( element, element );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif ( keepRule ) {\n\t\t\t\t\trules[ prop ] = val.param !== undefined ? val.param : true;\n\t\t\t\t} else {\n\t\t\t\t\t$.data( element.form, \"validator\" ).resetElements( $( element ) );\n\t\t\t\t\tdelete rules[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\t// Evaluate parameters\n\t\t$.each( rules, function( rule, parameter ) {\n\t\t\trules[ rule ] = $.isFunction( parameter ) && rule !== \"normalizer\" ? parameter( element ) : parameter;\n\t\t} );\n\n\t\t// Clean number parameters\n\t\t$.each( [ \"minlength\", \"maxlength\" ], function() {\n\t\t\tif ( rules[ this ] ) {\n\t\t\t\trules[ this ] = Number( rules[ this ] );\n\t\t\t}\n\t\t} );\n\t\t$.each( [ \"rangelength\", \"range\" ], function() {\n\t\t\tvar parts;\n\t\t\tif ( rules[ this ] ) {\n\t\t\t\tif ( $.isArray( rules[ this ] ) ) {\n\t\t\t\t\trules[ this ] = [ Number( rules[ this ][ 0 ] ), Number( rules[ this ][ 1 ] ) ];\n\t\t\t\t} else if ( typeof rules[ this ] === \"string\" ) {\n\t\t\t\t\tparts = rules[ this ].replace( /[\\[\\]]/g, \"\" ).split( /[\\s,]+/ );\n\t\t\t\t\trules[ this ] = [ Number( parts[ 0 ] ), Number( parts[ 1 ] ) ];\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\tif ( $.validator.autoCreateRanges ) {\n\n\t\t\t// Auto-create ranges\n\t\t\tif ( rules.min != null && rules.max != null ) {\n\t\t\t\trules.range = [ rules.min, rules.max ];\n\t\t\t\tdelete rules.min;\n\t\t\t\tdelete rules.max;\n\t\t\t}\n\t\t\tif ( rules.minlength != null && rules.maxlength != null ) {\n\t\t\t\trules.rangelength = [ rules.minlength, rules.maxlength ];\n\t\t\t\tdelete rules.minlength;\n\t\t\t\tdelete rules.maxlength;\n\t\t\t}\n\t\t}\n\n\t\treturn rules;\n\t},\n\n\t// Converts a simple string to a {string: true} rule, e.g., \"required\" to {required:true}\n\tnormalizeRule: function( data ) {\n\t\tif ( typeof data === \"string\" ) {\n\t\t\tvar transformed = {};\n\t\t\t$.each( data.split( /\\s/ ), function() {\n\t\t\t\ttransformed[ this ] = true;\n\t\t\t} );\n\t\t\tdata = transformed;\n\t\t}\n\t\treturn data;\n\t},\n\n\t// https://jqueryvalidation.org/jQuery.validator.addMethod/\n\taddMethod: function( name, method, message ) {\n\t\t$.validator.methods[ name ] = method;\n\t\t$.validator.messages[ name ] = message !== undefined ? message : $.validator.messages[ name ];\n\t\tif ( method.length < 3 ) {\n\t\t\t$.validator.addClassRules( name, $.validator.normalizeRule( name ) );\n\t\t}\n\t},\n\n\t// https://jqueryvalidation.org/jQuery.validator.methods/\n\tmethods: {\n\n\t\t// https://jqueryvalidation.org/required-method/\n\t\trequired: function( value, element, param ) {\n\n\t\t\t// Check if dependency is met\n\t\t\tif ( !this.depend( param, element ) ) {\n\t\t\t\treturn \"dependency-mismatch\";\n\t\t\t}\n\t\t\tif ( element.nodeName.toLowerCase() === \"select\" ) {\n\n\t\t\t\t// Could be an array for select-multiple or a string, both are fine this way\n\t\t\t\tvar val = $( element ).val();\n\t\t\t\treturn val && val.length > 0;\n\t\t\t}\n\t\t\tif ( this.checkable( element ) ) {\n\t\t\t\treturn this.getLength( value, element ) > 0;\n\t\t\t}\n\t\t\treturn value.length > 0;\n\t\t},\n\n\t\t// https://jqueryvalidation.org/email-method/\n\t\temail: function( value, element ) {\n\n\t\t\t// From https://html.spec.whatwg.org/multipage/forms.html#valid-e-mail-address\n\t\t\t// Retrieved 2014-01-14\n\t\t\t// If you have a problem with this implementation, report a bug against the above spec\n\t\t\t// Or use custom methods to implement your own email validation\n\t\t\treturn this.optional( element ) || /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test( value );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/url-method/\n\t\turl: function( value, element ) {\n\n\t\t\t// Copyright (c) 2010-2013 Diego Perini, MIT licensed\n\t\t\t// https://gist.github.com/dperini/729294\n\t\t\t// see also https://mathiasbynens.be/demo/url-regex\n\t\t\t// modified to allow protocol-relative URLs\n\t\t\treturn this.optional( element ) || /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})).?)(?::\\d{2,5})?(?:[/?#]\\S*)?$/i.test( value );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/date-method/\n\t\tdate: function( value, element ) {\n\t\t\treturn this.optional( element ) || !/Invalid|NaN/.test( new Date( value ).toString() );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/dateISO-method/\n\t\tdateISO: function( value, element ) {\n\t\t\treturn this.optional( element ) || /^\\d{4}[\\/\\-](0?[1-9]|1[012])[\\/\\-](0?[1-9]|[12][0-9]|3[01])$/.test( value );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/number-method/\n\t\tnumber: function( value, element ) {\n\t\t\treturn this.optional( element ) || /^(?:-?\\d+|-?\\d{1,3}(?:,\\d{3})+)?(?:\\.\\d+)?$/.test( value );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/digits-method/\n\t\tdigits: function( value, element ) {\n\t\t\treturn this.optional( element ) || /^\\d+$/.test( value );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/minlength-method/\n\t\tminlength: function( value, element, param ) {\n\t\t\tvar length = $.isArray( value ) ? value.length : this.getLength( value, element );\n\t\t\treturn this.optional( element ) || length >= param;\n\t\t},\n\n\t\t// https://jqueryvalidation.org/maxlength-method/\n\t\tmaxlength: function( value, element, param ) {\n\t\t\tvar length = $.isArray( value ) ? value.length : this.getLength( value, element );\n\t\t\treturn this.optional( element ) || length <= param;\n\t\t},\n\n\t\t// https://jqueryvalidation.org/rangelength-method/\n\t\trangelength: function( value, element, param ) {\n\t\t\tvar length = $.isArray( value ) ? value.length : this.getLength( value, element );\n\t\t\treturn this.optional( element ) || ( length >= param[ 0 ] && length <= param[ 1 ] );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/min-method/\n\t\tmin: function( value, element, param ) {\n\t\t\treturn this.optional( element ) || value >= param;\n\t\t},\n\n\t\t// https://jqueryvalidation.org/max-method/\n\t\tmax: function( value, element, param ) {\n\t\t\treturn this.optional( element ) || value <= param;\n\t\t},\n\n\t\t// https://jqueryvalidation.org/range-method/\n\t\trange: function( value, element, param ) {\n\t\t\treturn this.optional( element ) || ( value >= param[ 0 ] && value <= param[ 1 ] );\n\t\t},\n\n\t\t// https://jqueryvalidation.org/step-method/\n\t\tstep: function( value, element, param ) {\n\t\t\tvar type = $( element ).attr( \"type\" ),\n\t\t\t\terrorMessage = \"Step attribute on input type \" + type + \" is not supported.\",\n\t\t\t\tsupportedTypes = [ \"text\", \"number\", \"range\" ],\n\t\t\t\tre = new RegExp( \"\\\\b\" + type + \"\\\\b\" ),\n\t\t\t\tnotSupported = type && !re.test( supportedTypes.join() ),\n\t\t\t\tdecimalPlaces = function( num ) {\n\t\t\t\t\tvar match = ( \"\" + num ).match( /(?:\\.(\\d+))?$/ );\n\t\t\t\t\tif ( !match ) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Number of digits right of decimal point.\n\t\t\t\t\treturn match[ 1 ] ? match[ 1 ].length : 0;\n\t\t\t\t},\n\t\t\t\ttoInt = function( num ) {\n\t\t\t\t\treturn Math.round( num * Math.pow( 10, decimals ) );\n\t\t\t\t},\n\t\t\t\tvalid = true,\n\t\t\t\tdecimals;\n\n\t\t\t// Works only for text, number and range input types\n\t\t\t// TODO find a way to support input types date, datetime, datetime-local, month, time and week\n\t\t\tif ( notSupported ) {\n\t\t\t\tthrow new Error( errorMessage );\n\t\t\t}\n\n\t\t\tdecimals = decimalPlaces( param );\n\n\t\t\t// Value can't have too many decimals\n\t\t\tif ( decimalPlaces( value ) > decimals || toInt( value ) % toInt( param ) !== 0 ) {\n\t\t\t\tvalid = false;\n\t\t\t}\n\n\t\t\treturn this.optional( element ) || valid;\n\t\t},\n\n\t\t// https://jqueryvalidation.org/equalTo-method/\n\t\tequalTo: function( value, element, param ) {\n\n\t\t\t// Bind to the blur event of the target in order to revalidate whenever the target field is updated\n\t\t\tvar target = $( param );\n\t\t\tif ( this.settings.onfocusout && target.not( \".validate-equalTo-blur\" ).length ) {\n\t\t\t\ttarget.addClass( \"validate-equalTo-blur\" ).on( \"blur.validate-equalTo\", function() {\n\t\t\t\t\t$( element ).valid();\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn value === target.val();\n\t\t},\n\n\t\t// https://jqueryvalidation.org/remote-method/\n\t\tremote: function( value, element, param, method ) {\n\t\t\tif ( this.optional( element ) ) {\n\t\t\t\treturn \"dependency-mismatch\";\n\t\t\t}\n\n\t\t\tmethod = typeof method === \"string\" && method || \"remote\";\n\n\t\t\tvar previous = this.previousValue( element, method ),\n\t\t\t\tvalidator, data, optionDataString;\n\n\t\t\tif ( !this.settings.messages[ element.name ] ) {\n\t\t\t\tthis.settings.messages[ element.name ] = {};\n\t\t\t}\n\t\t\tprevious.originalMessage = previous.originalMessage || this.settings.messages[ element.name ][ method ];\n\t\t\tthis.settings.messages[ element.name ][ method ] = previous.message;\n\n\t\t\tparam = typeof param === \"string\" && { url: param } || param;\n\t\t\toptionDataString = $.param( $.extend( { data: value }, param.data ) );\n\t\t\tif ( previous.old === optionDataString ) {\n\t\t\t\treturn previous.valid;\n\t\t\t}\n\n\t\t\tprevious.old = optionDataString;\n\t\t\tvalidator = this;\n\t\t\tthis.startRequest( element );\n\t\t\tdata = {};\n\t\t\tdata[ element.name ] = value;\n\t\t\t$.ajax( $.extend( true, {\n\t\t\t\tmode: \"abort\",\n\t\t\t\tport: \"validate\" + element.name,\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata: data,\n\t\t\t\tcontext: validator.currentForm,\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tvar valid = response === true || response === \"true\",\n\t\t\t\t\t\terrors, message, submitted;\n\n\t\t\t\t\tvalidator.settings.messages[ element.name ][ method ] = previous.originalMessage;\n\t\t\t\t\tif ( valid ) {\n\t\t\t\t\t\tsubmitted = validator.formSubmitted;\n\t\t\t\t\t\tvalidator.resetInternals();\n\t\t\t\t\t\tvalidator.toHide = validator.errorsFor( element );\n\t\t\t\t\t\tvalidator.formSubmitted = submitted;\n\t\t\t\t\t\tvalidator.successList.push( element );\n\t\t\t\t\t\tvalidator.invalid[ element.name ] = false;\n\t\t\t\t\t\tvalidator.showErrors();\n\t\t\t\t\t} else {\n\t\t\t\t\t\terrors = {};\n\t\t\t\t\t\tmessage = response || validator.defaultMessage( element, { method: method, parameters: value } );\n\t\t\t\t\t\terrors[ element.name ] = previous.message = message;\n\t\t\t\t\t\tvalidator.invalid[ element.name ] = true;\n\t\t\t\t\t\tvalidator.showErrors( errors );\n\t\t\t\t\t}\n\t\t\t\t\tprevious.valid = valid;\n\t\t\t\t\tvalidator.stopRequest( element, valid );\n\t\t\t\t}\n\t\t\t}, param ) );\n\t\t\treturn \"pending\";\n\t\t}\n\t}\n\n} );\n\r\n// Ajax mode: abort\n// usage: $.ajax({ mode: \"abort\"[, port: \"uniqueport\"]});\n// if mode:\"abort\" is used, the previous request on that port (port can be undefined) is aborted via XMLHttpRequest.abort()\n\nvar pendingRequests = {},\n\tajax;\n\n// Use a prefilter if available (1.5+)\nif ( $.ajaxPrefilter ) {\n\t$.ajaxPrefilter( function( settings, _, xhr ) {\n\t\tvar port = settings.port;\n\t\tif ( settings.mode === \"abort\" ) {\n\t\t\tif ( pendingRequests[ port ] ) {\n\t\t\t\tpendingRequests[ port ].abort();\n\t\t\t}\n\t\t\tpendingRequests[ port ] = xhr;\n\t\t}\n\t} );\n} else {\n\n\t// Proxy ajax\n\tajax = $.ajax;\n\t$.ajax = function( settings ) {\n\t\tvar mode = ( \"mode\" in settings ? settings : $.ajaxSettings ).mode,\n\t\t\tport = ( \"port\" in settings ? settings : $.ajaxSettings ).port;\n\t\tif ( mode === \"abort\" ) {\n\t\t\tif ( pendingRequests[ port ] ) {\n\t\t\t\tpendingRequests[ port ].abort();\n\t\t\t}\n\t\t\tpendingRequests[ port ] = ajax.apply( this, arguments );\n\t\t\treturn pendingRequests[ port ];\n\t\t}\n\t\treturn ajax.apply( this, arguments );\n\t};\n}\nreturn $;\r\n}));","/*\r\n    jQuery Masked Input Plugin\r\n    Copyright (c) 2007 - 2015 Josh Bush (digitalbush.com)\r\n    Licensed under the MIT license (http://digitalbush.com/projects/masked-input-plugin/#license)\r\n    Version: 1.4.1\r\n*/\r\n!function(factory) {\r\n    \"function\" == typeof define && define.amd ? define([ \"jquery\" ], factory) : factory(\"object\" == typeof exports ? require(\"jquery\") : jQuery);\r\n}(function($) {\r\n    var caretTimeoutId, ua = navigator.userAgent, iPhone = /iphone/i.test(ua), chrome = /chrome/i.test(ua), android = /android/i.test(ua);\r\n    $.mask = {\r\n        definitions: {\r\n            \"9\": \"[0-9]\",\r\n            a: \"[A-Za-z]\",\r\n            \"*\": \"[A-Za-z0-9]\"\r\n        },\r\n        autoclear: !0,\r\n        dataName: \"rawMaskFn\",\r\n        placeholder: \"_\"\r\n    }, $.fn.extend({\r\n        caret: function(begin, end) {\r\n            var range;\r\n            if (0 !== this.length && !this.is(\":hidden\")) return \"number\" == typeof begin ? (end = \"number\" == typeof end ? end : begin, \r\n            this.each(function() {\r\n                this.setSelectionRange ? this.setSelectionRange(begin, end) : this.createTextRange && (range = this.createTextRange(), \r\n                range.collapse(!0), range.moveEnd(\"character\", end), range.moveStart(\"character\", begin), \r\n                range.select());\r\n            })) : (this[0].setSelectionRange ? (begin = this[0].selectionStart, end = this[0].selectionEnd) : document.selection && document.selection.createRange && (range = document.selection.createRange(), \r\n            begin = 0 - range.duplicate().moveStart(\"character\", -1e5), end = begin + range.text.length), \r\n            {\r\n                begin: begin,\r\n                end: end\r\n            });\r\n        },\r\n        unmask: function() {\r\n            return this.trigger(\"unmask\");\r\n        },\r\n        mask: function(mask, settings) {\r\n            var input, defs, tests, partialPosition, firstNonMaskPos, lastRequiredNonMaskPos, len, oldVal;\r\n            if (!mask && this.length > 0) {\r\n                input = $(this[0]);\r\n                var fn = input.data($.mask.dataName);\r\n                return fn ? fn() : void 0;\r\n            }\r\n            return settings = $.extend({\r\n                autoclear: $.mask.autoclear,\r\n                placeholder: $.mask.placeholder,\r\n                completed: null\r\n            }, settings), defs = $.mask.definitions, tests = [], partialPosition = len = mask.length, \r\n            firstNonMaskPos = null, $.each(mask.split(\"\"), function(i, c) {\r\n                \"?\" == c ? (len--, partialPosition = i) : defs[c] ? (tests.push(new RegExp(defs[c])), \r\n                null === firstNonMaskPos && (firstNonMaskPos = tests.length - 1), partialPosition > i && (lastRequiredNonMaskPos = tests.length - 1)) : tests.push(null);\r\n            }), this.trigger(\"unmask\").each(function() {\r\n                function tryFireCompleted() {\r\n                    if (settings.completed) {\r\n                        for (var i = firstNonMaskPos; lastRequiredNonMaskPos >= i; i++) if (tests[i] && buffer[i] === getPlaceholder(i)) return;\r\n                        settings.completed.call(input);\r\n                    }\r\n                }\r\n                function getPlaceholder(i) {\r\n                    return settings.placeholder.charAt(i < settings.placeholder.length ? i : 0);\r\n                }\r\n                function seekNext(pos) {\r\n                    for (;++pos < len && !tests[pos]; ) ;\r\n                    return pos;\r\n                }\r\n                function seekPrev(pos) {\r\n                    for (;--pos >= 0 && !tests[pos]; ) ;\r\n                    return pos;\r\n                }\r\n                function shiftL(begin, end) {\r\n                    var i, j;\r\n                    if (!(0 > begin)) {\r\n                        for (i = begin, j = seekNext(end); len > i; i++) if (tests[i]) {\r\n                            if (!(len > j && tests[i].test(buffer[j]))) break;\r\n                            buffer[i] = buffer[j], buffer[j] = getPlaceholder(j), j = seekNext(j);\r\n                        }\r\n                        writeBuffer(), input.caret(Math.max(firstNonMaskPos, begin));\r\n                    }\r\n                }\r\n                function shiftR(pos) {\r\n                    var i, c, j, t;\r\n                    for (i = pos, c = getPlaceholder(pos); len > i; i++) if (tests[i]) {\r\n                        if (j = seekNext(i), t = buffer[i], buffer[i] = c, !(len > j && tests[j].test(t))) break;\r\n                        c = t;\r\n                    }\r\n                }\r\n                function androidInputEvent() {\r\n                    var curVal = input.val(), pos = input.caret();\r\n                    if (oldVal && oldVal.length && oldVal.length > curVal.length) {\r\n                        for (checkVal(!0); pos.begin > 0 && !tests[pos.begin - 1]; ) pos.begin--;\r\n                        if (0 === pos.begin) for (;pos.begin < firstNonMaskPos && !tests[pos.begin]; ) pos.begin++;\r\n                        input.caret(pos.begin, pos.begin);\r\n                    } else {\r\n                        for (checkVal(!0); pos.begin < len && !tests[pos.begin]; ) pos.begin++;\r\n                        input.caret(pos.begin, pos.begin);\r\n                    }\r\n                    tryFireCompleted();\r\n                }\r\n                function blurEvent() {\r\n                    checkVal(), input.val() != focusText && input.change();\r\n                }\r\n                function keydownEvent(e) {\r\n                    if (!input.prop(\"readonly\")) {\r\n                        var pos, begin, end, k = e.which || e.keyCode;\r\n                        oldVal = input.val(), 8 === k || 46 === k || iPhone && 127 === k ? (pos = input.caret(), \r\n                        begin = pos.begin, end = pos.end, end - begin === 0 && (begin = 46 !== k ? seekPrev(begin) : end = seekNext(begin - 1), \r\n                        end = 46 === k ? seekNext(end) : end), clearBuffer(begin, end), shiftL(begin, end - 1), \r\n                        e.preventDefault()) : 13 === k ? blurEvent.call(this, e) : 27 === k && (input.val(focusText), \r\n                        input.caret(0, checkVal()), e.preventDefault());\r\n                    }\r\n                }\r\n                function keypressEvent(e) {\r\n                    if (!input.prop(\"readonly\")) {\r\n                        var p, c, next, k = e.which || e.keyCode, pos = input.caret();\r\n                        if (!(e.ctrlKey || e.altKey || e.metaKey || 32 > k) && k && 13 !== k) {\r\n                            if (pos.end - pos.begin !== 0 && (clearBuffer(pos.begin, pos.end), shiftL(pos.begin, pos.end - 1)), \r\n                            p = seekNext(pos.begin - 1), len > p && (c = String.fromCharCode(k), tests[p].test(c))) {\r\n                                if (shiftR(p), buffer[p] = c, writeBuffer(), next = seekNext(p), android) {\r\n                                    var proxy = function() {\r\n                                        $.proxy($.fn.caret, input, next)();\r\n                                    };\r\n                                    setTimeout(proxy, 0);\r\n                                } else input.caret(next);\r\n                                pos.begin <= lastRequiredNonMaskPos && tryFireCompleted();\r\n                            }\r\n                            e.preventDefault();\r\n                        }\r\n                    }\r\n                }\r\n                function clearBuffer(start, end) {\r\n                    var i;\r\n                    for (i = start; end > i && len > i; i++) tests[i] && (buffer[i] = getPlaceholder(i));\r\n                }\r\n                function writeBuffer() {\r\n                    input.val(buffer.join(\"\"));\r\n                }\r\n                function checkVal(allow) {\r\n                    var i, c, pos, test = input.val(), lastMatch = -1;\r\n                    for (i = 0, pos = 0; len > i; i++) if (tests[i]) {\r\n                        for (buffer[i] = getPlaceholder(i); pos++ < test.length; ) if (c = test.charAt(pos - 1), \r\n                        tests[i].test(c)) {\r\n                            buffer[i] = c, lastMatch = i;\r\n                            break;\r\n                        }\r\n                        if (pos > test.length) {\r\n                            clearBuffer(i + 1, len);\r\n                            break;\r\n                        }\r\n                    } else buffer[i] === test.charAt(pos) && pos++, partialPosition > i && (lastMatch = i);\r\n                    return allow ? writeBuffer() : partialPosition > lastMatch + 1 ? settings.autoclear || buffer.join(\"\") === defaultBuffer ? (input.val() && input.val(\"\"), \r\n                    clearBuffer(0, len)) : writeBuffer() : (writeBuffer(), input.val(input.val().substring(0, lastMatch + 1))), \r\n                    partialPosition ? i : firstNonMaskPos;\r\n                }\r\n                var input = $(this), buffer = $.map(mask.split(\"\"), function(c, i) {\r\n                    return \"?\" != c ? defs[c] ? getPlaceholder(i) : c : void 0;\r\n                }), defaultBuffer = buffer.join(\"\"), focusText = input.val();\r\n                input.data($.mask.dataName, function() {\r\n                    return $.map(buffer, function(c, i) {\r\n                        return tests[i] && c != getPlaceholder(i) ? c : null;\r\n                    }).join(\"\");\r\n                }), input.one(\"unmask\", function() {\r\n                    input.off(\".mask\").removeData($.mask.dataName);\r\n                }).on(\"focus.mask\", function() {\r\n                    if (!input.prop(\"readonly\")) {\r\n                        clearTimeout(caretTimeoutId);\r\n                        var pos;\r\n                        focusText = input.val(), pos = checkVal(), caretTimeoutId = setTimeout(function() {\r\n                            input.get(0) === document.activeElement && (writeBuffer(), pos == mask.replace(\"?\", \"\").length ? input.caret(0, pos) : input.caret(pos));\r\n                        }, 10);\r\n                    }\r\n                }).on(\"blur.mask\", blurEvent).on(\"keydown.mask\", keydownEvent).on(\"keypress.mask\", keypressEvent).on(\"input.mask paste.mask\", function() {\r\n                    input.prop(\"readonly\") || setTimeout(function() {\r\n                        var pos = checkVal(!0);\r\n                        input.caret(pos), tryFireCompleted();\r\n                    }, 0);\r\n                }), chrome && android && input.off(\"input.mask\").on(\"input.mask\", androidInputEvent), \r\n                checkVal();\r\n            });\r\n        }\r\n    });\r\n});","/*\r\n * jQuery Form Styler v2.0.2\r\n * https://github.com/Dimox/jQueryFormStyler\r\n *\r\n * Copyright 2012-2017 Dimox (http://dimox.name/)\r\n * Released under the MIT license.\r\n *\r\n * Date: 2017.10.22\r\n *\r\n */\r\n\r\n;(function(factory) {\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\t// AMD\r\n\t\tdefine(['jquery'], factory);\r\n\t} else if (typeof exports === 'object') {\r\n\t\t// CommonJS\r\n\t\tmodule.exports = factory($ || require('jquery'));\r\n\t} else {\r\n\t\tfactory(jQuery);\r\n\t}\r\n}(function($) {\r\n\r\n\t'use strict';\r\n\r\n\tvar pluginName = 'styler',\r\n\t\t\tdefaults = {\r\n\t\t\t\tidSuffix: '-styler',\r\n\t\t\t\tfilePlaceholder: 'Файл не выбран',\r\n\t\t\t\tfileBrowse: 'Обзор...',\r\n\t\t\t\tfileNumber: 'Выбрано файлов: %s',\r\n\t\t\t\tselectPlaceholder: 'Выберите...',\r\n\t\t\t\tselectSearch: false,\r\n\t\t\t\tselectSearchLimit: 10,\r\n\t\t\t\tselectSearchNotFound: 'Совпадений не найдено',\r\n\t\t\t\tselectSearchPlaceholder: 'Поиск...',\r\n\t\t\t\tselectVisibleOptions: 0,\r\n\t\t\t\tselectSmartPositioning: true,\r\n\t\t\t\tlocale: 'ru',\r\n\t\t\t\tlocales: {\r\n\t\t\t\t\t'en': {\r\n\t\t\t\t\t\tfilePlaceholder: 'No file selected',\r\n\t\t\t\t\t\tfileBrowse: 'Browse...',\r\n\t\t\t\t\t\tfileNumber: 'Selected files: %s',\r\n\t\t\t\t\t\tselectPlaceholder: 'Select...',\r\n\t\t\t\t\t\tselectSearchNotFound: 'No matches found',\r\n\t\t\t\t\t\tselectSearchPlaceholder: 'Search...'\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tonSelectOpened: function() {},\r\n\t\t\t\tonSelectClosed: function() {},\r\n\t\t\t\tonFormStyled: function() {}\r\n\t\t\t};\r\n\r\n\tfunction Plugin(element, options) {\r\n\t\tthis.element = element;\r\n\t\tthis.options = $.extend({}, defaults, options);\r\n\t\tvar locale = this.options.locale;\r\n\t\tif (this.options.locales[locale] !== undefined) {\r\n\t\t\t$.extend(this.options, this.options.locales[locale]);\r\n\t\t}\r\n\t\tthis.init();\r\n\t}\r\n\r\n\tPlugin.prototype = {\r\n\r\n\t\t// инициализация\r\n\t\tinit: function() {\r\n\r\n\t\t\tvar el = $(this.element);\r\n\t\t\tvar opt = this.options;\r\n\r\n\t\t\tvar iOS = (navigator.userAgent.match(/(iPad|iPhone|iPod)/i) && !navigator.userAgent.match(/(Windows\\sPhone)/i)) ? true : false;\r\n\t\t\tvar Android = (navigator.userAgent.match(/Android/i) && !navigator.userAgent.match(/(Windows\\sPhone)/i)) ? true : false;\r\n\r\n\t\t\tfunction Attributes() {\r\n\t\t\t\tif (el.attr('id') !== undefined && el.attr('id') !== '') {\r\n\t\t\t\t\tthis.id = el.attr('id') + opt.idSuffix;\r\n\t\t\t\t}\r\n\t\t\t\tthis.title = el.attr('title');\r\n\t\t\t\tthis.classes = el.attr('class');\r\n\t\t\t\tthis.data = el.data();\r\n\t\t\t}\r\n\r\n\t\t\t// checkbox\r\n\t\t\tif (el.is(':checkbox')) {\r\n\r\n\t\t\t\tvar checkboxOutput = function() {\r\n\r\n\t\t\t\t\tvar att = new Attributes();\r\n\t\t\t\t\tvar checkbox = $('<div class=\"jq-checkbox\"><div class=\"jq-checkbox__div\"></div></div>')\r\n\t\t\t\t\t\t.attr({\r\n\t\t\t\t\t\t\tid: att.id,\r\n\t\t\t\t\t\t\ttitle: att.title\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.addClass(att.classes)\r\n\t\t\t\t\t\t.data(att.data)\r\n\t\t\t\t\t;\r\n\r\n\t\t\t\t\tel.after(checkbox).prependTo(checkbox);\r\n\t\t\t\t\tif (el.is(':checked')) checkbox.addClass('checked');\r\n\t\t\t\t\tif (el.is(':disabled')) checkbox.addClass('disabled');\r\n\r\n\t\t\t\t\t// клик на псевдочекбокс\r\n\t\t\t\t\tcheckbox.click(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tel.triggerHandler('click');\r\n\t\t\t\t\t\tif (!checkbox.is('.disabled')) {\r\n\t\t\t\t\t\t\tif (el.is(':checked')) {\r\n\t\t\t\t\t\t\t\tel.prop('checked', false);\r\n\t\t\t\t\t\t\t\tcheckbox.removeClass('checked');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tel.prop('checked', true);\r\n\t\t\t\t\t\t\t\tcheckbox.addClass('checked');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tel.focus().change();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// клик на label\r\n\t\t\t\t\tel.closest('label').add('label[for=\"' + el.attr('id') + '\"]').on('click.styler', function(e) {\r\n\t\t\t\t\t\tif (!$(e.target).is('a') && !$(e.target).closest(checkbox).length) {\r\n\t\t\t\t\t\t\tcheckbox.triggerHandler('click');\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// переключение по Space или Enter\r\n\t\t\t\t\tel.on('change.styler', function() {\r\n\t\t\t\t\t\tif (el.is(':checked')) checkbox.addClass('checked');\r\n\t\t\t\t\t\telse checkbox.removeClass('checked');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// чтобы переключался чекбокс, который находится в теге label\r\n\t\t\t\t\t.on('keydown.styler', function(e) {\r\n\t\t\t\t\t\tif (e.which == 32) checkbox.click();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('focus.styler', function() {\r\n\t\t\t\t\t\tif (!checkbox.is('.disabled')) checkbox.addClass('focused');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('blur.styler', function() {\r\n\t\t\t\t\t\tcheckbox.removeClass('focused');\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}; // end checkboxOutput()\r\n\r\n\t\t\t\tcheckboxOutput();\r\n\r\n\t\t\t\t// обновление при динамическом изменении\r\n\t\t\t\tel.on('refresh', function() {\r\n\t\t\t\t\tel.closest('label').add('label[for=\"' + el.attr('id') + '\"]').off('.styler');\r\n\t\t\t\t\tel.off('.styler').parent().before(el).remove();\r\n\t\t\t\t\tcheckboxOutput();\r\n\t\t\t\t});\r\n\r\n\t\t\t// end checkbox\r\n\r\n\t\t\t// radio\r\n\t\t\t} else if (el.is(':radio')) {\r\n\r\n\t\t\t\tvar radioOutput = function() {\r\n\r\n\t\t\t\t\tvar att = new Attributes();\r\n\t\t\t\t\tvar radio = $('<div class=\"jq-radio\"><div class=\"jq-radio__div\"></div></div>')\r\n\t\t\t\t\t\t.attr({\r\n\t\t\t\t\t\t\tid: att.id,\r\n\t\t\t\t\t\t\ttitle: att.title\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.addClass(att.classes)\r\n\t\t\t\t\t\t.data(att.data)\r\n\t\t\t\t\t;\r\n\r\n\t\t\t\t\tel.after(radio).prependTo(radio);\r\n\t\t\t\t\tif (el.is(':checked')) radio.addClass('checked');\r\n\t\t\t\t\tif (el.is(':disabled')) radio.addClass('disabled');\r\n\r\n\t\t\t\t\t// определяем общего родителя у радиокнопок с одинаковым name\r\n\t\t\t\t\t// http://stackoverflow.com/a/27733847\r\n\t\t\t\t\t$.fn.commonParents = function() {\r\n\t\t\t\t\t\tvar cachedThis = this;\r\n\t\t\t\t\t\treturn cachedThis.first().parents().filter(function() {\r\n\t\t\t\t\t\t\treturn $(this).find(cachedThis).length === cachedThis.length;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t\t$.fn.commonParent = function() {\r\n\t\t\t\t\t\treturn $(this).commonParents().first();\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// клик на псевдорадиокнопке\r\n\t\t\t\t\tradio.click(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tel.triggerHandler('click');\r\n\t\t\t\t\t\tif (!radio.is('.disabled')) {\r\n\t\t\t\t\t\t\tvar inputName = $('input[name=\"' + el.attr('name') + '\"]');\r\n\t\t\t\t\t\t\tinputName.commonParent().find(inputName).prop('checked', false).parent().removeClass('checked');\r\n\t\t\t\t\t\t\tel.prop('checked', true).parent().addClass('checked');\r\n\t\t\t\t\t\t\tel.focus().change();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// клик на label\r\n\t\t\t\t\tel.closest('label').add('label[for=\"' + el.attr('id') + '\"]').on('click.styler', function(e) {\r\n\t\t\t\t\t\tif (!$(e.target).is('a') && !$(e.target).closest(radio).length) {\r\n\t\t\t\t\t\t\tradio.triggerHandler('click');\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// переключение стрелками\r\n\t\t\t\t\tel.on('change.styler', function() {\r\n\t\t\t\t\t\tel.parent().addClass('checked');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('focus.styler', function() {\r\n\t\t\t\t\t\tif (!radio.is('.disabled')) radio.addClass('focused');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('blur.styler', function() {\r\n\t\t\t\t\t\tradio.removeClass('focused');\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}; // end radioOutput()\r\n\r\n\t\t\t\tradioOutput();\r\n\r\n\t\t\t\t// обновление при динамическом изменении\r\n\t\t\t\tel.on('refresh', function() {\r\n\t\t\t\t\tel.closest('label').add('label[for=\"' + el.attr('id') + '\"]').off('.styler');\r\n\t\t\t\t\tel.off('.styler').parent().before(el).remove();\r\n\t\t\t\t\tradioOutput();\r\n\t\t\t\t});\r\n\r\n\t\t\t// end radio\r\n\r\n\t\t\t// file\r\n\t\t\t} else if (el.is(':file')) {\r\n\r\n\t\t\t\tvar fileOutput = function() {\r\n\r\n\t\t\t\t\tvar att = new Attributes();\r\n\t\t\t\t\tvar placeholder = el.data('placeholder');\r\n\t\t\t\t\tif (placeholder === undefined) placeholder = opt.filePlaceholder;\r\n\t\t\t\t\tvar browse = el.data('browse');\r\n\t\t\t\t\tif (browse === undefined || browse === '') browse = opt.fileBrowse;\r\n\r\n\t\t\t\t\tvar file =\r\n\t\t\t\t\t\t$('<div class=\"jq-file\">' +\r\n\t\t\t\t\t\t\t\t'<div class=\"jq-file__name\">' + placeholder + '</div>' +\r\n\t\t\t\t\t\t\t\t'<div class=\"jq-file__browse\">' + browse + '</div>' +\r\n\t\t\t\t\t\t\t'</div>')\r\n\t\t\t\t\t\t.attr({\r\n\t\t\t\t\t\t\tid: att.id,\r\n\t\t\t\t\t\t\ttitle: att.title\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.addClass(att.classes)\r\n\t\t\t\t\t\t.data(att.data)\r\n\t\t\t\t\t;\r\n\r\n\t\t\t\t\tel.after(file).appendTo(file);\r\n\t\t\t\t\tif (el.is(':disabled')) file.addClass('disabled');\r\n\r\n\t\t\t\t\tvar value = el.val();\r\n\t\t\t\t\tvar name = $('div.jq-file__name', file);\r\n\r\n\t\t\t\t\t// чтобы при динамическом изменении имя файла не сбрасывалось\r\n\t\t\t\t\tif (value) name.text(value.replace(/.+[\\\\\\/]/, ''));\r\n\r\n\t\t\t\t\tel.on('change.styler', function() {\r\n\t\t\t\t\t\tvar value = el.val();\r\n\t\t\t\t\t\tif (el.is('[multiple]')) {\r\n\t\t\t\t\t\t\tvalue = '';\r\n\t\t\t\t\t\t\tvar files = el[0].files.length;\r\n\t\t\t\t\t\t\tif (files > 0) {\r\n\t\t\t\t\t\t\t\tvar number = el.data('number');\r\n\t\t\t\t\t\t\t\tif (number === undefined) number = opt.fileNumber;\r\n\t\t\t\t\t\t\t\tnumber = number.replace('%s', files);\r\n\t\t\t\t\t\t\t\tvalue = number;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tname.text(value.replace(/.+[\\\\\\/]/, ''));\r\n\t\t\t\t\t\tif (value === '') {\r\n\t\t\t\t\t\t\tname.text(placeholder);\r\n\t\t\t\t\t\t\tfile.removeClass('changed');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tfile.addClass('changed');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('focus.styler', function() {\r\n\t\t\t\t\t\tfile.addClass('focused');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('blur.styler', function() {\r\n\t\t\t\t\t\tfile.removeClass('focused');\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.on('click.styler', function() {\r\n\t\t\t\t\t\tfile.removeClass('focused');\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}; // end fileOutput()\r\n\r\n\t\t\t\tfileOutput();\r\n\r\n\t\t\t\t// обновление при динамическом изменении\r\n\t\t\t\tel.on('refresh', function() {\r\n\t\t\t\t\tel.off('.styler').parent().before(el).remove();\r\n\t\t\t\t\tfileOutput();\r\n\t\t\t\t});\r\n\r\n\t\t\t// end file\r\n\r\n\t\t\t// number\r\n\t\t\t} else if (el.is('input[type=\"number\"]')) {\r\n\r\n\t\t\t\tvar numberOutput = function() {\r\n\r\n\t\t\t\t\tvar att = new Attributes();\r\n\t\t\t\t\tvar number =\r\n\t\t\t\t\t\t$('<div class=\"jq-number\">' +\r\n\t\t\t\t\t\t\t\t'<div class=\"jq-number__spin minus\"></div>' +\r\n\t\t\t\t\t\t\t\t'<div class=\"jq-number__spin plus\"></div>' +\r\n\t\t\t\t\t\t\t'</div>')\r\n\t\t\t\t\t\t.attr({\r\n\t\t\t\t\t\t\tid: att.id,\r\n\t\t\t\t\t\t\ttitle: att.title\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.addClass(att.classes)\r\n\t\t\t\t\t\t.data(att.data)\r\n\t\t\t\t\t;\r\n\r\n\t\t\t\t\tel.after(number).prependTo(number).wrap('<div class=\"jq-number__field\"></div>');\r\n\t\t\t\t\tif (el.is(':disabled')) number.addClass('disabled');\r\n\r\n\t\t\t\t\tvar min,\r\n\t\t\t\t\t\t\tmax,\r\n\t\t\t\t\t\t\tstep,\r\n\t\t\t\t\t\t\ttimeout = null,\r\n\t\t\t\t\t\t\tinterval = null;\r\n\t\t\t\t\tif (el.attr('min') !== undefined) min = el.attr('min');\r\n\t\t\t\t\tif (el.attr('max') !== undefined) max = el.attr('max');\r\n\t\t\t\t\tif (el.attr('step') !== undefined && $.isNumeric(el.attr('step')))\r\n\t\t\t\t\t\tstep = Number(el.attr('step'));\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tstep = Number(1);\r\n\r\n\t\t\t\t\tvar changeValue = function(spin) {\r\n\t\t\t\t\t\tvar value = el.val(),\r\n\t\t\t\t\t\t\t\tnewValue;\r\n\r\n\t\t\t\t\t\tif (!$.isNumeric(value)) {\r\n\t\t\t\t\t\t\tvalue = 0;\r\n\t\t\t\t\t\t\tel.val('0');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (spin.is('.minus')) {\r\n\t\t\t\t\t\t\tnewValue = Number(value) - step;\r\n\t\t\t\t\t\t} else if (spin.is('.plus')) {\r\n\t\t\t\t\t\t\tnewValue = Number(value) + step;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// определяем количество десятичных знаков после запятой в step\r\n\t\t\t\t\t\tvar decimals = (step.toString().split('.')[1] || []).length;\r\n\t\t\t\t\t\tif (decimals > 0) {\r\n\t\t\t\t\t\t\tvar multiplier = '1';\r\n\t\t\t\t\t\t\twhile (multiplier.length <= decimals) multiplier = multiplier + '0';\r\n\t\t\t\t\t\t\t// избегаем появления лишних знаков после запятой\r\n\t\t\t\t\t\t\tnewValue = Math.round(newValue * multiplier) / multiplier;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ($.isNumeric(min) && $.isNumeric(max)) {\r\n\t\t\t\t\t\t\tif (newValue >= min && newValue <= max) el.val(newValue);\r\n\t\t\t\t\t\t} else if ($.isNumeric(min) && !$.isNumeric(max)) {\r\n\t\t\t\t\t\t\tif (newValue >= min) el.val(newValue);\r\n\t\t\t\t\t\t} else if (!$.isNumeric(min) && $.isNumeric(max)) {\r\n\t\t\t\t\t\t\tif (newValue <= max) el.val(newValue);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tel.val(newValue);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (!number.is('.disabled')) {\r\n\t\t\t\t\t\tnumber.on('mousedown', 'div.jq-number__spin', function() {\r\n\t\t\t\t\t\t\tvar spin = $(this);\r\n\t\t\t\t\t\t\tchangeValue(spin);\r\n\t\t\t\t\t\t\ttimeout = setTimeout(function(){\r\n\t\t\t\t\t\t\t\tinterval = setInterval(function(){ changeValue(spin); }, 40);\r\n\t\t\t\t\t\t\t}, 350);\r\n\t\t\t\t\t\t}).on('mouseup mouseout', 'div.jq-number__spin', function() {\r\n\t\t\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t\t\t}).on('mouseup', 'div.jq-number__spin', function() {\r\n\t\t\t\t\t\t\tel.change().trigger('input');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tel.on('focus.styler', function() {\r\n\t\t\t\t\t\t\tnumber.addClass('focused');\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.on('blur.styler', function() {\r\n\t\t\t\t\t\t\tnumber.removeClass('focused');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}; // end numberOutput()\r\n\r\n\t\t\t\tnumberOutput();\r\n\r\n\t\t\t\t// обновление при динамическом изменении\r\n\t\t\t\tel.on('refresh', function() {\r\n\t\t\t\t\tel.off('.styler').closest('.jq-number').before(el).remove();\r\n\t\t\t\t\tnumberOutput();\r\n\t\t\t\t});\r\n\r\n\t\t\t// end number\r\n\r\n\t\t\t// select\r\n\t\t\t} else if (el.is('select')) {\r\n\r\n\t\t\t\tvar selectboxOutput = function() {\r\n\r\n\t\t\t\t\t// запрещаем прокрутку страницы при прокрутке селекта\r\n\t\t\t\t\tfunction preventScrolling(selector) {\r\n\r\n\t\t\t\t\t\tvar scrollDiff = selector.prop('scrollHeight') - selector.outerHeight(),\r\n\t\t\t\t\t\t\t\twheelDelta = null,\r\n\t\t\t\t\t\t\t\tscrollTop = null;\r\n\r\n\t\t\t\t\t\tselector.off('mousewheel DOMMouseScroll').on('mousewheel DOMMouseScroll', function(e) {\r\n\r\n\t\t\t\t\t\t\t/**\r\n\t\t\t\t\t\t\t * нормализация направления прокрутки\r\n\t\t\t\t\t\t\t * (firefox < 0 || chrome etc... > 0)\r\n\t\t\t\t\t\t\t * (e.originalEvent.detail < 0 || e.originalEvent.wheelDelta > 0)\r\n\t\t\t\t\t\t\t */\r\n\t\t\t\t\t\t\twheelDelta = (e.originalEvent.detail < 0 || e.originalEvent.wheelDelta > 0) ? 1 : -1; // направление прокрутки (-1 вниз, 1 вверх)\r\n\t\t\t\t\t\t\tscrollTop = selector.scrollTop(); // позиция скролла\r\n\r\n\t\t\t\t\t\t\tif ((scrollTop >= scrollDiff && wheelDelta < 0) || (scrollTop <= 0 && wheelDelta > 0)) {\r\n\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar option = $('option', el);\r\n\t\t\t\t\tvar list = '';\r\n\t\t\t\t\t// формируем список селекта\r\n\t\t\t\t\tfunction makeList() {\r\n\t\t\t\t\t\tfor (var i = 0; i < option.length; i++) {\r\n\t\t\t\t\t\t\tvar op = option.eq(i);\r\n\t\t\t\t\t\t\tvar li = '',\r\n\t\t\t\t\t\t\t\t\tliClass = '',\r\n\t\t\t\t\t\t\t\t\tliClasses = '',\r\n\t\t\t\t\t\t\t\t\tid = '',\r\n\t\t\t\t\t\t\t\t\ttitle = '',\r\n\t\t\t\t\t\t\t\t\tdataList = '',\r\n\t\t\t\t\t\t\t\t\toptionClass = '',\r\n\t\t\t\t\t\t\t\t\toptgroupClass = '',\r\n\t\t\t\t\t\t\t\t\tdataJqfsClass = '';\r\n\t\t\t\t\t\t\tvar disabled = 'disabled';\r\n\t\t\t\t\t\t\tvar selDis = 'selected sel disabled';\r\n\t\t\t\t\t\t\tif (op.prop('selected')) liClass = 'selected sel';\r\n\t\t\t\t\t\t\tif (op.is(':disabled')) liClass = disabled;\r\n\t\t\t\t\t\t\tif (op.is(':selected:disabled')) liClass = selDis;\r\n\t\t\t\t\t\t\tif (op.attr('id') !== undefined && op.attr('id') !== '') id = ' id=\"' + op.attr('id') + opt.idSuffix + '\"';\r\n\t\t\t\t\t\t\tif (op.attr('title') !== undefined && option.attr('title') !== '') title = ' title=\"' + op.attr('title') + '\"';\r\n\t\t\t\t\t\t\tif (op.attr('class') !== undefined) {\r\n\t\t\t\t\t\t\t\toptionClass = ' ' + op.attr('class');\r\n\t\t\t\t\t\t\t\tdataJqfsClass = ' data-jqfs-class=\"' + op.attr('class') + '\"';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar data = op.data();\r\n\t\t\t\t\t\t\tfor (var k in data) {\r\n\t\t\t\t\t\t\t\tif (data[k] !== '') dataList += ' data-' + k + '=\"' + data[k] + '\"';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( (liClass + optionClass) !== '' )   liClasses = ' class=\"' + liClass + optionClass + '\"';\r\n\t\t\t\t\t\t\tli = '<li' + dataJqfsClass + dataList + liClasses + title + id + '>'+ op.html() +'</li>';\r\n\r\n\t\t\t\t\t\t\t// если есть optgroup\r\n\t\t\t\t\t\t\tif (op.parent().is('optgroup')) {\r\n\t\t\t\t\t\t\t\tif (op.parent().attr('class') !== undefined) optgroupClass = ' ' + op.parent().attr('class');\r\n\t\t\t\t\t\t\t\tli = '<li' + dataJqfsClass + dataList + ' class=\"' + liClass + optionClass + ' option' + optgroupClass + '\"' + title + id + '>'+ op.html() +'</li>';\r\n\t\t\t\t\t\t\t\tif (op.is(':first-child')) {\r\n\t\t\t\t\t\t\t\t\tli = '<li class=\"optgroup' + optgroupClass + '\">' + op.parent().attr('label') + '</li>' + li;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlist += li;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} // end makeList()\r\n\r\n\t\t\t\t\t// одиночный селект\r\n\t\t\t\t\tfunction doSelect() {\r\n\r\n\t\t\t\t\t\tvar att = new Attributes();\r\n\t\t\t\t\t\tvar searchHTML = '';\r\n\t\t\t\t\t\tvar selectPlaceholder = el.data('placeholder');\r\n\t\t\t\t\t\tvar selectSearch = el.data('search');\r\n\t\t\t\t\t\tvar selectSearchLimit = el.data('search-limit');\r\n\t\t\t\t\t\tvar selectSearchNotFound = el.data('search-not-found');\r\n\t\t\t\t\t\tvar selectSearchPlaceholder = el.data('search-placeholder');\r\n\t\t\t\t\t\tvar selectSmartPositioning = el.data('smart-positioning');\r\n\r\n\t\t\t\t\t\tif (selectPlaceholder === undefined) selectPlaceholder = opt.selectPlaceholder;\r\n\t\t\t\t\t\tif (selectSearch === undefined || selectSearch === '') selectSearch = opt.selectSearch;\r\n\t\t\t\t\t\tif (selectSearchLimit === undefined || selectSearchLimit === '') selectSearchLimit = opt.selectSearchLimit;\r\n\t\t\t\t\t\tif (selectSearchNotFound === undefined || selectSearchNotFound === '') selectSearchNotFound = opt.selectSearchNotFound;\r\n\t\t\t\t\t\tif (selectSearchPlaceholder === undefined) selectSearchPlaceholder = opt.selectSearchPlaceholder;\r\n\t\t\t\t\t\tif (selectSmartPositioning === undefined || selectSmartPositioning === '') selectSmartPositioning = opt.selectSmartPositioning;\r\n\r\n\t\t\t\t\t\tvar selectbox =\r\n\t\t\t\t\t\t\t$('<div class=\"jq-selectbox jqselect\">' +\r\n\t\t\t\t\t\t\t\t\t'<div class=\"jq-selectbox__select\">' +\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"jq-selectbox__select-text\"></div>' +\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"jq-selectbox__trigger\">' +\r\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"jq-selectbox__trigger-arrow\"></div></div>' +\r\n\t\t\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t\t'</div>')\r\n\t\t\t\t\t\t\t.attr({\r\n\t\t\t\t\t\t\t\tid: att.id,\r\n\t\t\t\t\t\t\t\ttitle: att.title\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.addClass(att.classes)\r\n\t\t\t\t\t\t\t.data(att.data)\r\n\t\t\t\t\t\t;\r\n\r\n\t\t\t\t\t\tel.after(selectbox).prependTo(selectbox);\r\n\r\n\t\t\t\t\t\tvar selectzIndex = selectbox.css('z-index');\r\n\t\t\t\t\t\tselectzIndex = (selectzIndex > 0 ) ? selectzIndex : 1;\r\n\t\t\t\t\t\tvar divSelect = $('div.jq-selectbox__select', selectbox);\r\n\t\t\t\t\t\tvar divText = $('div.jq-selectbox__select-text', selectbox);\r\n\t\t\t\t\t\tvar optionSelected = option.filter(':selected');\r\n\r\n\t\t\t\t\t\tmakeList();\r\n\r\n\t\t\t\t\t\tif (selectSearch) searchHTML =\r\n\t\t\t\t\t\t\t'<div class=\"jq-selectbox__search\"><input type=\"search\" autocomplete=\"off\" placeholder=\"' + selectSearchPlaceholder + '\"></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"jq-selectbox__not-found\">' + selectSearchNotFound + '</div>';\r\n\t\t\t\t\t\tvar dropdown =\r\n\t\t\t\t\t\t\t$('<div class=\"jq-selectbox__dropdown\">' +\r\n\t\t\t\t\t\t\t\t\tsearchHTML + '<ul>' + list + '</ul>' +\r\n\t\t\t\t\t\t\t\t'</div>');\r\n\t\t\t\t\t\tselectbox.append(dropdown);\r\n\t\t\t\t\t\tvar ul = $('ul', dropdown);\r\n\t\t\t\t\t\tvar li = $('li', dropdown);\r\n\t\t\t\t\t\tvar search = $('input', dropdown);\r\n\t\t\t\t\t\tvar notFound = $('div.jq-selectbox__not-found', dropdown).hide();\r\n\t\t\t\t\t\tif (li.length < selectSearchLimit) search.parent().hide();\r\n\r\n\t\t\t\t\t\t// показываем опцию по умолчанию\r\n\t\t\t\t\t\t// если у 1-й опции нет текста, она выбрана по умолчанию и параметр selectPlaceholder не false, то показываем плейсхолдер\r\n\t\t\t\t\t\tif (option.first().text() === '' && option.first().is(':selected') && selectPlaceholder !== false) {\r\n\t\t\t\t\t\t\tdivText.text(selectPlaceholder).addClass('placeholder');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdivText.text(optionSelected.text());\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// определяем самый широкий пункт селекта\r\n\t\t\t\t\t\tvar liWidthInner = 0,\r\n\t\t\t\t\t\t\t\tliWidth = 0;\r\n\t\t\t\t\t\tli.css({'display': 'inline-block'});\r\n\t\t\t\t\t\tli.each(function() {\r\n\t\t\t\t\t\t\tvar l = $(this);\r\n\t\t\t\t\t\t\tif (l.innerWidth() > liWidthInner) {\r\n\t\t\t\t\t\t\t\tliWidthInner = l.innerWidth();\r\n\t\t\t\t\t\t\t\tliWidth = l.width();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tli.css({'display': ''});\r\n\r\n\t\t\t\t\t\t// подстраиваем ширину свернутого селекта в зависимости\r\n\t\t\t\t\t\t// от ширины плейсхолдера или самого широкого пункта\r\n\t\t\t\t\t\tif (divText.is('.placeholder') && (divText.width() > liWidthInner)) {\r\n\t\t\t\t\t\t\tdivText.width(divText.width());\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar selClone = selectbox.clone().appendTo('body').width('auto');\r\n\t\t\t\t\t\t\tvar selCloneWidth = selClone.outerWidth();\r\n\t\t\t\t\t\t\tselClone.remove();\r\n\t\t\t\t\t\t\tif (selCloneWidth == selectbox.outerWidth()) {\r\n\t\t\t\t\t\t\t\tdivText.width(liWidth);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// подстраиваем ширину выпадающего списка в зависимости от самого широкого пункта\r\n\t\t\t\t\t\tif (liWidthInner > selectbox.width()) dropdown.width(liWidthInner);\r\n\r\n\t\t\t\t\t\t// прячем 1-ю пустую опцию, если она есть и если атрибут data-placeholder не пустой\r\n\t\t\t\t\t\t// если все же нужно, чтобы первая пустая опция отображалась, то указываем у селекта: data-placeholder=\"\"\r\n\t\t\t\t\t\tif (option.first().text() === '' && el.data('placeholder') !== '') {\r\n\t\t\t\t\t\t\tli.first().hide();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar selectHeight = selectbox.outerHeight(true);\r\n\t\t\t\t\t\tvar searchHeight = search.parent().outerHeight(true) || 0;\r\n\t\t\t\t\t\tvar isMaxHeight = ul.css('max-height');\r\n\t\t\t\t\t\tvar liSelected = li.filter('.selected');\r\n\t\t\t\t\t\tif (liSelected.length < 1) li.first().addClass('selected sel');\r\n\t\t\t\t\t\tif (li.data('li-height') === undefined) {\r\n\t\t\t\t\t\t\tvar liOuterHeight = li.outerHeight();\r\n\t\t\t\t\t\t\tif (selectPlaceholder !== false) liOuterHeight = li.eq(1).outerHeight();\r\n\t\t\t\t\t\t\tli.data('li-height', liOuterHeight);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar position = dropdown.css('top');\r\n\t\t\t\t\t\tif (dropdown.css('left') == 'auto') dropdown.css({left: 0});\r\n\t\t\t\t\t\tif (dropdown.css('top') == 'auto') {\r\n\t\t\t\t\t\t\tdropdown.css({top: selectHeight});\r\n\t\t\t\t\t\t\tposition = selectHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdropdown.hide();\r\n\r\n\t\t\t\t\t\t// если выбран не дефолтный пункт\r\n\t\t\t\t\t\tif (liSelected.length) {\r\n\t\t\t\t\t\t\t// добавляем класс, показывающий изменение селекта\r\n\t\t\t\t\t\t\tif (option.first().text() != optionSelected.text()) {\r\n\t\t\t\t\t\t\t\tselectbox.addClass('changed');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// передаем селекту класс выбранного пункта\r\n\t\t\t\t\t\t\tselectbox.data('jqfs-class', liSelected.data('jqfs-class'));\r\n\t\t\t\t\t\t\tselectbox.addClass(liSelected.data('jqfs-class'));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// если селект неактивный\r\n\t\t\t\t\t\tif (el.is(':disabled')) {\r\n\t\t\t\t\t\t\tselectbox.addClass('disabled');\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// при клике на псевдоселекте\r\n\t\t\t\t\t\tdivSelect.click(function() {\r\n\r\n\t\t\t\t\t\t\t// колбек при закрытии селекта\r\n\t\t\t\t\t\t\tif ($('div.jq-selectbox').filter('.opened').length) {\r\n\t\t\t\t\t\t\t\topt.onSelectClosed.call($('div.jq-selectbox').filter('.opened'));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tel.focus();\r\n\r\n\t\t\t\t\t\t\t// если iOS, то не показываем выпадающий список,\r\n\t\t\t\t\t\t\t// т.к. отображается нативный и неизвестно, как его спрятать\r\n\t\t\t\t\t\t\tif (iOS) return;\r\n\r\n\t\t\t\t\t\t\t// умное позиционирование\r\n\t\t\t\t\t\t\tvar win = $(window);\r\n\t\t\t\t\t\t\tvar liHeight = li.data('li-height');\r\n\t\t\t\t\t\t\tvar topOffset = selectbox.offset().top;\r\n\t\t\t\t\t\t\tvar bottomOffset = win.height() - selectHeight - (topOffset - win.scrollTop());\r\n\t\t\t\t\t\t\tvar visible = el.data('visible-options');\r\n\t\t\t\t\t\t\tif (visible === undefined || visible === '') visible = opt.selectVisibleOptions;\r\n\t\t\t\t\t\t\tvar minHeight = liHeight * 5;\r\n\t\t\t\t\t\t\tvar newHeight = liHeight * visible;\r\n\t\t\t\t\t\t\tif (visible > 0 && visible < 6) minHeight = newHeight;\r\n\t\t\t\t\t\t\tif (visible === 0) newHeight = 'auto';\r\n\r\n\t\t\t\t\t\t\tvar dropDown = function() {\r\n\t\t\t\t\t\t\t\tdropdown.height('auto').css({bottom: 'auto', top: position});\r\n\t\t\t\t\t\t\t\tvar maxHeightBottom = function() {\r\n\t\t\t\t\t\t\t\t\tul.css('max-height', Math.floor((bottomOffset - 20 - searchHeight) / liHeight) * liHeight);\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tmaxHeightBottom();\r\n\t\t\t\t\t\t\t\tul.css('max-height', newHeight);\r\n\t\t\t\t\t\t\t\tif (isMaxHeight != 'none') {\r\n\t\t\t\t\t\t\t\t\tul.css('max-height', isMaxHeight);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (bottomOffset < (dropdown.outerHeight() + 20)) {\r\n\t\t\t\t\t\t\t\t\tmaxHeightBottom();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tvar dropUp = function() {\r\n\t\t\t\t\t\t\t\tdropdown.height('auto').css({top: 'auto', bottom: position});\r\n\t\t\t\t\t\t\t\tvar maxHeightTop = function() {\r\n\t\t\t\t\t\t\t\t\tul.css('max-height', Math.floor((topOffset - win.scrollTop() - 20 - searchHeight) / liHeight) * liHeight);\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tmaxHeightTop();\r\n\t\t\t\t\t\t\t\tul.css('max-height', newHeight);\r\n\t\t\t\t\t\t\t\tif (isMaxHeight != 'none') {\r\n\t\t\t\t\t\t\t\t\tul.css('max-height', isMaxHeight);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ((topOffset - win.scrollTop() - 20) < (dropdown.outerHeight() + 20)) {\r\n\t\t\t\t\t\t\t\t\tmaxHeightTop();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tif (selectSmartPositioning === true || selectSmartPositioning === 1) {\r\n\t\t\t\t\t\t\t\t// раскрытие вниз\r\n\t\t\t\t\t\t\t\tif (bottomOffset > (minHeight + searchHeight + 20)) {\r\n\t\t\t\t\t\t\t\t\tdropDown();\r\n\t\t\t\t\t\t\t\t\tselectbox.removeClass('dropup').addClass('dropdown');\r\n\t\t\t\t\t\t\t\t// раскрытие вверх\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdropUp();\r\n\t\t\t\t\t\t\t\t\tselectbox.removeClass('dropdown').addClass('dropup');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (selectSmartPositioning === false || selectSmartPositioning === 0) {\r\n\t\t\t\t\t\t\t\t// раскрытие вниз\r\n\t\t\t\t\t\t\t\tif (bottomOffset > (minHeight + searchHeight + 20)) {\r\n\t\t\t\t\t\t\t\t\tdropDown();\r\n\t\t\t\t\t\t\t\t\tselectbox.removeClass('dropup').addClass('dropdown');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// если умное позиционирование отключено\r\n\t\t\t\t\t\t\t\tdropdown.height('auto').css({bottom: 'auto', top: position});\r\n\t\t\t\t\t\t\t\tul.css('max-height', newHeight);\r\n\t\t\t\t\t\t\t\tif (isMaxHeight != 'none') {\r\n\t\t\t\t\t\t\t\t\tul.css('max-height', isMaxHeight);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// если выпадающий список выходит за правый край окна браузера,\r\n\t\t\t\t\t\t\t// то меняем позиционирование с левого на правое\r\n\t\t\t\t\t\t\tif (selectbox.offset().left + dropdown.outerWidth() > win.width()) {\r\n\t\t\t\t\t\t\t\tdropdown.css({left: 'auto', right: 0});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// конец умного позиционирования\r\n\r\n\t\t\t\t\t\t\t$('div.jqselect').css({zIndex: (selectzIndex - 1)}).removeClass('opened');\r\n\t\t\t\t\t\t\tselectbox.css({zIndex: selectzIndex});\r\n\t\t\t\t\t\t\tif (dropdown.is(':hidden')) {\r\n\t\t\t\t\t\t\t\t$('div.jq-selectbox__dropdown:visible').hide();\r\n\t\t\t\t\t\t\t\tdropdown.show();\r\n\t\t\t\t\t\t\t\tselectbox.addClass('opened focused');\r\n\t\t\t\t\t\t\t\t// колбек при открытии селекта\r\n\t\t\t\t\t\t\t\topt.onSelectOpened.call(selectbox);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdropdown.hide();\r\n\t\t\t\t\t\t\t\tselectbox.removeClass('opened dropup dropdown');\r\n\t\t\t\t\t\t\t\t// колбек при закрытии селекта\r\n\t\t\t\t\t\t\t\tif ($('div.jq-selectbox').filter('.opened').length) {\r\n\t\t\t\t\t\t\t\t\topt.onSelectClosed.call(selectbox);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// поисковое поле\r\n\t\t\t\t\t\t\tif (search.length) {\r\n\t\t\t\t\t\t\t\tsearch.val('').keyup();\r\n\t\t\t\t\t\t\t\tnotFound.hide();\r\n\t\t\t\t\t\t\t\tsearch.keyup(function() {\r\n\t\t\t\t\t\t\t\t\tvar query = $(this).val();\r\n\t\t\t\t\t\t\t\t\tli.each(function() {\r\n\t\t\t\t\t\t\t\t\t\tif (!$(this).html().match(new RegExp('.*?' + query + '.*?', 'i'))) {\r\n\t\t\t\t\t\t\t\t\t\t\t$(this).hide();\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t$(this).show();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t// прячем 1-ю пустую опцию\r\n\t\t\t\t\t\t\t\t\tif (option.first().text() === '' && el.data('placeholder') !== '') {\r\n\t\t\t\t\t\t\t\t\t\tli.first().hide();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (li.filter(':visible').length < 1) {\r\n\t\t\t\t\t\t\t\t\t\tnotFound.show();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tnotFound.hide();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// прокручиваем до выбранного пункта при открытии списка\r\n\t\t\t\t\t\t\tif (li.filter('.selected').length) {\r\n\t\t\t\t\t\t\t\tif (el.val() === '') {\r\n\t\t\t\t\t\t\t\t\tul.scrollTop(0);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// если нечетное количество видимых пунктов,\r\n\t\t\t\t\t\t\t\t\t// то высоту пункта делим пополам для последующего расчета\r\n\t\t\t\t\t\t\t\t\tif ( (ul.innerHeight() / liHeight) % 2 !== 0 ) liHeight = liHeight / 2;\r\n\t\t\t\t\t\t\t\t\tul.scrollTop(ul.scrollTop() + li.filter('.selected').position().top - ul.innerHeight() / 2 + liHeight);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tpreventScrolling(ul);\r\n\r\n\t\t\t\t\t\t}); // end divSelect.click()\r\n\r\n\t\t\t\t\t\t// при наведении курсора на пункт списка\r\n\t\t\t\t\t\tli.hover(function() {\r\n\t\t\t\t\t\t\t$(this).siblings().removeClass('selected');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvar selectedText = li.filter('.selected').text();\r\n\r\n\t\t\t\t\t\t// при клике на пункт списка\r\n\t\t\t\t\t\tli.filter(':not(.disabled):not(.optgroup)').click(function() {\r\n\t\t\t\t\t\t\tel.focus();\r\n\t\t\t\t\t\t\tvar t = $(this);\r\n\t\t\t\t\t\t\tvar liText = t.text();\r\n\t\t\t\t\t\t\tif (!t.is('.selected')) {\r\n\t\t\t\t\t\t\t\tvar index = t.index();\r\n\t\t\t\t\t\t\t\tindex -= t.prevAll('.optgroup').length;\r\n\t\t\t\t\t\t\t\tt.addClass('selected sel').siblings().removeClass('selected sel');\r\n\t\t\t\t\t\t\t\toption.prop('selected', false).eq(index).prop('selected', true);\r\n\t\t\t\t\t\t\t\tselectedText = liText;\r\n\t\t\t\t\t\t\t\tdivText.text(liText);\r\n\r\n\t\t\t\t\t\t\t\t// передаем селекту класс выбранного пункта\r\n\t\t\t\t\t\t\t\tif (selectbox.data('jqfs-class')) selectbox.removeClass(selectbox.data('jqfs-class'));\r\n\t\t\t\t\t\t\t\tselectbox.data('jqfs-class', t.data('jqfs-class'));\r\n\t\t\t\t\t\t\t\tselectbox.addClass(t.data('jqfs-class'));\r\n\r\n\t\t\t\t\t\t\t\tel.change();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdropdown.hide();\r\n\t\t\t\t\t\t\tselectbox.removeClass('opened dropup dropdown');\r\n\t\t\t\t\t\t\t// колбек при закрытии селекта\r\n\t\t\t\t\t\t\topt.onSelectClosed.call(selectbox);\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdropdown.mouseout(function() {\r\n\t\t\t\t\t\t\t$('li.sel', dropdown).addClass('selected');\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// изменение селекта\r\n\t\t\t\t\t\tel.on('change.styler', function() {\r\n\t\t\t\t\t\t\tdivText.text(option.filter(':selected').text()).removeClass('placeholder');\r\n\t\t\t\t\t\t\tli.removeClass('selected sel').not('.optgroup').eq(el[0].selectedIndex).addClass('selected sel');\r\n\t\t\t\t\t\t\t// добавляем класс, показывающий изменение селекта\r\n\t\t\t\t\t\t\tif (option.first().text() != li.filter('.selected').text()) {\r\n\t\t\t\t\t\t\t\tselectbox.addClass('changed');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tselectbox.removeClass('changed');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.on('focus.styler', function() {\r\n\t\t\t\t\t\t\tselectbox.addClass('focused');\r\n\t\t\t\t\t\t\t$('div.jqselect').not('.focused').removeClass('opened dropup dropdown').find('div.jq-selectbox__dropdown').hide();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.on('blur.styler', function() {\r\n\t\t\t\t\t\t\tselectbox.removeClass('focused');\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// изменение селекта с клавиатуры\r\n\t\t\t\t\t\t.on('keydown.styler keyup.styler', function(e) {\r\n\t\t\t\t\t\t\tvar liHeight = li.data('li-height');\r\n\t\t\t\t\t\t\tif (el.val() === '') {\r\n\t\t\t\t\t\t\t\tdivText.text(selectPlaceholder).addClass('placeholder');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdivText.text(option.filter(':selected').text());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tli.removeClass('selected sel').not('.optgroup').eq(el[0].selectedIndex).addClass('selected sel');\r\n\t\t\t\t\t\t\t// вверх, влево, Page Up, Home\r\n\t\t\t\t\t\t\tif (e.which == 38 || e.which == 37 || e.which == 33 || e.which == 36) {\r\n\t\t\t\t\t\t\t\tif (el.val() === '') {\r\n\t\t\t\t\t\t\t\t\tul.scrollTop(0);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tul.scrollTop(ul.scrollTop() + li.filter('.selected').position().top);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// вниз, вправо, Page Down, End\r\n\t\t\t\t\t\t\tif (e.which == 40 || e.which == 39 || e.which == 34 || e.which == 35) {\r\n\t\t\t\t\t\t\t\tul.scrollTop(ul.scrollTop() + li.filter('.selected').position().top - ul.innerHeight() + liHeight);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// закрываем выпадающий список при нажатии Enter\r\n\t\t\t\t\t\t\tif (e.which == 13) {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\tdropdown.hide();\r\n\t\t\t\t\t\t\t\tselectbox.removeClass('opened dropup dropdown');\r\n\t\t\t\t\t\t\t\t// колбек при закрытии селекта\r\n\t\t\t\t\t\t\t\topt.onSelectClosed.call(selectbox);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).on('keydown.styler', function(e) {\r\n\t\t\t\t\t\t\t// открываем выпадающий список при нажатии Space\r\n\t\t\t\t\t\t\tif (e.which == 32) {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\tdivSelect.click();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// прячем выпадающий список при клике за пределами селекта\r\n\t\t\t\t\t\tif (!onDocumentClick.registered) {\r\n\t\t\t\t\t\t\t$(document).on('click', onDocumentClick);\r\n\t\t\t\t\t\t\tonDocumentClick.registered = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} // end doSelect()\r\n\r\n\t\t\t\t\t// мультиселект\r\n\t\t\t\t\tfunction doMultipleSelect() {\r\n\r\n\t\t\t\t\t\tvar att = new Attributes();\r\n\t\t\t\t\t\tvar selectbox =\r\n\t\t\t\t\t\t\t$('<div class=\"jq-select-multiple jqselect\"></div>')\r\n\t\t\t\t\t\t\t.attr({\r\n\t\t\t\t\t\t\t\tid: att.id,\r\n\t\t\t\t\t\t\t\ttitle: att.title\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.addClass(att.classes)\r\n\t\t\t\t\t\t\t.data(att.data)\r\n\t\t\t\t\t\t;\r\n\r\n\t\t\t\t\t\tel.after(selectbox);\r\n\r\n\t\t\t\t\t\tmakeList();\r\n\t\t\t\t\t\tselectbox.append('<ul>' + list + '</ul>');\r\n\t\t\t\t\t\tvar ul = $('ul', selectbox);\r\n\t\t\t\t\t\tvar li = $('li', selectbox);\r\n\t\t\t\t\t\tvar size = el.attr('size');\r\n\t\t\t\t\t\tvar ulHeight = ul.outerHeight();\r\n\t\t\t\t\t\tvar liHeight = li.outerHeight();\r\n\t\t\t\t\t\tif (size !== undefined && size > 0) {\r\n\t\t\t\t\t\t\tul.css({'height': liHeight * size});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tul.css({'height': liHeight * 4});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (ulHeight > selectbox.height()) {\r\n\t\t\t\t\t\t\tul.css('overflowY', 'scroll');\r\n\t\t\t\t\t\t\tpreventScrolling(ul);\r\n\t\t\t\t\t\t\t// прокручиваем до выбранного пункта\r\n\t\t\t\t\t\t\tif (li.filter('.selected').length) {\r\n\t\t\t\t\t\t\t\tul.scrollTop(ul.scrollTop() + li.filter('.selected').position().top);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// прячем оригинальный селект\r\n\t\t\t\t\t\tel.prependTo(selectbox);\r\n\r\n\t\t\t\t\t\t// если селект неактивный\r\n\t\t\t\t\t\tif (el.is(':disabled')) {\r\n\t\t\t\t\t\t\tselectbox.addClass('disabled');\r\n\t\t\t\t\t\t\toption.each(function() {\r\n\t\t\t\t\t\t\t\tif ($(this).is(':selected')) li.eq($(this).index()).addClass('selected');\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// если селект активный\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// при клике на пункт списка\r\n\t\t\t\t\t\t\tli.filter(':not(.disabled):not(.optgroup)').click(function(e) {\r\n\t\t\t\t\t\t\t\tel.focus();\r\n\t\t\t\t\t\t\t\tvar clkd = $(this);\r\n\t\t\t\t\t\t\t\tif(!e.ctrlKey && !e.metaKey) clkd.addClass('selected');\r\n\t\t\t\t\t\t\t\tif(!e.shiftKey) clkd.addClass('first');\r\n\t\t\t\t\t\t\t\tif(!e.ctrlKey && !e.metaKey && !e.shiftKey) clkd.siblings().removeClass('selected first');\r\n\r\n\t\t\t\t\t\t\t\t// выделение пунктов при зажатом Ctrl\r\n\t\t\t\t\t\t\t\tif(e.ctrlKey || e.metaKey) {\r\n\t\t\t\t\t\t\t\t\tif (clkd.is('.selected')) clkd.removeClass('selected first');\r\n\t\t\t\t\t\t\t\t\t\telse clkd.addClass('selected first');\r\n\t\t\t\t\t\t\t\t\tclkd.siblings().removeClass('first');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// выделение пунктов при зажатом Shift\r\n\t\t\t\t\t\t\t\tif(e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\tvar prev = false,\r\n\t\t\t\t\t\t\t\t\t\t\tnext = false;\r\n\t\t\t\t\t\t\t\t\tclkd.siblings().removeClass('selected').siblings('.first').addClass('selected');\r\n\t\t\t\t\t\t\t\t\tclkd.prevAll().each(function() {\r\n\t\t\t\t\t\t\t\t\t\tif ($(this).is('.first')) prev = true;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tclkd.nextAll().each(function() {\r\n\t\t\t\t\t\t\t\t\t\tif ($(this).is('.first')) next = true;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tif (prev) {\r\n\t\t\t\t\t\t\t\t\t\tclkd.prevAll().each(function() {\r\n\t\t\t\t\t\t\t\t\t\t\tif ($(this).is('.selected')) return false;\r\n\t\t\t\t\t\t\t\t\t\t\t\telse $(this).not('.disabled, .optgroup').addClass('selected');\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (next) {\r\n\t\t\t\t\t\t\t\t\t\tclkd.nextAll().each(function() {\r\n\t\t\t\t\t\t\t\t\t\t\tif ($(this).is('.selected')) return false;\r\n\t\t\t\t\t\t\t\t\t\t\t\telse $(this).not('.disabled, .optgroup').addClass('selected');\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (li.filter('.selected').length == 1) clkd.addClass('first');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// отмечаем выбранные мышью\r\n\t\t\t\t\t\t\t\toption.prop('selected', false);\r\n\t\t\t\t\t\t\t\tli.filter('.selected').each(function() {\r\n\t\t\t\t\t\t\t\t\tvar t = $(this);\r\n\t\t\t\t\t\t\t\t\tvar index = t.index();\r\n\t\t\t\t\t\t\t\t\tif (t.is('.option')) index -= t.prevAll('.optgroup').length;\r\n\t\t\t\t\t\t\t\t\toption.eq(index).prop('selected', true);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tel.change();\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t// отмечаем выбранные с клавиатуры\r\n\t\t\t\t\t\t\toption.each(function(i) {\r\n\t\t\t\t\t\t\t\t$(this).data('optionIndex', i);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tel.on('change.styler', function() {\r\n\t\t\t\t\t\t\t\tli.removeClass('selected');\r\n\t\t\t\t\t\t\t\tvar arrIndexes = [];\r\n\t\t\t\t\t\t\t\toption.filter(':selected').each(function() {\r\n\t\t\t\t\t\t\t\t\tarrIndexes.push($(this).data('optionIndex'));\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tli.not('.optgroup').filter(function(i) {\r\n\t\t\t\t\t\t\t\t\treturn $.inArray(i, arrIndexes) > -1;\r\n\t\t\t\t\t\t\t\t}).addClass('selected');\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.on('focus.styler', function() {\r\n\t\t\t\t\t\t\t\tselectbox.addClass('focused');\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.on('blur.styler', function() {\r\n\t\t\t\t\t\t\t\tselectbox.removeClass('focused');\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t// прокручиваем с клавиатуры\r\n\t\t\t\t\t\t\tif (ulHeight > selectbox.height()) {\r\n\t\t\t\t\t\t\t\tel.on('keydown.styler', function(e) {\r\n\t\t\t\t\t\t\t\t\t// вверх, влево, PageUp\r\n\t\t\t\t\t\t\t\t\tif (e.which == 38 || e.which == 37 || e.which == 33) {\r\n\t\t\t\t\t\t\t\t\t\tul.scrollTop(ul.scrollTop() + li.filter('.selected').position().top - liHeight);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// вниз, вправо, PageDown\r\n\t\t\t\t\t\t\t\t\tif (e.which == 40 || e.which == 39 || e.which == 34) {\r\n\t\t\t\t\t\t\t\t\t\tul.scrollTop(ul.scrollTop() + li.filter('.selected:last').position().top - ul.innerHeight() + liHeight * 2);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} // end doMultipleSelect()\r\n\r\n\t\t\t\t\tif (el.is('[multiple]')) {\r\n\r\n\t\t\t\t\t\t// если Android или iOS, то мультиселект не стилизуем\r\n\t\t\t\t\t\t// причина для Android - в стилизованном селекте нет возможности выбрать несколько пунктов\r\n\t\t\t\t\t\t// причина для iOS - в стилизованном селекте неправильно отображаются выбранные пункты\r\n\t\t\t\t\t\tif (Android || iOS) return;\r\n\r\n\t\t\t\t\t\tdoMultipleSelect();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdoSelect();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}; // end selectboxOutput()\r\n\r\n\t\t\t\tselectboxOutput();\r\n\r\n\t\t\t\t// обновление при динамическом изменении\r\n\t\t\t\tel.on('refresh', function() {\r\n\t\t\t\t\tel.off('.styler').parent().before(el).remove();\r\n\t\t\t\t\tselectboxOutput();\r\n\t\t\t\t});\r\n\r\n\t\t\t// end select\r\n\r\n\t\t\t// reset\r\n\t\t\t} else if (el.is(':reset')) {\r\n\t\t\t\tel.on('click', function() {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tel.closest('form').find('input, select').trigger('refresh');\r\n\t\t\t\t\t}, 1);\r\n\t\t\t\t});\r\n\t\t\t} // end reset\r\n\r\n\t\t}, // init: function()\r\n\r\n\t\t// деструктор\r\n\t\tdestroy: function() {\r\n\r\n\t\t\tvar el = $(this.element);\r\n\r\n\t\t\tif (el.is(':checkbox') || el.is(':radio')) {\r\n\t\t\t\tel.removeData('_' + pluginName).off('.styler refresh').removeAttr('style').parent().before(el).remove();\r\n\t\t\t\tel.closest('label').add('label[for=\"' + el.attr('id') + '\"]').off('.styler');\r\n\t\t\t} else if (el.is('input[type=\"number\"]')) {\r\n\t\t\t\tel.removeData('_' + pluginName).off('.styler refresh').closest('.jq-number').before(el).remove();\r\n\t\t\t} else if (el.is(':file') || el.is('select')) {\r\n\t\t\t\tel.removeData('_' + pluginName).off('.styler refresh').removeAttr('style').parent().before(el).remove();\r\n\t\t\t}\r\n\r\n\t\t} // destroy: function()\r\n\r\n\t}; // Plugin.prototype\r\n\r\n\t$.fn[pluginName] = function(options) {\r\n\t\tvar args = arguments;\r\n\t\tif (options === undefined || typeof options === 'object') {\r\n\t\t\tthis.each(function() {\r\n\t\t\t\tif (!$.data(this, '_' + pluginName)) {\r\n\t\t\t\t\t$.data(this, '_' + pluginName, new Plugin(this, options));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// колбек после выполнения плагина\r\n\t\t\t.promise()\r\n\t\t\t.done(function() {\r\n\t\t\t\tvar opt = $(this[0]).data('_' + pluginName);\r\n\t\t\t\tif (opt) opt.options.onFormStyled.call();\r\n\t\t\t});\r\n\t\t\treturn this;\r\n\t\t} else if (typeof options === 'string' && options[0] !== '_' && options !== 'init') {\r\n\t\t\tvar returns;\r\n\t\t\tthis.each(function() {\r\n\t\t\t\tvar instance = $.data(this, '_' + pluginName);\r\n\t\t\t\tif (instance instanceof Plugin && typeof instance[options] === 'function') {\r\n\t\t\t\t\treturns = instance[options].apply(instance, Array.prototype.slice.call(args, 1));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn returns !== undefined ? returns : this;\r\n\t\t}\r\n\t};\r\n\r\n\t// прячем выпадающий список при клике за пределами селекта\r\n\tfunction onDocumentClick(e) {\r\n\t\t// e.target.nodeName != 'OPTION' - добавлено для обхода бага в Opera на движке Presto\r\n\t\t// (при изменении селекта с клавиатуры срабатывает событие onclick)\r\n\t\tif (!$(e.target).parents().hasClass('jq-selectbox') && e.target.nodeName != 'OPTION') {\r\n\t\t\tif ($('div.jq-selectbox.opened').length) {\r\n\t\t\t\tvar selectbox = $('div.jq-selectbox.opened'),\r\n\t\t\t\t\t\tsearch = $('div.jq-selectbox__search input', selectbox),\r\n\t\t\t\t\t\tdropdown = $('div.jq-selectbox__dropdown', selectbox),\r\n\t\t\t\t\t\topt = selectbox.find('select').data('_' + pluginName).options;\r\n\r\n\t\t\t\t// колбек при закрытии селекта\r\n\t\t\t\topt.onSelectClosed.call(selectbox);\r\n\r\n\t\t\t\tif (search.length) search.val('').keyup();\r\n\t\t\t\tdropdown.hide().find('li.sel').addClass('selected');\r\n\t\t\t\tselectbox.removeClass('focused opened dropup dropdown');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tonDocumentClick.registered = false;\r\n\r\n}));","/*!\r\n * @fileOverview TouchSwipe - jQuery Plugin\r\n * @version 1.6.18\r\n *\r\n * @author Matt Bryson http://www.github.com/mattbryson\r\n * @see https://github.com/mattbryson/TouchSwipe-Jquery-Plugin\r\n * @see http://labs.rampinteractive.co.uk/touchSwipe/\r\n * @see http://plugins.jquery.com/project/touchSwipe\r\n * @license\r\n * Copyright (c) 2010-2015 Matt Bryson\r\n * Dual licensed under the MIT or GPL Version 2 licenses.\r\n *\r\n */\r\n\r\n/*\r\n *\r\n * Changelog\r\n * $Date: 2010-12-12 (Wed, 12 Dec 2010) $\r\n * $version: 1.0.0\r\n * $version: 1.0.1 - removed multibyte comments\r\n *\r\n * $Date: 2011-21-02 (Mon, 21 Feb 2011) $\r\n * $version: 1.1.0 \t- added allowPageScroll property to allow swiping and scrolling of page\r\n *\t\t\t\t\t- changed handler signatures so one handler can be used for multiple events\r\n * $Date: 2011-23-02 (Wed, 23 Feb 2011) $\r\n * $version: 1.2.0 \t- added click handler. This is fired if the user simply clicks and does not swipe. The event object and click target are passed to handler.\r\n *\t\t\t\t\t- If you use the http://code.google.com/p/jquery-ui-for-ipad-and-iphone/ plugin, you can also assign jQuery mouse events to children of a touchSwipe object.\r\n * $version: 1.2.1 \t- removed console log!\r\n *\r\n * $version: 1.2.2 \t- Fixed bug where scope was not preserved in callback methods.\r\n *\r\n * $Date: 2011-28-04 (Thurs, 28 April 2011) $\r\n * $version: 1.2.4 \t- Changed licence terms to be MIT or GPL inline with jQuery. Added check for support of touch events to stop non compatible browsers erroring.\r\n *\r\n * $Date: 2011-27-09 (Tues, 27 September 2011) $\r\n * $version: 1.2.5 \t- Added support for testing swipes with mouse on desktop browser (thanks to https://github.com/joelhy)\r\n *\r\n * $Date: 2012-14-05 (Mon, 14 May 2012) $\r\n * $version: 1.2.6 \t- Added timeThreshold between start and end touch, so user can ignore slow swipes (thanks to Mark Chase). Default is null, all swipes are detected\r\n *\r\n * $Date: 2012-05-06 (Tues, 05 June 2012) $\r\n * $version: 1.2.7 \t- Changed time threshold to have null default for backwards compatibility. Added duration param passed back in events, and refactored how time is handled.\r\n *\r\n * $Date: 2012-05-06 (Tues, 05 June 2012) $\r\n * $version: 1.2.8 \t- Added the possibility to return a value like null or false in the trigger callback. In that way we can control when the touch start/move should take effect or not (simply by returning in some cases return null; or return false;) This effects the ontouchstart/ontouchmove event.\r\n *\r\n * $Date: 2012-06-06 (Wed, 06 June 2012) $\r\n * $version: 1.3.0 \t- Refactored whole plugin to allow for methods to be executed, as well as exposed defaults for user override. Added 'enable', 'disable', and 'destroy' methods\r\n *\r\n * $Date: 2012-05-06 (Fri, 05 June 2012) $\r\n * $version: 1.3.1 \t- Bug fixes  - bind() with false as last argument is no longer supported in jQuery 1.6, also, if you just click, the duration is now returned correctly.\r\n *\r\n * $Date: 2012-29-07 (Sun, 29 July 2012) $\r\n * $version: 1.3.2\t- Added fallbackToMouseEvents option to NOT capture mouse events on non touch devices.\r\n * \t\t\t- Added \"all\" fingers value to the fingers property, so any combination of fingers triggers the swipe, allowing event handlers to check the finger count\r\n *\r\n * $Date: 2012-09-08 (Thurs, 9 Aug 2012) $\r\n * $version: 1.3.3\t- Code tidy prep for minefied version\r\n *\r\n * $Date: 2012-04-10 (wed, 4 Oct 2012) $\r\n * $version: 1.4.0\t- Added pinch support, pinchIn and pinchOut\r\n *\r\n * $Date: 2012-11-10 (Thurs, 11 Oct 2012) $\r\n * $version: 1.5.0\t- Added excludedElements, a jquery selector that specifies child elements that do NOT trigger swipes. By default, this is .noSwipe\r\n *\r\n * $Date: 2012-22-10 (Mon, 22 Oct 2012) $\r\n * $version: 1.5.1\t- Fixed bug with jQuery 1.8 and trailing comma in excludedElements\r\n *\t\t\t\t\t- Fixed bug with IE and eventPreventDefault()\r\n * $Date: 2013-01-12 (Fri, 12 Jan 2013) $\r\n * $version: 1.6.0\t- Fixed bugs with pinching, mainly when both pinch and swipe enabled, as well as adding time threshold for multifinger gestures, so releasing one finger beofre the other doesnt trigger as single finger gesture.\r\n *\t\t\t\t\t- made the demo site all static local HTML pages so they can be run locally by a developer\r\n *\t\t\t\t\t- added jsDoc comments and added documentation for the plugin\r\n *\t\t\t\t\t- code tidy\r\n *\t\t\t\t\t- added triggerOnTouchLeave property that will end the event when the user swipes off the element.\r\n * $Date: 2013-03-23 (Sat, 23 Mar 2013) $\r\n * $version: 1.6.1\t- Added support for ie8 touch events\r\n * $version: 1.6.2\t- Added support for events binding with on / off / bind in jQ for all callback names.\r\n *                   - Deprecated the 'click' handler in favour of tap.\r\n *                   - added cancelThreshold property\r\n *                   - added option method to update init options at runtime\r\n * $version 1.6.3    - added doubletap, longtap events and longTapThreshold, doubleTapThreshold property\r\n *\r\n * $Date: 2013-04-04 (Thurs, 04 April 2013) $\r\n * $version 1.6.4    - Fixed bug with cancelThreshold introduced in 1.6.3, where swipe status no longer fired start event, and stopped once swiping back.\r\n *\r\n * $Date: 2013-08-24 (Sat, 24 Aug 2013) $\r\n * $version 1.6.5    - Merged a few pull requests fixing various bugs, added AMD support.\r\n *\r\n * $Date: 2014-06-04 (Wed, 04 June 2014) $\r\n * $version 1.6.6 \t- Merge of pull requests.\r\n *    \t\t\t\t- IE10 touch support\r\n *    \t\t\t\t- Only prevent default event handling on valid swipe\r\n *    \t\t\t\t- Separate license/changelog comment\r\n *    \t\t\t\t- Detect if the swipe is valid at the end of the touch event.\r\n *    \t\t\t\t- Pass fingerdata to event handlers.\r\n *    \t\t\t\t- Add 'hold' gesture\r\n *    \t\t\t\t- Be more tolerant about the tap distance\r\n *    \t\t\t\t- Typos and minor fixes\r\n *\r\n * $Date: 2015-22-01 (Thurs, 22 Jan 2015) $\r\n * $version 1.6.7    - Added patch from https://github.com/mattbryson/TouchSwipe-Jquery-Plugin/issues/206 to fix memory leak\r\n *\r\n * $Date: 2015-2-2 (Mon, 2 Feb 2015) $\r\n * $version 1.6.8    - Added preventDefaultEvents option to proxy events regardless.\r\n *\t\t\t\t\t- Fixed issue with swipe and pinch not triggering at the same time\r\n *\r\n * $Date: 2015-9-6 (Tues, 9 June 2015) $\r\n * $version 1.6.9    - Added PR from jdalton/hybrid to fix pointer events\r\n *\t\t\t\t\t- Added scrolling demo\r\n *\t\t\t\t\t- Added version property to plugin\r\n *\r\n * $Date: 2015-1-10 (Wed, 1 October 2015) $\r\n * $version 1.6.10    - Added PR from beatspace to fix tap events\r\n * $version 1.6.11    - Added PRs from indri-indri ( Doc tidyup), kkirsche ( Bower tidy up ), UziTech (preventDefaultEvents fixes )\r\n *\t\t\t\t\t - Allowed setting multiple options via .swipe(\"options\", options_hash) and more simply .swipe(options_hash) or exisitng instances\r\n * $version 1.6.12    - Fixed bug with multi finger releases above 2 not triggering events\r\n *\r\n * $Date: 2015-12-18 (Fri, 18 December 2015) $\r\n * $version 1.6.13    - Added PRs\r\n *                    - Fixed #267 allowPageScroll not working correctly\r\n * $version 1.6.14    - Fixed #220 / #248 doubletap not firing with swipes, #223 commonJS compatible\r\n * $version 1.6.15    - More bug fixes\r\n *\r\n * $Date: 2016-04-29 (Fri, 29 April 2016) $\r\n * $version 1.6.16    - Swipes with 0 distance now allow default events to trigger.  So tapping any form elements or A tags will allow default interaction, but swiping will trigger a swipe.\r\n                        Removed the a, input, select etc from the excluded Children list as the 0 distance tap solves that issue.\r\n* $Date: 2016-05-19  (Fri, 29 April 2016) $\r\n* $version 1.6.17     - Fixed context issue when calling instance methods via $(\"selector\").swipe(\"method\");\r\n* $version 1.6.18     - now honors fallbackToMouseEvents=false for MS Pointer events when a Mouse is used.\r\n\r\n */\r\n\r\n/**\r\n * See (http://jquery.com/).\r\n * @name $\r\n * @class\r\n * See the jQuery Library  (http://jquery.com/) for full details.  This just\r\n * documents the function and classes that are added to jQuery by this plug-in.\r\n */\r\n\r\n/**\r\n * See (http://jquery.com/)\r\n * @name fn\r\n * @class\r\n * See the jQuery Library  (http://jquery.com/) for full details.  This just\r\n * documents the function and classes that are added to jQuery by this plug-in.\r\n * @memberOf $\r\n */\r\n\r\n\r\n(function(factory) {\r\n  if (typeof define === 'function' && define.amd && define.amd.jQuery) {\r\n    // AMD. Register as anonymous module.\r\n    define(['jquery'], factory);\r\n  } else if (typeof module !== 'undefined' && module.exports) {\r\n    // CommonJS Module\r\n    factory(require(\"jquery\"));\r\n  } else {\r\n    // Browser globals.\r\n    factory(jQuery);\r\n  }\r\n}(function($) {\r\n  \"use strict\";\r\n\r\n  //Constants\r\n  var VERSION = \"1.6.18\",\r\n    LEFT = \"left\",\r\n    RIGHT = \"right\",\r\n    UP = \"up\",\r\n    DOWN = \"down\",\r\n    IN = \"in\",\r\n    OUT = \"out\",\r\n\r\n    NONE = \"none\",\r\n    AUTO = \"auto\",\r\n\r\n    SWIPE = \"swipe\",\r\n    PINCH = \"pinch\",\r\n    TAP = \"tap\",\r\n    DOUBLE_TAP = \"doubletap\",\r\n    LONG_TAP = \"longtap\",\r\n    HOLD = \"hold\",\r\n\r\n    HORIZONTAL = \"horizontal\",\r\n    VERTICAL = \"vertical\",\r\n\r\n    ALL_FINGERS = \"all\",\r\n\r\n    DOUBLE_TAP_THRESHOLD = 10,\r\n\r\n    PHASE_START = \"start\",\r\n    PHASE_MOVE = \"move\",\r\n    PHASE_END = \"end\",\r\n    PHASE_CANCEL = \"cancel\",\r\n\r\n    SUPPORTS_TOUCH = 'ontouchstart' in window,\r\n\r\n    SUPPORTS_POINTER_IE10 = window.navigator.msPointerEnabled && !window.navigator.pointerEnabled && !SUPPORTS_TOUCH,\r\n\r\n    SUPPORTS_POINTER = (window.navigator.pointerEnabled || window.navigator.msPointerEnabled) && !SUPPORTS_TOUCH,\r\n\r\n    PLUGIN_NS = 'TouchSwipe';\r\n\r\n\r\n\r\n  /**\r\n  * The default configuration, and available options to configure touch swipe with.\r\n  * You can set the default values by updating any of the properties prior to instantiation.\r\n  * @name $.fn.swipe.defaults\r\n  * @namespace\r\n  * @property {int} [fingers=1] The number of fingers to detect in a swipe. Any swipes that do not meet this requirement will NOT trigger swipe handlers.\r\n  * @property {int} [threshold=75] The number of pixels that the user must move their finger by before it is considered a swipe.\r\n  * @property {int} [cancelThreshold=null] The number of pixels that the user must move their finger back from the original swipe direction to cancel the gesture.\r\n  * @property {int} [pinchThreshold=20] The number of pixels that the user must pinch their finger by before it is considered a pinch.\r\n  * @property {int} [maxTimeThreshold=null] Time, in milliseconds, between touchStart and touchEnd must NOT exceed in order to be considered a swipe.\r\n  * @property {int} [fingerReleaseThreshold=250] Time in milliseconds between releasing multiple fingers.  If 2 fingers are down, and are released one after the other, if they are within this threshold, it counts as a simultaneous release.\r\n  * @property {int} [longTapThreshold=500] Time in milliseconds between tap and release for a long tap\r\n  * @property {int} [doubleTapThreshold=200] Time in milliseconds between 2 taps to count as a double tap\r\n  * @property {function} [swipe=null] A handler to catch all swipes. See {@link $.fn.swipe#event:swipe}\r\n  * @property {function} [swipeLeft=null] A handler that is triggered for \"left\" swipes. See {@link $.fn.swipe#event:swipeLeft}\r\n  * @property {function} [swipeRight=null] A handler that is triggered for \"right\" swipes. See {@link $.fn.swipe#event:swipeRight}\r\n  * @property {function} [swipeUp=null] A handler that is triggered for \"up\" swipes. See {@link $.fn.swipe#event:swipeUp}\r\n  * @property {function} [swipeDown=null] A handler that is triggered for \"down\" swipes. See {@link $.fn.swipe#event:swipeDown}\r\n  * @property {function} [swipeStatus=null] A handler triggered for every phase of the swipe. See {@link $.fn.swipe#event:swipeStatus}\r\n  * @property {function} [pinchIn=null] A handler triggered for pinch in events. See {@link $.fn.swipe#event:pinchIn}\r\n  * @property {function} [pinchOut=null] A handler triggered for pinch out events. See {@link $.fn.swipe#event:pinchOut}\r\n  * @property {function} [pinchStatus=null] A handler triggered for every phase of a pinch. See {@link $.fn.swipe#event:pinchStatus}\r\n  * @property {function} [tap=null] A handler triggered when a user just taps on the item, rather than swipes it. If they do not move, tap is triggered, if they do move, it is not.\r\n  * @property {function} [doubleTap=null] A handler triggered when a user double taps on the item. The delay between taps can be set with the doubleTapThreshold property. See {@link $.fn.swipe.defaults#doubleTapThreshold}\r\n  * @property {function} [longTap=null] A handler triggered when a user long taps on the item. The delay between start and end can be set with the longTapThreshold property. See {@link $.fn.swipe.defaults#longTapThreshold}\r\n  * @property (function) [hold=null] A handler triggered when a user reaches longTapThreshold on the item. See {@link $.fn.swipe.defaults#longTapThreshold}\r\n  * @property {boolean} [triggerOnTouchEnd=true] If true, the swipe events are triggered when the touch end event is received (user releases finger).  If false, it will be triggered on reaching the threshold, and then cancel the touch event automatically.\r\n  * @property {boolean} [triggerOnTouchLeave=false] If true, then when the user leaves the swipe object, the swipe will end and trigger appropriate handlers.\r\n  * @property {string|undefined} [allowPageScroll='auto'] How the browser handles page scrolls when the user is swiping on a touchSwipe object. See {@link $.fn.swipe.pageScroll}.  <br/><br/>\r\n  \t\t\t\t\t\t\t\t\t<code>\"auto\"</code> : all undefined swipes will cause the page to scroll in that direction. <br/>\r\n  \t\t\t\t\t\t\t\t\t<code>\"none\"</code> : the page will not scroll when user swipes. <br/>\r\n  \t\t\t\t\t\t\t\t\t<code>\"horizontal\"</code> : will force page to scroll on horizontal swipes. <br/>\r\n  \t\t\t\t\t\t\t\t\t<code>\"vertical\"</code> : will force page to scroll on vertical swipes. <br/>\r\n  * @property {boolean} [fallbackToMouseEvents=true] If true mouse events are used when run on a non touch device, false will stop swipes being triggered by mouse events on non touch devices.\r\n  * @property {string} [excludedElements=\".noSwipe\"] A jquery selector that specifies child elements that do NOT trigger swipes. By default this excludes elements with the class .noSwipe .\r\n  * @property {boolean} [preventDefaultEvents=true] by default default events are cancelled, so the page doesn't move.  You can disable this so both native events fire as well as your handlers.\r\n\r\n  */\r\n  var defaults = {\r\n    fingers: 1,\r\n    threshold: 75,\r\n    cancelThreshold: null,\r\n    pinchThreshold: 20,\r\n    maxTimeThreshold: null,\r\n    fingerReleaseThreshold: 250,\r\n    longTapThreshold: 500,\r\n    doubleTapThreshold: 200,\r\n    swipe: null,\r\n    swipeLeft: null,\r\n    swipeRight: null,\r\n    swipeUp: null,\r\n    swipeDown: null,\r\n    swipeStatus: null,\r\n    pinchIn: null,\r\n    pinchOut: null,\r\n    pinchStatus: null,\r\n    click: null, //Deprecated since 1.6.2\r\n    tap: null,\r\n    doubleTap: null,\r\n    longTap: null,\r\n    hold: null,\r\n    triggerOnTouchEnd: true,\r\n    triggerOnTouchLeave: false,\r\n    allowPageScroll: \"auto\",\r\n    fallbackToMouseEvents: true,\r\n    excludedElements: \".noSwipe\",\r\n    preventDefaultEvents: true\r\n  };\r\n\r\n\r\n\r\n  /**\r\n   * Applies TouchSwipe behaviour to one or more jQuery objects.\r\n   * The TouchSwipe plugin can be instantiated via this method, or methods within\r\n   * TouchSwipe can be executed via this method as per jQuery plugin architecture.\r\n   * An existing plugin can have its options changed simply by re calling .swipe(options)\r\n   * @see TouchSwipe\r\n   * @class\r\n   * @param {Mixed} method If the current DOMNode is a TouchSwipe object, and <code>method</code> is a TouchSwipe method, then\r\n   * the <code>method</code> is executed, and any following arguments are passed to the TouchSwipe method.\r\n   * If <code>method</code> is an object, then the TouchSwipe class is instantiated on the current DOMNode, passing the\r\n   * configuration properties defined in the object. See TouchSwipe\r\n   *\r\n   */\r\n  $.fn.swipe = function(method) {\r\n    var $this = $(this),\r\n      plugin = $this.data(PLUGIN_NS);\r\n\r\n    //Check if we are already instantiated and trying to execute a method\r\n    if (plugin && typeof method === 'string') {\r\n      if (plugin[method]) {\r\n        return plugin[method].apply(plugin, Array.prototype.slice.call(arguments, 1));\r\n      } else {\r\n        $.error('Method ' + method + ' does not exist on jQuery.swipe');\r\n      }\r\n    }\r\n\r\n    //Else update existing plugin with new options hash\r\n    else if (plugin && typeof method === 'object') {\r\n      plugin['option'].apply(plugin, arguments);\r\n    }\r\n\r\n    //Else not instantiated and trying to pass init object (or nothing)\r\n    else if (!plugin && (typeof method === 'object' || !method)) {\r\n      return init.apply(this, arguments);\r\n    }\r\n\r\n    return $this;\r\n  };\r\n\r\n  /**\r\n   * The version of the plugin\r\n   * @readonly\r\n   */\r\n  $.fn.swipe.version = VERSION;\r\n\r\n\r\n\r\n  //Expose our defaults so a user could override the plugin defaults\r\n  $.fn.swipe.defaults = defaults;\r\n\r\n  /**\r\n   * The phases that a touch event goes through.  The <code>phase</code> is passed to the event handlers.\r\n   * These properties are read only, attempting to change them will not alter the values passed to the event handlers.\r\n   * @namespace\r\n   * @readonly\r\n   * @property {string} PHASE_START Constant indicating the start phase of the touch event. Value is <code>\"start\"</code>.\r\n   * @property {string} PHASE_MOVE Constant indicating the move phase of the touch event. Value is <code>\"move\"</code>.\r\n   * @property {string} PHASE_END Constant indicating the end phase of the touch event. Value is <code>\"end\"</code>.\r\n   * @property {string} PHASE_CANCEL Constant indicating the cancel phase of the touch event. Value is <code>\"cancel\"</code>.\r\n   */\r\n  $.fn.swipe.phases = {\r\n    PHASE_START: PHASE_START,\r\n    PHASE_MOVE: PHASE_MOVE,\r\n    PHASE_END: PHASE_END,\r\n    PHASE_CANCEL: PHASE_CANCEL\r\n  };\r\n\r\n  /**\r\n   * The direction constants that are passed to the event handlers.\r\n   * These properties are read only, attempting to change them will not alter the values passed to the event handlers.\r\n   * @namespace\r\n   * @readonly\r\n   * @property {string} LEFT Constant indicating the left direction. Value is <code>\"left\"</code>.\r\n   * @property {string} RIGHT Constant indicating the right direction. Value is <code>\"right\"</code>.\r\n   * @property {string} UP Constant indicating the up direction. Value is <code>\"up\"</code>.\r\n   * @property {string} DOWN Constant indicating the down direction. Value is <code>\"cancel\"</code>.\r\n   * @property {string} IN Constant indicating the in direction. Value is <code>\"in\"</code>.\r\n   * @property {string} OUT Constant indicating the out direction. Value is <code>\"out\"</code>.\r\n   */\r\n  $.fn.swipe.directions = {\r\n    LEFT: LEFT,\r\n    RIGHT: RIGHT,\r\n    UP: UP,\r\n    DOWN: DOWN,\r\n    IN: IN,\r\n    OUT: OUT\r\n  };\r\n\r\n  /**\r\n   * The page scroll constants that can be used to set the value of <code>allowPageScroll</code> option\r\n   * These properties are read only\r\n   * @namespace\r\n   * @readonly\r\n   * @see $.fn.swipe.defaults#allowPageScroll\r\n   * @property {string} NONE Constant indicating no page scrolling is allowed. Value is <code>\"none\"</code>.\r\n   * @property {string} HORIZONTAL Constant indicating horizontal page scrolling is allowed. Value is <code>\"horizontal\"</code>.\r\n   * @property {string} VERTICAL Constant indicating vertical page scrolling is allowed. Value is <code>\"vertical\"</code>.\r\n   * @property {string} AUTO Constant indicating either horizontal or vertical will be allowed, depending on the swipe handlers registered. Value is <code>\"auto\"</code>.\r\n   */\r\n  $.fn.swipe.pageScroll = {\r\n    NONE: NONE,\r\n    HORIZONTAL: HORIZONTAL,\r\n    VERTICAL: VERTICAL,\r\n    AUTO: AUTO\r\n  };\r\n\r\n  /**\r\n   * Constants representing the number of fingers used in a swipe.  These are used to set both the value of <code>fingers</code> in the\r\n   * options object, as well as the value of the <code>fingers</code> event property.\r\n   * These properties are read only, attempting to change them will not alter the values passed to the event handlers.\r\n   * @namespace\r\n   * @readonly\r\n   * @see $.fn.swipe.defaults#fingers\r\n   * @property {string} ONE Constant indicating 1 finger is to be detected / was detected. Value is <code>1</code>.\r\n   * @property {string} TWO Constant indicating 2 fingers are to be detected / were detected. Value is <code>2</code>.\r\n   * @property {string} THREE Constant indicating 3 finger are to be detected / were detected. Value is <code>3</code>.\r\n   * @property {string} FOUR Constant indicating 4 finger are to be detected / were detected. Not all devices support this. Value is <code>4</code>.\r\n   * @property {string} FIVE Constant indicating 5 finger are to be detected / were detected. Not all devices support this. Value is <code>5</code>.\r\n   * @property {string} ALL Constant indicating any combination of finger are to be detected.  Value is <code>\"all\"</code>.\r\n   */\r\n  $.fn.swipe.fingers = {\r\n    ONE: 1,\r\n    TWO: 2,\r\n    THREE: 3,\r\n    FOUR: 4,\r\n    FIVE: 5,\r\n    ALL: ALL_FINGERS\r\n  };\r\n\r\n  /**\r\n   * Initialise the plugin for each DOM element matched\r\n   * This creates a new instance of the main TouchSwipe class for each DOM element, and then\r\n   * saves a reference to that instance in the elements data property.\r\n   * @internal\r\n   */\r\n  function init(options) {\r\n    //Prep and extend the options\r\n    if (options && (options.allowPageScroll === undefined && (options.swipe !== undefined || options.swipeStatus !== undefined))) {\r\n      options.allowPageScroll = NONE;\r\n    }\r\n\r\n    //Check for deprecated options\r\n    //Ensure that any old click handlers are assigned to the new tap, unless we have a tap\r\n    if (options.click !== undefined && options.tap === undefined) {\r\n      options.tap = options.click;\r\n    }\r\n\r\n    if (!options) {\r\n      options = {};\r\n    }\r\n\r\n    //pass empty object so we dont modify the defaults\r\n    options = $.extend({}, $.fn.swipe.defaults, options);\r\n\r\n    //For each element instantiate the plugin\r\n    return this.each(function() {\r\n      var $this = $(this);\r\n\r\n      //Check we havent already initialised the plugin\r\n      var plugin = $this.data(PLUGIN_NS);\r\n\r\n      if (!plugin) {\r\n        plugin = new TouchSwipe(this, options);\r\n        $this.data(PLUGIN_NS, plugin);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Main TouchSwipe Plugin Class.\r\n   * Do not use this to construct your TouchSwipe object, use the jQuery plugin method $.fn.swipe(); {@link $.fn.swipe}\r\n   * @private\r\n   * @name TouchSwipe\r\n   * @param {DOMNode} element The HTML DOM object to apply to plugin to\r\n   * @param {Object} options The options to configure the plugin with.  @link {$.fn.swipe.defaults}\r\n   * @see $.fh.swipe.defaults\r\n   * @see $.fh.swipe\r\n   * @class\r\n   */\r\n  function TouchSwipe(element, options) {\r\n\r\n    //take a local/instacne level copy of the options - should make it this.options really...\r\n    var options = $.extend({}, options);\r\n\r\n    var useTouchEvents = (SUPPORTS_TOUCH || SUPPORTS_POINTER || !options.fallbackToMouseEvents),\r\n      START_EV = useTouchEvents ? (SUPPORTS_POINTER ? (SUPPORTS_POINTER_IE10 ? 'MSPointerDown' : 'pointerdown') : 'touchstart') : 'mousedown',\r\n      MOVE_EV = useTouchEvents ? (SUPPORTS_POINTER ? (SUPPORTS_POINTER_IE10 ? 'MSPointerMove' : 'pointermove') : 'touchmove') : 'mousemove',\r\n      END_EV = useTouchEvents ? (SUPPORTS_POINTER ? (SUPPORTS_POINTER_IE10 ? 'MSPointerUp' : 'pointerup') : 'touchend') : 'mouseup',\r\n      LEAVE_EV = useTouchEvents ? (SUPPORTS_POINTER ? 'mouseleave' : null) : 'mouseleave', //we manually detect leave on touch devices, so null event here\r\n      CANCEL_EV = (SUPPORTS_POINTER ? (SUPPORTS_POINTER_IE10 ? 'MSPointerCancel' : 'pointercancel') : 'touchcancel');\r\n\r\n\r\n\r\n    //touch properties\r\n    var distance = 0,\r\n      direction = null,\r\n      currentDirection = null,\r\n      duration = 0,\r\n      startTouchesDistance = 0,\r\n      endTouchesDistance = 0,\r\n      pinchZoom = 1,\r\n      pinchDistance = 0,\r\n      pinchDirection = 0,\r\n      maximumsMap = null;\r\n\r\n\r\n\r\n    //jQuery wrapped element for this instance\r\n    var $element = $(element);\r\n\r\n    //Current phase of th touch cycle\r\n    var phase = \"start\";\r\n\r\n    // the current number of fingers being used.\r\n    var fingerCount = 0;\r\n\r\n    //track mouse points / delta\r\n    var fingerData = {};\r\n\r\n    //track times\r\n    var startTime = 0,\r\n      endTime = 0,\r\n      previousTouchEndTime = 0,\r\n      fingerCountAtRelease = 0,\r\n      doubleTapStartTime = 0;\r\n\r\n    //Timeouts\r\n    var singleTapTimeout = null,\r\n      holdTimeout = null;\r\n\r\n    // Add gestures to all swipable areas if supported\r\n    try {\r\n      $element.bind(START_EV, touchStart);\r\n      $element.bind(CANCEL_EV, touchCancel);\r\n    } catch (e) {\r\n      $.error('events not supported ' + START_EV + ',' + CANCEL_EV + ' on jQuery.swipe');\r\n    }\r\n\r\n    //\r\n    //Public methods\r\n    //\r\n\r\n    /**\r\n     * re-enables the swipe plugin with the previous configuration\r\n     * @function\r\n     * @name $.fn.swipe#enable\r\n     * @return {DOMNode} The Dom element that was registered with TouchSwipe\r\n     * @example $(\"#element\").swipe(\"enable\");\r\n     */\r\n    this.enable = function() {\r\n      //Incase we are already enabled, clean up...\r\n      this.disable();\r\n      $element.bind(START_EV, touchStart);\r\n      $element.bind(CANCEL_EV, touchCancel);\r\n      return $element;\r\n    };\r\n\r\n    /**\r\n     * disables the swipe plugin\r\n     * @function\r\n     * @name $.fn.swipe#disable\r\n     * @return {DOMNode} The Dom element that is now registered with TouchSwipe\r\n     * @example $(\"#element\").swipe(\"disable\");\r\n     */\r\n    this.disable = function() {\r\n      removeListeners();\r\n      return $element;\r\n    };\r\n\r\n    /**\r\n     * Destroy the swipe plugin completely. To use any swipe methods, you must re initialise the plugin.\r\n     * @function\r\n     * @name $.fn.swipe#destroy\r\n     * @example $(\"#element\").swipe(\"destroy\");\r\n     */\r\n    this.destroy = function() {\r\n      removeListeners();\r\n      $element.data(PLUGIN_NS, null);\r\n      $element = null;\r\n    };\r\n\r\n\r\n    /**\r\n     * Allows run time updating of the swipe configuration options.\r\n     * @function\r\n     * @name $.fn.swipe#option\r\n     * @param {String} property The option property to get or set, or a has of multiple options to set\r\n     * @param {Object} [value] The value to set the property to\r\n     * @return {Object} If only a property name is passed, then that property value is returned. If nothing is passed the current options hash is returned.\r\n     * @example $(\"#element\").swipe(\"option\", \"threshold\"); // return the threshold\r\n     * @example $(\"#element\").swipe(\"option\", \"threshold\", 100); // set the threshold after init\r\n     * @example $(\"#element\").swipe(\"option\", {threshold:100, fingers:3} ); // set multiple properties after init\r\n     * @example $(\"#element\").swipe({threshold:100, fingers:3} ); // set multiple properties after init - the \"option\" method is optional!\r\n     * @example $(\"#element\").swipe(\"option\"); // Return the current options hash\r\n     * @see $.fn.swipe.defaults\r\n     *\r\n     */\r\n    this.option = function(property, value) {\r\n\r\n      if (typeof property === 'object') {\r\n        options = $.extend(options, property);\r\n      } else if (options[property] !== undefined) {\r\n        if (value === undefined) {\r\n          return options[property];\r\n        } else {\r\n          options[property] = value;\r\n        }\r\n      } else if (!property) {\r\n        return options;\r\n      } else {\r\n        $.error('Option ' + property + ' does not exist on jQuery.swipe.options');\r\n      }\r\n\r\n      return null;\r\n    }\r\n\r\n\r\n\r\n    //\r\n    // Private methods\r\n    //\r\n\r\n    //\r\n    // EVENTS\r\n    //\r\n    /**\r\n     * Event handler for a touch start event.\r\n     * Stops the default click event from triggering and stores where we touched\r\n     * @inner\r\n     * @param {object} jqEvent The normalised jQuery event object.\r\n     */\r\n    function touchStart(jqEvent) {\r\n\r\n      //If we already in a touch event (a finger already in use) then ignore subsequent ones..\r\n      if (getTouchInProgress()) {\r\n        return;\r\n      }\r\n\r\n      //Check if this element matches any in the excluded elements selectors,  or its parent is excluded, if so, DON'T swipe\r\n      if ($(jqEvent.target).closest(options.excludedElements, $element).length > 0) {\r\n        return;\r\n      }\r\n\r\n      //As we use Jquery bind for events, we need to target the original event object\r\n      //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.\r\n      var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent;\r\n\r\n\r\n      //If we have a pointer event, whoes type is 'mouse' and we have said NO mouse events, then dont do anything.\r\n      if(event.pointerType && event.pointerType==\"mouse\" && options.fallbackToMouseEvents==false) {\r\n        return;\r\n      };\r\n\r\n      var ret,\r\n        touches = event.touches,\r\n        evt = touches ? touches[0] : event;\r\n\r\n      phase = PHASE_START;\r\n\r\n      //If we support touches, get the finger count\r\n      if (touches) {\r\n        // get the total number of fingers touching the screen\r\n        fingerCount = touches.length;\r\n      }\r\n      //Else this is the desktop, so stop the browser from dragging content\r\n      else if (options.preventDefaultEvents !== false) {\r\n        jqEvent.preventDefault(); //call this on jq event so we are cross browser\r\n      }\r\n\r\n      //clear vars..\r\n      distance = 0;\r\n      direction = null;\r\n      currentDirection=null;\r\n      pinchDirection = null;\r\n      duration = 0;\r\n      startTouchesDistance = 0;\r\n      endTouchesDistance = 0;\r\n      pinchZoom = 1;\r\n      pinchDistance = 0;\r\n      maximumsMap = createMaximumsData();\r\n      cancelMultiFingerRelease();\r\n\r\n      //Create the default finger data\r\n      createFingerData(0, evt);\r\n\r\n      // check the number of fingers is what we are looking for, or we are capturing pinches\r\n      if (!touches || (fingerCount === options.fingers || options.fingers === ALL_FINGERS) || hasPinches()) {\r\n        // get the coordinates of the touch\r\n        startTime = getTimeStamp();\r\n\r\n        if (fingerCount == 2) {\r\n          //Keep track of the initial pinch distance, so we can calculate the diff later\r\n          //Store second finger data as start\r\n          createFingerData(1, touches[1]);\r\n          startTouchesDistance = endTouchesDistance = calculateTouchesDistance(fingerData[0].start, fingerData[1].start);\r\n        }\r\n\r\n        if (options.swipeStatus || options.pinchStatus) {\r\n          ret = triggerHandler(event, phase);\r\n        }\r\n      } else {\r\n        //A touch with more or less than the fingers we are looking for, so cancel\r\n        ret = false;\r\n      }\r\n\r\n      //If we have a return value from the users handler, then return and cancel\r\n      if (ret === false) {\r\n        phase = PHASE_CANCEL;\r\n        triggerHandler(event, phase);\r\n        return ret;\r\n      } else {\r\n        if (options.hold) {\r\n          holdTimeout = setTimeout($.proxy(function() {\r\n            //Trigger the event\r\n            $element.trigger('hold', [event.target]);\r\n            //Fire the callback\r\n            if (options.hold) {\r\n              ret = options.hold.call($element, event, event.target);\r\n            }\r\n          }, this), options.longTapThreshold);\r\n        }\r\n\r\n        setTouchInProgress(true);\r\n      }\r\n\r\n      return null;\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * Event handler for a touch move event.\r\n     * If we change fingers during move, then cancel the event\r\n     * @inner\r\n     * @param {object} jqEvent The normalised jQuery event object.\r\n     */\r\n    function touchMove(jqEvent) {\r\n\r\n      //As we use Jquery bind for events, we need to target the original event object\r\n      //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.\r\n      var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent;\r\n\r\n      //If we are ending, cancelling, or within the threshold of 2 fingers being released, don't track anything..\r\n      if (phase === PHASE_END || phase === PHASE_CANCEL || inMultiFingerRelease())\r\n        return;\r\n\r\n      var ret,\r\n        touches = event.touches,\r\n        evt = touches ? touches[0] : event;\r\n\r\n\r\n      //Update the  finger data\r\n      var currentFinger = updateFingerData(evt);\r\n      endTime = getTimeStamp();\r\n\r\n      if (touches) {\r\n        fingerCount = touches.length;\r\n      }\r\n\r\n      if (options.hold) {\r\n        clearTimeout(holdTimeout);\r\n      }\r\n\r\n      phase = PHASE_MOVE;\r\n\r\n      //If we have 2 fingers get Touches distance as well\r\n      if (fingerCount == 2) {\r\n\r\n        //Keep track of the initial pinch distance, so we can calculate the diff later\r\n        //We do this here as well as the start event, in case they start with 1 finger, and the press 2 fingers\r\n        if (startTouchesDistance == 0) {\r\n          //Create second finger if this is the first time...\r\n          createFingerData(1, touches[1]);\r\n\r\n          startTouchesDistance = endTouchesDistance = calculateTouchesDistance(fingerData[0].start, fingerData[1].start);\r\n        } else {\r\n          //Else just update the second finger\r\n          updateFingerData(touches[1]);\r\n\r\n          endTouchesDistance = calculateTouchesDistance(fingerData[0].end, fingerData[1].end);\r\n          pinchDirection = calculatePinchDirection(fingerData[0].end, fingerData[1].end);\r\n        }\r\n\r\n        pinchZoom = calculatePinchZoom(startTouchesDistance, endTouchesDistance);\r\n        pinchDistance = Math.abs(startTouchesDistance - endTouchesDistance);\r\n      }\r\n\r\n      if ((fingerCount === options.fingers || options.fingers === ALL_FINGERS) || !touches || hasPinches()) {\r\n\r\n        //The overall direction of the swipe. From start to now.\r\n        direction = calculateDirection(currentFinger.start, currentFinger.end);\r\n\r\n        //The immediate direction of the swipe, direction between the last movement and this one.\r\n        currentDirection = calculateDirection(currentFinger.last, currentFinger.end);\r\n\r\n        //Check if we need to prevent default event (page scroll / pinch zoom) or not\r\n        validateDefaultEvent(jqEvent, currentDirection);\r\n\r\n        //Distance and duration are all off the main finger\r\n        distance = calculateDistance(currentFinger.start, currentFinger.end);\r\n        duration = calculateDuration();\r\n\r\n        //Cache the maximum distance we made in this direction\r\n        setMaxDistance(direction, distance);\r\n\r\n        //Trigger status handler\r\n        ret = triggerHandler(event, phase);\r\n\r\n\r\n        //If we trigger end events when threshold are met, or trigger events when touch leaves element\r\n        if (!options.triggerOnTouchEnd || options.triggerOnTouchLeave) {\r\n\r\n          var inBounds = true;\r\n\r\n          //If checking if we leave the element, run the bounds check (we can use touchleave as its not supported on webkit)\r\n          if (options.triggerOnTouchLeave) {\r\n            var bounds = getbounds(this);\r\n            inBounds = isInBounds(currentFinger.end, bounds);\r\n          }\r\n\r\n          //Trigger end handles as we swipe if thresholds met or if we have left the element if the user has asked to check these..\r\n          if (!options.triggerOnTouchEnd && inBounds) {\r\n            phase = getNextPhase(PHASE_MOVE);\r\n          }\r\n          //We end if out of bounds here, so set current phase to END, and check if its modified\r\n          else if (options.triggerOnTouchLeave && !inBounds) {\r\n            phase = getNextPhase(PHASE_END);\r\n          }\r\n\r\n          if (phase == PHASE_CANCEL || phase == PHASE_END) {\r\n            triggerHandler(event, phase);\r\n          }\r\n        }\r\n      } else {\r\n        phase = PHASE_CANCEL;\r\n        triggerHandler(event, phase);\r\n      }\r\n\r\n      if (ret === false) {\r\n        phase = PHASE_CANCEL;\r\n        triggerHandler(event, phase);\r\n      }\r\n    }\r\n\r\n\r\n\r\n\r\n    /**\r\n     * Event handler for a touch end event.\r\n     * Calculate the direction and trigger events\r\n     * @inner\r\n     * @param {object} jqEvent The normalised jQuery event object.\r\n     */\r\n    function touchEnd(jqEvent) {\r\n      //As we use Jquery bind for events, we need to target the original event object\r\n      //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.\r\n      var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent,\r\n        touches = event.touches;\r\n\r\n      //If we are still in a touch with the device wait a fraction and see if the other finger comes up\r\n      //if it does within the threshold, then we treat it as a multi release, not a single release and end the touch / swipe\r\n      if (touches) {\r\n        if (touches.length && !inMultiFingerRelease()) {\r\n          startMultiFingerRelease(event);\r\n          return true;\r\n        } else if (touches.length && inMultiFingerRelease()) {\r\n          return true;\r\n        }\r\n      }\r\n\r\n      //If a previous finger has been released, check how long ago, if within the threshold, then assume it was a multifinger release.\r\n      //This is used to allow 2 fingers to release fractionally after each other, whilst maintaining the event as containing 2 fingers, not 1\r\n      if (inMultiFingerRelease()) {\r\n        fingerCount = fingerCountAtRelease;\r\n      }\r\n\r\n      //Set end of swipe\r\n      endTime = getTimeStamp();\r\n\r\n      //Get duration incase move was never fired\r\n      duration = calculateDuration();\r\n\r\n      //If we trigger handlers at end of swipe OR, we trigger during, but they didnt trigger and we are still in the move phase\r\n      if (didSwipeBackToCancel() || !validateSwipeDistance()) {\r\n        phase = PHASE_CANCEL;\r\n        triggerHandler(event, phase);\r\n      } else if (options.triggerOnTouchEnd || (options.triggerOnTouchEnd === false && phase === PHASE_MOVE)) {\r\n        //call this on jq event so we are cross browser\r\n        if (options.preventDefaultEvents !== false && jqEvent.cancelable !== false) {\r\n          jqEvent.preventDefault();\r\n        }\r\n        phase = PHASE_END;\r\n        triggerHandler(event, phase);\r\n      }\r\n      //Special cases - A tap should always fire on touch end regardless,\r\n      //So here we manually trigger the tap end handler by itself\r\n      //We dont run trigger handler as it will re-trigger events that may have fired already\r\n      else if (!options.triggerOnTouchEnd && hasTap()) {\r\n        //Trigger the pinch events...\r\n        phase = PHASE_END;\r\n        triggerHandlerForGesture(event, phase, TAP);\r\n      } else if (phase === PHASE_MOVE) {\r\n        phase = PHASE_CANCEL;\r\n        triggerHandler(event, phase);\r\n      }\r\n\r\n      setTouchInProgress(false);\r\n\r\n      return null;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Event handler for a touch cancel event.\r\n     * Clears current vars\r\n     * @inner\r\n     */\r\n    function touchCancel() {\r\n      // reset the variables back to default values\r\n      fingerCount = 0;\r\n      endTime = 0;\r\n      startTime = 0;\r\n      startTouchesDistance = 0;\r\n      endTouchesDistance = 0;\r\n      pinchZoom = 1;\r\n\r\n      //If we were in progress of tracking a possible multi touch end, then re set it.\r\n      cancelMultiFingerRelease();\r\n\r\n      setTouchInProgress(false);\r\n    }\r\n\r\n\r\n    /**\r\n     * Event handler for a touch leave event.\r\n     * This is only triggered on desktops, in touch we work this out manually\r\n     * as the touchleave event is not supported in webkit\r\n     * @inner\r\n     */\r\n    function touchLeave(jqEvent) {\r\n      //If these events are being programmatically triggered, we don't have an original event object, so use the Jq one.\r\n      var event = jqEvent.originalEvent ? jqEvent.originalEvent : jqEvent;\r\n\r\n      //If we have the trigger on leave property set....\r\n      if (options.triggerOnTouchLeave) {\r\n        phase = getNextPhase(PHASE_END);\r\n        triggerHandler(event, phase);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Removes all listeners that were associated with the plugin\r\n     * @inner\r\n     */\r\n    function removeListeners() {\r\n      $element.unbind(START_EV, touchStart);\r\n      $element.unbind(CANCEL_EV, touchCancel);\r\n      $element.unbind(MOVE_EV, touchMove);\r\n      $element.unbind(END_EV, touchEnd);\r\n\r\n      //we only have leave events on desktop, we manually calculate leave on touch as its not supported in webkit\r\n      if (LEAVE_EV) {\r\n        $element.unbind(LEAVE_EV, touchLeave);\r\n      }\r\n\r\n      setTouchInProgress(false);\r\n    }\r\n\r\n\r\n    /**\r\n     * Checks if the time and distance thresholds have been met, and if so then the appropriate handlers are fired.\r\n     */\r\n    function getNextPhase(currentPhase) {\r\n\r\n      var nextPhase = currentPhase;\r\n\r\n      // Ensure we have valid swipe (under time and over distance  and check if we are out of bound...)\r\n      var validTime = validateSwipeTime();\r\n      var validDistance = validateSwipeDistance();\r\n      var didCancel = didSwipeBackToCancel();\r\n\r\n      //If we have exceeded our time, then cancel\r\n      if (!validTime || didCancel) {\r\n        nextPhase = PHASE_CANCEL;\r\n      }\r\n      //Else if we are moving, and have reached distance then end\r\n      else if (validDistance && currentPhase == PHASE_MOVE && (!options.triggerOnTouchEnd || options.triggerOnTouchLeave)) {\r\n        nextPhase = PHASE_END;\r\n      }\r\n      //Else if we have ended by leaving and didn't reach distance, then cancel\r\n      else if (!validDistance && currentPhase == PHASE_END && options.triggerOnTouchLeave) {\r\n        nextPhase = PHASE_CANCEL;\r\n      }\r\n\r\n      return nextPhase;\r\n    }\r\n\r\n\r\n    /**\r\n     * Trigger the relevant event handler\r\n     * The handlers are passed the original event, the element that was swiped, and in the case of the catch all handler, the direction that was swiped, \"left\", \"right\", \"up\", or \"down\"\r\n     * @param {object} event the original event object\r\n     * @param {string} phase the phase of the swipe (start, end cancel etc) {@link $.fn.swipe.phases}\r\n     * @inner\r\n     */\r\n    function triggerHandler(event, phase) {\r\n\r\n\r\n\r\n      var ret,\r\n        touches = event.touches;\r\n\r\n      // SWIPE GESTURES\r\n      if (didSwipe() || hasSwipes()) {\r\n          ret = triggerHandlerForGesture(event, phase, SWIPE);\r\n      }\r\n\r\n      // PINCH GESTURES (if the above didn't cancel)\r\n      if ((didPinch() || hasPinches()) && ret !== false) {\r\n          ret = triggerHandlerForGesture(event, phase, PINCH);\r\n      }\r\n\r\n      // CLICK / TAP (if the above didn't cancel)\r\n      if (didDoubleTap() && ret !== false) {\r\n        //Trigger the tap events...\r\n        ret = triggerHandlerForGesture(event, phase, DOUBLE_TAP);\r\n      }\r\n\r\n      // CLICK / TAP (if the above didn't cancel)\r\n      else if (didLongTap() && ret !== false) {\r\n        //Trigger the tap events...\r\n        ret = triggerHandlerForGesture(event, phase, LONG_TAP);\r\n      }\r\n\r\n      // CLICK / TAP (if the above didn't cancel)\r\n      else if (didTap() && ret !== false) {\r\n        //Trigger the tap event..\r\n        ret = triggerHandlerForGesture(event, phase, TAP);\r\n      }\r\n\r\n\r\n\r\n      // If we are cancelling the gesture, then manually trigger the reset handler\r\n      if (phase === PHASE_CANCEL) {\r\n\r\n        touchCancel(event);\r\n      }\r\n\r\n\r\n\r\n\r\n      // If we are ending the gesture, then manually trigger the reset handler IF all fingers are off\r\n      if (phase === PHASE_END) {\r\n        //If we support touch, then check that all fingers are off before we cancel\r\n        if (touches) {\r\n          if (!touches.length) {\r\n            touchCancel(event);\r\n          }\r\n        } else {\r\n          touchCancel(event);\r\n        }\r\n      }\r\n\r\n      return ret;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Trigger the relevant event handler\r\n     * The handlers are passed the original event, the element that was swiped, and in the case of the catch all handler, the direction that was swiped, \"left\", \"right\", \"up\", or \"down\"\r\n     * @param {object} event the original event object\r\n     * @param {string} phase the phase of the swipe (start, end cancel etc) {@link $.fn.swipe.phases}\r\n     * @param {string} gesture the gesture to trigger a handler for : PINCH or SWIPE {@link $.fn.swipe.gestures}\r\n     * @return Boolean False, to indicate that the event should stop propagation, or void.\r\n     * @inner\r\n     */\r\n    function triggerHandlerForGesture(event, phase, gesture) {\r\n\r\n      var ret;\r\n\r\n      //SWIPES....\r\n      if (gesture == SWIPE) {\r\n        //Trigger status every time..\r\n        $element.trigger('swipeStatus', [phase, direction || null, distance || 0, duration || 0, fingerCount, fingerData, currentDirection]);\r\n\r\n        if (options.swipeStatus) {\r\n          ret = options.swipeStatus.call($element, event, phase, direction || null, distance || 0, duration || 0, fingerCount, fingerData, currentDirection);\r\n          //If the status cancels, then dont run the subsequent event handlers..\r\n          if (ret === false) return false;\r\n        }\r\n\r\n        if (phase == PHASE_END && validateSwipe()) {\r\n\r\n          //Cancel any taps that were in progress...\r\n          clearTimeout(singleTapTimeout);\r\n          clearTimeout(holdTimeout);\r\n\r\n          $element.trigger('swipe', [direction, distance, duration, fingerCount, fingerData, currentDirection]);\r\n\r\n          if (options.swipe) {\r\n            ret = options.swipe.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);\r\n            //If the status cancels, then dont run the subsequent event handlers..\r\n            if (ret === false) return false;\r\n          }\r\n\r\n          //trigger direction specific event handlers\r\n          switch (direction) {\r\n            case LEFT:\r\n              $element.trigger('swipeLeft', [direction, distance, duration, fingerCount, fingerData, currentDirection]);\r\n\r\n              if (options.swipeLeft) {\r\n                ret = options.swipeLeft.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);\r\n              }\r\n              break;\r\n\r\n            case RIGHT:\r\n              $element.trigger('swipeRight', [direction, distance, duration, fingerCount, fingerData, currentDirection]);\r\n\r\n              if (options.swipeRight) {\r\n                ret = options.swipeRight.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);\r\n              }\r\n              break;\r\n\r\n            case UP:\r\n              $element.trigger('swipeUp', [direction, distance, duration, fingerCount, fingerData, currentDirection]);\r\n\r\n              if (options.swipeUp) {\r\n                ret = options.swipeUp.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);\r\n              }\r\n              break;\r\n\r\n            case DOWN:\r\n              $element.trigger('swipeDown', [direction, distance, duration, fingerCount, fingerData, currentDirection]);\r\n\r\n              if (options.swipeDown) {\r\n                ret = options.swipeDown.call($element, event, direction, distance, duration, fingerCount, fingerData, currentDirection);\r\n              }\r\n              break;\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n      //PINCHES....\r\n      if (gesture == PINCH) {\r\n        $element.trigger('pinchStatus', [phase, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData]);\r\n\r\n        if (options.pinchStatus) {\r\n          ret = options.pinchStatus.call($element, event, phase, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData);\r\n          //If the status cancels, then dont run the subsequent event handlers..\r\n          if (ret === false) return false;\r\n        }\r\n\r\n        if (phase == PHASE_END && validatePinch()) {\r\n\r\n          switch (pinchDirection) {\r\n            case IN:\r\n              $element.trigger('pinchIn', [pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData]);\r\n\r\n              if (options.pinchIn) {\r\n                ret = options.pinchIn.call($element, event, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData);\r\n              }\r\n              break;\r\n\r\n            case OUT:\r\n              $element.trigger('pinchOut', [pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData]);\r\n\r\n              if (options.pinchOut) {\r\n                ret = options.pinchOut.call($element, event, pinchDirection || null, pinchDistance || 0, duration || 0, fingerCount, pinchZoom, fingerData);\r\n              }\r\n              break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (gesture == TAP) {\r\n        if (phase === PHASE_CANCEL || phase === PHASE_END) {\r\n\r\n          clearTimeout(singleTapTimeout);\r\n          clearTimeout(holdTimeout);\r\n\r\n          //If we are also looking for doubelTaps, wait incase this is one...\r\n          if (hasDoubleTap() && !inDoubleTap()) {\r\n            doubleTapStartTime = getTimeStamp();\r\n\r\n            //Now wait for the double tap timeout, and trigger this single tap\r\n            //if its not cancelled by a double tap\r\n            singleTapTimeout = setTimeout($.proxy(function() {\r\n              doubleTapStartTime = null;\r\n              $element.trigger('tap', [event.target]);\r\n\r\n              if (options.tap) {\r\n                ret = options.tap.call($element, event, event.target);\r\n              }\r\n            }, this), options.doubleTapThreshold);\r\n\r\n          } else {\r\n            doubleTapStartTime = null;\r\n            $element.trigger('tap', [event.target]);\r\n            if (options.tap) {\r\n              ret = options.tap.call($element, event, event.target);\r\n            }\r\n          }\r\n        }\r\n      } else if (gesture == DOUBLE_TAP) {\r\n        if (phase === PHASE_CANCEL || phase === PHASE_END) {\r\n          clearTimeout(singleTapTimeout);\r\n          clearTimeout(holdTimeout);\r\n          doubleTapStartTime = null;\r\n          $element.trigger('doubletap', [event.target]);\r\n\r\n          if (options.doubleTap) {\r\n            ret = options.doubleTap.call($element, event, event.target);\r\n          }\r\n        }\r\n      } else if (gesture == LONG_TAP) {\r\n        if (phase === PHASE_CANCEL || phase === PHASE_END) {\r\n          clearTimeout(singleTapTimeout);\r\n          doubleTapStartTime = null;\r\n\r\n          $element.trigger('longtap', [event.target]);\r\n          if (options.longTap) {\r\n            ret = options.longTap.call($element, event, event.target);\r\n          }\r\n        }\r\n      }\r\n\r\n      return ret;\r\n    }\r\n\r\n\r\n    //\r\n    // GESTURE VALIDATION\r\n    //\r\n\r\n    /**\r\n     * Checks the user has swipe far enough\r\n     * @return Boolean if <code>threshold</code> has been set, return true if the threshold was met, else false.\r\n     * If no threshold was set, then we return true.\r\n     * @inner\r\n     */\r\n    function validateSwipeDistance() {\r\n      var valid = true;\r\n      //If we made it past the min swipe distance..\r\n      if (options.threshold !== null) {\r\n        valid = distance >= options.threshold;\r\n      }\r\n\r\n      return valid;\r\n    }\r\n\r\n    /**\r\n     * Checks the user has swiped back to cancel.\r\n     * @return Boolean if <code>cancelThreshold</code> has been set, return true if the cancelThreshold was met, else false.\r\n     * If no cancelThreshold was set, then we return true.\r\n     * @inner\r\n     */\r\n    function didSwipeBackToCancel() {\r\n      var cancelled = false;\r\n      if (options.cancelThreshold !== null && direction !== null) {\r\n        cancelled = (getMaxDistance(direction) - distance) >= options.cancelThreshold;\r\n      }\r\n\r\n      return cancelled;\r\n    }\r\n\r\n    /**\r\n     * Checks the user has pinched far enough\r\n     * @return Boolean if <code>pinchThreshold</code> has been set, return true if the threshold was met, else false.\r\n     * If no threshold was set, then we return true.\r\n     * @inner\r\n     */\r\n    function validatePinchDistance() {\r\n      if (options.pinchThreshold !== null) {\r\n        return pinchDistance >= options.pinchThreshold;\r\n      }\r\n      return true;\r\n    }\r\n\r\n    /**\r\n     * Checks that the time taken to swipe meets the minimum / maximum requirements\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validateSwipeTime() {\r\n      var result;\r\n      //If no time set, then return true\r\n      if (options.maxTimeThreshold) {\r\n        if (duration >= options.maxTimeThreshold) {\r\n          result = false;\r\n        } else {\r\n          result = true;\r\n        }\r\n      } else {\r\n        result = true;\r\n      }\r\n\r\n      return result;\r\n    }\r\n\r\n\r\n    /**\r\n     * Checks direction of the swipe and the value allowPageScroll to see if we should allow or prevent the default behaviour from occurring.\r\n     * This will essentially allow page scrolling or not when the user is swiping on a touchSwipe object.\r\n     * @param {object} jqEvent The normalised jQuery representation of the event object.\r\n     * @param {string} direction The direction of the event. See {@link $.fn.swipe.directions}\r\n     * @see $.fn.swipe.directions\r\n     * @inner\r\n     */\r\n    function validateDefaultEvent(jqEvent, direction) {\r\n\r\n      //If the option is set, allways allow the event to bubble up (let user handle weirdness)\r\n      if (options.preventDefaultEvents === false) {\r\n        return;\r\n      }\r\n\r\n      if (options.allowPageScroll === NONE) {\r\n        jqEvent.preventDefault();\r\n      } else {\r\n        var auto = options.allowPageScroll === AUTO;\r\n\r\n        switch (direction) {\r\n          case LEFT:\r\n            if ((options.swipeLeft && auto) || (!auto && options.allowPageScroll != HORIZONTAL)) {\r\n              jqEvent.preventDefault();\r\n            }\r\n            break;\r\n\r\n          case RIGHT:\r\n            if ((options.swipeRight && auto) || (!auto && options.allowPageScroll != HORIZONTAL)) {\r\n              jqEvent.preventDefault();\r\n            }\r\n            break;\r\n\r\n          case UP:\r\n            if ((options.swipeUp && auto) || (!auto && options.allowPageScroll != VERTICAL)) {\r\n              jqEvent.preventDefault();\r\n            }\r\n            break;\r\n\r\n          case DOWN:\r\n            if ((options.swipeDown && auto) || (!auto && options.allowPageScroll != VERTICAL)) {\r\n              jqEvent.preventDefault();\r\n            }\r\n            break;\r\n\r\n          case NONE:\r\n\r\n            break;\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    // PINCHES\r\n    /**\r\n     * Returns true of the current pinch meets the thresholds\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validatePinch() {\r\n      var hasCorrectFingerCount = validateFingers();\r\n      var hasEndPoint = validateEndPoint();\r\n      var hasCorrectDistance = validatePinchDistance();\r\n      return hasCorrectFingerCount && hasEndPoint && hasCorrectDistance;\r\n\r\n    }\r\n\r\n    /**\r\n     * Returns true if any Pinch events have been registered\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function hasPinches() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(options.pinchStatus || options.pinchIn || options.pinchOut);\r\n    }\r\n\r\n    /**\r\n     * Returns true if we are detecting pinches, and have one\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function didPinch() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(validatePinch() && hasPinches());\r\n    }\r\n\r\n\r\n\r\n\r\n    // SWIPES\r\n    /**\r\n     * Returns true if the current swipe meets the thresholds\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validateSwipe() {\r\n      //Check validity of swipe\r\n      var hasValidTime = validateSwipeTime();\r\n      var hasValidDistance = validateSwipeDistance();\r\n      var hasCorrectFingerCount = validateFingers();\r\n      var hasEndPoint = validateEndPoint();\r\n      var didCancel = didSwipeBackToCancel();\r\n\r\n      // if the user swiped more than the minimum length, perform the appropriate action\r\n      // hasValidDistance is null when no distance is set\r\n      var valid = !didCancel && hasEndPoint && hasCorrectFingerCount && hasValidDistance && hasValidTime;\r\n\r\n      return valid;\r\n    }\r\n\r\n    /**\r\n     * Returns true if any Swipe events have been registered\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function hasSwipes() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(options.swipe || options.swipeStatus || options.swipeLeft || options.swipeRight || options.swipeUp || options.swipeDown);\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns true if we are detecting swipes and have one\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function didSwipe() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(validateSwipe() && hasSwipes());\r\n    }\r\n\r\n    /**\r\n     * Returns true if we have matched the number of fingers we are looking for\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validateFingers() {\r\n      //The number of fingers we want were matched, or on desktop we ignore\r\n      return ((fingerCount === options.fingers || options.fingers === ALL_FINGERS) || !SUPPORTS_TOUCH);\r\n    }\r\n\r\n    /**\r\n     * Returns true if we have an end point for the swipe\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validateEndPoint() {\r\n      //We have an end value for the finger\r\n      return fingerData[0].end.x !== 0;\r\n    }\r\n\r\n    // TAP / CLICK\r\n    /**\r\n     * Returns true if a click / tap events have been registered\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function hasTap() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(options.tap);\r\n    }\r\n\r\n    /**\r\n     * Returns true if a double tap events have been registered\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function hasDoubleTap() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(options.doubleTap);\r\n    }\r\n\r\n    /**\r\n     * Returns true if any long tap events have been registered\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function hasLongTap() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(options.longTap);\r\n    }\r\n\r\n    /**\r\n     * Returns true if we could be in the process of a double tap (one tap has occurred, we are listening for double taps, and the threshold hasn't past.\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validateDoubleTap() {\r\n      if (doubleTapStartTime == null) {\r\n        return false;\r\n      }\r\n      var now = getTimeStamp();\r\n      return (hasDoubleTap() && ((now - doubleTapStartTime) <= options.doubleTapThreshold));\r\n    }\r\n\r\n    /**\r\n     * Returns true if we could be in the process of a double tap (one tap has occurred, we are listening for double taps, and the threshold hasn't past.\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function inDoubleTap() {\r\n      return validateDoubleTap();\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns true if we have a valid tap\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validateTap() {\r\n      return ((fingerCount === 1 || !SUPPORTS_TOUCH) && (isNaN(distance) || distance < options.threshold));\r\n    }\r\n\r\n    /**\r\n     * Returns true if we have a valid long tap\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function validateLongTap() {\r\n      //slight threshold on moving finger\r\n      return ((duration > options.longTapThreshold) && (distance < DOUBLE_TAP_THRESHOLD));\r\n    }\r\n\r\n    /**\r\n     * Returns true if we are detecting taps and have one\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function didTap() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(validateTap() && hasTap());\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns true if we are detecting double taps and have one\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function didDoubleTap() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(validateDoubleTap() && hasDoubleTap());\r\n    }\r\n\r\n    /**\r\n     * Returns true if we are detecting long taps and have one\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function didLongTap() {\r\n      //Enure we dont return 0 or null for false values\r\n      return !!(validateLongTap() && hasLongTap());\r\n    }\r\n\r\n\r\n\r\n\r\n    // MULTI FINGER TOUCH\r\n    /**\r\n     * Starts tracking the time between 2 finger releases, and keeps track of how many fingers we initially had up\r\n     * @inner\r\n     */\r\n    function startMultiFingerRelease(event) {\r\n      previousTouchEndTime = getTimeStamp();\r\n      fingerCountAtRelease = event.touches.length + 1;\r\n    }\r\n\r\n    /**\r\n     * Cancels the tracking of time between 2 finger releases, and resets counters\r\n     * @inner\r\n     */\r\n    function cancelMultiFingerRelease() {\r\n      previousTouchEndTime = 0;\r\n      fingerCountAtRelease = 0;\r\n    }\r\n\r\n    /**\r\n     * Checks if we are in the threshold between 2 fingers being released\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function inMultiFingerRelease() {\r\n\r\n      var withinThreshold = false;\r\n\r\n      if (previousTouchEndTime) {\r\n        var diff = getTimeStamp() - previousTouchEndTime\r\n        if (diff <= options.fingerReleaseThreshold) {\r\n          withinThreshold = true;\r\n        }\r\n      }\r\n\r\n      return withinThreshold;\r\n    }\r\n\r\n\r\n    /**\r\n     * gets a data flag to indicate that a touch is in progress\r\n     * @return Boolean\r\n     * @inner\r\n     */\r\n    function getTouchInProgress() {\r\n      //strict equality to ensure only true and false are returned\r\n      return !!($element.data(PLUGIN_NS + '_intouch') === true);\r\n    }\r\n\r\n    /**\r\n     * Sets a data flag to indicate that a touch is in progress\r\n     * @param {boolean} val The value to set the property to\r\n     * @inner\r\n     */\r\n    function setTouchInProgress(val) {\r\n\r\n      //If destroy is called in an event handler, we have no el, and we have already cleaned up, so return.\r\n      if(!$element) { return; }\r\n\r\n      //Add or remove event listeners depending on touch status\r\n      if (val === true) {\r\n        $element.bind(MOVE_EV, touchMove);\r\n        $element.bind(END_EV, touchEnd);\r\n\r\n        //we only have leave events on desktop, we manually calcuate leave on touch as its not supported in webkit\r\n        if (LEAVE_EV) {\r\n          $element.bind(LEAVE_EV, touchLeave);\r\n        }\r\n      } else {\r\n\r\n        $element.unbind(MOVE_EV, touchMove, false);\r\n        $element.unbind(END_EV, touchEnd, false);\r\n\r\n        //we only have leave events on desktop, we manually calcuate leave on touch as its not supported in webkit\r\n        if (LEAVE_EV) {\r\n          $element.unbind(LEAVE_EV, touchLeave, false);\r\n        }\r\n      }\r\n\r\n\r\n      //strict equality to ensure only true and false can update the value\r\n      $element.data(PLUGIN_NS + '_intouch', val === true);\r\n    }\r\n\r\n\r\n    /**\r\n     * Creates the finger data for the touch/finger in the event object.\r\n     * @param {int} id The id to store the finger data under (usually the order the fingers were pressed)\r\n     * @param {object} evt The event object containing finger data\r\n     * @return finger data object\r\n     * @inner\r\n     */\r\n    function createFingerData(id, evt) {\r\n      var f = {\r\n        start: {\r\n          x: 0,\r\n          y: 0\r\n        },\r\n        last: {\r\n          x: 0,\r\n          y: 0\r\n        },\r\n        end: {\r\n          x: 0,\r\n          y: 0\r\n        }\r\n      };\r\n      f.start.x = f.last.x = f.end.x = evt.pageX || evt.clientX;\r\n      f.start.y = f.last.y = f.end.y = evt.pageY || evt.clientY;\r\n      fingerData[id] = f;\r\n      return f;\r\n    }\r\n\r\n    /**\r\n     * Updates the finger data for a particular event object\r\n     * @param {object} evt The event object containing the touch/finger data to upadte\r\n     * @return a finger data object.\r\n     * @inner\r\n     */\r\n    function updateFingerData(evt) {\r\n      var id = evt.identifier !== undefined ? evt.identifier : 0;\r\n      var f = getFingerData(id);\r\n\r\n      if (f === null) {\r\n        f = createFingerData(id, evt);\r\n      }\r\n\r\n      f.last.x = f.end.x;\r\n      f.last.y = f.end.y;\r\n\r\n      f.end.x = evt.pageX || evt.clientX;\r\n      f.end.y = evt.pageY || evt.clientY;\r\n\r\n      return f;\r\n    }\r\n\r\n    /**\r\n     * Returns a finger data object by its event ID.\r\n     * Each touch event has an identifier property, which is used\r\n     * to track repeat touches\r\n     * @param {int} id The unique id of the finger in the sequence of touch events.\r\n     * @return a finger data object.\r\n     * @inner\r\n     */\r\n    function getFingerData(id) {\r\n      return fingerData[id] || null;\r\n    }\r\n\r\n\r\n    /**\r\n     * Sets the maximum distance swiped in the given direction.\r\n     * If the new value is lower than the current value, the max value is not changed.\r\n     * @param {string}  direction The direction of the swipe\r\n     * @param {int}  distance The distance of the swipe\r\n     * @inner\r\n     */\r\n    function setMaxDistance(direction, distance) {\r\n      if(direction==NONE) return;\r\n      distance = Math.max(distance, getMaxDistance(direction));\r\n      maximumsMap[direction].distance = distance;\r\n    }\r\n\r\n    /**\r\n     * gets the maximum distance swiped in the given direction.\r\n     * @param {string}  direction The direction of the swipe\r\n     * @return int  The distance of the swipe\r\n     * @inner\r\n     */\r\n    function getMaxDistance(direction) {\r\n      if (maximumsMap[direction]) return maximumsMap[direction].distance;\r\n      return undefined;\r\n    }\r\n\r\n    /**\r\n     * Creats a map of directions to maximum swiped values.\r\n     * @return Object A dictionary of maximum values, indexed by direction.\r\n     * @inner\r\n     */\r\n    function createMaximumsData() {\r\n      var maxData = {};\r\n      maxData[LEFT] = createMaximumVO(LEFT);\r\n      maxData[RIGHT] = createMaximumVO(RIGHT);\r\n      maxData[UP] = createMaximumVO(UP);\r\n      maxData[DOWN] = createMaximumVO(DOWN);\r\n\r\n      return maxData;\r\n    }\r\n\r\n    /**\r\n     * Creates a map maximum swiped values for a given swipe direction\r\n     * @param {string} The direction that these values will be associated with\r\n     * @return Object Maximum values\r\n     * @inner\r\n     */\r\n    function createMaximumVO(dir) {\r\n      return {\r\n        direction: dir,\r\n        distance: 0\r\n      }\r\n    }\r\n\r\n\r\n    //\r\n    // MATHS / UTILS\r\n    //\r\n\r\n    /**\r\n     * Calculate the duration of the swipe\r\n     * @return int\r\n     * @inner\r\n     */\r\n    function calculateDuration() {\r\n      return endTime - startTime;\r\n    }\r\n\r\n    /**\r\n     * Calculate the distance between 2 touches (pinch)\r\n     * @param {point} startPoint A point object containing x and y co-ordinates\r\n     * @param {point} endPoint A point object containing x and y co-ordinates\r\n     * @return int;\r\n     * @inner\r\n     */\r\n    function calculateTouchesDistance(startPoint, endPoint) {\r\n      var diffX = Math.abs(startPoint.x - endPoint.x);\r\n      var diffY = Math.abs(startPoint.y - endPoint.y);\r\n\r\n      return Math.round(Math.sqrt(diffX * diffX + diffY * diffY));\r\n    }\r\n\r\n    /**\r\n     * Calculate the zoom factor between the start and end distances\r\n     * @param {int} startDistance Distance (between 2 fingers) the user started pinching at\r\n     * @param {int} endDistance Distance (between 2 fingers) the user ended pinching at\r\n     * @return float The zoom value from 0 to 1.\r\n     * @inner\r\n     */\r\n    function calculatePinchZoom(startDistance, endDistance) {\r\n      var percent = (endDistance / startDistance) * 1;\r\n      return percent.toFixed(2);\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns the pinch direction, either IN or OUT for the given points\r\n     * @return string Either {@link $.fn.swipe.directions.IN} or {@link $.fn.swipe.directions.OUT}\r\n     * @see $.fn.swipe.directions\r\n     * @inner\r\n     */\r\n    function calculatePinchDirection() {\r\n      if (pinchZoom < 1) {\r\n        return OUT;\r\n      } else {\r\n        return IN;\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Calculate the length / distance of the swipe\r\n     * @param {point} startPoint A point object containing x and y co-ordinates\r\n     * @param {point} endPoint A point object containing x and y co-ordinates\r\n     * @return int\r\n     * @inner\r\n     */\r\n    function calculateDistance(startPoint, endPoint) {\r\n      return Math.round(Math.sqrt(Math.pow(endPoint.x - startPoint.x, 2) + Math.pow(endPoint.y - startPoint.y, 2)));\r\n    }\r\n\r\n    /**\r\n     * Calculate the angle of the swipe\r\n     * @param {point} startPoint A point object containing x and y co-ordinates\r\n     * @param {point} endPoint A point object containing x and y co-ordinates\r\n     * @return int\r\n     * @inner\r\n     */\r\n    function calculateAngle(startPoint, endPoint) {\r\n      var x = startPoint.x - endPoint.x;\r\n      var y = endPoint.y - startPoint.y;\r\n      var r = Math.atan2(y, x); //radians\r\n      var angle = Math.round(r * 180 / Math.PI); //degrees\r\n\r\n      //ensure value is positive\r\n      if (angle < 0) {\r\n        angle = 360 - Math.abs(angle);\r\n      }\r\n\r\n      return angle;\r\n    }\r\n\r\n    /**\r\n     * Calculate the direction of the swipe\r\n     * This will also call calculateAngle to get the latest angle of swipe\r\n     * @param {point} startPoint A point object containing x and y co-ordinates\r\n     * @param {point} endPoint A point object containing x and y co-ordinates\r\n     * @return string Either {@link $.fn.swipe.directions.LEFT} / {@link $.fn.swipe.directions.RIGHT} / {@link $.fn.swipe.directions.DOWN} / {@link $.fn.swipe.directions.UP}\r\n     * @see $.fn.swipe.directions\r\n     * @inner\r\n     */\r\n    function calculateDirection(startPoint, endPoint) {\r\n\r\n      if( comparePoints(startPoint, endPoint) ) {\r\n        return NONE;\r\n      }\r\n\r\n      var angle = calculateAngle(startPoint, endPoint);\r\n\r\n      if ((angle <= 45) && (angle >= 0)) {\r\n        return LEFT;\r\n      } else if ((angle <= 360) && (angle >= 315)) {\r\n        return LEFT;\r\n      } else if ((angle >= 135) && (angle <= 225)) {\r\n        return RIGHT;\r\n      } else if ((angle > 45) && (angle < 135)) {\r\n        return DOWN;\r\n      } else {\r\n        return UP;\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns a MS time stamp of the current time\r\n     * @return int\r\n     * @inner\r\n     */\r\n    function getTimeStamp() {\r\n      var now = new Date();\r\n      return now.getTime();\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Returns a bounds object with left, right, top and bottom properties for the element specified.\r\n     * @param {DomNode} The DOM node to get the bounds for.\r\n     */\r\n    function getbounds(el) {\r\n      el = $(el);\r\n      var offset = el.offset();\r\n\r\n      var bounds = {\r\n        left: offset.left,\r\n        right: offset.left + el.outerWidth(),\r\n        top: offset.top,\r\n        bottom: offset.top + el.outerHeight()\r\n      }\r\n\r\n      return bounds;\r\n    }\r\n\r\n\r\n    /**\r\n     * Checks if the point object is in the bounds object.\r\n     * @param {object} point A point object.\r\n     * @param {int} point.x The x value of the point.\r\n     * @param {int} point.y The x value of the point.\r\n     * @param {object} bounds The bounds object to test\r\n     * @param {int} bounds.left The leftmost value\r\n     * @param {int} bounds.right The righttmost value\r\n     * @param {int} bounds.top The topmost value\r\n     * @param {int} bounds.bottom The bottommost value\r\n     */\r\n    function isInBounds(point, bounds) {\r\n      return (point.x > bounds.left && point.x < bounds.right && point.y > bounds.top && point.y < bounds.bottom);\r\n    };\r\n\r\n    /**\r\n     * Checks if the two points are equal\r\n     * @param {object} point A point object.\r\n     * @param {object} point B point object.\r\n     * @return true of the points match\r\n     */\r\n    function comparePoints(pointA, pointB) {\r\n      return (pointA.x == pointB.x && pointA.y == pointB.y);\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n  /**\r\n   * A catch all handler that is triggered for all swipe directions.\r\n   * @name $.fn.swipe#swipe\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user swiped\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   * @param {string} currentDirection The current direction the user is swiping.\r\n   */\r\n\r\n\r\n\r\n\r\n  /**\r\n   * A handler that is triggered for \"left\" swipes.\r\n   * @name $.fn.swipe#swipeLeft\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user swiped\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   * @param {string} currentDirection The current direction the user is swiping.\r\n   */\r\n\r\n  /**\r\n   * A handler that is triggered for \"right\" swipes.\r\n   * @name $.fn.swipe#swipeRight\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user swiped\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   * @param {string} currentDirection The current direction the user is swiping.\r\n   */\r\n\r\n  /**\r\n   * A handler that is triggered for \"up\" swipes.\r\n   * @name $.fn.swipe#swipeUp\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user swiped\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   * @param {string} currentDirection The current direction the user is swiping.\r\n   */\r\n\r\n  /**\r\n   * A handler that is triggered for \"down\" swipes.\r\n   * @name $.fn.swipe#swipeDown\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user swiped in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user swiped\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   * @param {string} currentDirection The current direction the user is swiping.\r\n   */\r\n\r\n  /**\r\n   * A handler triggered for every phase of the swipe. This handler is constantly fired for the duration of the pinch.\r\n   * This is triggered regardless of swipe thresholds.\r\n   * @name $.fn.swipe#swipeStatus\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {string} phase The phase of the swipe event. See {@link $.fn.swipe.phases}\r\n   * @param {string} direction The direction the user swiped in. This is null if the user has yet to move. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user swiped. This is 0 if the user has yet to move.\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   * @param {string} currentDirection The current direction the user is swiping.\r\n   */\r\n\r\n  /**\r\n   * A handler triggered for pinch in events.\r\n   * @name $.fn.swipe#pinchIn\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user pinched in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user pinched\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {int} zoom The zoom/scale level the user pinched too, 0-1.\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   */\r\n\r\n  /**\r\n   * A handler triggered for pinch out events.\r\n   * @name $.fn.swipe#pinchOut\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user pinched in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user pinched\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {int} zoom The zoom/scale level the user pinched too, 0-1.\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   */\r\n\r\n  /**\r\n   * A handler triggered for all pinch events. This handler is constantly fired for the duration of the pinch. This is triggered regardless of thresholds.\r\n   * @name $.fn.swipe#pinchStatus\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {int} direction The direction the user pinched in. See {@link $.fn.swipe.directions}\r\n   * @param {int} distance The distance the user pinched\r\n   * @param {int} duration The duration of the swipe in milliseconds\r\n   * @param {int} fingerCount The number of fingers used. See {@link $.fn.swipe.fingers}\r\n   * @param {int} zoom The zoom/scale level the user pinched too, 0-1.\r\n   * @param {object} fingerData The coordinates of fingers in event\r\n   */\r\n\r\n  /**\r\n   * A click handler triggered when a user simply clicks, rather than swipes on an element.\r\n   * This is deprecated since version 1.6.2, any assignment to click will be assigned to the tap handler.\r\n   * You cannot use <code>on</code> to bind to this event as the default jQ <code>click</code> event will be triggered.\r\n   * Use the <code>tap</code> event instead.\r\n   * @name $.fn.swipe#click\r\n   * @event\r\n   * @deprecated since version 1.6.2, please use {@link $.fn.swipe#tap} instead\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {DomObject} target The element clicked on.\r\n   */\r\n\r\n  /**\r\n   * A click / tap handler triggered when a user simply clicks or taps, rather than swipes on an element.\r\n   * @name $.fn.swipe#tap\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {DomObject} target The element clicked on.\r\n   */\r\n\r\n  /**\r\n   * A double tap handler triggered when a user double clicks or taps on an element.\r\n   * You can set the time delay for a double tap with the {@link $.fn.swipe.defaults#doubleTapThreshold} property.\r\n   * Note: If you set both <code>doubleTap</code> and <code>tap</code> handlers, the <code>tap</code> event will be delayed by the <code>doubleTapThreshold</code>\r\n   * as the script needs to check if its a double tap.\r\n   * @name $.fn.swipe#doubleTap\r\n   * @see  $.fn.swipe.defaults#doubleTapThreshold\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {DomObject} target The element clicked on.\r\n   */\r\n\r\n  /**\r\n   * A long tap handler triggered once a tap has been release if the tap was longer than the longTapThreshold.\r\n   * You can set the time delay for a long tap with the {@link $.fn.swipe.defaults#longTapThreshold} property.\r\n   * @name $.fn.swipe#longTap\r\n   * @see  $.fn.swipe.defaults#longTapThreshold\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {DomObject} target The element clicked on.\r\n   */\r\n\r\n  /**\r\n   * A hold tap handler triggered as soon as the longTapThreshold is reached\r\n   * You can set the time delay for a long tap with the {@link $.fn.swipe.defaults#longTapThreshold} property.\r\n   * @name $.fn.swipe#hold\r\n   * @see  $.fn.swipe.defaults#longTapThreshold\r\n   * @event\r\n   * @default null\r\n   * @param {EventObject} event The original event object\r\n   * @param {DomObject} target The element clicked on.\r\n   */\r\n\r\n}));\r\n"]}